<html>
<head><meta charset="utf-8"><title>Circularity and infinite chains in the locale hierarchy · General · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/index.html">General</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Circularity.20and.20infinite.20chains.20in.20the.20locale.20hierarchy.html">Circularity and infinite chains in the locale hierarchy</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="539523228"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Circularity%20and%20infinite%20chains%20in%20the%20locale%20hierarchy/near/539523228" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gergely Buday <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Circularity.20and.20infinite.20chains.20in.20the.20locale.20hierarchy.html#539523228">(Sep 15 2025 at 10:54)</a>:</h4>
<p>Section 5.7.3 Locale interpretation in the Isar Reference Manual says:</p>
<blockquote>
<p>Circular sublocale declarations are allowed as long as they do not lead to infinite chains.</p>
</blockquote>
<p>How a circular, sublocale A &lt; B, sublocale B &lt; A declaration does <em>not</em> lead to an infinite chain?</p>
<p>And, what declarations do lead to an infinite chain?</p>
<p>This works:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">locale</span><span class="w"> </span><span class="n">partial_order</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="kp">fixes</span><span class="w"> </span><span class="n">le</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a ⇒ 'a ⇒ bool"</span><span class="w"> </span><span class="o">(</span><span class="kp">infixl</span><span class="w"> </span><span class="s">"⊑"</span><span class="w"> </span><span class="n">50</span><span class="o">)</span>
<span class="w">  </span><span class="kp">assumes</span><span class="w"> </span><span class="n">reflexivity</span><span class="w"> </span><span class="o">[</span><span class="n">intro</span><span class="o">,</span><span class="w"> </span><span class="n">simp</span><span class="o">]:</span><span class="w"> </span><span class="s">"x ⊑ x"</span>
<span class="w">      </span><span class="kp">and</span><span class="w"> </span><span class="n">antisymmetry</span><span class="w"> </span><span class="o">[</span><span class="n">intro</span><span class="o">]:</span><span class="w"> </span><span class="s">"x ⊑ y ⟹ y ⊑ x ⟹ x = y"</span>
<span class="w">      </span><span class="kp">and</span><span class="w"> </span><span class="n">transitivity</span><span class="w"> </span><span class="o">[</span><span class="n">trans</span><span class="o">]:</span><span class="w"> </span><span class="s">"x ⊑ y ⟹ y ⊑ z ⟹ x ⊑ z"</span>
<span class="k">begin</span><span class="w"> </span><span class="k">end</span>

<span class="k">locale</span><span class="w"> </span><span class="n">po</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">partial_order</span>

<span class="kn">sublocale</span><span class="w"> </span><span class="n">po</span><span class="w"> </span><span class="n">&lt;</span><span class="w"> </span><span class="n">partial_order</span><span class="w"> </span><span class="ow">..</span>

<span class="kn">sublocale</span><span class="w"> </span><span class="n">partial_order</span><span class="w"> </span><span class="n">&lt;</span><span class="w"> </span><span class="n">po</span><span class="w"> </span><span class="kt">sledgehammer</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">partial_order_axioms</span><span class="w"> </span><span class="n">po_def</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">blast</span>
</code></pre></div>



<a name="539599067"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Circularity%20and%20infinite%20chains%20in%20the%20locale%20hierarchy/near/539599067" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Circularity.20and.20infinite.20chains.20in.20the.20locale.20hierarchy.html#539599067">(Sep 15 2025 at 16:07)</a>:</h4>
<p>You have to be careful, some locale errors only happens when you instantiate them</p>



<a name="539599170"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Circularity%20and%20infinite%20chains%20in%20the%20locale%20hierarchy/near/539599170" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Circularity.20and.20infinite.20chains.20in.20the.20locale.20hierarchy.html#539599170">(Sep 15 2025 at 16:08)</a>:</h4>
<p>because it is only at the instantiation time, that the theorems are generated</p>



<a name="539991531"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Circularity%20and%20infinite%20chains%20in%20the%20locale%20hierarchy/near/539991531" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel Eberl <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Circularity.20and.20infinite.20chains.20in.20the.20locale.20hierarchy.html#539991531">(Sep 17 2025 at 11:38)</a>:</h4>
<p>I think if you reach the exact same locale interpretation again in the chain that you already have then that's fine; it just terminates at that point. That's how e.g. the "dual" sublocales in the order locales work. But all the term parameters have to be exactly the same terms for that to work. I'm sure that's documented somewhere...</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>