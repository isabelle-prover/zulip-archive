<html>
<head><meta charset="utf-8"><title>CryptHOL: proof obvious advantage difference ¬∑ General ¬∑ Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/index.html">General</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/CryptHOL.3A.20proof.20obvious.20advantage.20difference.html">CryptHOL: proof obvious advantage difference</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="377591611"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/CryptHOL%3A%20proof%20obvious%20advantage%20difference/near/377591611" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tobias Rothmann <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/CryptHOL.3A.20proof.20obvious.20advantage.20difference.html#377591611">(Jul 22 2023 at 13:00)</a>:</h4>
<p>Hi, <br>
I have two games defined as follows:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="n">game0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRY</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="ow">{</span>
<span class="w">        </span><span class="n">Œ±</span><span class="o">::</span><span class="n">nat</span><span class="w"> </span><span class="n">‚Üê</span><span class="w"> </span><span class="n">sample_uniform</span><span class="w"> </span><span class="o">(</span><span class="n">order</span><span class="w"> </span><span class="n">G‚á©p</span><span class="o">)</span><span class="n">;</span>
<span class="w">        </span><span class="n">x</span><span class="o">::</span><span class="n n-Type">'y</span><span class="w"> </span><span class="n">‚Üê</span><span class="w"> </span><span class="o">(</span><span class="n">ùíú</span><span class="o">::</span><span class="n">nat</span><span class="w"> </span><span class="n">‚áí</span><span class="w"> </span><span class="n n-Type">'y</span><span class="w"> </span><span class="n">spmf</span><span class="o">)</span><span class="w"> </span><span class="n">Œ±;</span>
<span class="w">          </span><span class="o">_</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="n">‚Üê</span><span class="w"> </span><span class="n">assert_spmf</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="n">;</span>
<span class="w">          </span><span class="n">return_spmf</span><span class="w"> </span><span class="n">True</span>
<span class="w">      </span><span class="ow">}</span><span class="w"> </span><span class="n">ELSE</span><span class="w"> </span><span class="n">return_spmf</span><span class="w"> </span><span class="n">False</span>
</code></pre></div>
<p>and </p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="n">game1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TRY</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="ow">{</span>
<span class="w">        </span><span class="n">Œ±</span><span class="o">::</span><span class="n">nat</span><span class="w"> </span><span class="n">‚Üê</span><span class="w"> </span><span class="n">sample_uniform</span><span class="w"> </span><span class="o">(</span><span class="n">order</span><span class="w"> </span><span class="n">G‚á©p</span><span class="o">)</span><span class="n">;</span>
<span class="w">        </span><span class="n">x</span><span class="o">::</span><span class="n n-Type">'y</span><span class="w"> </span><span class="n">‚Üê</span><span class="w"> </span><span class="o">(</span><span class="n">ùíú</span><span class="o">::</span><span class="n">nat</span><span class="w"> </span><span class="n">‚áí</span><span class="w"> </span><span class="n n-Type">'y</span><span class="w"> </span><span class="n">spmf</span><span class="o">)</span><span class="w"> </span><span class="n">Œ±;</span>
<span class="w">          </span><span class="o">_</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="n">‚Üê</span><span class="w"> </span><span class="n">assert_spmf</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="n">;</span>
<span class="w">          </span><span class="o">_</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="n">‚Üê</span><span class="w"> </span><span class="n">assert_spmf</span><span class="w"> </span><span class="o">(</span><span class="n">b</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="n">;</span>
<span class="w">          </span><span class="n">return_spmf</span><span class="w"> </span><span class="n">True</span>
<span class="w">      </span><span class="ow">}</span><span class="w"> </span><span class="n">ELSE</span><span class="w"> </span><span class="n">return_spmf</span><span class="w"> </span><span class="n">False</span>
</code></pre></div>
<p>Now I want to show that the advantage the Adversary A can have in game0 is greater-equal to the advantage it can have in game1 , which is trivially true (or at least I thought so..) as game1 literally adds one assert to game0.<br>
However, the proof is not easy (for me).  <br>
I would greatly appreciate any help or advice in proving this thing. I already looked through the SPMF theory, but couldn't find anything, but a lot of measure lemmas, which left me clueless. </p>
<p>Ah one more thing, the goal looks like this:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="n">spmf</span><span class="w"> </span><span class="o">(</span><span class="n">game0</span><span class="w"> </span><span class="n">A</span><span class="o">)</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="n">&lt;</span><span class="o">=</span><span class="w"> </span><span class="n">spmf</span><span class="w"> </span><span class="o">(</span><span class="n">game1</span><span class="o">)</span><span class="w"> </span><span class="n">True</span>
</code></pre></div>
<p>Thanks for your time :)</p>



<a name="377956977"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/CryptHOL%3A%20proof%20obvious%20advantage%20difference/near/377956977" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/CryptHOL.3A.20proof.20obvious.20advantage.20difference.html#377956977">(Jul 24 2023 at 00:56)</a>:</h4>
<p>hi Tobias, have you looked at <a href="https://eprint.iacr.org/2018/941">https://eprint.iacr.org/2018/941</a> ?<br>
In this case, you need to apply some form of "identical-until-bad" reasoning (see Section 3.6) -- which I do agree was a bit heavyweight when I tried it</p>



<a name="378212292"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/CryptHOL%3A%20proof%20obvious%20advantage%20difference/near/378212292" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tobias Rothmann <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/CryptHOL.3A.20proof.20obvious.20advantage.20difference.html#378212292">(Jul 24 2023 at 16:54)</a>:</h4>
<p>Hi Yong, <br>
thanks a lot for the hint. I looked at it when I started with CryptHOL, but my understanding wasn't good enough to think of it again. <br>
But looks exactly like what I need to do, so thanks a lot! That saved definitely a lot of hours searching around :)</p>



<a name="378306461"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/CryptHOL%3A%20proof%20obvious%20advantage%20difference/near/378306461" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/CryptHOL.3A.20proof.20obvious.20advantage.20difference.html#378306461">(Jul 25 2023 at 00:50)</a>:</h4>
<p>FWIW: I found it much easier to start with <code>spmf</code> only when trying this out, I'm still totally lost on <code>gpv</code>s if I have to be honest <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="378569424"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/CryptHOL%3A%20proof%20obvious%20advantage%20difference/near/378569424" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tobias Rothmann <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/CryptHOL.3A.20proof.20obvious.20advantage.20difference.html#378569424">(Jul 25 2023 at 18:23)</a>:</h4>
<p>I can relate, even spmf is hard for me now, luckily I don't have to deal with gpv for my project <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="393937438"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/CryptHOL%3A%20proof%20obvious%20advantage%20difference/near/393937438" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tobias Rothmann <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/CryptHOL.3A.20proof.20obvious.20advantage.20difference.html#393937438">(Sep 29 2023 at 14:04)</a>:</h4>
<p>In case someone every stumbles upon this, I managed to proof this thing without a failure-event proof. <br>
Its the lemma "spmf_reduction" in this file:<a href="https://github.com/tobias-rothmann/KZG-Polynomial-Commitment-Scheme/blob/main/KZG_poly_bind.thy#L624">https://github.com/tobias-rothmann/KZG-Polynomial-Commitment-Scheme/blob/main/KZG_poly_bind.thy#L624</a></p>



<a name="394013968"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/CryptHOL%3A%20proof%20obvious%20advantage%20difference/near/394013968" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel Eberl <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/CryptHOL.3A.20proof.20obvious.20advantage.20difference.html#394013968">(Sep 29 2023 at 22:41)</a>:</h4>
<p>I don't know anything about CryptHOL, but I'd prove this by relational reasoning, without going down all the level to computing integrals. You can insert a <code>_ :: unit ‚Üê assert_pmf True</code> in the first program at the location where the additional line in the second one is, and then you can prove <code>rel_spmf (=) game1 game0</code> compositionally because the two programs are syntactically completely equal except for that one line, and that should give you what you need.</p>



<a name="394086839"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/CryptHOL%3A%20proof%20obvious%20advantage%20difference/near/394086839" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tobias Rothmann <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/CryptHOL.3A.20proof.20obvious.20advantage.20difference.html#394086839">(Sep 30 2023 at 13:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232736">Manuel Eberl</span> <a href="#narrow/stream/202961-General/topic/CryptHOL.3A.20proof.20obvious.20advantage.20difference/near/394013968">said</a>:</p>
<blockquote>
<p>I don't know anything about CryptHOL, but I'd prove this by relational reasoning, without going down all the level to computing integrals. You can insert a <code>_ :: unit ‚Üê assert_pmf True</code> in the first program at the location where the additional line in the second one is, and then you can prove <code>rel_spmf (=) game1 game0</code> compositionally because the two programs are syntactically completely equal except for that one line, and that should give you what you need.</p>
</blockquote>
<p>Ahh thanks for the hint! Didn't think of it, I'll try it out and update accordingly sometime soon. Thanks :)</p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>