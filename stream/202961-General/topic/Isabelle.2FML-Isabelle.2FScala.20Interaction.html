<html>
<head><meta charset="utf-8"><title>Isabelle/ML-Isabelle/Scala Interaction · General · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/index.html">General</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html">Isabelle/ML-Isabelle/Scala Interaction</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="440310561"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/440310561" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan Julian Huerta y Munive <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#440310561">(May 23 2024 at 12:20)</a>:</h4>
<p>Hi, I want to find the Isabelle/ML and Isabelle/Scala functions in charge of communicating both worlds. The way I currently understand Isabelle's inner workings is that there is a "thread" managing the messages from both systems. I am interested in the functions (from both sides) that send and receive the messages to/from this "thread". If this is not the correct model, an explanation with pointers to the code would be desirable. Written in another way, I am interested in the functions corresponding to the "internal protocol" part in slide 5 of <a href="https://isabelle.in.tum.de/nominal/activities/tphols09/IDW/MW-slides4.pdf">these slides</a>. Thanks!</p>



<a name="440350994"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/440350994" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#440350994">(May 23 2024 at 15:47)</a>:</h4>
<p>What are you trying to achieve, exactly? There are many moving parts here, and your question is too broad to answer well.</p>



<a name="440352787"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/440352787" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#440352787">(May 23 2024 at 15:57)</a>:</h4>
<p>Certainly there is no 'single thread that manages all  communication and lives outside the system' if that is what you mean</p>



<a name="440353102"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/440353102" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#440353102">(May 23 2024 at 15:58)</a>:</h4>
<p>On a technical level, there are System channels and Databases for IPC.</p>



<a name="440359832"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/440359832" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan Julian Huerta y Munive <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#440359832">(May 23 2024 at 16:35)</a>:</h4>
<p>I am trying to understand Isabelle better to decide the best approach to interface the proving process with Python. Suppose I want to use <a href="https://github.com/py4j/py4j">this Python library</a>. I would like to build a heap, postulate a theorem from Python from that point, receive a filtered list of possible methods and proven theorems from this heap, choose the proof method and its arguments from Python, ask Isabelle/ML to send back the new Proof.state after using that method, and repeat. After looking at Isabelle's scala files, it seems to me that doing it via Isabelle/scala would alleviate the need of building my own YXML parsers, document model, thread management, and all the engineering already there.</p>



<a name="440373999"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/440373999" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#440373999">(May 23 2024 at 18:10)</a>:</h4>
<p>Yes, I would highly recommend simply using Isabelle/Scala instead of trying to interact with the raw Poly/ML process.</p>



<a name="440498981"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/440498981" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan Julian Huerta y Munive <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#440498981">(May 24 2024 at 12:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="348400">Fabian Huch</span> <a href="#narrow/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction/near/440353102">said</a>:</p>
<blockquote>
<p>On a technical level, there are System channels and Databases for IPC.</p>
</blockquote>
<p>Based on this, I guess I would like to pinpoint how the proof state is updated from the Isabelle/scala part. Reading the libraries takes a lot of time. Is the process described precisely somewhere with pointers to the code?</p>



<a name="440529430"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/440529430" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#440529430">(May 24 2024 at 15:16)</a>:</h4>
<p>No, the precise document is the code itself. Maybe you are better off using the Isabelle server to send theory snippets/receive results? Of course it doesn't scale as well, but it's easy to use from the outside, and there are even python bindings for the API.</p>



<a name="440529785"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/440529785" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#440529785">(May 24 2024 at 15:19)</a>:</h4>
<p>Anyway, the state is updated via <code>Document.Edit</code>s (see Pure/PIDE/document.scala), which are progressed from within the ML process.</p>



<a name="440550995"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/440550995" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan Julian Huerta y Munive <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#440550995">(May 24 2024 at 17:37)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="348400">@Fabian Huch</span>. I'll take my time to understand Isabelle/Scala. I think I am making good progress on that front.</p>



<a name="445295934"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/445295934" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan Julian Huerta y Munive <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#445295934">(Jun 18 2024 at 08:00)</a>:</h4>
<p>For future reference to whoever is interested: the most useful file to answer my question was <code>session.scala</code>. The file has its own model of the <code>prover</code> and it declares various <code>Consumer_Thread</code>s to interact with it and the PIDE. Interesting threads in that file are <code>manager</code>, <code>dispatcher</code> and <code>change_parser</code>. Among the messages that they handle are <code>Prover.Output</code>s and <code>Prover.Input</code>s. Accordingly, the file <code>prover.scala</code> provides the <code>Prover</code> class extending the referred <code>Protocol</code> in the slides linked above. The protocol is implemented in both the scala side (<code>protocol.scala</code>) and the ML side (<code>protocol.ML</code>). Then, as Fabian stated, <code>Document.Edits</code> are sent to the ML side which contain the code snippets that Isabelle/ML processes.</p>



<a name="472248573"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/472248573" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chengsong Tan <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#472248573">(Sep 23 2024 at 14:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="441006">Jonathan Julian Huerta y Munive</span> <a href="#narrow/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction/near/445295934">said</a>:</p>
<blockquote>
<p>For future reference to whoever is interested: the most useful file to answer my question was <code>session.scala</code>. The file has its own model of the <code>prover</code> and it declares various <code>Consumer_Thread</code>s to interact with it and the PIDE. Interesting threads in that file are <code>manager</code>, <code>dispatcher</code> and <code>change_parser</code>. Among the messages that they handle are <code>Prover.Output</code>s and <code>Prover.Input</code>s. Accordingly, the file <code>prover.scala</code> provides the <code>Prover</code> class extending the referred <code>Protocol</code> in the slides linked above. The protocol is implemented in both the scala side (<code>protocol.scala</code>) and the ML side (<code>protocol.ML</code>). Then, as Fabian stated, <code>Document.Edits</code> are sent to the ML side which contain the code snippets that Isabelle/ML processes.</p>
</blockquote>
<p>Hi Julian,</p>
<p>Thanks very much for this very useful information! I am now also trying to come up with some automated tools utilizing Isabelle/Scala.<br>
I was wondering if you have any "hello world" snippets you can share? For instance what code in Isabelle/Scala did you write to cause an edit to happen without actually editing in jedit? Or how do you intercept the messages returned by the prover IDE and print them to stdout instead?</p>
<p>Thanks a lot for any help in advance!</p>
<p>Best wishes,<br>
Chengsong</p>



<a name="472654500"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/472654500" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan Julian Huerta y Munive <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#472654500">(Sep 25 2024 at 09:44)</a>:</h4>
<p><span class="user-mention" data-user-id="241231">@Chengsong Tan</span> I am sorry to write that I do not have anything quick to follow/share with you. Basically, I used the <a href="https://isabelle-dev.sketis.net/source/isabelle/">develop version of Isabelle with its Mercurial version control</a> and modified the code in a personal "branch" in <code>session.scala</code> so that the <code>manager</code> and the <code>dispatcher</code> printed to the standard output some messages that they send and receive. However, after reading them and the <code>protocol.scala</code> I felt that the messages that they send are very specific for the PIDE. Right now I am using <a href="https://dominique-unruh.github.io/scala-isabelle/">Dominique Unruh's scala-isabelle</a> which seems to work for my purposes. If you wish, we can discuss more privately about each other's objectives and maybe we can align them.</p>



<a name="472658458"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle/ML-Isabelle/Scala%20Interaction/near/472658458" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jonathan Julian Huerta y Munive <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle.2FML-Isabelle.2FScala.20Interaction.html#472658458">(Sep 25 2024 at 10:06)</a>:</h4>
<p>If you want to go the "official" way, code that might be useful to read appears in <code>PIDE/headless.scala</code> (e.g. <code>resources.start_session</code>) and its interaction with <code>Tools/server_commands.scala</code></p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>