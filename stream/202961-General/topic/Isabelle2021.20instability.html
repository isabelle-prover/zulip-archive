<html>
<head><meta charset="utf-8"><title>Isabelle2021 instability · General · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/index.html">General</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html">Isabelle2021 instability</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="228500481"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228500481" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Nowak <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228500481">(Mar 02 2021 at 22:44)</a>:</h4>
<p>Ever since upgrading to the new Isabelle2021, occasionally my the "zulu architecture" takes about 100% cpu usage, likely triggered by typing some proofs, not even necessarily <code>try</code> or anything. The only option is to close Isabelle, and 2/3 times it works. But occasionally the proof search processes (z3,...) never exit, and I need to restart my whole PC. Has anyone run into similar issues? I'm on Windows x64 on fairly recent hardware.</p>



<a name="228509685"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228509685" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Nowak <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228509685">(Mar 03 2021 at 00:00)</a>:</h4>
<p><a href="/user_uploads/14278/y-FVhsdhIg7pLJIPXwnaDjyN/grafik.png">This seems to be a common pattern</a> (usage drops to 0 since I quit isabelle)</p>
<div class="message_inline_image"><a href="/user_uploads/14278/y-FVhsdhIg7pLJIPXwnaDjyN/grafik.png" title="This seems to be a common pattern"><img src="/user_uploads/14278/y-FVhsdhIg7pLJIPXwnaDjyN/grafik.png"></a></div>



<a name="228541118"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228541118" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228541118">(Mar 03 2021 at 05:53)</a>:</h4>
<p>Any specific reason to assume z3 is responsible?</p>



<a name="228541365"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228541365" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228541365">(Mar 03 2021 at 05:56)</a>:</h4>
<p>Anyway, next time you start Isabelle, can you open the Monitor (bottom right, double click on ML) and look what happens on the ML side when it freezes? I saw this kind of things happen before on large theories and very slow GCing, but that might be something different.</p>



<a name="228542080"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228542080" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228542080">(Mar 03 2021 at 06:06)</a>:</h4>
<p>What kind of formalization are you doing?</p>



<a name="228542201"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228542201" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228542201">(Mar 03 2021 at 06:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="392349">Max Nowak</span> <a href="#narrow/stream/202961-general/topic/Isabelle2021.20instability/near/228509685">said</a>:</p>
<blockquote>
<p><a href="/user_uploads/14278/y-FVhsdhIg7pLJIPXwnaDjyN/grafik.png">This seems to be a common pattern</a> (usage drops to 0 since I quit isabelle)</p>
</blockquote>
<p>I am not familiar with the windows task manager. Is that one CPU or all CPUs? Does 100% mean every core is used?</p>



<a name="228686596"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228686596" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Nowak <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228686596">(Mar 03 2021 at 23:17)</a>:</h4>
<p>That is all CPUs. No particular reason why z3, but it tends to happen when I use <code>try</code> or even just normal typing, and... hm, random realization: it tends to happen particularly often when I edit something at the beginning of a long proof, so maybe isabelle/hol tries spawning very heavy proof searches for all the now-broken subsequent proof steps, and hence lags a bunch?</p>



<a name="228686678"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228686678" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Nowak <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228686678">(Mar 03 2021 at 23:18)</a>:</h4>
<p>I am not sure what to look for in the ML window.</p>



<a name="228722601"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228722601" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228722601">(Mar 04 2021 at 06:05)</a>:</h4>
<p>In the ML window, look at the heap panel and if see anything suspicious (I don't know what to expect either). For example, you might see that GC is happening every 0.3 seconds, indicating that polyml needs more memory</p>



<a name="228722779"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228722779" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228722779">(Mar 04 2021 at 06:08)</a>:</h4>
<p>When editing long proof and something breaks, I add a <code>oops</code> to make sure Isabelle is not running something (like metis or blast).</p>



<a name="228750249"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228750249" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Nowak <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228750249">(Mar 04 2021 at 10:44)</a>:</h4>
<p>ML isn't the issue I think, it's got to be something else. Looking into the java monitoring console, I spotted a thread which seems to be running a solver all the time, even though there's nothing to do currently in my file, the stack trace is never in any waiting method, and instead always in <code>kodkod.engine.Solver.solve()</code> or deeper. And exactly one of my cores is currently fully loaded, so I assume it's just this thread too? Gut feeling tells me there's some issue killing the solvers once they're no longer needed and/or starting too many. Or maybe it's just an intended background task.</p>



<a name="228750720"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228750720" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228750720">(Mar 04 2021 at 10:48)</a>:</h4>
<p>I know that some threads have moved from ML to Scala (aka java), like Kodkod. But I have no idea what happens in your case. You could try to deactivate auto_nitpick, but I don't know if this helps</p>



<a name="228750836"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228750836" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228750836">(Mar 04 2021 at 10:49)</a>:</h4>
<p>I have a similar problem in Isabelle2020 when editing a file with two long proofs. After some time Isabelle greys out repeatedly but without Isabelle nor the system going out of memory. It is especially surprising since the file does not depend on other theories and the file itself is not too long (~700 lines).</p>



<a name="228751187"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228751187" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Nowak <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228751187">(Mar 04 2021 at 10:53)</a>:</h4>
<p>Same theories, but isabelle2020 and everything is just fine for me.</p>



<a name="228758612"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/228758612" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#228758612">(Mar 04 2021 at 11:54)</a>:</h4>
<p>If it is kodkod-Scala specifically, you could try Isabelle/jEdit &gt; Plugins &gt; Plugins options. Then Plugin Options &gt; Isabelle &gt; General &gt; Miscellaneous Tools &gt; untick kodkod scala</p>



<a name="229250459"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/229250459" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pandaman <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#229250459">(Mar 08 2021 at 05:38)</a>:</h4>
<p>Hi! I stumbled upon this thread and tried monitoring my long-running theory. The theory takes several minutes at <code>apply (auto simp add: Let_def)</code>, and the heap monitor shows the "zigzag" behavior at the time. Is this something that can be mitigated by adjusting the config, rewriting the proof, etc.? <a href="/user_uploads/14278/pl9K-KBtwLF6kZ8lWMdspC0E/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/14278/pl9K-KBtwLF6kZ8lWMdspC0E/image.png" title="image.png"><img src="/user_uploads/14278/pl9K-KBtwLF6kZ8lWMdspC0E/image.png"></a></div>



<a name="229251089"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/229251089" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#229251089">(Mar 08 2021 at 05:48)</a>:</h4>
<p>Rewrite the proof.</p>



<a name="229304883"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/229304883" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Max Nowak <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#229304883">(Mar 08 2021 at 14:15)</a>:</h4>
<p>The heap monitor always shows a zigzag for me, no matter what I do. I assumed that is normal behaviour though?</p>



<a name="229348847"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/229348847" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#229348847">(Mar 08 2021 at 18:24)</a>:</h4>
<p>the zigzag is normal. In big applications, memory pressure increases and you expect at some point a full GC where the allocated memory increases (the red curve)</p>



<a name="229349453"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/229349453" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel Eberl <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#229349453">(Mar 08 2021 at 18:28)</a>:</h4>
<p>I think the official recommendation is that if you have to open the memory monitor for any reason, you should buy more RAM. <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span> </p>
<p>I have 16 GB on my laptop and that's usually enough. My desktop has 32 GB and that's pretty much always enough. Less than 16 GB can be a bit problematic (although I, too, wonder <em>why</em> Isabell needs that much memory…)</p>



<a name="229421227"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/229421227" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> pandaman <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#229421227">(Mar 09 2021 at 04:41)</a>:</h4>
<p>Thank you for the answer. I already have 32GB of RAM and tried to tweak ISABELLE_TOOL_JAVA_OPTIONS and ML_OPTIONS, but it didn't change the behavior (maybe I should have closed the browser).<br>
It seems that the expansion of the let expression is behaving exponentially, so I will try to work around this during the proof.</p>



<a name="229441550"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/229441550" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#229441550">(Mar 09 2021 at 08:46)</a>:</h4>
<p>To change the settings for the java process in<code>Isabelle/jEdit</code>, you have to set <code>JEDIT_JAVA_OPTIONS</code> (at least in a repository version).</p>



<a name="229447113"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Isabelle2021%20instability/near/229447113" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel Eberl <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Isabelle2021.20instability.html#229447113">(Mar 09 2021 at 09:30)</a>:</h4>
<p>Indeed, if 32 GB isn't enough, you really should change the proof.</p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>