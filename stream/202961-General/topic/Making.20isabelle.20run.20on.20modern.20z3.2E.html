<html>
<head><meta charset="utf-8"><title>Making isabelle run on modern z3. · General · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/index.html">General</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html">Making isabelle run on modern z3.</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="475986314"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/475986314" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#475986314">(Oct 10 2024 at 00:49)</a>:</h4>
<p>Making a new thread to distinguish from the previous thread on making isabelle run on musl-c</p>



<a name="475986354"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/475986354" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#475986354">(Oct 10 2024 at 00:49)</a>:</h4>
<p><a href="https://www21.in.tum.de/~boehmes/proofrec.pdf">https://www21.in.tum.de/~boehmes/proofrec.pdf</a><br>
think this is the paper?</p>



<a name="476020442"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476020442" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476020442">(Oct 10 2024 at 03:41)</a>:</h4>
<p>Ok looking at it so far Z3 now uses SMTLIB2.<br>
isabelle already has some code ~~/src/HOL/Tools/SMT/smtlib for smtlib2 which is used for verit i think.</p>



<a name="476021920"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476021920" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476021920">(Oct 10 2024 at 03:48)</a>:</h4>
<p><a href="https://www.verit-solver.org/papers/pxtp2019.pdf">https://www.verit-solver.org/papers/pxtp2019.pdf</a><br>
found another relevant paper</p>



<a name="476031589"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476031589" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476031589">(Oct 10 2024 at 04:56)</a>:</h4>
<p>The PhD thesis is probably a better start <a href="https://www21.in.tum.de/~boehmes/phd_thesis.pdf">https://www21.in.tum.de/~boehmes/phd_thesis.pdf</a></p>



<a name="476032445"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476032445" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476032445">(Oct 10 2024 at 05:04)</a>:</h4>
<p>I have to do some digging if I still have the patch I used back then, but anyway the realistic path to do this is to add a z3_new and keep the old one:</p>
<ol>
<li>add a Z3_NEW_SOLVER to the binary to the <code>.isabelle/etc/settings</code> file (compare it to <code>$ isabelle env | grep Z3</code></li>
<li>add a z3_new system to <code>~/src/HOL/Tools/smt/smt_systems.ML</code> (duplicate the z3 fields + duplicate the reconstruction function by creating a new file)</li>
<li>copy <code>~~/src/HOL/SMT_Examples/SMT_Examples.thy</code> into <code>~~/src/HOL/SMT_Examples/SMT_Examples_Z3_New.thy</code>, replace z3 by z3_new, remove the certificates stuff (comment out the two lines on top) and look at the examples that fail here</li>
</ol>



<a name="476032481"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476032481" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476032481">(Oct 10 2024 at 05:05)</a>:</h4>
<p>Then you need to know the <code>[[smt_trace]]</code> flag to see what the reconstruction is doing</p>



<a name="476032610"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476032610" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476032610">(Oct 10 2024 at 05:06)</a>:</h4>
<p>and the obvious thing: if the lemma you have is only about quantifiers, bool, and int, you can copy it over to SMT.thy and change the reconstruction directly</p>



<a name="476032626"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476032626" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476032626">(Oct 10 2024 at 05:06)</a>:</h4>
<p>Do not forget to start Isabelle with Pure as base session (<code>-l Pure</code>)</p>



<a name="476032941"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476032941" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476032941">(Oct 10 2024 at 05:10)</a>:</h4>
<p>(PS: there are two people around who can answer questions on the reconstruction, <span class="user-mention" data-user-id="477368">@Hanna Lachnitt</span> and me, so it might be a good idea to explicitly mention me when you have a question)</p>



<a name="476071103"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476071103" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476071103">(Oct 10 2024 at 08:07)</a>:</h4>
<p>I have a request: the SMT method sometimes fails if there is high system load, e. g. <a href="https://build.proof.cit.tum.de/build?name=all%2F190">here</a>. While you're delving into SMT, could you check if this can be made more robust? I suspect that there's a timeout somewhere in the internals.</p>



<a name="476072369"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476072369" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476072369">(Oct 10 2024 at 08:12)</a>:</h4>
<p>That is another issue that has nothing to do with this (if there is a timeout you get a proper error)</p>



<a name="476072419"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476072419" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476072419">(Oct 10 2024 at 08:12)</a>:</h4>
<p>There is no timeout anymore (see the smt_timeout parameter)</p>



<a name="476072855"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476072855" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476072855">(Oct 10 2024 at 08:14)</a>:</h4>
<p>I think the issue is that Isabelle is spawning so many tasks that all the external threads (smt is running in a bash shell) is starved until another general timeout happens</p>



<a name="476074229"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476074229" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476074229">(Oct 10 2024 at 08:21)</a>:</h4>
<p>Hmm I see</p>



<a name="476074327"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476074327" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476074327">(Oct 10 2024 at 08:22)</a>:</h4>
<p>I believe that this issue is somehow linked to the windows issue of stuff not being killed</p>



<a name="476074713"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476074713" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476074713">(Oct 10 2024 at 08:24)</a>:</h4>
<p>Internally smt and sledgehammer are relying on this in cache_io to run code:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">fun</span><span class="w"> </span><span class="n">raw_run</span><span class="w"> </span><span class="n">make_cmd</span><span class="w"> </span><span class="n">str</span><span class="w"> </span><span class="n">in_path</span><span class="w"> </span><span class="n">out_path</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="k">let</span>
<span class="w">    </span><span class="n">val</span><span class="w"> </span><span class="o">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">File.write</span><span class="w"> </span><span class="n">in_path</span><span class="w"> </span><span class="n">str</span>
<span class="w">    </span><span class="n">val</span><span class="w"> </span><span class="o">(</span><span class="n">out2</span><span class="o">,</span><span class="w"> </span><span class="n">rc</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Isabelle_System.bash_output</span><span class="w"> </span><span class="o">(</span><span class="n">make_cmd</span><span class="w"> </span><span class="n">in_path</span><span class="w"> </span><span class="n">out_path</span><span class="o">)</span>
<span class="w">    </span><span class="n">val</span><span class="w"> </span><span class="n">out1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">try_read_lines</span><span class="w"> </span><span class="n">out_path</span>
<span class="w">  </span><span class="kp">in</span><span class="w"> </span><span class="ow">{</span><span class="kp">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split_lines</span><span class="w"> </span><span class="n">out2</span><span class="o">,</span><span class="w"> </span><span class="n">redirected_output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">out1</span><span class="o">,</span><span class="w"> </span><span class="n">return_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rc</span><span class="ow">}</span><span class="w"> </span><span class="k">end</span>
</code></pre></div>
<p>and this:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">fun</span><span class="w"> </span><span class="n">with_time_limit</span><span class="w"> </span><span class="n">ctxt</span><span class="w"> </span><span class="n">timeout_config</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="n">Timeout.apply</span><span class="w"> </span><span class="o">(</span><span class="n">seconds</span><span class="w"> </span><span class="o">(</span><span class="n">Config.get</span><span class="w"> </span><span class="n">ctxt</span><span class="w"> </span><span class="n">timeout_config</span><span class="o">))</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">x</span>
<span class="w">    </span><span class="n">handle</span><span class="w"> </span><span class="n">Timeout.TIMEOUT</span><span class="w"> </span><span class="o">_</span><span class="w"> </span><span class="o">=</span><span class="n">&gt;</span><span class="w"> </span><span class="n">raise</span><span class="w"> </span><span class="n">SMT_Failure.SMT</span><span class="w"> </span><span class="n">SMT_Failure.Time_Out</span>
</code></pre></div>
<p>to limit the amount of time</p>



<a name="476074899"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476074899" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476074899">(Oct 10 2024 at 08:25)</a>:</h4>
<p>So the culprit would be <code>Isabelle_System.bash_output</code></p>



<a name="476074959"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476074959" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476074959">(Oct 10 2024 at 08:25)</a>:</h4>
<p>That is my guess, but I have no clue how to check that</p>



<a name="476075031"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476075031" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476075031">(Oct 10 2024 at 08:25)</a>:</h4>
<p>We also get some spurious nitpick errors: </p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="n">Unexpected</span><span class="w"> </span><span class="n">outcome</span><span class="o">:</span><span class="w"> </span><span class="s">"unknown"</span>
<span class="n">***</span><span class="w">                              </span><span class="n">At</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="s">"nitpick"</span>
</code></pre></div>
<p>which might be for the same reason</p>



<a name="476075135"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476075135" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476075135">(Oct 10 2024 at 08:26)</a>:</h4>
<p>basically yes, but here there is a timeout</p>



<a name="476075151"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476075151" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476075151">(Oct 10 2024 at 08:26)</a>:</h4>
<p>hence the unknown answer</p>



<a name="476075858"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476075858" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476075858">(Oct 10 2024 at 08:29)</a>:</h4>
<p>Oh you're right, that seems like a weird implementation of nitpick</p>



<a name="476076395"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476076395" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476076395">(Oct 10 2024 at 08:32)</a>:</h4>
<p>It is more complicated than that I think: during development it totally makes sense to have such a timeout. Also these problems only appear on big servers or slow machines (I tried to run Isabelle on raspberry pi)</p>



<a name="476076457"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476076457" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476076457">(Oct 10 2024 at 08:32)</a>:</h4>
<p>Well also under heavy load on normal machines</p>



<a name="476077260"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476077260" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476077260">(Oct 10 2024 at 08:36)</a>:</h4>
<p>I remember the time before I could run <code>-j 8</code> on my office machine (not enough RAM) and back then that was not an issue</p>



<a name="476077372"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476077372" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476077372">(Oct 10 2024 at 08:37)</a>:</h4>
<p>but you are right that this should be fixed somehow</p>



<a name="476077627"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476077627" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476077627">(Oct 10 2024 at 08:38)</a>:</h4>
<p>It was not an issue before because the build strategy was too inefficient</p>



<a name="476078630"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476078630" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476078630">(Oct 10 2024 at 08:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="348400">Fabian Huch</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476074899">said</a>:</p>
<blockquote>
<p>So the culprit would be <code>Isabelle_System.bash_output</code></p>
</blockquote>
<p>But somehow trying to understand the behavior sounds like a bachelor project (at least understanding the behavior)</p>



<a name="476078770"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476078770" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476078770">(Oct 10 2024 at 08:44)</a>:</h4>
<p>do you have bachelor students around?</p>



<a name="476079179"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476079179" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476079179">(Oct 10 2024 at 08:46)</a>:</h4>
<p>I don't think code archeology is a good thesis project...</p>



<a name="476079738"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476079738" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476079738">(Oct 10 2024 at 08:48)</a>:</h4>
<p>Not for a thesis. But as a more practical project (so trying to understand the behavior and the order in which the jobs are done)</p>



<a name="476079835"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476079835" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476079835">(Oct 10 2024 at 08:49)</a>:</h4>
<p>Sadly I don't really have students for that</p>



<a name="476384466"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476384466" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476384466">(Oct 11 2024 at 13:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476032445">said</a>:</p>
<blockquote>
<p>I have to do some digging if I still have the patch I used back then, but anyway the realistic path to do this is to add a z3_new and keep the old one:</p>
<ol>
<li>add a Z3_NEW_SOLVER to the binary to the <code>.isabelle/etc/settings</code> file (compare it to <code>$ isabelle env | grep Z3</code></li>
<li>add a z3_new system to <code>~/src/HOL/Tools/smt/smt_systems.ML</code> (duplicate the z3 fields + duplicate the reconstruction function by creating a new file)</li>
<li>copy <code>~~/src/HOL/SMT_Examples/SMT_Examples.thy</code> into <code>~~/src/HOL/SMT_Examples/SMT_Examples_Z3_New.thy</code>, replace z3 by z3_new, remove the certificates stuff (comment out the two lines on top) and look at the examples that fail here</li>
</ol>
</blockquote>
<p>Manage to finally get started. And found the issue specifically its from calling  </p>
<p>lemma "(a \&lt;and&gt; b) \&lt;or&gt; (c \&lt;and&gt; d) \&lt;Longrightarrow&gt; (a \&lt;and&gt; b) \&lt;or&gt; (c \&lt;and&gt; d)" by (smt (z3_new )) which leads to this issue <a href="https://github.com/Z3Prover/z3/issues/5073">https://github.com/Z3Prover/z3/issues/5073</a></p>



<a name="476386624"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476386624" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476386624">(Oct 11 2024 at 13:15)</a>:</h4>
<p>Im planning to ignore that issue first try to get proof-bind to work. Can even revert back to an older commit where its fixed</p>



<a name="476387108"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476387108" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476387108">(Oct 11 2024 at 13:18)</a>:</h4>
<p>I checked it as far as to find a release where that was working</p>



<a name="476387222"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476387222" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476387222">(Oct 11 2024 at 13:18)</a>:</h4>
<p>(it is written somewhere on Makarius' bug tracker)</p>



<a name="476387587"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476387587" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476387587">(Oct 11 2024 at 13:20)</a>:</h4>
<p>Or not <a href="https://isabelle-dev.sketis.net/T29">https://isabelle-dev.sketis.net/T29</a>, I must be misremembering</p>



<a name="476387627"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476387627" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476387627">(Oct 11 2024 at 13:20)</a>:</h4>
<p>but there was one release where this was working</p>



<a name="476388911"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476388911" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476388911">(Oct 11 2024 at 13:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476387108">said</a>:</p>
<blockquote>
<p>I checked it as far as to find a release where that was working</p>
</blockquote>
<p>You wrote it in the issue itself <a href="https://github.com/Z3Prover/z3/issues/5073#issuecomment-1273517432">https://github.com/Z3Prover/z3/issues/5073#issuecomment-1273517432</a></p>



<a name="476390549"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476390549" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476390549">(Oct 11 2024 at 13:36)</a>:</h4>
<p>I noticed you mention <a href="https://publikationen.bibliothek.kit.edu/1000131835">https://publikationen.bibliothek.kit.edu/1000131835</a> as papers using z3 with proof reconstruction as one of the latest do you have a list of papers which have z3 reconstruction</p>



<a name="476390857"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476390857" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476390857">(Oct 11 2024 at 13:38)</a>:</h4>
<p>search engine does not seem to really show any except the isabelle one</p>



<a name="476392344"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476392344" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476392344">(Oct 11 2024 at 13:46)</a>:</h4>
<p>There is the Isabelle one by Sascha, the HOL4 one by Tjark (<a href="https://www21.in.tum.de/~boehmes/fast_proof_rec/fast_proof_rec.pdf">https://www21.in.tum.de/~boehmes/fast_proof_rec/fast_proof_rec.pdf</a>) -- they both wrote it up together --, and the Key one you found</p>



<a name="476392492"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476392492" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476392492">(Oct 11 2024 at 13:48)</a>:</h4>
<p>I had a patch to support proof-bind (it was not hard, I think ignoring it was possible)</p>



<a name="476392552"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476392552" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476392552">(Oct 11 2024 at 13:48)</a>:</h4>
<p>but I cannot find it anymore</p>



<a name="476392623"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476392623" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476392623">(Oct 11 2024 at 13:48)</a>:</h4>
<p>The main issue is finding out what it does, because I never found any documentation on that</p>



<a name="476393360"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476393360" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476393360">(Oct 11 2024 at 13:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="714722">irvin</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476386624">said</a>:</p>
<blockquote>
<p>Im planning to ignore that issue first try to get proof-bind to work. Can even revert back to an older commit where its fixed</p>
</blockquote>
<p>that is a good plan. Better finding out how much is broken before trying to fix the bug on the reconstruction side</p>



<a name="476394571"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476394571" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476394571">(Oct 11 2024 at 13:58)</a>:</h4>
<p>(I mostly stopped at that point because I run out of free work cycles while waiting for Z3 answers)</p>



<a name="476399700"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476399700" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476399700">(Oct 11 2024 at 14:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476392623">said</a>:</p>
<blockquote>
<p>The main issue is finding out what it does, because I never found any documentation on that</p>
</blockquote>
<p>Seems to be the commit where proof-bind was added <a href="https://github.com/Z3Prover/z3/commit/520ce9a5ee6079651580b6d83bc2db0f342b8a20">https://github.com/Z3Prover/z3/commit/520ce9a5ee6079651580b6d83bc2db0f342b8a20</a></p>



<a name="476402307"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476402307" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476402307">(Oct 11 2024 at 14:40)</a>:</h4>
<p>So it is the equivalent of the Isar block</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="ow">{</span>
<span class="k">fix</span><span class="w"> </span><span class="n">x</span>
<span class="w">  </span><span class="ow">...</span><span class="k">proof</span><span class="ow">..</span>
<span class="ow">}</span><span class="w"> </span><span class="c">(*exported last fact here*)</span>
</code></pre></div>



<a name="476403162"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476403162" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476403162">(Oct 11 2024 at 14:45)</a>:</h4>
<p>This is not hard to represent in Isabelle (you declare the new variables in the context and export the fact at the end):</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="c">(*creating a sub_ctxt where the new variable skolem_name is declared*)</span>
<span class="n">val</span><span class="w"> </span><span class="o">([</span><span class="n">name</span><span class="o">],</span><span class="w"> </span><span class="n">sub_ctxt</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Variable.variant_fixes</span><span class="w"> </span><span class="o">[</span><span class="n">skolem_name</span><span class="o">]</span><span class="w"> </span><span class="n">ctxt</span>
<span class="w">       </span><span class="o">||</span><span class="n">&gt;</span><span class="w"> </span><span class="n">Variable.declare_term</span><span class="w"> </span><span class="o">(</span><span class="n">Free</span><span class="w"> </span><span class="o">(</span><span class="n">skolem_name</span><span class="o">,</span><span class="w"> </span><span class="n">fastype_of</span><span class="w"> </span><span class="k">declaration</span><span class="o">))</span>
<span class="w">    </span><span class="n">val</span><span class="w"> </span><span class="n">old_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="n">Free</span><span class="w"> </span><span class="o">(</span><span class="n">skolem_name</span><span class="o">,</span><span class="w"> </span><span class="n">fastype_of</span><span class="w"> </span><span class="k">declaration</span><span class="o">))</span>
<span class="w">    </span><span class="n">val</span><span class="w"> </span><span class="n">new_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="n">Free</span><span class="w"> </span><span class="o">(</span><span class="n">name</span><span class="o">,</span><span class="w"> </span><span class="n">fastype_of</span><span class="w"> </span><span class="k">declaration</span><span class="o">))</span>
<span class="c">(*now export it*)</span>
<span class="n">val</span><span class="w"> </span><span class="n">export_thm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Proof_Context.export</span><span class="w"> </span><span class="n">sub_ctxt</span><span class="w"> </span><span class="n">ctxt</span><span class="w"> </span><span class="kn">theorem</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">export</span>
</code></pre></div>



<a name="476403349"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476403349" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476403349">(Oct 11 2024 at 14:46)</a>:</h4>
<p>IIRC purely ignoring the rule does work because the format of z3 is not very precise anyway.</p>



<a name="476403527"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476403527" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476403527">(Oct 11 2024 at 14:47)</a>:</h4>
<p>But it would be better to change that to properly support that, but this is a lot of work and context manipulation is tough (because of the very weird bugs it generates)</p>



<a name="476403750"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476403750" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476403750">(Oct 11 2024 at 14:48)</a>:</h4>
<p>(if you look at the veriT proof, you will see that the used datastructure is recursive exactly to handle these context manipulation properly)</p>



<a name="476513290"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476513290" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476513290">(Oct 12 2024 at 10:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476403162">said</a>:</p>
<blockquote>
<p>This is not hard to represent in Isabelle (you declare the new variables in the context and export the fact at the end):</p>
<p><div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="c">(*creating a sub_ctxt where the new variable skolem_name is declared*)</span>
<span class="n">val</span><span class="w"> </span><span class="o">([</span><span class="n">name</span><span class="o">],</span><span class="w"> </span><span class="n">sub_ctxt</span><span class="o">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Variable.variant_fixes</span><span class="w"> </span><span class="o">[</span><span class="n">skolem_name</span><span class="o">]</span><span class="w"> </span><span class="n">ctxt</span>
<span class="w">       </span><span class="o">||</span><span class="n">&gt;</span><span class="w"> </span><span class="n">Variable.declare_term</span><span class="w"> </span><span class="o">(</span><span class="n">Free</span><span class="w"> </span><span class="o">(</span><span class="n">skolem_name</span><span class="o">,</span><span class="w"> </span><span class="n">fastype_of</span><span class="w"> </span><span class="k">declaration</span><span class="o">))</span>
<span class="w">    </span><span class="n">val</span><span class="w"> </span><span class="n">old_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="n">Free</span><span class="w"> </span><span class="o">(</span><span class="n">skolem_name</span><span class="o">,</span><span class="w"> </span><span class="n">fastype_of</span><span class="w"> </span><span class="k">declaration</span><span class="o">))</span>
<span class="w">    </span><span class="n">val</span><span class="w"> </span><span class="n">new_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">(</span><span class="n">Free</span><span class="w"> </span><span class="o">(</span><span class="n">name</span><span class="o">,</span><span class="w"> </span><span class="n">fastype_of</span><span class="w"> </span><span class="k">declaration</span><span class="o">))</span>
<span class="c">(*now export it*)</span>
<span class="n">val</span><span class="w"> </span><span class="n">export_thm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Proof_Context.export</span><span class="w"> </span><span class="n">sub_ctxt</span><span class="w"> </span><span class="n">ctxt</span><span class="w"> </span><span class="kn">theorem</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">export</span>
</code></pre></div><br>
</p>
</blockquote>
<p>thanks for the help.</p>



<a name="476513493"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476513493" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476513493">(Oct 12 2024 at 10:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476403349">said</a>:</p>
<blockquote>
<p>IIRC purely ignoring the rule does work because the format of z3 is not very precise anyway.</p>
</blockquote>
<p>Seems to be this bit</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">text</span><span class="w"> </span><span class="s">‹</span>
<span class="s">Several prof rules of Z3 are not very well documented. There are two</span>
<span class="s">lemma groups which can turn failing Z3 proof reconstruction attempts</span>
<span class="s">into succeeding ones: the facts in ‹z3_rule› are tried prior to</span>
<span class="s">any implemented reconstruction procedure for all uncertain Z3 proof</span>
<span class="s">rules;  the facts in ‹z3_simp› are only fed to invocations of</span>
<span class="s">the simplifier when reconstructing theory-specific proof steps.</span>
<span class="s">›</span>
</code></pre></div>



<a name="476513724"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476513724" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476513724">(Oct 12 2024 at 10:26)</a>:</h4>
<p>Right now im directly modifying the z3 proof reconstruction code instead of copying. Hope that it would work for both versions.</p>



<a name="476533338"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476533338" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476533338">(Oct 12 2024 at 15:51)</a>:</h4>
<p>Do any of the other smt provers use smtlib_proof.ML because according to <a href="https://smt-lib.org/papers/smt-lib-reference-v2.6-r2024-09-20.pdf#Hendnote.50">https://smt-lib.org/papers/smt-lib-reference-v2.6-r2024-09-20.pdf#Hendnote.50</a> there is no standard smt-lib proof format</p>



<a name="476534112"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476534112" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476534112">(Oct 12 2024 at 16:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="714722">irvin</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476533338">said</a>:</p>
<blockquote>
<p>Do any of the other smt provers use smtlib_proof.ML because according to <a href="https://smt-lib.org/papers/smt-lib-reference-v2.6-r2024-09-20.pdf#Hendnote.50">https://smt-lib.org/papers/smt-lib-reference-v2.6-r2024-09-20.pdf#Hendnote.50</a> there is no standard smt-lib proof format</p>
</blockquote>
<p>grep -r "SMTLIB_Proof"<br>
src/HOL/Tools/SMT/lethe_proof.ML: val parse_raw_proof_steps: string option -&gt; SMTLIB.tree list -&gt; SMTLIB_Proof.name_bindings -&gt; int -&gt;<br>
src/HOL/Tools/SMT/lethe_proof.ML: raw_lethe_node list * SMTLIB.tree list * SMTLIB_Proof.name_bindings<br>
src/HOL/Tools/SMT/lethe_proof.ML:open SMTLIB_Proof<br>
src/HOL/Tools/SMT/lethe_proof.ML:         let val (l, cx) = (fst oo SMTLIB_Proof.extract_and_update_name_bindings) t cx<br>
src/HOL/Tools/SMT/lethe_proof.ML:            |&gt; apsnd (SMTLIB_Proof.update_name_binding (name, SMTLIB.Sym id))<br>
src/HOL/Tools/SMT/lethe_proof.ML:         let val (l, cx) = (fst oo SMTLIB_Proof.extract_and_update_name_bindings) (SMTLIB.S l) cx<br>
src/HOL/Tools/SMT/lethe_proof.ML:         let val (l, cx) = (fst oo SMTLIB_Proof.extract_and_update_name_bindings) def cx<br>
src/HOL/Tools/SMT/lethe_proof.ML:          let val ((args, cx), _) = SMTLIB_Proof.extract_and_update_name_bindings args cx<br>
src/HOL/Tools/SMT/lethe_proof.ML:          let val (concl, cx) = fold_map (fst oo SMTLIB_Proof.extract_and_update_name_bindings) concl cx<br>
src/HOL/Tools/SMT/lethe_proof.ML:            val ((t, cx), _) = SMTLIB_Proof.extract_and_update_name_bindings t cx<br>
src/HOL/Tools/SMT/lethe_proof.ML:            val ((t, cx), _) = SMTLIB_Proof.extract_and_update_name_bindings term cx<br>
src/HOL/Tools/SMT/lethe_proof.ML:      fun not_already_bound cx t = SMTLIB_Proof.lookup_binding cx t = None andalso<br>
src/HOL/Tools/SMT/lethe_proof.ML:        parse_raw_proof_steps NONE smtlib_lines_without_qm SMTLIB_Proof.empty_name_binding 0<br>
src/HOL/Tools/SMT/z3_proof.ML:open SMTLIB_Proof<br>
src/HOL/Tools/SMT/smtlib_proof.ML:structure SMTLIB_Proof: SMTLIB_PROOF =<br>
src/HOL/Tools/SMT/smt_real.ML:  SMTLIB_Proof.add_type_parser real_type_parser #&gt;<br>
src/HOL/Tools/SMT/smt_real.ML:  SMTLIB_Proof.add_term_parser real_term_parser #&gt;<br>
src/HOL/Tools/SMT/verit_strategies.ML:open SMTLIB_Proof<br>
src/HOL/Tools/SMT/z3_proof.ML~:open SMTLIB_Proof<br>
Oh looks like it being used</p>



<a name="476534318"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476534318" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476534318">(Oct 12 2024 at 16:06)</a>:</h4>
<p>Even if there is no smt-lib proof format, all proof formats use the SMT-Lib syntax for terms</p>



<a name="476534333"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476534333" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476534333">(Oct 12 2024 at 16:07)</a>:</h4>
<p>hence it is used by veriT (Lethe) and Z3</p>



<a name="476544635"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476544635" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476544635">(Oct 12 2024 at 18:48)</a>:</h4>
<p>Z3 seems to support lambdas expressions. Specifically that seems to be what this commit seems to add. </p>
<p><span class="user-mention silent" data-user-id="714722">irvin</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476399700">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476392623">said</a>:</p>
<blockquote>
<p>The main issue is finding out what it does, because I never found any documentation on that</p>
</blockquote>
<p>Seems to be the commit where proof-bind was added <a href="https://github.com/Z3Prover/z3/commit/520ce9a5ee6079651580b6d83bc2db0f342b8a20">https://github.com/Z3Prover/z3/commit/520ce9a5ee6079651580b6d83bc2db0f342b8a20</a></p>
</blockquote>
<p>Z3 also seems to support algebraic datatypes (part of SMT lib i think) part of the match stuff.</p>
<p>Right now smt has infrastructure so that lambdas are converted. When doing translations from HOL to MSFOL. Should I try to remove that.</p>
<p>Lambdas are not part of MSFOL so I probably will do code duplication and write a second function for z3<br>
Cant really figure out this bit but not really a issue just a bad error msg<br>
<del>Second right now will have to be reworked for z3.  lambda is not part SMT-LIB. However this function gave a weird error message when its executed with SMTLIB.S [SMTLIB.Sym "lambda",...] which it then tries to parse term and succeeds but then another later call fail  lookup_binding cx lambda failed and then it called parse_term t which then it incorrect and you get the error bad SMT term which does not make sense. Do you know anyway to future proof against this sort of errors</del></p>
<div class="codehilite" data-code-language="Standard ML"><pre><span></span><code><span class="kr">fun</span> <span class="nf">term_of</span> <span class="n">t</span> <span class="n">cx</span> <span class="p">=</span>
  <span class="p">(</span><span class="kr">case</span> <span class="n">t</span> <span class="kr">of</span>
    <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="p">[</span><span class="nn">SMTLIB</span><span class="p">.</span><span class="n">Sym</span> <span class="s2">"forall"</span><span class="p">,</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="n">vars</span><span class="p">,</span> <span class="n">body</span><span class="p">]</span> <span class="p">=&gt;</span> <span class="n">quant</span> <span class="nn">HOLogic</span><span class="p">.</span><span class="n">mk_all</span> <span class="n">vars</span> <span class="n">body</span> <span class="n">cx</span>
  <span class="n">|</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="p">[</span><span class="nn">SMTLIB</span><span class="p">.</span><span class="n">Sym</span> <span class="s2">"exists"</span><span class="p">,</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="n">vars</span><span class="p">,</span> <span class="n">body</span><span class="p">]</span> <span class="p">=&gt;</span> <span class="n">quant</span> <span class="nn">HOLogic</span><span class="p">.</span><span class="n">mk_exists</span> <span class="n">vars</span> <span class="n">body</span> <span class="n">cx</span>
  <span class="n">|</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="p">[</span><span class="nn">SMTLIB</span><span class="p">.</span><span class="n">Sym</span> <span class="s2">"choice"</span><span class="p">,</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="n">vars</span><span class="p">,</span> <span class="n">body</span><span class="p">]</span> <span class="p">=&gt;</span> <span class="n">quant</span> <span class="n">mk_choice</span> <span class="n">vars</span> <span class="n">body</span> <span class="n">cx</span>
  <span class="n">|</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="p">[</span><span class="nn">SMTLIB</span><span class="p">.</span><span class="n">Sym</span> <span class="s2">"let"</span><span class="p">,</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="n">bindings</span><span class="p">,</span> <span class="n">body</span><span class="p">]</span> <span class="p">=&gt;</span>
      <span class="n">with_bindings</span> <span class="p">(</span><span class="n">map</span> <span class="n">dest_binding</span> <span class="n">bindings</span><span class="p">)</span> <span class="p">(</span><span class="n">term_of</span> <span class="n">body</span><span class="p">)</span> <span class="n">cx</span>
  <span class="n">|</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="p">(</span><span class="nn">SMTLIB</span><span class="p">.</span><span class="n">Sym</span> <span class="s2">"!"</span> <span class="n">::</span> <span class="n">t</span> <span class="n">::</span> <span class="p">_)</span> <span class="p">=&gt;</span> <span class="n">term_of</span> <span class="n">t</span> <span class="n">cx</span>
  <span class="n">|</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="p">(</span><span class="n">f</span> <span class="n">::</span> <span class="n">args</span><span class="p">)</span> <span class="p">=&gt;</span>
      <span class="n">cx</span>
      <span class="n">|&gt;</span> <span class="n">fold_map</span> <span class="n">term_of</span> <span class="n">args</span>
      <span class="n">|-&gt;</span> <span class="n">parse_term</span> <span class="n">f</span>
  <span class="n">|</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">Sym</span> <span class="n">name</span> <span class="p">=&gt;</span>
      <span class="p">(</span><span class="kr">case</span> <span class="n">lookup_binding</span> <span class="n">cx</span> <span class="n">name</span> <span class="kr">of</span>
        <span class="n">Tree</span> <span class="n">u</span> <span class="p">=&gt;</span>
          <span class="n">cx</span>
          <span class="n">|&gt;</span> <span class="n">term_of</span> <span class="n">u</span>
          <span class="n">|-&gt;</span> <span class="p">(</span><span class="kr">fn</span> <span class="n">u'</span> <span class="p">=&gt;</span> <span class="n">pair</span> <span class="n">u'</span> <span class="n">o</span> <span class="n">update_binding</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Term</span> <span class="n">u'</span><span class="p">))</span>
      <span class="n">|</span> <span class="n">Term</span> <span class="n">u</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">cx</span><span class="p">)</span>
      <span class="n">|</span> <span class="n">None</span> <span class="p">=&gt;</span> <span class="n">parse_term</span> <span class="n">t</span> <span class="p">[]</span> <span class="n">cx</span>
      <span class="n">|</span> <span class="p">_</span> <span class="p">=&gt;</span> <span class="kr">raise</span> <span class="n">SMTLIB_PARSE</span> <span class="p">(</span><span class="s2">"bad SMT term format"</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
  <span class="n">|</span> <span class="p">_</span> <span class="p">=&gt;</span> <span class="n">parse_term</span> <span class="n">t</span> <span class="p">[]</span> <span class="n">cx</span><span class="p">)</span>
</code></pre></div>



<a name="476545395"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476545395" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476545395">(Oct 12 2024 at 19:00)</a>:</h4>
<p><del>I think i figured out the second one</del> or maybe not</p>



<a name="476545831"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476545831" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476545831">(Oct 12 2024 at 19:07)</a>:</h4>
<p><a href="/user_uploads/14278/iMUuaK8WwLLm0UyGbkHQsJuY/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/14278/iMUuaK8WwLLm0UyGbkHQsJuY/image.png" title="image.png"><img data-original-dimensions="620x371" src="/user_uploads/thumbnail/14278/iMUuaK8WwLLm0UyGbkHQsJuY/image.png/840x560.webp"></a></div>



<a name="476547171"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476547171" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476547171">(Oct 12 2024 at 19:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="714722">irvin</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476544635">said</a>:</p>
<blockquote>
<p>Z3 seems to support lambdas expressions. Specifically that seems to be what this commit seems to add. </p>
</blockquote>
<p>That does not mean that it must be a lambda in Isabelle. <code>fix</code> variable are usually not written as lambdas in Isabelle</p>



<a name="476703756"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476703756" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476703756">(Oct 14 2024 at 07:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="714722">irvin</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476545395">said</a>:</p>
<blockquote>
<p><del>I think i figured out the second one</del> or maybe not</p>
</blockquote>
<p>While trying to figure the parser errors. I realized that the current parser does not do let binding scope correctly.<br>
The parser goes through parse generating a binding =&gt; unparsed binding context<br>
The term is not parsed as more information is needed to known whether it is a binding to term or proofterm (<em>this is for z3 not sure whether other proof formats it is clear</em>)<br>
On the first instance when the binding is encountered. (<em>Now clear whether it is a term or proofterm</em>).<br>
Its parsed and updated. With the binding of the first encounter of the new context.</p>



<a name="476706317"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476706317" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476706317">(Oct 14 2024 at 07:45)</a>:</h4>
<p>Also repeated lets wont work<br>
ie.<br>
let a = foo in<br>
let b = something with a<br>
let a = bar in<br>
...</p>



<a name="476707376"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476707376" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476707376">(Oct 14 2024 at 07:49)</a>:</h4>
<p>So im going to rewrite the parser</p>



<a name="476707426"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476707426" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476707426">(Oct 14 2024 at 07:50)</a>:</h4>
<p>Doesn't z3 generate a new name for each binding?</p>



<a name="476708066"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476708066" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476708066">(Oct 14 2024 at 07:52)</a>:</h4>
<p>Yup it does so this is really just being more defensive. Against inputs. Current version can run forever on some inputs</p>



<a name="476708271"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476708271" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476708271">(Oct 14 2024 at 07:53)</a>:</h4>
<p>Also is there any method of execption combinators</p>



<a name="476708632"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476708632" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476708632">(Oct 14 2024 at 07:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="714722">irvin</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476708066">said</a>:</p>
<blockquote>
<p>Yup it does so this is really just being more defensive. Against inputs</p>
</blockquote>
<p>You can safely assume that you will get inputs from z3 only, so being defensive is not really necessary</p>



<a name="476708805"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476708805" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476708805">(Oct 14 2024 at 07:55)</a>:</h4>
<p>(and there will never be another solver that uses that proof format)</p>



<a name="476708971"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476708971" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476708971">(Oct 14 2024 at 07:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="714722">irvin</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476708271">said</a>:</p>
<blockquote>
<p>Also is there any method of execption combinators</p>
</blockquote>
<p>No, the first error can just itnerrupt the execution</p>



<a name="476709795"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476709795" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476709795">(Oct 14 2024 at 07:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476708805">said</a>:</p>
<blockquote>
<p>(and there will never be another solver that uses that proof format)</p>
</blockquote>
<p>This affects the generic smtlib terms also</p>



<a name="476710866"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476710866" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476710866">(Oct 14 2024 at 08:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="714722">irvin</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476707376">said</a>:</p>
<blockquote>
<p>So im going to rewrite the parser</p>
</blockquote>
<p>Anyone rewriting that scares me a <em>lot</em></p>



<a name="476710974"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476710974" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476710974">(Oct 14 2024 at 08:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476710866">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="714722">irvin</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476707376">said</a>:</p>
<blockquote>
<p>So im going to rewrite the parser</p>
</blockquote>
<p>Anyone rewriting that scares me a <em>lot</em></p>
</blockquote>
<p>Oh</p>



<a name="476710988"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476710988" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476710988">(Oct 14 2024 at 08:03)</a>:</h4>
<p>I know that it is tempting to make it better</p>



<a name="476711118"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476711118" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476711118">(Oct 14 2024 at 08:04)</a>:</h4>
<p>but working stuff that is not buggy is always better</p>



<a name="476711225"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476711225" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476711225">(Oct 14 2024 at 08:04)</a>:</h4>
<p>So unless you find a bug, I would not rewrite the smtlib parser (the z3 parser is fine)</p>



<a name="476715307"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476715307" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476715307">(Oct 14 2024 at 08:23)</a>:</h4>
<p>For documentation purposes. This is the affected function. A simple fix would probably be to make let call update. </p>
<div class="codehilite" data-code-language="Standard ML"><pre><span></span><code><span class="kr">fun</span> <span class="nf">term_of</span> <span class="n">t</span> <span class="n">cx</span> <span class="p">=</span>
  <span class="p">(</span><span class="kr">case</span> <span class="n">t</span> <span class="kr">of</span>
    <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="p">[</span><span class="nn">SMTLIB</span><span class="p">.</span><span class="n">Sym</span> <span class="s2">"forall"</span><span class="p">,</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="n">vars</span><span class="p">,</span> <span class="n">body</span><span class="p">]</span> <span class="p">=&gt;</span> <span class="n">quant</span> <span class="nn">HOLogic</span><span class="p">.</span><span class="n">mk_all</span> <span class="n">vars</span> <span class="n">body</span> <span class="n">cx</span>
  <span class="n">|</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="p">[</span><span class="nn">SMTLIB</span><span class="p">.</span><span class="n">Sym</span> <span class="s2">"exists"</span><span class="p">,</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="n">vars</span><span class="p">,</span> <span class="n">body</span><span class="p">]</span> <span class="p">=&gt;</span> <span class="n">quant</span> <span class="nn">HOLogic</span><span class="p">.</span><span class="n">mk_exists</span> <span class="n">vars</span> <span class="n">body</span> <span class="n">cx</span>
  <span class="n">|</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="p">[</span><span class="nn">SMTLIB</span><span class="p">.</span><span class="n">Sym</span> <span class="s2">"choice"</span><span class="p">,</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="n">vars</span><span class="p">,</span> <span class="n">body</span><span class="p">]</span> <span class="p">=&gt;</span> <span class="n">quant</span> <span class="n">mk_choice</span> <span class="n">vars</span> <span class="n">body</span> <span class="n">cx</span>
  <span class="n">|</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="p">[</span><span class="nn">SMTLIB</span><span class="p">.</span><span class="n">Sym</span> <span class="s2">"let"</span><span class="p">,</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="n">bindings</span><span class="p">,</span> <span class="n">body</span><span class="p">]</span> <span class="p">=&gt;</span>
      <span class="n">with_bindings</span> <span class="p">(</span><span class="n">map</span> <span class="n">dest_binding</span> <span class="n">bindings</span><span class="p">)</span> <span class="p">(</span><span class="n">term_of</span> <span class="n">body</span><span class="p">)</span> <span class="n">cx</span>
  <span class="n">|</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="p">(</span><span class="nn">SMTLIB</span><span class="p">.</span><span class="n">Sym</span> <span class="s2">"!"</span> <span class="n">::</span> <span class="n">t</span> <span class="n">::</span> <span class="p">_)</span> <span class="p">=&gt;</span> <span class="n">term_of</span> <span class="n">t</span> <span class="n">cx</span>
  <span class="n">|</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">S</span> <span class="p">(</span><span class="n">f</span> <span class="n">::</span> <span class="n">args</span><span class="p">)</span> <span class="p">=&gt;</span>
      <span class="n">cx</span>
      <span class="n">|&gt;</span> <span class="n">fold_map</span> <span class="n">term_of</span> <span class="n">args</span>
      <span class="n">|-&gt;</span> <span class="n">parse_term</span> <span class="n">f</span>
  <span class="n">|</span> <span class="nn">SMTLIB</span><span class="p">.</span><span class="n">Sym</span> <span class="n">name</span> <span class="p">=&gt;</span>
      <span class="p">(</span><span class="kr">case</span> <span class="n">lookup_binding</span> <span class="n">cx</span> <span class="n">name</span> <span class="kr">of</span>
        <span class="n">Tree</span> <span class="n">u</span> <span class="p">=&gt;</span>
          <span class="n">cx</span>
          <span class="n">|&gt;</span> <span class="n">term_of</span> <span class="n">u</span>
          <span class="n">|-&gt;</span> <span class="p">(</span><span class="kr">fn</span> <span class="n">u'</span> <span class="p">=&gt;</span> <span class="n">pair</span> <span class="n">u'</span> <span class="n">o</span> <span class="n">update_binding</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">Term</span> <span class="n">u'</span><span class="p">))</span>
      <span class="n">|</span> <span class="n">Term</span> <span class="n">u</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">cx</span><span class="p">)</span>
      <span class="n">|</span> <span class="n">None</span> <span class="p">=&gt;</span> <span class="n">parse_term</span> <span class="n">t</span> <span class="p">[]</span> <span class="n">cx</span>
      <span class="n">|</span> <span class="p">_</span> <span class="p">=&gt;</span> <span class="kr">raise</span> <span class="n">SMTLIB_PARSE</span> <span class="p">(</span><span class="s2">"bad SMT term format"</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
  <span class="n">|</span> <span class="p">_</span> <span class="p">=&gt;</span> <span class="n">parse_term</span> <span class="n">t</span> <span class="p">[]</span> <span class="n">cx</span><span class="p">)</span>

<span class="kr">and</span> <span class="nf">quant</span> <span class="n">q</span> <span class="n">vars</span> <span class="n">body</span> <span class="n">cx</span> <span class="p">=</span>
  <span class="kr">let</span> <span class="kr">val</span> <span class="nv">vs</span> <span class="p">=</span> <span class="n">map</span> <span class="p">(</span><span class="n">dest_var</span> <span class="n">cx</span><span class="p">)</span> <span class="n">vars</span>
  <span class="kr">in</span>
    <span class="n">cx</span>
    <span class="n">|&gt;</span> <span class="n">with_bindings</span> <span class="p">(</span><span class="n">map</span> <span class="p">(</span><span class="n">apsnd</span> <span class="p">(</span><span class="n">Term</span> <span class="n">o</span> <span class="n">Free</span><span class="p">))</span> <span class="n">vs</span><span class="p">)</span> <span class="p">(</span><span class="n">term_of</span> <span class="p">(</span><span class="n">dest_body</span> <span class="n">body</span><span class="p">))</span>
    <span class="n">|&gt;&gt;</span> <span class="n">fold_rev</span> <span class="p">(</span><span class="kr">fn</span> <span class="p">(_,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T</span><span class="p">))</span> <span class="p">=&gt;</span> <span class="kr">fn</span> <span class="n">t</span> <span class="p">=&gt;</span> <span class="n">q</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span> <span class="n">vs</span>
  <span class="kr">end</span>
</code></pre></div>



<a name="476715471"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476715471" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476715471">(Oct 14 2024 at 08:24)</a>:</h4>
<p>Is comments to zulip links considered bad?</p>



<a name="476721010"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476721010" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fabian Huch <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476721010">(Oct 14 2024 at 08:48)</a>:</h4>
<p>You mean in the source code? Certainly.</p>



<a name="476728316"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476728316" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476728316">(Oct 14 2024 at 09:19)</a>:</h4>
<p>Adding a pattern to <code>term_of</code> is fine</p>



<a name="476728778"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476728778" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476728778">(Oct 14 2024 at 09:21)</a>:</h4>
<p>but isn't with ẁith_bindings`already doing an update?</p>



<a name="476730266"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476730266" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476730266">(Oct 14 2024 at 09:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476728778">said</a>:</p>
<blockquote>
<p>but isn't with ẁith_bindings`already doing an update?</p>
</blockquote>
<p>Oh my bad seems to ok then.</p>



<a name="476732032"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476732032" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476732032">(Oct 14 2024 at 09:34)</a>:</h4>
<p>At least the code looks like it:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">fun</span><span class="w"> </span><span class="n">with_bindings</span><span class="w"> </span><span class="n">bs</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">cx</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="n">bs'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="o">(</span><span class="n">lookup_binding</span><span class="w"> </span><span class="n">cx</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="n">fst</span><span class="o">)</span><span class="w"> </span><span class="n">bs</span>
<span class="w">  </span><span class="kp">in</span>
<span class="w">    </span><span class="n">cx</span>
<span class="w">    </span><span class="o">|</span><span class="n">&gt;</span><span class="w"> </span><span class="n">fold</span><span class="w"> </span><span class="n">update_binding</span><span class="w"> </span><span class="n">bs</span>
<span class="w">    </span><span class="o">|</span><span class="n">&gt;</span><span class="w"> </span><span class="n">f</span>
<span class="w">    </span><span class="o">||</span><span class="n">&gt;</span><span class="w"> </span><span class="n">fold2</span><span class="w"> </span><span class="o">(</span><span class="n">fn</span><span class="w"> </span><span class="o">(</span><span class="n">name</span><span class="o">,</span><span class="w"> </span><span class="o">_)</span><span class="w"> </span><span class="o">=</span><span class="n">&gt;</span><span class="w"> </span><span class="n">update_binding</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="n">pair</span><span class="w"> </span><span class="n">name</span><span class="o">)</span><span class="w"> </span><span class="n">bs</span><span class="w"> </span><span class="n">bs'</span>
<span class="w">  </span><span class="k">end</span>
</code></pre></div>
<p>(and this is one of the cases were always updating is the easiest solution)</p>



<a name="476738849"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476738849" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476738849">(Oct 14 2024 at 10:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476732032">said</a>:</p>
<blockquote>
<p>At least the code looks like it:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">fun</span><span class="w"> </span><span class="n">with_bindings</span><span class="w"> </span><span class="n">bs</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">cx</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="n">bs'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="o">(</span><span class="n">lookup_binding</span><span class="w"> </span><span class="n">cx</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="n">fst</span><span class="o">)</span><span class="w"> </span><span class="n">bs</span>
<span class="w">  </span><span class="kp">in</span>
<span class="w">    </span><span class="n">cx</span>
<span class="w">    </span><span class="o">|</span><span class="n">&gt;</span><span class="w"> </span><span class="n">fold</span><span class="w"> </span><span class="n">update_binding</span><span class="w"> </span><span class="n">bs</span>
<span class="w">    </span><span class="o">|</span><span class="n">&gt;</span><span class="w"> </span><span class="n">f</span>
<span class="w">    </span><span class="o">||</span><span class="n">&gt;</span><span class="w"> </span><span class="n">fold2</span><span class="w"> </span><span class="o">(</span><span class="n">fn</span><span class="w"> </span><span class="o">(</span><span class="n">name</span><span class="o">,</span><span class="w"> </span><span class="o">_)</span><span class="w"> </span><span class="o">=</span><span class="n">&gt;</span><span class="w"> </span><span class="n">update_binding</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="n">pair</span><span class="w"> </span><span class="n">name</span><span class="o">)</span><span class="w"> </span><span class="n">bs</span><span class="w"> </span><span class="n">bs'</span>
<span class="w">  </span><span class="k">end</span>
</code></pre></div>
<p>(and this is one of the cases were always updating is the easiest solution)</p>
</blockquote>
<p>It doesnt it simply registers unparsed tree in the symtab</p>



<a name="476739228"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476739228" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476739228">(Oct 14 2024 at 10:04)</a>:</h4>
<p><code>with_bindings (map dest_binding bindings) (term_of body) cx</code> term_of is not passed into with_bindings at all so it cant have a chance to parse it</p>



<a name="476753356"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476753356" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476753356">(Oct 14 2024 at 11:08)</a>:</h4>
<p>Explanation of the code.<br>
bindings are destructored using <code>map dest_binding bindings</code><br>
with_binding call<br>
current binding is saved in the <br>
<code>val bs' = map (lookup cx o fst) bs</code><br>
update the binding the unparsed values of (map dest_binding bindings)<br>
call the  (term_of body with the context updated.<br>
reset back the bindings. to the thing so let scoping works. for the case of <br>
let a = ... in (let a in ...) (<em>Which i was wrong</em>)<br>
However weird recursion let work<br>
something like <br>
let a = b in (let b = a)<br>
Modifing with_binding</p>
<div class="codehilite" data-code-language="Standard ML"><pre><span></span><code><span class="kr">fun</span> <span class="nf">with_bindings</span> <span class="n">bs</span> <span class="n">f</span> <span class="n">cx</span> <span class="p">=</span>
  <span class="kr">let</span> <span class="kr">val</span> <span class="nv">bs'</span> <span class="p">=</span> <span class="n">map</span> <span class="p">(</span><span class="n">lookup_binding</span> <span class="n">cx</span> <span class="n">o</span> <span class="n">fst</span><span class="p">)</span> <span class="n">bs</span>
         <span class="kr">val</span> <span class="nv">cx2</span> <span class="p">=</span> <span class="n">fold</span> <span class="n">update_binding</span> <span class="n">bs</span> <span class="n">cx</span>
         <span class="kr">val</span> <span class="p">_</span> <span class="p">=</span> <span class="n">writeln</span> <span class="p">(</span><span class="n">@</span><span class="p">{</span><span class="n">make_string</span><span class="p">}</span> <span class="p">(</span><span class="n">map</span> <span class="p">(</span><span class="n">lookup_binding</span> <span class="n">cx2</span> <span class="n">o</span> <span class="n">fst</span><span class="p">)</span> <span class="n">bs</span><span class="p">))</span>

  <span class="kr">in</span>
    <span class="n">cx</span>
    <span class="n">|&gt;</span> <span class="n">fold</span> <span class="n">update_binding</span> <span class="n">bs</span>
    <span class="n">|&gt;</span> <span class="n">f</span>
    <span class="n">||&gt;</span> <span class="n">fold2</span> <span class="p">(</span><span class="kr">fn</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">_)</span> <span class="p">=&gt;</span> <span class="n">update_binding</span> <span class="n">o</span> <span class="n">pair</span> <span class="n">name</span><span class="p">)</span> <span class="n">bs</span> <span class="n">bs'</span>
  <span class="kr">end</span>
</code></pre></div>
<p>Everything printed is of Tree (<em>not yet parsed</em>)<br>
  datatype 'b shared = Tree of SMTLIB.tree | Term of term | Proof of 'b | None</p>



<a name="476753690"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476753690" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476753690">(Oct 14 2024 at 11:10)</a>:</h4>
<p>Side note I dont seem to see verit make use of let at all is this true</p>



<a name="476777089"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476777089" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476777089">(Oct 14 2024 at 12:51)</a>:</h4>
<p>Also do you know anyway of creating a   type ('a, 'b) context for testing</p>



<a name="476781740"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476781740" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476781740">(Oct 14 2024 at 13:08)</a>:</h4>
<p><code>empty_context</code></p>



<a name="476781889"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476781889" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476781889">(Oct 14 2024 at 13:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="714722">irvin</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476753356">said</a>:</p>
<blockquote>
<p>Explanation of the code.<br>
bindings are destructored using <code>map dest_binding bindings</code><br>
with_binding call<br>
current binding is saved in the <br>
<code>val bs' = map (lookup cx o fst) bs</code><br>
update the binding the unparsed values of (map dest_binding bindings)<br>
call the  (term_of body with the context updated.<br>
reset back the bindings. to the thing so let scoping works. for the case of <br>
let a = ... in (let a in ...) (<em>Which i was wrong</em>)<br>
However weird recursion let work<br>
something like <br>
let a = b in (let b = a)<br>
Modifing with_binding</p>
<div class="codehilite" data-code-language="Standard ML"><pre><span></span><code><span class="kr">fun</span> <span class="nf">with_bindings</span> <span class="n">bs</span> <span class="n">f</span> <span class="n">cx</span> <span class="p">=</span>
  <span class="kr">let</span> <span class="kr">val</span> <span class="nv">bs'</span> <span class="p">=</span> <span class="n">map</span> <span class="p">(</span><span class="n">lookup_binding</span> <span class="n">cx</span> <span class="n">o</span> <span class="n">fst</span><span class="p">)</span> <span class="n">bs</span>
         <span class="kr">val</span> <span class="nv">cx2</span> <span class="p">=</span> <span class="n">fold</span> <span class="n">update_binding</span> <span class="n">bs</span> <span class="n">cx</span>
         <span class="kr">val</span> <span class="p">_</span> <span class="p">=</span> <span class="n">writeln</span> <span class="p">(</span><span class="n">@</span><span class="p">{</span><span class="n">make_string</span><span class="p">}</span> <span class="p">(</span><span class="n">map</span> <span class="p">(</span><span class="n">lookup_binding</span> <span class="n">cx2</span> <span class="n">o</span> <span class="n">fst</span><span class="p">)</span> <span class="n">bs</span><span class="p">))</span>

  <span class="kr">in</span>
    <span class="n">cx</span>
    <span class="n">|&gt;</span> <span class="n">fold</span> <span class="n">update_binding</span> <span class="n">bs</span>
    <span class="n">|&gt;</span> <span class="n">f</span>
    <span class="n">||&gt;</span> <span class="n">fold2</span> <span class="p">(</span><span class="kr">fn</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">_)</span> <span class="p">=&gt;</span> <span class="n">update_binding</span> <span class="n">o</span> <span class="n">pair</span> <span class="n">name</span><span class="p">)</span> <span class="n">bs</span> <span class="n">bs'</span>
  <span class="kr">end</span>
</code></pre></div>
<p>Everything printed is of Tree (<em>not yet parsed</em>)<br>
  datatype 'b shared = Tree of SMTLIB.tree | Term of term | Proof of 'b | None</p>
</blockquote>
<p>The question is how to represent the end of a scope</p>



<a name="476782055"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476782055" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476782055">(Oct 14 2024 at 13:10)</a>:</h4>
<p><del>For verit we "open" a new context and can close is outside of a subproof)</del><br>
I have to think about your text again</p>



<a name="476811427"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476811427" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476811427">(Oct 14 2024 at 15:29)</a>:</h4>
<p>You just duplicate context until you reach the end of a context</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">let</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="kp">in</span><span class="w"> </span><span class="o">(</span><span class="k">let</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="kp">in</span><span class="w"> </span><span class="n">a</span><span class="o">)</span><span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="n">b</span>
<span class="n">ctxt</span><span class="o">-----------------------</span><span class="n">x</span>
<span class="w">           </span><span class="n">\</span><span class="o">-----------------------</span><span class="n">&gt;</span>
</code></pre></div>



<a name="476816463"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476816463" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476816463">(Oct 14 2024 at 16:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476707426">said</a>:</p>
<blockquote>
<p>Doesn't z3 generate a new name for each binding?</p>
</blockquote>
<p>I just checked again and z3 doesnt generate a new name for each binding</p>



<a name="476824414"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476824414" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476824414">(Oct 14 2024 at 16:57)</a>:</h4>
<p>Ok finally got the z3 proofs to be parsed</p>



<a name="476873433"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476873433" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476873433">(Oct 15 2024 at 01:26)</a>:</h4>
<p><a href="/user_uploads/14278/ArsdJNvbc3EbsTwGVkqd8hP4/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/14278/ArsdJNvbc3EbsTwGVkqd8hP4/image.png" title="image.png"><img data-original-dimensions="1169x623" src="/user_uploads/thumbnail/14278/ArsdJNvbc3EbsTwGVkqd8hP4/image.png/840x560.webp"></a></div>



<a name="476876757"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476876757" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476876757">(Oct 15 2024 at 02:08)</a>:</h4>
<p>So from what i understand. The proof-bind is not really a "proof method" and is handled at the parser level. Currently the implementation automatically does the free variables.  So ignoring it is possible.</p>



<a name="476877339"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/476877339" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#476877339">(Oct 15 2024 at 02:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476547171">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="714722">irvin</span> <a href="#narrow/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/476544635">said</a>:</p>
<blockquote>
<p>Z3 seems to support lambdas expressions. Specifically that seems to be what this commit seems to add. </p>
</blockquote>
<p>That does not mean that it must be a lambda in Isabelle. <code>fix</code> variable are usually not written as lambdas in Isabelle</p>
</blockquote>
<p>In this case is it just !!a. P a</p>



<a name="477336414"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477336414" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477336414">(Oct 17 2024 at 02:38)</a>:</h4>
<p>The current situation is the z3 rule  rewrite failing. rewrite a rewrite which does not provide justification and according to z3 proof reconstruction should use internal decision provers to reconstruct the rewrite rule</p>



<a name="477340255"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477340255" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477340255">(Oct 17 2024 at 03:09)</a>:</h4>
<p>Also does anyone know if there is any tooling to make isabelle build expose warning/ errors similar to how a compiler exposes the errors when compiling <br>
Source of the issue is that the SMT_Examples_*.thy requires Complex_Main which results in every single edit requiring the whole state below to be parsed. Im guessing that it will be extremely hard to make isabelle graph based and only reloading the nodes affected below.<br>
If there isnt where would i look to make a component to make it do this.</p>



<a name="477352258"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477352258" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477352258">(Oct 17 2024 at 04:57)</a>:</h4>
<p>It is not that bad actually in practise</p>



<a name="477352337"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477352337" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477352337">(Oct 17 2024 at 04:58)</a>:</h4>
<p>there are two ways to make it less horrible:</p>
<p>1. replace the import by HOL.SMT. Will not work for everything (mostly the first part of the file will work, but for debugging that is usually enough)</p>



<a name="477352404"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477352404" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477352404">(Oct 17 2024 at 04:59)</a>:</h4>
<ol start="2">
<li>you can also remove SMT and Sledgehammer and nitpick by replacing the point where there are imported by their own imports. Then you only import SMT in the example file. Just sorry the stuff that does not work</li>
</ol>



<a name="477355292"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477355292" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477355292">(Oct 17 2024 at 05:32)</a>:</h4>
<blockquote>
<p>make isabelle graph based and only reloading the nodes affected below[...] If there isnt where would i look to make a component to make it do this.</p>
</blockquote>
<p>I am pretty sure that this is part of the "you do not want to do that because an error here can make Isabelle incorrect so no sane person would want to use that". Also the SMT method is used in List.thy anyway</p>



<a name="477355544"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477355544" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477355544">(Oct 17 2024 at 05:35)</a>:</h4>
<blockquote>
<p>Also does anyone know if there is any tooling to make isabelle build expose warning/ errors similar to how a compiler exposes the errors when compiling </p>
</blockquote>
<p>Usually I have SMT.thy open at the point of the SML import files and the ML files I am editing, then you see in the output panel all the error messages</p>



<a name="477355641"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477355641" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477355641">(Oct 17 2024 at 05:36)</a>:</h4>
<p>Yup the graph based version is not something i would try to do. However im asking on the feasibility  of making isabelle build output warning and errors</p>



<a name="477355918"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477355918" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477355918">(Oct 17 2024 at 05:39)</a>:</h4>
<p><a href="/user_uploads/14278/_7mOKroYb2SOniDEi1DqCZC9/image.png">image.png</a><br>
here you can see the error message at the bottom. In the right theory you can see the follow-up places where there are errors</p>
<div class="message_inline_image"><a href="/user_uploads/14278/_7mOKroYb2SOniDEi1DqCZC9/image.png" title="image.png"><img data-original-dimensions="2559x1047" src="/user_uploads/thumbnail/14278/_7mOKroYb2SOniDEi1DqCZC9/image.png/840x560.webp"></a></div>



<a name="477355987"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477355987" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477355987">(Oct 17 2024 at 05:40)</a>:</h4>
<p>This is much better than the alternative with <code>isabelle build</code> which stops at the first error</p>



<a name="477356133"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477356133" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477356133">(Oct 17 2024 at 05:42)</a>:</h4>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="n">$</span><span class="w"> </span><span class="ow">.</span><span class="n">/bin/isabelle</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="n">HOL</span>
<span class="n">Building</span><span class="w"> </span><span class="n">HOL</span><span class="w"> </span><span class="ow">...</span>
<span class="n">HOL</span><span class="w"> </span><span class="n">FAILED</span><span class="w"> </span><span class="o">(</span><span class="n">see</span><span class="w"> </span><span class="k">also</span><span class="w"> </span><span class="s">"isabelle build_log -H Error HOL"</span><span class="o">)</span>
<span class="ow">...</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.String"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Bit_Operations"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Code_Numeral"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Enum"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.BNF_Greatest_Fixpoint"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.String"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Predicate"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.String"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Typerep"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.String"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Random"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Code_Numeral"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Groups_List"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.List"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Lazy_Sequence"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Predicate"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Limited_Sequence"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Lazy_Sequence"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Code_Evaluation"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Limited_Sequence"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Typerep"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Random"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Code_Evaluation"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Enum"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Random"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Exhaustive"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Random"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Record"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Exhaustive"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Nitpick"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.GCD"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Record"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Nunchaku"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Nitpick"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Narrowing"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Random"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Random_Pred"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Random"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Random_Sequence"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Random_Pred"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Predicate_Compile"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Exhaustive"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Random_Sequence"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Mirabelle"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Predicate_Compile"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Sledgehammer"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"Main"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.BNF_Greatest_Fixpoint"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Binomial"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.GCD"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Mirabelle"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Nunchaku"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Predicate_Compile"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Narrowing"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Archimedean_Field"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"Main"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Rat"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Archimedean_Field"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Real"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Rat"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Hull"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"Main"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Modules"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Hull"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Vector_Spaces"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Modules"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Topological_Spaces"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"Main"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Real_Vector_Spaces"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Real"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Topological_Spaces"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Vector_Spaces"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Inequalities"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Real_Vector_Spaces"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Limits"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Real_Vector_Spaces"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Deriv"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Limits"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.NthRoot"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Deriv"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Series"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Inequalities"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Limits"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Transcendental"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Deriv"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.NthRoot"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Series"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Complex"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Real_Vector_Spaces"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Transcendental"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.MacLaurin"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Transcendental"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"Complex_Main"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Complex"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.MacLaurin"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="k">ML</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">(</span><span class="n">line</span><span class="w"> </span><span class="n">129</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="s">"~~/src/HOL/Tools/SMT/alethe/alethe_proof.ML"</span><span class="o">):</span>
<span class="n">***</span><span class="w"> </span><span class="n">Expression</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">found</span>
<span class="n">***</span>
<span class="n">***</span><span class="w"> </span><span class="n">At</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="s">"ML_file"</span><span class="w"> </span><span class="o">(</span><span class="n">line</span><span class="w"> </span><span class="n">688</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="s">"~~/src/HOL/SMT.thy"</span><span class="o">)</span>
<span class="n">Unfinished</span><span class="w"> </span><span class="n">session</span><span class="o">(</span><span class="n">s</span><span class="o">):</span><span class="w"> </span><span class="n">HOL</span>
<span class="n">0</span><span class="o">:</span><span class="n">00</span><span class="o">:</span><span class="n">49</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="n">time</span><span class="o">,</span><span class="w"> </span><span class="n">0</span><span class="o">:</span><span class="n">02</span><span class="o">:</span><span class="n">22</span><span class="w"> </span><span class="n">cpu</span><span class="w"> </span><span class="n">time</span><span class="o">,</span><span class="w"> </span><span class="n">factor</span><span class="w"> </span><span class="n">2.85</span>
</code></pre></div>



<a name="477356195"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477356195" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477356195">(Oct 17 2024 at 05:42)</a>:</h4>
<p>(this output is not edited)</p>



<a name="477356328"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477356328" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477356328">(Oct 17 2024 at 05:44)</a>:</h4>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="n">$</span><span class="w"> </span><span class="ow">.</span><span class="n">/bin/isabelle</span><span class="w"> </span><span class="n">build_log</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">HOL</span>

<span class="n">Theory</span><span class="w"> </span><span class="s">"HOL.Sledgehammer"</span><span class="w"> </span><span class="o">(</span><span class="kp">in</span><span class="w"> </span><span class="n">HOL</span><span class="o">):</span><span class="w"> </span><span class="n">MISSING</span>
<span class="o">[</span><span class="ow">...</span><span class="o">]</span><span class="w"> </span><span class="n">#here</span><span class="w"> </span><span class="n">removed</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">MISSING</span>
<span class="n">Theory</span><span class="w"> </span><span class="s">"Complex_Main"</span><span class="w"> </span><span class="o">(</span><span class="kp">in</span><span class="w"> </span><span class="n">HOL</span><span class="o">):</span><span class="w"> </span><span class="n">MISSING</span>

<span class="n">Build</span><span class="w"> </span><span class="n">errors</span><span class="o">:</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Sledgehammer"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.SMT"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.List"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Sledgehammer"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Groups_List"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.List"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Bit_Operations"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Groups_List"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Code_Numeral"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Bit_Operations"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Factorial"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Groups_List"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Binomial"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Factorial"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.GCD"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Code_Numeral"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Groups_List"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Map"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.List"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Enum"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Groups_List"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Map"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.String"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Bit_Operations"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Code_Numeral"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Enum"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.BNF_Greatest_Fixpoint"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.String"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Predicate"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.String"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Typerep"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.String"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Random"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Code_Numeral"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Groups_List"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.List"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Lazy_Sequence"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Predicate"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Limited_Sequence"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Lazy_Sequence"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Code_Evaluation"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Limited_Sequence"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Typerep"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Random"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Code_Evaluation"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Enum"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Random"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Exhaustive"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Random"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Record"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Exhaustive"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Nitpick"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.GCD"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Record"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Nunchaku"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Nitpick"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Narrowing"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Random"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Random_Pred"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Random"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Random_Sequence"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Random_Pred"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Predicate_Compile"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Exhaustive"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Random_Sequence"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Mirabelle"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Predicate_Compile"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Sledgehammer"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"Main"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.BNF_Greatest_Fixpoint"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Binomial"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.GCD"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Mirabelle"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Nunchaku"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Predicate_Compile"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Quickcheck_Narrowing"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Archimedean_Field"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"Main"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Rat"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Archimedean_Field"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Real"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Rat"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Hull"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"Main"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Modules"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Hull"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Vector_Spaces"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Modules"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Topological_Spaces"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"Main"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Real_Vector_Spaces"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Real"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Topological_Spaces"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Vector_Spaces"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Inequalities"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Real_Vector_Spaces"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Limits"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Real_Vector_Spaces"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Deriv"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Limits"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.NthRoot"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Deriv"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Series"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Inequalities"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Limits"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Transcendental"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Deriv"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.NthRoot"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Series"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.Complex"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Real_Vector_Spaces"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.Transcendental"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"HOL.MacLaurin"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Transcendental"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="k">theory</span><span class="w"> </span><span class="s">"Complex_Main"</span><span class="w"> </span><span class="o">(</span><span class="n">unresolved</span><span class="w"> </span><span class="s">"HOL.Complex"</span><span class="o">,</span><span class="w"> </span><span class="s">"HOL.MacLaurin"</span><span class="o">)</span>
<span class="n">***</span><span class="w"> </span><span class="k">ML</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">(</span><span class="n">line</span><span class="w"> </span><span class="n">129</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="s">"~~/src/HOL/Tools/SMT/alethe/alethe_proof.ML"</span><span class="o">):</span>
<span class="n">***</span><span class="w"> </span><span class="n">Expression</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">found</span>
<span class="n">***</span>
<span class="n">***</span><span class="w"> </span><span class="n">At</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="s">"ML_file"</span><span class="w"> </span><span class="o">(</span><span class="n">line</span><span class="w"> </span><span class="n">688</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="s">"~~/src/HOL/SMT.thy"</span><span class="o">)</span>

<span class="n">Return</span><span class="w"> </span><span class="n">code</span><span class="o">:</span><span class="w"> </span><span class="n">1</span><span class="w"> </span><span class="o">(</span><span class="n">ERROR</span><span class="o">)</span>
</code></pre></div>



<a name="477356605"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477356605" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477356605">(Oct 17 2024 at 05:47)</a>:</h4>
<p>Ok i guess i spend time looking at the code to see how to add warnings</p>



<a name="477370256"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477370256" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477370256">(Oct 17 2024 at 07:14)</a>:</h4>
<p>usually you want to add printing, not warnings</p>



<a name="477370284"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477370284" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477370284">(Oct 17 2024 at 07:15)</a>:</h4>
<p>@{print} allows you to print pretty-much anything</p>



<a name="477570487"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477570487" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477570487">(Oct 18 2024 at 04:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/channel/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/477370284">said</a>:</p>
<blockquote>
<p>@{print} allows you to print pretty-much anything</p>
</blockquote>
<p>Oh thanks i was doing writeln @{make_string}.<br>
Is there any conventions regarding whether to use @{lemma ... by ...} or doing the proof in isar then using @{thm ....}</p>



<a name="477571082"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477571082" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477571082">(Oct 18 2024 at 04:46)</a>:</h4>
<p>Not that I am aware of. My convention: if it already exists or is long I use <code>@{thm}</code>. Otherwise I use @{lemma}.</p>
<p>But: Put it in a constant instead of evaluating in a function, just to be sure that it is not reproven whenever you run the function. (Yes, Polyml probably is able to optimize but I do not trust that because I do not understand the quotations enough to be sure of that)</p>



<a name="477572962"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477572962" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477572962">(Oct 18 2024 at 05:06)</a>:</h4>
<p>Oh its because i see that smt.thy has a lot of verit theories and i wondered whether I should do the same for the z3 theorems i prove and move them to the smt file</p>



<a name="477573686"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477573686" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477573686">(Oct 18 2024 at 05:16)</a>:</h4>
<p>Yeah just put it there too</p>



<a name="477599650"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477599650" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477599650">(Oct 18 2024 at 08:05)</a>:</h4>
<p>Do you have any guide on understanding the abs_context code in smt_replay_method.</p>



<a name="477776995"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477776995" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477776995">(Oct 19 2024 at 06:00)</a>:</h4>
<p>It is used to abstract over the structure of a term if you know that the reconstruction is needing some details of the term</p>



<a name="477777086"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477777086" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477777086">(Oct 19 2024 at 06:01)</a>:</h4>
<p>for example,  if you know that you are reconstructing an arithmetic step, then if-then-else constructs are seen as black box and thus you can abstract over it naming it with a fresh name (like <code>x12</code> or whatever)</p>



<a name="477777178"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477777178" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477777178">(Oct 19 2024 at 06:02)</a>:</h4>
<p>this improves the performance of the reconstruction and make it more robust (like if you use auto, it will not get lost on some unrelated part of the term)</p>



<a name="477777189"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477777189" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477777189">(Oct 19 2024 at 06:02)</a>:</h4>
<p>I never had to change it, except when it turns out that the assumption over the abstraction is wrong</p>



<a name="477777217"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/477777217" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#477777217">(Oct 19 2024 at 06:03)</a>:</h4>
<p>(like arithmetic steps actually reason below if-then-else)</p>



<a name="479604724"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/479604724" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#479604724">(Oct 30 2024 at 04:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/channel/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/477777189">said</a>:</p>
<blockquote>
<p>I never had to change it, except when it turns out that the assumption over the abstraction is wrong</p>
</blockquote>
<p>Is there a way to deal with the abstraction over comm assoc or<br>
I have a proof rule which has to to destructive equality resolution<br>
which is a rewrite of <br>
lemma "∀a. ¬(a = c) ∨ P a = P c"<br>
except for that its a or chain and ¬(a = c) may not be the first in the or</p>



<a name="479604807"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/479604807" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#479604807">(Oct 30 2024 at 04:18)</a>:</h4>
<p>Btw sorry for not replying lately my linux system broke and I had to spend time troubleshooting it</p>



<a name="479611951"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/479611951" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#479611951">(Oct 30 2024 at 05:56)</a>:</h4>
<p>my intuition says that abstraction is too naive to do that</p>



<a name="479612103"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/479612103" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#479612103">(Oct 30 2024 at 05:58)</a>:</h4>
<p>It is not even clear to me how easy it would to reorder the chains to have them before</p>



<a name="479612114"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/479612114" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#479612114">(Oct 30 2024 at 05:58)</a>:</h4>
<p>(for Alethe we know it is ordered)</p>



<a name="479612134"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/479612134" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#479612134">(Oct 30 2024 at 05:59)</a>:</h4>
<p>I would do a <code>simp only:</code> as just rewriting is enough. And only if performance is too bad, I would spend more thinking into it</p>



<a name="479612477"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/479612477" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#479612477">(Oct 30 2024 at 06:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/channel/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/479612103">said</a>:</p>
<blockquote>
<p>It is not even clear to me how easy it would to reorder the chains to have them before</p>
</blockquote>
<p>actually it should be easy on the perfect shared term as <code>P a</code> must have a bigger term number than <code>a</code>, but there is a lot of work in the parsing to fix the ordering (or at least extract the <code>P</code> which would be enough).</p>



<a name="480299846"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/480299846" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#480299846">(Nov 03 2024 at 11:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/channel/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E/near/479612134">said</a>:</p>
<blockquote>
<p>I would do a <code>simp only:</code> as just rewriting is enough. And only if performance is too bad, I would spend more thinking into it</p>
</blockquote>
<p>For now apparently most of the time just running auto on the goals seems to solve them. But pretty sure its going have a performance impact.</p>



<a name="486684895"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/486684895" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#486684895">(Dec 07 2024 at 16:38)</a>:</h4>
<p><span class="user-mention" data-user-id="233198">@Mathias Fleury</span>  Btw an update. Apparent HOL4 decided to deal with the "bug" in z3 output and i think im going to try and do the same and deal with it rather than fix it on the z3 side. The rest works I think</p>



<a name="486684956"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/486684956" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#486684956">(Dec 07 2024 at 16:39)</a>:</h4>
<p>So they are sure that this is the only bug?</p>



<a name="486685375"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/486685375" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#486685375">(Dec 07 2024 at 16:44)</a>:</h4>
<p>theses are apparently the relevant commits that the HOL4 maintainer sent me. I havent figured it out but they seem to be able to handle define-fun at the top of the proof block.<br>
<a href="https://github.com/HOL-Theorem-Prover/HOL/commit/8f8bd67b8c5a3d799144a14206aa8d4266edd36b">https://github.com/HOL-Theorem-Prover/HOL/commit/8f8bd67b8c5a3d799144a14206aa8d4266edd36b</a><br>
<a href="https://github.com/HOL-Theorem-Prover/HOL/commit/def62b7000cb313b19c84cabe8c1867e63a9c624">https://github.com/HOL-Theorem-Prover/HOL/commit/def62b7000cb313b19c84cabe8c1867e63a9c624</a> <a href="https://github.com/HOL-Theorem-Prover/HOL/commit/4324a79a32b7cccf11efbef4ecee637784ad28c4">https://github.com/HOL-Theorem-Prover/HOL/commit/4324a79a32b7cccf11efbef4ecee637784ad28c4</a> <a href="https://github.com/HOL-Theorem-Prover/HOL/commit/313365a0e83c847c9767d67ab52b2f69135dcaba">https://github.com/HOL-Theorem-Prover/HOL/commit/313365a0e83c847c9767d67ab52b2f69135dcaba</a> <a href="https://github.com/HOL-Theorem-Prover/HOL/commit/4b763209b040de35cf9d408e76a9c4898ce848d5">https://github.com/HOL-Theorem-Prover/HOL/commit/4b763209b040de35cf9d408e76a9c4898ce848d5</a> <a href="https://github.com/HOL-Theorem-Prover/HOL/commit/120e7bb43bc3ffcca4efb2cafbeed0605d620bff">https://github.com/HOL-Theorem-Prover/HOL/commit/120e7bb43bc3ffcca4efb2cafbeed0605d620bff</a> <a href="https://github.com/HOL-Theorem-Prover/HOL/commit/525694a1f1c7016dea954894bea6e6e396f7d6b3">https://github.com/HOL-Theorem-Prover/HOL/commit/525694a1f1c7016dea954894bea6e6e396f7d6b3</a></p>



<a name="486685577"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/486685577" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#486685577">(Dec 07 2024 at 16:46)</a>:</h4>
<p>Ahh thanks for the links!</p>



<a name="486685749"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/486685749" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#486685749">(Dec 07 2024 at 16:48)</a>:</h4>
<p>I guess it might be easier as they can be made schematic variables in isabelle?</p>



<a name="486685838"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/486685838" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#486685838">(Dec 07 2024 at 16:50)</a>:</h4>
<p>I always tried to avoid those in the reconstruction.</p>



<a name="486686040"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/486686040" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#486686040">(Dec 07 2024 at 16:52)</a>:</h4>
<p>Also a lot of the reconstruction is actively avoiding them too (by fixing them prior to proving anything). This also avoids accidentally instantiating them.</p>



<a name="546364445"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/546364445" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#546364445">(Oct 22 2025 at 04:39)</a>:</h4>
<p>did you manage to make z3 work <span class="user-mention" data-user-id="714722">@irvin</span> ?</p>



<a name="546366457"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Making%20isabelle%20run%20on%20modern%20z3./near/546366457" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> irvin <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Making.20isabelle.20run.20on.20modern.20z3.2E.html#546366457">(Oct 22 2025 at 05:07)</a>:</h4>
<p>I gave up on it. Working around the internal variables while possible is a pain.</p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>