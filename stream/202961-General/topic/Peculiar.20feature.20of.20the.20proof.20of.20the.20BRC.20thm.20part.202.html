<html>
<head><meta charset="utf-8"><title>Peculiar feature of the proof of the BRC thm part 2 · General · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/index.html">General</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html">Peculiar feature of the proof of the BRC thm part 2</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="490344332"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490344332" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490344332">(Dec 22 2024 at 00:49)</a>:</h4>
<p>I tried the following lemma in Isabelle:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="kn">lemma</span><span class="w"> </span><span class="n">induction_step</span><span class="o">:</span>
<span class="w">      </span><span class="kp">assumes</span><span class="w">  </span><span class="s">"a ∈ ℕ"</span><span class="w"> </span><span class="s">"b ∈ ℕ"</span><span class="w"> </span><span class="s">"c ∈ ℕ"</span><span class="w"> </span><span class="s">"d ∈ ℕ"</span>
<span class="w">                </span><span class="s">"x0 ∈ ℚ"</span><span class="w"> </span><span class="s">"x1 ∈ ℚ"</span><span class="w"> </span><span class="s">"x2 ∈ ℚ"</span><span class="w"> </span><span class="s">"x3 ∈ ℚ"</span>
<span class="w">                </span><span class="s">"a^2 + b^2 + c^2 + d^2 = 𝗄 - Λ"</span>
<span class="w">                </span><span class="s">"x ∈ rat mat 𝗏 1"</span><span class="w"> </span><span class="s">"𝗏 &gt; 3"</span><span class="w"> </span><span class="s">"m &gt; 3"</span><span class="w"> </span><span class="s">"x0 = x $$ (0,0)"</span>
<span class="w">                </span><span class="s">"x1 = x $$ (1,0)"</span><span class="w"> </span><span class="s">"x2 = x $$ (2,0)"</span><span class="w"> </span><span class="s">"x3 = x $$ (3,0)"</span>
<span class="w">                </span><span class="s">"x0 = one_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3)))"</span>
<span class="w">                </span><span class="s">"x1 = two_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3)))"</span>
<span class="w">                </span><span class="s">"x2 = three_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3)))"</span>
<span class="w">                </span><span class="s">"x3 = four_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3)))"</span>
<span class="w">                </span><span class="s">"y0 ∈ ℚ"</span><span class="w"> </span><span class="s">"y1 ∈ ℚ"</span><span class="w"> </span><span class="s">"y2 ∈ ℚ"</span><span class="w"> </span><span class="s">"y3 ∈ ℚ"</span>
<span class="w">                </span><span class="s">"(a ∈ ℕ ∧ b ∈ ℕ ∧ c ∈ ℕ ∧ d ∈ ℕ ∧</span>
<span class="s">                 x0 ∈ ℚ ∧ x1 ∈ ℚ ∧ x2 ∈ ℚ ∧ x3 ∈ ℚ ∧</span>
<span class="s">                 (a^2 + b^2 + c^2 + d^2 = 𝗄 - Λ) ∧</span>
<span class="s">                 x ∈ rat mat 𝗏 1 ∧ 𝗏 &gt; 3 ∧ m &gt; 3 ∧ x0 = x $$ (0,0) ∧</span>
<span class="s">                 x1 = x $$ (1,0) ∧ x2 = x $$ (2,0) ∧ x3 = x $$ (3,0) ∧</span>
<span class="s">                 x0 = one_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3))) ∧</span>
<span class="s">                 x1 = two_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3))) ∧</span>
<span class="s">                 x2 = three_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3))) ∧</span>
<span class="s">                 x3 = four_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3))) ∧</span>
<span class="s">                 y0 ∈ ℚ ∧ y1 ∈ ℚ ∧ y2 ∈ ℚ ∧ y3 ∈ ℚ) ⟶</span>
<span class="s">                (∑i ∈ {0..&lt;m}.(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">                 of_int Λ * (∑j ∈ {0..&lt;𝗏}.(x $$ (j, 0)))^2 +</span>
<span class="s">                 of_int (𝗄 - Λ) * (∑j ∈ {4..&lt;m}. (x $$ (j, 0))^2) +</span>
<span class="s">                 y0^2 + y1^2 + y2^2 + y3^2"</span>
<span class="w">              </span><span class="kp">shows</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,1)) * x $$ (h,0))^2 +</span>
<span class="s">                      (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,2)) * x $$ (h,0))^2 +</span>
<span class="s">                      (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,3)) * x $$ (h,0))^2 +</span>
<span class="s">                      (∑i ∈ {4..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">                      y1^2 + y2^2 + y3^2 + of_int Λ * (∑j ∈ {0..&lt;𝗏}.(x $$ (j, 0)))^2 +</span>
<span class="s">                      of_int (𝗄 - Λ) * (∑j ∈ {4..&lt;m}. (x $$ (j, 0))^2)"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="o">?</span><span class="n">L0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0))"</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="o">?</span><span class="n">L1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,1)) * x $$ (h,0))"</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="o">?</span><span class="n">L2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,2)) * x $$ (h,0))"</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="o">?</span><span class="n">L3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,3)) * x $$ (h,0))"</span>

<span class="w">   </span><span class="k">have</span><span class="w"> </span><span class="n">sumdef</span><span class="o">:</span><span class="w"> </span><span class="s">"(∑i ∈ {0..&lt;4}.(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">    ?L0^2 + ?L1^2 + ?L2^2 + ?L3^2"</span>
<span class="w">   </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">numeral.simps</span><span class="o">(</span><span class="n">2</span><span class="o">,</span><span class="n">3</span><span class="o">))</span>
<span class="w">   </span><span class="k">have</span><span class="w"> </span><span class="n">split</span><span class="o">:</span><span class="w"> </span><span class="s">"{0..&lt;m} = {0..&lt;4} ∪ {4..&lt;m}"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="o">(</span><span class="n">12</span><span class="o">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">   </span><span class="k">have</span><span class="w"> </span><span class="n">inter</span><span class="o">:</span><span class="w"> </span><span class="s">"{} = {0..&lt;4} ∩ {4..&lt;m}"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">   </span><span class="k">have</span><span class="w"> </span><span class="s">"(∑i ∈ {0..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">        (∑i ∈ {0..&lt;4}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) +</span>
<span class="s">        (∑i ∈ {4..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2)"</span>
<span class="w">     </span><span class="k">using</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">inter</span><span class="w"> </span><span class="n">sum.union_disjoint</span><span class="o">[</span><span class="n">of</span><span class="w"> </span><span class="s">"{0..&lt;4}"</span><span class="w"> </span><span class="s">"{4..&lt;m}"</span><span class="w"> </span><span class="s">"λ i .</span>
<span class="s">      (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2"</span><span class="o">]</span>
<span class="w">     </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">metis</span><span class="w"> </span><span class="o">(</span><span class="n">no_types</span><span class="o">,</span><span class="w"> </span><span class="n">lifting</span><span class="o">)</span><span class="w"> </span><span class="n">finite_atLeastLessThan</span><span class="o">)</span>
<span class="w">   </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="n">lhs</span><span class="o">:</span><span class="w"> </span><span class="s">"(∑i ∈ {0..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">    ?L0^2 + ?L1^2 + ?L2^2 + ?L3^2 +</span>
<span class="s">    (∑i ∈ {4..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2)"</span>
<span class="w">     </span><span class="k">using</span><span class="w"> </span><span class="n">sumdef</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>

<span class="w">   </span><span class="k">have</span><span class="w"> </span><span class="s">"∃e00 e01 e02 e03 :: rat. ?L0 =</span>
<span class="s">    e00 * y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">    (∑h ∈ {4..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0))"</span>
<span class="w">     </span><span class="k">using</span><span class="w"> </span><span class="n">linear_comb_of_y0_part_2</span><span class="w"> </span><span class="n">assms</span><span class="o">(</span><span class="n">1</span><span class="o">-</span><span class="n">24</span><span class="o">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>

<span class="w">   </span><span class="k">then</span><span class="w"> </span><span class="k">obtain</span><span class="w"> </span><span class="n">e00</span><span class="w"> </span><span class="n">e01</span><span class="w"> </span><span class="n">e02</span><span class="w"> </span><span class="n">e03</span><span class="w"> </span><span class="kp">where</span><span class="w"> </span><span class="n">lin_comb_key_0</span><span class="o">:</span>
<span class="w">    </span><span class="s">"?L0 = e00 * y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">    (∑h ∈ {4..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0))"</span>
<span class="w">     </span><span class="k">by</span><span class="w"> </span><span class="n">fast</span>

<span class="w">   </span><span class="k">assume</span><span class="w"> </span><span class="n">zero_assump</span><span class="o">:</span><span class="w"> </span><span class="s">"y0 = (if e00 = 1 then -(e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">    (∑h ∈ {4..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0)))/2 else</span>
<span class="s">    (e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">    (∑h ∈ {4..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0)))/(1-e00))"</span>

<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="n">first_fact</span><span class="o">:</span><span class="w"> </span><span class="s">"y0^2 = ?L0^2"</span>
<span class="w">   </span><span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">cases</span><span class="w"> </span><span class="s">"e00 = 1"</span><span class="o">)</span>
<span class="w">     </span><span class="k">case</span><span class="w"> </span><span class="n">True</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"y0 = -(e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0))) / 2"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">zero_assump</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"-y0 = y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0))"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"(-y0)^2 = (y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0)))^2"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="n">argo</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="n">eq</span><span class="o">:</span><span class="w"> </span><span class="s">"y0^2 = (e00* y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0)))^2"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0)) =</span>
<span class="s">         e00 * y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0))"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">lin_comb_key_0</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"y0^2 = (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0))^2"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">eq</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">eq</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">   </span><span class="k">next</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="n">False</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"y0 = (e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0))) / (1 - e00)"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">zero_assump</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"(1 - e00) * y0 = e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0))"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">False</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"y0 = e00 * y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">          (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0))"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">algebra_simps</span><span class="o">)</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="n">eq</span><span class="o">:</span><span class="w"> </span><span class="s">"(y0)^2 = (e00 * y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">          (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0)))^2"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="n">argo</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0)) =</span>
<span class="s">            e00 * y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">            (∑h ∈ {4..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0))"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">lin_comb_key_0</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"y0^2 = (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0))^2"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">eq</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">algebra_simps</span><span class="o">)</span>
<span class="w">  </span><span class="k">qed</span>

<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="s">"(∑i ∈ {0..&lt;m}.(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">                 of_int Λ * (∑j ∈ {0..&lt;𝗏}.(x $$ (j, 0)))^2 +</span>
<span class="s">                 of_int (𝗄 - Λ) * (∑j ∈ {4..&lt;m}. (x $$ (j, 0))^2) +</span>
<span class="s">                 y0^2 + y1^2 + y2^2 + y3^2"</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="o">(</span><span class="n">1</span><span class="o">-</span><span class="n">25</span><span class="o">)</span><span class="w"> </span><span class="n">zero_assump</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="n">split_eq</span><span class="o">:</span><span class="w"> </span><span class="s">"?L0^2 + ?L1^2 + ?L2^2 + ?L3^2 +</span>
<span class="s">    (∑i ∈ {4..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">    y0^2 + y1^2 + y2^2 + y3^2 + of_int Λ * (∑j ∈ {0..&lt;𝗏}.(x $$ (j, 0)))^2 +</span>
<span class="s">    of_int (𝗄 - Λ) * (∑j ∈ {4..&lt;m}. (x $$ (j, 0))^2)"</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">lhs</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"?L1^2 + ?L2^2 + ?L3^2 +</span>
<span class="s">    (∑i ∈ {4..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">    y1^2 + y2^2 + y3^2 + of_int Λ * (∑j ∈ {0..&lt;𝗏}.(x $$ (j, 0)))^2 +</span>
<span class="s">    of_int (𝗄 - Λ) * (∑j ∈ {4..&lt;m}. (x $$ (j, 0))^2)"</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">split_eq</span><span class="w"> </span><span class="n">first_fact</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">thus</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="k">qed</span>
</code></pre></div>
<p>Isabelle accepted every step of the proof except for the last line "thus ?thesis by simp", even though the line before that is identical to the thesis. The error message was, "Illegal application of proof command in "state" mode" and "Result contains obtained parameters: e03 e02 e01 e00" and "Local statement fails to refine any pending goal". I assume this has to do with the fact that I used "assume" in the proof. I had anticipated that Isabelle would have problems with this in my first post "Peculiar feature of the proof of the Bruck Ryser Chowla thm". And I was right unfortunately. I'm not sure how to get Isabelle to recognize that it is a valid proof even though it is peculiar - the thesis doesn't say anything about y0, even though the proof assumes that y0 is a specific linear combination of the other y variables. Therefore, the assumption is irrelevant to whether the lemma is correct.</p>
<p>Any explanations or ideas?</p>



<a name="490359502"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490359502" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490359502">(Dec 22 2024 at 05:07)</a>:</h4>
<p>I’m starting to think perhaps I should rewrite the thesis instead as “there exists y1 y2 y3 and vector x such that ….” Since the thesis is correct only with the assumption in my proof.</p>



<a name="490359916"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490359916" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490359916">(Dec 22 2024 at 05:15)</a>:</h4>
<p>But there is a problem with this - I can’t repeat the induction step to get rid of y1, y2, y3, etc. with this strategy. So I am at a loss as to what to do next.</p>



<a name="490406831"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490406831" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490406831">(Dec 22 2024 at 17:53)</a>:</h4>
<p>Thinking about this more perhaps the answer is putting the assume part in the initial assumption.</p>



<a name="490408776"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490408776" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490408776">(Dec 22 2024 at 18:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="736162">Craig Alan Feinstein</span> <a href="#narrow/channel/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202/near/490344332">said</a>:</p>
<blockquote>
<p>And I was right unfortunately. I'm not sure how to get Isabelle to recognize that it is a valid proof even though it is peculiar - the thesis doesn't say anything about y0, even though the proof assumes that y0 is a specific linear combination of the other y variables. Therefore, the assumption is irrelevant to whether the lemma is correct.</p>
<p>Any explanations or ideas?</p>
</blockquote>
<ol>
<li>Adding random assumptions is incorrect even if they to not appear in the goal. If I assume that there is a number that is both even and odd, everything will go through.</li>
<li>How about rephrasing your theorem into proper mathematical term? Your assume is not an assume. It is a <em>definition</em> of <code>y0</code>. So why not use the keyword <code>define</code>?</li>
</ol>



<a name="490408918"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490408918" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490408918">(Dec 22 2024 at 18:25)</a>:</h4>
<p>Also your theorem is a mess currently. At least you could: </p>
<ul>
<li>use defines for abbreviations in your theorem</li>
<li>think about deduplicating assumptions</li>
</ul>



<a name="490409390"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490409390" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490409390">(Dec 22 2024 at 18:32)</a>:</h4>
<p>Remark that you did not follow the suggested proof pattern from Fabian. Why?</p>



<a name="490409857"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490409857" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490409857">(Dec 22 2024 at 18:41)</a>:</h4>
<p>At least from what I can see here, there <em>are</em> assumption on <code>y0</code></p>



<a name="490409925"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490409925" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490409925">(Dec 22 2024 at 18:42)</a>:</h4>
<p>So it is not a free variable as you suggested in the other thread</p>



<a name="490428901"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490428901" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490428901">(Dec 22 2024 at 23:55)</a>:</h4>
<p>My idea to put the assume part in the assumptions worked. Isabelle recognizes the lemma proof as valid.</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="kn">lemma</span><span class="w"> </span><span class="n">induction_step</span><span class="o">:</span>
<span class="w">      </span><span class="kp">assumes</span><span class="w">  </span><span class="s">"a ∈ ℕ"</span><span class="w"> </span><span class="s">"b ∈ ℕ"</span><span class="w"> </span><span class="s">"c ∈ ℕ"</span><span class="w"> </span><span class="s">"d ∈ ℕ"</span>
<span class="w">                </span><span class="s">"x0 ∈ ℚ"</span><span class="w"> </span><span class="s">"x1 ∈ ℚ"</span><span class="w"> </span><span class="s">"x2 ∈ ℚ"</span><span class="w"> </span><span class="s">"x3 ∈ ℚ"</span>
<span class="w">                </span><span class="s">"a^2 + b^2 + c^2 + d^2 = 𝗄 - Λ"</span>
<span class="w">                </span><span class="s">"x ∈ rat mat 𝗏 1"</span><span class="w"> </span><span class="s">"𝗏 &gt; 3"</span><span class="w"> </span><span class="s">"m &gt; 3"</span><span class="w"> </span><span class="s">"x0 = x $$ (0,0)"</span>
<span class="w">                </span><span class="s">"x1 = x $$ (1,0)"</span><span class="w"> </span><span class="s">"x2 = x $$ (2,0)"</span><span class="w"> </span><span class="s">"x3 = x $$ (3,0)"</span>
<span class="w">                </span><span class="s">"x0 = one_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3)))"</span>
<span class="w">                </span><span class="s">"x1 = two_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3)))"</span>
<span class="w">                </span><span class="s">"x2 = three_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3)))"</span>
<span class="w">                </span><span class="s">"x3 = four_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3)))"</span>
<span class="w">                </span><span class="s">"y0 ∈ ℚ"</span><span class="w"> </span><span class="s">"y1 ∈ ℚ"</span><span class="w"> </span><span class="s">"y2 ∈ ℚ"</span><span class="w"> </span><span class="s">"y3 ∈ ℚ"</span>
<span class="w">                </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0)) =</span>
<span class="s">                 e00 * y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">                 (∑h ∈ {4..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0))"</span>
<span class="w">                </span><span class="s">"y0 = (if e00 = 1 then -(e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">                 (∑h ∈ {4..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0)))/2 else</span>
<span class="s">                 (e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">                 (∑h ∈ {4..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0)))/(1-e00))"</span>
<span class="w">                </span><span class="s">"(a ∈ ℕ ∧ b ∈ ℕ ∧ c ∈ ℕ ∧ d ∈ ℕ ∧</span>
<span class="s">                 x0 ∈ ℚ ∧ x1 ∈ ℚ ∧ x2 ∈ ℚ ∧ x3 ∈ ℚ ∧</span>
<span class="s">                 (a^2 + b^2 + c^2 + d^2 = 𝗄 - Λ) ∧</span>
<span class="s">                 x ∈ rat mat 𝗏 1 ∧ 𝗏 &gt; 3 ∧ m &gt; 3 ∧ x0 = x $$ (0,0) ∧</span>
<span class="s">                 x1 = x $$ (1,0) ∧ x2 = x $$ (2,0) ∧ x3 = x $$ (3,0) ∧</span>
<span class="s">                 x0 = one_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3))) ∧</span>
<span class="s">                 x1 = two_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3))) ∧</span>
<span class="s">                 x2 = three_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3))) ∧</span>
<span class="s">                 x3 = four_of(y_inv_of((a, b, c, d),(y0, y1, y2, y3))) ∧</span>
<span class="s">                 y0 ∈ ℚ ∧ y1 ∈ ℚ ∧ y2 ∈ ℚ ∧ y3 ∈ ℚ) ⟶</span>
<span class="s">                (∑i ∈ {0..&lt;m}.(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">                 of_int Λ * (∑j ∈ {0..&lt;𝗏}.(x $$ (j, 0)))^2 +</span>
<span class="s">                 of_int (𝗄 - Λ) * (∑j ∈ {4..&lt;m}. (x $$ (j, 0))^2) +</span>
<span class="s">                 y0^2 + y1^2 + y2^2 + y3^2"</span>
<span class="w">              </span><span class="kp">shows</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,1)) * x $$ (h,0))^2 +</span>
<span class="s">                      (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,2)) * x $$ (h,0))^2 +</span>
<span class="s">                      (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,3)) * x $$ (h,0))^2 +</span>
<span class="s">                      (∑i ∈ {4..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">                      y1^2 + y2^2 + y3^2 + of_int Λ * (∑j ∈ {0..&lt;𝗏}.(x $$ (j, 0)))^2 +</span>
<span class="s">                      of_int (𝗄 - Λ) * (∑j ∈ {4..&lt;m}. (x $$ (j, 0))^2)"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="o">?</span><span class="n">L0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0))"</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="o">?</span><span class="n">L1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,1)) * x $$ (h,0))"</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="o">?</span><span class="n">L2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,2)) * x $$ (h,0))"</span>
<span class="w">  </span><span class="k">let</span><span class="w"> </span><span class="o">?</span><span class="n">L3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,3)) * x $$ (h,0))"</span>

<span class="w">   </span><span class="k">have</span><span class="w"> </span><span class="n">sumdef</span><span class="o">:</span><span class="w"> </span><span class="s">"(∑i ∈ {0..&lt;4}.(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">    ?L0^2 + ?L1^2 + ?L2^2 + ?L3^2"</span>
<span class="w">   </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">numeral.simps</span><span class="o">(</span><span class="n">2</span><span class="o">,</span><span class="n">3</span><span class="o">))</span>
<span class="w">   </span><span class="k">have</span><span class="w"> </span><span class="n">split</span><span class="o">:</span><span class="w"> </span><span class="s">"{0..&lt;m} = {0..&lt;4} ∪ {4..&lt;m}"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="o">(</span><span class="n">12</span><span class="o">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">   </span><span class="k">have</span><span class="w"> </span><span class="n">inter</span><span class="o">:</span><span class="w"> </span><span class="s">"{} = {0..&lt;4} ∩ {4..&lt;m}"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">   </span><span class="k">have</span><span class="w"> </span><span class="s">"(∑i ∈ {0..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">        (∑i ∈ {0..&lt;4}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) +</span>
<span class="s">        (∑i ∈ {4..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2)"</span>
<span class="w">     </span><span class="k">using</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="n">inter</span><span class="w"> </span><span class="n">sum.union_disjoint</span><span class="o">[</span><span class="n">of</span><span class="w"> </span><span class="s">"{0..&lt;4}"</span><span class="w"> </span><span class="s">"{4..&lt;m}"</span><span class="w"> </span><span class="s">"λ i .</span>
<span class="s">      (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2"</span><span class="o">]</span>
<span class="w">     </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">metis</span><span class="w"> </span><span class="o">(</span><span class="n">no_types</span><span class="o">,</span><span class="w"> </span><span class="n">lifting</span><span class="o">)</span><span class="w"> </span><span class="n">finite_atLeastLessThan</span><span class="o">)</span>
<span class="w">   </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="n">lhs</span><span class="o">:</span><span class="w"> </span><span class="s">"(∑i ∈ {0..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">    ?L0^2 + ?L1^2 + ?L2^2 + ?L3^2 +</span>
<span class="s">    (∑i ∈ {4..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2)"</span>
<span class="w">     </span><span class="k">using</span><span class="w"> </span><span class="n">sumdef</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>

<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="n">first_fact</span><span class="o">:</span><span class="w"> </span><span class="s">"y0^2 = ?L0^2"</span>
<span class="w">   </span><span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">cases</span><span class="w"> </span><span class="s">"e00 = 1"</span><span class="o">)</span>
<span class="w">     </span><span class="k">case</span><span class="w"> </span><span class="n">True</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"y0 = -(e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0))) / 2"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="o">(</span><span class="n">26</span><span class="o">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"-y0 = y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0))"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"(-y0)^2 = (y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0)))^2"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="n">argo</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="n">eq</span><span class="o">:</span><span class="w"> </span><span class="s">"y0^2 = (e00* y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0)))^2"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">True</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0)) =</span>
<span class="s">         e00 * y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0))"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="o">(</span><span class="n">25</span><span class="o">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"y0^2 = (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0))^2"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">eq</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">eq</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">   </span><span class="k">next</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="n">False</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"y0 = (e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0))) / (1 - e00)"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="o">(</span><span class="n">26</span><span class="o">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"(1 - e00) * y0 = e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">         (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0))"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">False</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"y0 = e00 * y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">          (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0))"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">algebra_simps</span><span class="o">)</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="n">eq</span><span class="o">:</span><span class="w"> </span><span class="s">"(y0)^2 = (e00 * y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">          (∑h ∈ {4..&lt;𝗏}. of_int (N $$ (h, 0)) * x $$ (h, 0)))^2"</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="n">argo</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="s">"(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0)) =</span>
<span class="s">            e00 * y0 + e01 * y1 + e02 * y2 + e03 * y3 +</span>
<span class="s">            (∑h ∈ {4..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0))"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="o">(</span><span class="n">25</span><span class="o">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"y0^2 = (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,0)) * x $$ (h,0))^2"</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">eq</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">algebra_simps</span><span class="o">)</span>
<span class="w">  </span><span class="k">qed</span>

<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="s">"(∑i ∈ {0..&lt;m}.(∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">                 of_int Λ * (∑j ∈ {0..&lt;𝗏}.(x $$ (j, 0)))^2 +</span>
<span class="s">                 of_int (𝗄 - Λ) * (∑j ∈ {4..&lt;m}. (x $$ (j, 0))^2) +</span>
<span class="s">                 y0^2 + y1^2 + y2^2 + y3^2"</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="o">(</span><span class="n">1</span><span class="o">-</span><span class="n">27</span><span class="o">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="n">split_eq</span><span class="o">:</span><span class="w"> </span><span class="s">"?L0^2 + ?L1^2 + ?L2^2 + ?L3^2 +</span>
<span class="s">    (∑i ∈ {4..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">    y0^2 + y1^2 + y2^2 + y3^2 + of_int Λ * (∑j ∈ {0..&lt;𝗏}.(x $$ (j, 0)))^2 +</span>
<span class="s">    of_int (𝗄 - Λ) * (∑j ∈ {4..&lt;m}. (x $$ (j, 0))^2)"</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">lhs</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"?L1^2 + ?L2^2 + ?L3^2 +</span>
<span class="s">    (∑i ∈ {4..&lt;m}. (∑h ∈ {0..&lt;𝗏}. of_int(N $$ (h,i)) * x $$ (h,0))^2) =</span>
<span class="s">    y1^2 + y2^2 + y3^2 + of_int Λ * (∑j ∈ {0..&lt;𝗏}.(x $$ (j, 0)))^2 +</span>
<span class="s">    of_int (𝗄 - Λ) * (∑j ∈ {4..&lt;m}. (x $$ (j, 0))^2)"</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">split_eq</span><span class="w"> </span><span class="n">first_fact</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">thus</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="k">qed</span>
</code></pre></div>
<p>Thank you Mathias Fleury for your remarks. I now agree with you that the proof does not have the peculiar property that I suggested in the thread, as y0 is not a free variable as I thought in the other thread. Also I agree that the theorem is a mess for readers to read. My goal now is to get my proofs accepted by Isabelle and later I'll worry about making my proofs readable.</p>



<a name="490434461"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490434461" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490434461">(Dec 23 2024 at 01:21)</a>:</h4>
<p>"My goal now is to get my proofs accepted by Isabelle and later I'll worry about making my proofs readable."</p>
<p>this is surely the wrong way to go for formalized math; even if your proofs are messy, the theorem statements should really not be a mess, both for your own context management and also for others to inspect your results. It is also very difficult (I assume) for <span class="user-mention" data-user-id="233198">@Mathias Fleury</span> and others to figure out what's wrong with your proofs.</p>



<a name="490443562"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490443562" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490443562">(Dec 23 2024 at 03:25)</a>:</h4>
<p>Yong Kiam, this particular lemma (along with three other similar lemmas) is central to the proof of the BRC theorem. Everything else in the proof is high school algebra with some linear algebra and elementary number theory. The only way I know of to make it more readable would be to stick this lemma in another lemma, which I just might do. But every assumption is necessary for the lemma to work, even though there are twenty something assumptions. Also anyone who reads the proof in Stinson’s book of the BRC should be able to understand the lemma since it uses the same variable names.</p>



<a name="490443716"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490443716" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490443716">(Dec 23 2024 at 03:27)</a>:</h4>
<p>Also the lemma needs to be modified since it only looks at four columns of matrix N instead of all columns. But that shouldn’t be too hard to do.</p>



<a name="490444284"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490444284" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490444284">(Dec 23 2024 at 03:34)</a>:</h4>
<p>Also Yong Kiam thank you for your comments.</p>



<a name="490448677"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490448677" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490448677">(Dec 23 2024 at 04:32)</a>:</h4>
<p>sure, but there are many more things that you can do even in its current state, such as the points <span class="user-mention" data-user-id="233198">@Mathias Fleury</span>  has mentioned about defining variables with the <code>defines</code> keyword</p>
<p>just looking quickly, the role of <code>x0</code> etc. are all just acting as (local) definitions</p>
<p>you only need to define, e.g., <code>x0 = x $$ (0,0)</code> once instead of writing it in every assumption</p>



<a name="490450248"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490450248" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490450248">(Dec 23 2024 at 04:51)</a>:</h4>
<p>You mean I can just put “define x0 = x$$(0,0)” in the middle of the proof? That would definitely help to make it more readable.</p>



<a name="490450321"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490450321" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490450321">(Dec 23 2024 at 04:52)</a>:</h4>
<p>you can write <code>defines</code> as a keyword in the theorem statement, not in the middle of the proof</p>



<a name="490450363"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490450363" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490450363">(Dec 23 2024 at 04:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/channel/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202/near/490408918">said</a>:</p>
<blockquote>
<p>Also your theorem is a mess currently. At least you could: </p>
<ul>
<li>use defines for abbreviations in your theorem</li>
<li>think about deduplicating assumptions</li>
</ul>
</blockquote>
<p>^ what I mean following what Mathias has written here would be a good step to clean up your theorem for subsequent use</p>



<a name="490450386"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490450386" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490450386">(Dec 23 2024 at 04:53)</a>:</h4>
<p>You mean the assumptions part?</p>



<a name="490450506"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490450506" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490450506">(Dec 23 2024 at 04:55)</a>:</h4>
<p>Can you please give an example?</p>



<a name="490450741"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490450741" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490450741">(Dec 23 2024 at 04:58)</a>:</h4>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="kn">lemma</span><span class="w"> </span><span class="n">foo</span><span class="o">:</span>
<span class="w">  </span><span class="kp">defines</span><span class="w"> </span><span class="s">"x0 \equiv x $$ (0,0)"</span>
<span class="w">  </span><span class="kp">assumes</span><span class="w"> </span><span class="s">".... just use x0 in here ..."</span>
</code></pre></div>



<a name="490452629"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490452629" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490452629">(Dec 23 2024 at 05:17)</a>:</h4>
<p>Ok thank you.</p>



<a name="490530630"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490530630" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490530630">(Dec 23 2024 at 14:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="234226">Yong Kiam</span> <a href="#narrow/channel/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202/near/490434461">said</a>:</p>
<blockquote>
<p>"My goal now is to get my proofs accepted by Isabelle and later I'll worry about making my proofs readable."</p>
<p>this is surely the wrong way to go for formalized math; even if your proofs are messy, the theorem statements should really not be a mess, both for your own context management and also for others to inspect your results. It is also very difficult (I assume) for <span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> and others to figure out what's wrong with your proofs.</p>
</blockquote>
<p>I actually tried to run the proof in Isabelle but failed to guess what imports it needed, so I stopped</p>



<a name="490531327"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490531327" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490531327">(Dec 23 2024 at 14:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="736162">Craig Alan Feinstein</span> <a href="#narrow/channel/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202/near/490443562">said</a>:</p>
<blockquote>
<p>Yong Kiam, this particular lemma (along with three other similar lemmas) is central to the proof of the BRC theorem. Everything else in the proof is high school algebra with some linear algebra and elementary number theory. The only way I know of to make it more readable would be to stick this lemma in another lemma, which I just might do. But every assumption is necessary for the lemma to work, even though there are twenty something assumptions. Also anyone who reads the proof in Stinson’s book of the BRC should be able to understand the lemma since it uses the same variable names.</p>
</blockquote>
<p>I have not read the book, but does I doubt that Stinson put everything as an assumption. This for example just looks fishy:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="o">(</span><span class="n">a</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">ℕ</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">ℕ</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">ℕ</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">ℕ</span><span class="w"> </span><span class="n">∧</span>
<span class="w">                 </span><span class="n">x0</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">ℚ</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">x1</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">ℚ</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">ℚ</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">x3</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">ℚ</span><span class="w"> </span><span class="n">∧</span>
<span class="w">                 </span><span class="o">(</span><span class="n">a^2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b^2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c^2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">d^2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">𝗄</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Λ</span><span class="o">)</span><span class="w"> </span><span class="n">∧</span>
<span class="w">                 </span><span class="n">x</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">rat</span><span class="w"> </span><span class="n">mat</span><span class="w"> </span><span class="n">𝗏</span><span class="w"> </span><span class="n">1</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">𝗏</span><span class="w"> </span><span class="n">&gt;</span><span class="w"> </span><span class="n">3</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">&gt;</span><span class="w"> </span><span class="n">3</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">x0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">$$</span><span class="w"> </span><span class="o">(</span><span class="n">0</span><span class="o">,</span><span class="n">0</span><span class="o">)</span><span class="w"> </span><span class="n">∧</span>
<span class="w">                 </span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">$$</span><span class="w"> </span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="n">0</span><span class="o">)</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">$$</span><span class="w"> </span><span class="o">(</span><span class="n">2</span><span class="o">,</span><span class="n">0</span><span class="o">)</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">x3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">$$</span><span class="w"> </span><span class="o">(</span><span class="n">3</span><span class="o">,</span><span class="n">0</span><span class="o">)</span><span class="w"> </span><span class="n">∧</span>
<span class="w">                 </span><span class="n">x0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one_of</span><span class="o">(</span><span class="n">y_inv_of</span><span class="o">((</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="o">),(</span><span class="n">y0</span><span class="o">,</span><span class="w"> </span><span class="n">y1</span><span class="o">,</span><span class="w"> </span><span class="n">y2</span><span class="o">,</span><span class="w"> </span><span class="n">y3</span><span class="o">)))</span><span class="w"> </span><span class="n">∧</span>
<span class="w">                 </span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">two_of</span><span class="o">(</span><span class="n">y_inv_of</span><span class="o">((</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="o">),(</span><span class="n">y0</span><span class="o">,</span><span class="w"> </span><span class="n">y1</span><span class="o">,</span><span class="w"> </span><span class="n">y2</span><span class="o">,</span><span class="w"> </span><span class="n">y3</span><span class="o">)))</span><span class="w"> </span><span class="n">∧</span>
<span class="w">                 </span><span class="n">x2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">three_of</span><span class="o">(</span><span class="n">y_inv_of</span><span class="o">((</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="o">),(</span><span class="n">y0</span><span class="o">,</span><span class="w"> </span><span class="n">y1</span><span class="o">,</span><span class="w"> </span><span class="n">y2</span><span class="o">,</span><span class="w"> </span><span class="n">y3</span><span class="o">)))</span><span class="w"> </span><span class="n">∧</span>
<span class="w">                 </span><span class="n">x3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">four_of</span><span class="o">(</span><span class="n">y_inv_of</span><span class="o">((</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="o">),(</span><span class="n">y0</span><span class="o">,</span><span class="w"> </span><span class="n">y1</span><span class="o">,</span><span class="w"> </span><span class="n">y2</span><span class="o">,</span><span class="w"> </span><span class="n">y3</span><span class="o">)))</span><span class="w"> </span><span class="n">∧</span>
<span class="w">                 </span><span class="n">y0</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">ℚ</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">y1</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">ℚ</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">y2</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">ℚ</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">y3</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">ℚ</span><span class="o">)</span><span class="w"> </span><span class="n">⟶</span>
<span class="w">                </span><span class="o">(</span><span class="n">∑i</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="ow">{</span><span class="n">0..&lt;m</span><span class="ow">}.</span><span class="o">(</span><span class="n">∑h</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="ow">{</span><span class="n">0..&lt;𝗏</span><span class="ow">}.</span><span class="w"> </span><span class="n">of_int</span><span class="o">(</span><span class="n">N</span><span class="w"> </span><span class="n">$$</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="o">,</span><span class="n">i</span><span class="o">))</span><span class="w"> </span><span class="n">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">$$</span><span class="w"> </span><span class="o">(</span><span class="n">h</span><span class="o">,</span><span class="n">0</span><span class="o">))</span><span class="n">^2</span><span class="o">)</span><span class="w"> </span><span class="o">=</span>
<span class="w">                 </span><span class="n">of_int</span><span class="w"> </span><span class="n">Λ</span><span class="w"> </span><span class="n">*</span><span class="w"> </span><span class="o">(</span><span class="n">∑j</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="ow">{</span><span class="n">0..&lt;𝗏</span><span class="ow">}.</span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="n">$$</span><span class="w"> </span><span class="o">(</span><span class="n">j</span><span class="o">,</span><span class="w"> </span><span class="n">0</span><span class="o">)))</span><span class="n">^2</span><span class="w"> </span><span class="o">+</span>
<span class="w">                 </span><span class="n">of_int</span><span class="w"> </span><span class="o">(</span><span class="n">𝗄</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Λ</span><span class="o">)</span><span class="w"> </span><span class="n">*</span><span class="w"> </span><span class="o">(</span><span class="n">∑j</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="ow">{</span><span class="n">4..&lt;m</span><span class="ow">}.</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="w"> </span><span class="n">$$</span><span class="w"> </span><span class="o">(</span><span class="n">j</span><span class="o">,</span><span class="w"> </span><span class="n">0</span><span class="o">))</span><span class="n">^2</span><span class="o">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">                 </span><span class="n">y0^2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y1^2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y2^2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">y3^2</span>
</code></pre></div>



<a name="490531429"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490531429" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490531429">(Dec 23 2024 at 14:48)</a>:</h4>
<p>It looks like you are having an induction around and this is the induction hypothesis</p>



<a name="490592408"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490592408" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490592408">(Dec 23 2024 at 22:20)</a>:</h4>
<p>I have imports:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">theory</span><span class="w"> </span><span class="n">Bruck_Ryser_Chowla</span><span class="w"> </span><span class="kp">imports</span>
<span class="w">  </span><span class="n">Fishers_Inequality.Fishers_Inequality</span><span class="w"> </span><span class="n">SumSquares.FourSquares</span><span class="w"> </span><span class="n">Pell.Pell</span>
<span class="k">begin</span>
</code></pre></div>
<p>The assumptions in my lemma use functions that I defined elsewhere though. I will use the lemma in my induction argument, which I haven't created yet.</p>



<a name="490607825"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490607825" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490607825">(Dec 24 2024 at 00:38)</a>:</h4>
<p>that is not the problem with your assumptions, rather, you have assumptions like this:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="kp">assumes</span><span class="w"> </span><span class="n">P</span>
<span class="kp">assumes</span><span class="w"> </span><span class="s">"P ⟶ Q"</span>
</code></pre></div>
<p>you can just write that as</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="kp">assumes</span><span class="w"> </span><span class="n">P</span>
<span class="kp">assumes</span><span class="w"> </span><span class="n">Q</span>
</code></pre></div>



<a name="490613773"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/Peculiar%20feature%20of%20the%20proof%20of%20the%20BRC%20thm%20part%202/near/490613773" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/Peculiar.20feature.20of.20the.20proof.20of.20the.20BRC.20thm.20part.202.html#490613773">(Dec 24 2024 at 01:38)</a>:</h4>
<p>Yong Kiam, excellent point. That gets rid of almost half of the assumptions without affecting the validity of the proof. Thank you.</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>