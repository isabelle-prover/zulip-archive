<html>
<head><meta charset="utf-8"><title>printing types in non-ML notation · General · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/index.html">General</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/printing.20types.20in.20non-ML.20notation.html">printing types in non-ML notation</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="548112558"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/printing%20types%20in%20non-ML%20notation/near/548112558" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edoardo Putti <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/printing.20types.20in.20non-ML.20notation.html#548112558">(Oct 31 2025 at 09:34)</a>:</h4>
<p>Hello all,</p>
<p>I'm surely working against the pretty-printing and syntax but what I found in Pure/HOL/AFP does not seems to address this issue I am facing.</p>
<p>I want to print a type in postfix notation, e.g. option 'a, in place of prefix notation.</p>
<p>After spelunking in pure_theory.ML I got to the syntax definition for type application and I can override the normal syntax with mine for a custom print mode.</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">syntax</span><span class="w"> </span><span class="o">(</span><span class="n">pvl</span><span class="w"> </span><span class="kp">output</span><span class="o">)</span>
<span class="w">    </span><span class="s">"_tapp"</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"type =&gt; type_name =&gt; type"</span><span class="w"> </span><span class="o">(</span><span class="s">"(1_&lt;_&gt;)"</span><span class="o">)</span>

<span class="kt">typ</span><span class="w"> </span><span class="s">"'a option"</span><span class="w">            </span><span class="c">(* prints as 'a option    *)</span>
<span class="kt">typ</span><span class="w"> </span><span class="o">(</span><span class="n">pvl</span><span class="o">)</span><span class="w"> </span><span class="s">"'a option"</span><span class="w"> </span><span class="c">(* prints as 'a&lt;option&gt; *)</span>
</code></pre></div>
<p>I cannot exchange the order of in the mixfix declaration but I can declare a new pattern _pvl_tapp and a translation from _tapp to _pvl_tapp.</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">syntax</span><span class="w"> </span><span class="o">(</span><span class="n">pvl</span><span class="w"> </span><span class="kp">output</span><span class="o">)</span>
<span class="w">    </span><span class="s">"_pvl_tapp"</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">" type_name =&gt; type =&gt; type"</span><span class="w"> </span><span class="o">(</span><span class="s">"(1_&lt;_&gt;)"</span><span class="o">)</span><span class="w"> </span><span class="c">(* note inversion of type_name and type in production *)</span>

<span class="kt">typ</span><span class="w"> </span><span class="s">"'a option"</span><span class="w">            </span><span class="c">(* prints as 'a option    *)</span>
<span class="kt">typ</span><span class="w"> </span><span class="o">(</span><span class="n">pvl</span><span class="o">)</span><span class="w"> </span><span class="s">"'a option"</span><span class="w"> </span><span class="c">(* prints as 'a option, expected as I have no translation yet *)</span>

<span class="n">translation</span>
<span class="w">  </span><span class="s">"_pvl_tapp tc ty"</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"_tapp ty tc"</span>


<span class="kt">typ</span><span class="w"> </span><span class="s">"'a option"</span><span class="w">            </span><span class="c">(* prints as 'a option    *)</span>
<span class="kt">typ</span><span class="w"> </span><span class="o">(</span><span class="n">pvl</span><span class="o">)</span><span class="w"> </span><span class="s">"'a option"</span><span class="w"> </span><span class="c">(* prints as 'a option *)</span>
</code></pre></div>
<p>I even got as far as looking at type_syntax but that binds one syntax constant to one type or type synonym.<br>
Decorating the translation with the (type) qualifier (?) yields the error <code>Undefined type name: "_pvl_tapp"</code>, example below.</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="w"> </span><span class="n">translation</span>
<span class="w">  </span><span class="o">(</span><span class="n">type</span><span class="o">)</span><span class="w"> </span><span class="s">"_pvl_tapp tc ty"</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">(</span><span class="n">type</span><span class="o">)</span><span class="w"> </span><span class="s">"_tapp ty tc"</span>
</code></pre></div>
<p>Is this use-case supported in any way? It's also unclear how to interface with the type pretty printing and I cannot find anybody attempting this.</p>
<p>The second question is, it there a way to scope translations to one printing mode? In the previous example the translation from _tapp to _pvl_tapp makes no sense in normal output so it should be ignored by the system, which is what I am observing now.</p>



<a name="548122237"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/printing%20types%20in%20non-ML%20notation/near/548122237" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/printing.20types.20in.20non-ML.20notation.html#548122237">(Oct 31 2025 at 10:26)</a>:</h4>
<p>Your approach looks good and I am not sure why it is not working. You might have more luck asking on the mailing list.</p>



<a name="554181804"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202961-General/topic/printing%20types%20in%20non-ML%20notation/near/554181804" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Edoardo Putti <a href="http://isabelle.systems/zulip-archive/stream/202961-General/topic/printing.20types.20in.20non-ML.20notation.html#554181804">(Nov 06 2025 at 20:15)</a>:</h4>
<p>I was able to use the following snippet to replace the production _tapp with the production _pvl_tapp. It does not look like it is possible to do this using the translation command. In the following translation I raise an exception when the print mode is not pvl which scopes it to what I needed.</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">print_translation</span><span class="w"> </span><span class="s">"</span>
<span class="s">let</span>
<span class="s">  fun with_pvl_mode f ctxt ast = if Print_Mode.print_mode_active "</span><span class="n">pvl"</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">ctxt</span><span class="w"> </span><span class="n">ast</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="n">raise</span><span class="w"> </span><span class="n">Match;</span>
<span class="w">  </span><span class="k">fun</span><span class="w"> </span><span class="n">print_pvl_tapp</span><span class="w"> </span><span class="n">ctxt</span><span class="w"> </span><span class="o">[</span><span class="n">typeAst</span><span class="o">,</span><span class="w"> </span><span class="n">typenameAst</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Ast.Appl</span><span class="w"> </span><span class="o">[</span><span class="n">Ast.Constant</span><span class="w"> </span><span class="n">@</span><span class="ow">{</span><span class="n">syntax_const</span><span class="w">  </span><span class="s">"_pvl_tapp"</span><span class="ow">}</span><span class="o">,</span><span class="w"> </span><span class="n">typenameAst</span><span class="o">,</span><span class="w"> </span><span class="n">typeAst</span><span class="o">]</span>
<span class="w"> </span><span class="kp">in</span>
<span class="w">  </span><span class="o">[</span>
<span class="w">   </span><span class="o">(</span><span class="n">@</span><span class="ow">{</span><span class="n">syntax_const</span><span class="w"> </span><span class="s">"_tapp"</span><span class="ow">}</span><span class="o">,</span><span class="w">  </span><span class="n">with_pvl_mode</span><span class="w"> </span><span class="n">print_pvl_tapp</span><span class="o">),</span>
<span class="w">  </span><span class="o">]</span>
<span class="k">end</span>
<span class="s">"</span>
</code></pre></div>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>