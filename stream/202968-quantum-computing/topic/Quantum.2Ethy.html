<html>
<head><meta charset="utf-8"><title>Quantum.thy · quantum computing · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/index.html">quantum computing</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html">Quantum.thy</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="173119733"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/173119733" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bordg <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#173119733">(Aug 13 2019 at 14:45)</a>:</h4>
<p>One should remove the condition <code>state n v</code> in <code>prob0</code> and <code>prob1</code>. The if/then/else structure here is useless. Of course, the condition <code>state n v</code> should be listed among the assumptions in the subsequent lemmas whenever needed, but in the definition itself it's useless.<br>
<span class="user-mention" data-user-id="228787">@Hanna Lachnitt</span>  <span class="user-mention" data-user-id="228785">@Yijun He</span></p>



<a name="173119910"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/173119910" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hanna Lachnitt <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#173119910">(Aug 13 2019 at 14:47)</a>:</h4>
<p>That would be good it gave me some problems in Deutsch-Jozsa</p>



<a name="173120066"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/173120066" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hanna Lachnitt <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#173120066">(Aug 13 2019 at 14:49)</a>:</h4>
<p>Also could we maybe use k instead of j in the def of select_index?</p>



<a name="173120818"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/173120818" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bordg <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#173120818">(Aug 13 2019 at 14:56)</a>:</h4>
<blockquote>
<p>That would be good it gave me some problems in Deutsch-Jozsa</p>
</blockquote>
<p>This is what I have in mind actually.</p>



<a name="173121682"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/173121682" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bordg <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#173121682">(Aug 13 2019 at 15:05)</a>:</h4>
<p><code>prob0</code> and <code>prob1</code> have been simplify and <code>Quantum.thy</code> has been updated on GitHub.</p>



<a name="173280162"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/173280162" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bordg <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#173280162">(Aug 15 2019 at 10:41)</a>:</h4>
<p>What about moving everything related to measurement from <code>Quantum.thy</code> to a dedicated theory <code>Measurement.thy</code> ?<br>
<span class="user-mention" data-user-id="228785">@Yijun He</span> <span class="user-mention" data-user-id="228787">@Hanna Lachnitt</span></p>



<a name="173280610"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/173280610" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hanna Lachnitt <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#173280610">(Aug 15 2019 at 10:51)</a>:</h4>
<p>I would totally opt for that.</p>



<a name="173280862"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/173280862" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yijun He <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#173280862">(Aug 15 2019 at 10:56)</a>:</h4>
<p>I also agree with that.</p>



<a name="173669574"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/173669574" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bordg <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#173669574">(Aug 20 2019 at 15:46)</a>:</h4>
<p>Ok, but to avoid a loop (Measurement.thy importing Quantum.thy and Quantum.thy importing Measurement.thy) I would need to put the definition of Bell states and everything related to them in Measurement.thy or in a dedicated theory Bell.thy.<br>
<span class="user-mention" data-user-id="228787">@Hanna Lachnitt</span>  <span class="user-mention" data-user-id="228785">@Yijun He</span></p>



<a name="173670055"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/173670055" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hanna Lachnitt <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#173670055">(Aug 20 2019 at 15:53)</a>:</h4>
<p>Hmm... both does not sound perfect. Why don't you want to leave the definitions of the Bell states in Quantum.thy and move their measurement in Measurement.thy? Is it because facts about the Bell states would be scattered then or does it have another reason?</p>



<a name="173670536"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/173670536" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bordg <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#173670536">(Aug 20 2019 at 15:59)</a>:</h4>
<blockquote>
<p>Hmm... both does not sound perfect. Why don't you want to leave the definitions of the Bell states in Quantum.thy and move their measurement in Measurement.thy? Is it because facts about the Bell states would be scattered then or does it have another reason?</p>
</blockquote>
<p>Yes, it would be scattered, but actually I think it's fine and probably the best solution.</p>



<a name="177038144"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/177038144" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bordg <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#177038144">(Oct 01 2019 at 09:30)</a>:</h4>
<p><span class="user-mention" data-user-id="228785">@Yijun He</span> In Quantum.thy one proves that a unitary matrix is length-preserving. It would be nice to add the converse implication, namely that a length-preserving matrix is unitary. The proof is not difficult. We could mention this result in the section 2 of the article.</p>



<a name="177043384"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/177043384" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bordg <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#177043384">(Oct 01 2019 at 10:55)</a>:</h4>
<p><span class="user-mention" data-user-id="228785">@Yijun He</span> <br>
I should probably rename <code>hermite_cnj</code> with <code>dagger</code> for conciseness.</p>



<a name="177048659"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/177048659" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hanna Lachnitt <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#177048659">(Oct 01 2019 at 12:13)</a>:</h4>
<p>I would also like to move this lemma into Quantum.thy if thats fine for you.</p>
<div class="codehilite"><pre><span></span>lemma cpx_mat_transpose_prod:
  fixes M N::&quot;complex Matrix.mat&quot;
  assumes &quot;dim_col M = dim_row N&quot;
  shows &quot;(M * N)⇧t = N⇧t * (M⇧t)&quot;
proof
  fix i j::nat
  assume a0: &quot;i &lt; dim_row (N⇧t * (M⇧t))&quot; and a1: &quot;j &lt; dim_col (N⇧t * (M⇧t))&quot;
  then have &quot;(M * N)⇧t $$ (i,j) = (M * N) $$ (j,i)&quot; by auto
  also have &quot;... = (∑k&lt;dim_row M⇧t.  M $$ (j,k) * N $$ (k,i))&quot;
    using assms a0 a1 by auto
  also have &quot;... = (∑k&lt;dim_row M⇧t. N $$ (k,i) * M $$ (j,k))&quot;
   by (simp add: semiring_normalization_rules(7))
  also have &quot;... = (∑k&lt;dim_row M⇧t. ((N⇧t) $$ (i,k)) * (M⇧t) $$ (k,j))&quot;
    using assms a0 a1 by auto
  finally show &quot;((M * N)⇧t) $$ (i,j) = (N⇧t * (M⇧t)) $$ (i,j)&quot;
    using assms a0 a1 by auto
next
  show &quot;dim_row ((M * N)⇧t) = dim_row (N⇧t * (M⇧t))&quot; by auto
next
  show &quot;dim_col ((M * N)⇧t) = dim_col (N⇧t * (M⇧t))&quot; by auto
qed
</pre></div>


<p>I need it for the quantum fourier transform, but it fits into Quantum.thy much better. I can also make a pull request for this if you want to.</p>



<a name="177049783"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/177049783" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hanna Lachnitt <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#177049783">(Oct 01 2019 at 12:29)</a>:</h4>
<p>And also this </p>
<div class="codehilite"><pre><span></span>lemma cpx_mat_hermite_cnj_prod:
  fixes M N::&quot;complex Matrix.mat&quot;
  assumes &quot;dim_col M = dim_row N&quot;
  shows &quot;(M * N)⇧† = N⇧† * (M⇧†)&quot;
proof-
  have &quot;(M * N)⇧† = ((M * N)⇧⋆)⇧t&quot; by auto
  also have &quot;... = ((M⇧⋆) * (N⇧⋆))⇧t&quot; using assms cpx_mat_cnj_prod by auto
  also have &quot;... = (N⇧⋆)⇧t * ((M⇧⋆)⇧t)&quot;
    by (metis assms cpx_mat_transpose_prod cnj_transpose hermite_cnj_dim_col hermite_cnj_dim_row index_transpose_mat(2) index_transpose_mat(3))
  finally show &quot;(M * N)⇧† = N⇧† * (M⇧†)&quot; by auto
qed
</pre></div>



<a name="177059885"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/177059885" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bordg <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#177059885">(Oct 01 2019 at 14:22)</a>:</h4>
<blockquote>
<p>I would also like to move this lemma into Quantum.thy if thats fine for you.</p>
</blockquote>
<p><span class="user-mention" data-user-id="228787">@Hanna Lachnitt</span>  sure, please open a PR with your lemmas. <br>
But first you may need to update your branch due to the recent changes I made in the master branch.</p>



<a name="177113741"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/177113741" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yijun He <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#177113741">(Oct 02 2019 at 01:21)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="228785">Yijun He</span> In Quantum.thy one proves that a unitary matrix is length-preserving. It would be nice to add the converse implication, namely that a length-preserving matrix is unitary. The proof is not difficult. We could mention this result in the section 2 of the article.</p>
</blockquote>
<p><span class="user-mention" data-user-id="228778">@Anthony Bordg</span>  I will work on the lemma today and add it to the pull request.</p>



<a name="177144680"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/177144680" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hanna Lachnitt <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#177144680">(Oct 02 2019 at 12:28)</a>:</h4>
<p>Pull request is open :) I added another lemma about the product of two gates.</p>



<a name="177326111"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/177326111" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yijun He <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#177326111">(Oct 04 2019 at 10:14)</a>:</h4>
<p><span class="user-mention" data-user-id="228778">@Anthony Bordg</span>  I have finished the proof and updated the pull request, but the proof seems too complicated. I will try to clean it up tonight.</p>



<a name="177329002"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/177329002" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anthony Bordg <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#177329002">(Oct 04 2019 at 11:05)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="228778">Anthony Bordg</span>  I have finished the proof and updated the pull request, but the proof seems too complicated. I will try to clean it up tonight.</p>
</blockquote>
<p><span class="user-mention" data-user-id="228785">@Yijun He</span>  Great! <br>
One could use the following result:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">∥</mo><mi>M</mi><mi mathvariant="normal">∣</mi><mi>ψ</mi><mo stretchy="false">⟩</mo><msup><mo stretchy="false">∥</mo><mn>2</mn></msup><mo>=</mo><mo stretchy="false">⟨</mo><mi>ψ</mi><mi mathvariant="normal">∣</mi><msup><mi>M</mi><mo>†</mo></msup><mi>M</mi><mi mathvariant="normal">∣</mi><mi>ψ</mi><mo stretchy="false">⟩</mo><mtext>  </mtext><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\lVert M|\psi\rangle\rVert^2 = \langle \psi|M^{\dagger}M|\psi\rangle\;.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.03588em;">ψ</span><span class="mclose">⟩</span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mopen">⟨</span><span class="mord mathdefault" style="margin-right:0.03588em;">ψ</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">†</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.03588em;">ψ</span><span class="mclose">⟩</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">.</span></span></span></span></span></p>
<p>Then use </p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msup><mi>M</mi><mo>†</mo></msup><mi>M</mi><msub><mo stretchy="false">)</mo><mrow><mi>i</mi><mi>i</mi></mrow></msub><mo>=</mo><mo stretchy="false">⟨</mo><msub><mi>e</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><msup><mi>M</mi><mo>†</mo></msup><mi>M</mi><mi mathvariant="normal">∣</mi><msub><mi>e</mi><mi>i</mi></msub><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">(M^{\dagger}M)_{ii}= \langle e_i|M^{\dagger}M|e_i\rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">†</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mopen">⟨</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">†</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">⟩</span></span></span></span></span></p>
<p>and the assumption that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> is length-preserving to prove that the diagonal elements of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>M</mi><mo>†</mo></msup><mi>M</mi></mrow><annotation encoding="application/x-tex">M^{\dagger}M</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">†</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> are <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>.<br>
The result </p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">∥</mo><mi>M</mi><mi mathvariant="normal">∣</mi><mi>ψ</mi><mo stretchy="false">⟩</mo><msup><mo stretchy="false">∥</mo><mn>2</mn></msup><mo>=</mo><mo stretchy="false">⟨</mo><mi>ψ</mi><mi mathvariant="normal">∣</mi><msup><mi>M</mi><mo>†</mo></msup><mi>M</mi><mi mathvariant="normal">∣</mi><mi>ψ</mi><mo stretchy="false">⟩</mo></mrow><annotation encoding="application/x-tex">\lVert M|\psi\rangle\rVert^2 = \langle \psi|M^{\dagger}M|\psi\rangle</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mopen">∥</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.03588em;">ψ</span><span class="mclose">⟩</span><span class="mclose"><span class="mclose">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mopen">⟨</span><span class="mord mathdefault" style="margin-right:0.03588em;">ψ</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">†</span></span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.03588em;">ψ</span><span class="mclose">⟩</span></span></span></span></span></p>
<p>can easily be formalized using <code>cpx_vec_length_inner_prod</code> and <code>bra_mat_on_vec</code>.</p>



<a name="177339430"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/202968-quantum%20computing/topic/Quantum.thy/near/177339430" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yijun He <a href="http://isabelle.systems/zulip-archive/stream/202968-quantum-computing/topic/Quantum.2Ethy.html#177339430">(Oct 04 2019 at 13:38)</a>:</h4>
<p>I finished cleaning up just now.</p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>