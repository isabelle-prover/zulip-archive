<html>
<head><meta charset="utf-8"><title>&quot;size_list&quot; in a termination proof · Beginner Questions · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/index.html">Beginner Questions</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html">&quot;size_list&quot; in a termination proof</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="476692141"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476692141" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476692141">(Oct 14 2024 at 06:50)</a>:</h4>
<p>I want to prove a termination, and Isabelle wants me to do it by hand, I got the following goal after "apply auto"<br>
<code>1. length x = length fl ⟹ R m (w # x) ⟹ size (fl ! xa) &lt; Suc (size_list size fl)</code><br>
The lemma "size_list_estimation" seems to be helpful<br>
<code>?x ∈ list.set ?xs ⟹ ?y &lt; ?f ?x ⟹ ?y &lt; size_list ?f ?xs</code><br>
I typed <code>sledgehammer(size_list_estimation)</code> and it does not find any proof. It should be straightforward. How do people usually do with this (it seems to me that such a pattern is quite typical)?</p>



<a name="476693474"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476693474" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476693474">(Oct 14 2024 at 06:57)</a>:</h4>
<p>You probably want <code>sledgehammer(add: size_list_estimation)</code></p>



<a name="476693540"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476693540" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476693540">(Oct 14 2024 at 06:57)</a>:</h4>
<p>otherwise you are asking Sledgehammer to find a proof with only that theorem</p>



<a name="476693778"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476693778" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476693778">(Oct 14 2024 at 06:58)</a>:</h4>
<p>But the general solution is to... write a proof by hand</p>



<a name="476693842"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476693842" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476693842">(Oct 14 2024 at 06:59)</a>:</h4>
<p>Thanks a lot! Yes I was wrong with that.  I tried and it still does not give me a proof. Maybe it does require me to write it out.</p>



<a name="476693877"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476693877" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476693877">(Oct 14 2024 at 06:59)</a>:</h4>
<p>to prove termination you can open a proof block</p>



<a name="476693940"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476693940" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476693940">(Oct 14 2024 at 06:59)</a>:</h4>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="kn">termination</span><span class="w"> </span><span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">relation</span><span class="w"> </span><span class="s">"measure (λ(a,b,c,d) ⇒ size d)"</span><span class="o">,</span><span class="w"> </span><span class="n">goal_cases</span><span class="o">)</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">1</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">2</span><span class="w"> </span><span class="n">τ</span><span class="w"> </span><span class="n">Φ</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="n">f2</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">3</span><span class="w"> </span><span class="n">τ</span><span class="w"> </span><span class="n">Φ</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="n">f2</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">4</span><span class="w"> </span><span class="n">τ</span><span class="w"> </span><span class="n">Φ</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="n">f2</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">5</span><span class="w"> </span><span class="n">τ</span><span class="w"> </span><span class="n">Φ</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="n">f2</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">6</span><span class="w"> </span><span class="n">τ</span><span class="w"> </span><span class="n">Φ</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="n">f2</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">7</span><span class="w"> </span><span class="n">τ</span><span class="w"> </span><span class="n">Φ</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="n">f2</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">8</span><span class="w"> </span><span class="n">τ</span><span class="w"> </span><span class="n">Φ</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">f</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">9</span><span class="w"> </span><span class="n">τ</span><span class="w"> </span><span class="n">Φ</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">fl</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">xa</span><span class="o">)</span>
<span class="w">  </span><span class="kt">find_theorems</span><span class="w"> </span><span class="n">size_list</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="n">auto</span><span class="w"> </span><span class="kt">sledgehammer</span><span class="o">(</span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">size_list_estimation</span><span class="o">)</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">10</span><span class="w"> </span><span class="n">τ</span><span class="w"> </span><span class="n">Φ</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">fl</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="n">yb</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="gr">sorry</span>
<span class="k">qed</span>
</code></pre></div>



<a name="476694242"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476694242" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476694242">(Oct 14 2024 at 07:00)</a>:</h4>
<p>That is what I am currently writing. I am try to fill the sorries now. I would appreciate if you remind me about something that already looks bad in that proof!</p>



<a name="476695667"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476695667" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476695667">(Oct 14 2024 at 07:06)</a>:</h4>
<p>Oh what is wrong is that the goal is bad.</p>



<a name="476695837"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476695837" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476695837">(Oct 14 2024 at 07:06)</a>:</h4>
<p>It is not the goal I expected.</p>
<p>The corresponding clause is:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="w"> </span><span class="s">"satis (τ,Φ) (W,R,V) w (BOX m fl) ⟷</span>
<span class="s">    (m ∈ fst τ ∧ (snd τ) m = length fl ∧</span>
<span class="s">     w ∈ W ∧ (∀vl. length vl = length fl ∧ R m (w # vl) ⟶</span>
<span class="s">     (∃i. i &lt; length vl ∧</span>
<span class="s">     satis (τ,Φ) (W,R,V) (vl ! i) (fl ! i))))"</span>
</code></pre></div>
<p>I have the assumption that <code>i &lt; length vl</code>.</p>



<a name="476695973"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476695973" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476695973">(Oct 14 2024 at 07:07)</a>:</h4>
<p>But in the goal, it asks me to prove </p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="w"> </span><span class="n">⋀τ</span><span class="w"> </span><span class="n">Φ</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">w</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">fl</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">xa.</span>
<span class="w">       </span><span class="n">length</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="n">fl</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">(</span><span class="n">w</span><span class="w"> </span><span class="n">#</span><span class="w"> </span><span class="n">x</span><span class="o">)</span><span class="w"> </span><span class="n">⟹</span>
<span class="w">       </span><span class="o">(((</span><span class="n">τ</span><span class="o">,</span><span class="w"> </span><span class="n">Φ</span><span class="o">),</span><span class="w"> </span><span class="o">(</span><span class="n">W</span><span class="o">,</span><span class="w"> </span><span class="n">R</span><span class="o">,</span><span class="w"> </span><span class="n">V</span><span class="o">),</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">xa</span><span class="o">,</span><span class="w"> </span><span class="n">fl</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="n">xa</span><span class="o">),</span><span class="w"> </span><span class="o">(</span><span class="n">τ</span><span class="o">,</span><span class="w"> </span><span class="n">Φ</span><span class="o">),</span><span class="w"> </span><span class="o">(</span><span class="n">W</span><span class="o">,</span><span class="w"> </span><span class="n">R</span><span class="o">,</span><span class="w"> </span><span class="n">V</span><span class="o">),</span><span class="w"> </span><span class="n">w</span><span class="o">,</span><span class="w"> </span><span class="n">□m</span><span class="w"> </span><span class="n">fl</span><span class="o">)</span><span class="w"> </span><span class="n">∈</span><span class="w"> </span><span class="n">measure</span><span class="w"> </span><span class="o">(</span><span class="n">λx.</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="o">)</span><span class="w"> </span><span class="n">⇒</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="n">d</span><span class="o">)</span>
</code></pre></div>



<a name="476696108"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476696108" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476696108">(Oct 14 2024 at 07:07)</a>:</h4>
<p>There is no assumption on <code>xa</code> saying that <code>xa &lt; length fl</code> or <code>xa &lt; length vl</code>.</p>



<a name="476696483"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476696483" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476696483">(Oct 14 2024 at 07:09)</a>:</h4>
<p>Why does Isabelle refuse to give me such an assumption, and how should I get it? Yesterday Yong Kiam taught me to make the recursion on list more obvious to Isabelle. But here I am overwhelm about what to try.</p>



<a name="476697378"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/%22size_list%22%20in%20a%20termination%20proof/near/476697378" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/.22size_list.22.20in.20a.20termination.20proof.html#476697378">(Oct 14 2024 at 07:12)</a>:</h4>
<p>I expect if we have something called "list.exists", means exists a list member that does something, that might help. But I did not find one.</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>