<html>
<head><meta charset="utf-8"><title>Debugging heap rebuilds · Beginner Questions · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/index.html">Beginner Questions</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html">Debugging heap rebuilds</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="224227776"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224227776" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224227776">(Jan 27 2021 at 18:41)</a>:</h4>
<p>I'm managing my Isabelle installation with the Nix package manager. Each time I update, Isabelle decides to rebuild the heap images for Pure and HOL. I suspect that this might be because the path to the isabelle installation changes each time, but I don't understand why that would affect this - Isabelle ships with heap images in the tarball, and they get picked up regardless of the installation directory. How can I debug this?</p>



<a name="224228037"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224228037" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224228037">(Jan 27 2021 at 18:43)</a>:</h4>
<p>(the reason this is quite annoying for me is that the build takes so much RAM that I cannot simply run it in the background. Is the required RAM an intrinsic property of the process, or could it be reduced by, for example, reducing the parallelism or something?)</p>



<a name="224229291"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224229291" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224229291">(Jan 27 2021 at 18:49)</a>:</h4>
<p><a href="https://arxiv.org/pdf/1805.07195.pdf">https://arxiv.org/pdf/1805.07195.pdf</a> the remote_build tools makes it possible to compile remotely. So I don't believe that the path is important</p>



<a name="224229511"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224229511" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224229511">(Jan 27 2021 at 18:50)</a>:</h4>
<p>How drastic is your nix setup? Do you use the default components or do you also use the nix-provided version of the components?</p>



<a name="224229586"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224229586" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224229586">(Jan 27 2021 at 18:51)</a>:</h4>
<p>(I believe that at least the polyml version is included in the heap, so a change in that wll cause a new compilation)</p>



<a name="224229793"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224229793" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224229793">(Jan 27 2021 at 18:52)</a>:</h4>
<p>re: <code>remote_build</code> - interesting, is it possible to set up jedit so that the heap builds it starts use <code>remote_build</code> too?</p>



<a name="224229880"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224229880" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224229880">(Jan 27 2021 at 18:53)</a>:</h4>
<p>I'm using the package from nixpkgs, not sure whether they pin the polyml</p>



<a name="224229886"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224229886" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224229886">(Jan 27 2021 at 18:53)</a>:</h4>
<p>I don't think so, but I have never used remote_build</p>



<a name="224230078"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224230078" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224230078">(Jan 27 2021 at 18:54)</a>:</h4>
<p>but usually you know what sessions you use (because you start the session every day)</p>



<a name="224230099"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224230099" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224230099">(Jan 27 2021 at 18:54)</a>:</h4>
<p>however, both the old and new heaps are in <code>~/.isabelle/Isabelle2020/heaps/polyml-5.8.1_x86_64-linux</code>, so the polyml version seems to match</p>



<a name="224230634"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224230634" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224230634">(Jan 27 2021 at 18:58)</a>:</h4>
<p>Sadly, I don't use nix. Could you try <code>isabelle env</code> before and after your next update and see if there is any difference (for example by <code>git diff --no-index old new</code>)?</p>



<a name="224231534"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224231534" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224231534">(Jan 27 2021 at 19:03)</a>:</h4>
<p>If you use <a href="https://github.com/NixOS/nixpkgs/blob/master/pkgs/applications/science/logic/isabelle/default.nix">https://github.com/NixOS/nixpkgs/blob/master/pkgs/applications/science/logic/isabelle/default.nix</a>, then Nix is really using its own components. So the only person who understands the low-level isabelle part will tell you to use the nicely packaged isabelle version</p>



<a name="224232048"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224232048" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224232048">(Jan 27 2021 at 19:07)</a>:</h4>
<p>The problem with that is that the packaged Isabelle doesn't work as-is because the dynamic libraries don't exist at the expected locations :D</p>



<a name="224233193"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224233193" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224233193">(Jan 27 2021 at 19:14)</a>:</h4>
<p>Got an isabelle env diff, only some paths changed their hash</p>



<a name="224233600"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224233600" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224233600">(Jan 27 2021 at 19:17)</a>:</h4>
<p>I am also using nix without problems. I maintain my own nix expression (forked from the one in nixpkgs), though. See here: <a href="https://github.com/lukasstevens/dotfiles/blob/master/nix/isabelle/default.nix">https://github.com/lukasstevens/dotfiles/blob/master/nix/isabelle/default.nix</a></p>



<a name="224233717"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224233717" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224233717">(Jan 27 2021 at 19:18)</a>:</h4>
<p>You will also need an updated version of polyml: <a href="https://github.com/lukasstevens/dotfiles/blob/master/nix/polyml/default.nix">https://github.com/lukasstevens/dotfiles/blob/master/nix/polyml/default.nix</a></p>



<a name="224233860"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224233860" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224233860">(Jan 27 2021 at 19:19)</a>:</h4>
<p>Those expressions are still up to date (Isabelle2020)</p>



<a name="224234133"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224234133" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224234133">(Jan 27 2021 at 19:21)</a>:</h4>
<p>One could improve the expressions by also managing the isabelle settings and preferences</p>



<a name="224234317"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224234317" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224234317">(Jan 27 2021 at 19:23)</a>:</h4>
<p>I don't see any relevant differences between your expression and the one in nixpkgs...</p>



<a name="224234386"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224234386" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224234386">(Jan 27 2021 at 19:23)</a>:</h4>
<p>it also seems that the polyml in nixpkgs is newer</p>



<a name="224234480"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224234480" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224234480">(Jan 27 2021 at 19:24)</a>:</h4>
<p>Yeah, back when I created those it was outdated in nixpkgs.</p>



<a name="224234503"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224234503" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224234503">(Jan 27 2021 at 19:24)</a>:</h4>
<p>And some minor changes where necessary from Isabelle2019 -&gt; Isabelle2020</p>



<a name="224234548"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224234548" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224234548">(Jan 27 2021 at 19:25)</a>:</h4>
<p>The polyml version is the version that Isabelle2020 is shipped with.</p>



<a name="224234701"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224234701" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224234701">(Jan 27 2021 at 19:26)</a>:</h4>
<p>the one on my plain-old-Debian computer is also using 5.8.1, you seem to be using 5.8</p>



<a name="224234871"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224234871" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224234871">(Jan 27 2021 at 19:27)</a>:</h4>
<p>You can reduce RAM usage by setting <code>ML_OPTIONS="--maxheap 8G"</code> in <code>~/.isabelle/Isabelle2020/etc/settings</code>. Although for large sessions this won't help you much and the process will just be killed.</p>



<a name="224235075"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224235075" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224235075">(Jan 27 2021 at 19:28)</a>:</h4>
<p>what's the default maxheap?</p>



<a name="224235310"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224235310" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224235310">(Jan 27 2021 at 19:30)</a>:</h4>
<p>Not really sure. I think as much as possible.</p>



<a name="224235376"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224235376" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224235376">(Jan 27 2021 at 19:31)</a>:</h4>
<p>But since Linux deals with OOM situations badly that backfires often.</p>



<a name="224236430"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224236430" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel Eberl <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224236430">(Jan 27 2021 at 19:39)</a>:</h4>
<p>I don't think I would recommend using your own version of components (JDK, PolyML, etc.) instead of the ones that Isabelle ships with.</p>



<a name="224236490"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224236490" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224236490">(Jan 27 2021 at 19:39)</a>:</h4>
<p>Conceptually, it is better to do that, though.</p>



<a name="224236496"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224236496" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224236496">(Jan 27 2021 at 19:39)</a>:</h4>
<p>AFAICS nixpkgs matches the versions used by the actual release</p>



<a name="224236530"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224236530" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224236530">(Jan 27 2021 at 19:39)</a>:</h4>
<p>I don't think it does for z3</p>



<a name="224236586"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224236586" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224236586">(Jan 27 2021 at 19:40)</a>:</h4>
<p>This often leads to broken smt proofs. Thats my hunch on why that happens for me anyways</p>



<a name="224236715"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224236715" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel Eberl <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224236715">(Jan 27 2021 at 19:41)</a>:</h4>
<p>I just remember all kinds of problems arising from this kind of repackaging. People ask on the mailing list because something crashes or doesn't work and after some interrogation it transpires it's because of some repackaging issue and Makarius gets <em>really</em> annoyed by this because he wasted time tracking down an issue that only arises because people did something he specifically advises against.</p>



<a name="224236763"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224236763" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224236763">(Jan 27 2021 at 19:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233155">Lukas Stevens</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds/near/224236586">said</a>:</p>
<blockquote>
<p>This often leads to broken smt proofs. Thats my hunch on why that happens for me anyways</p>
</blockquote>
<p>It didn't earlier, now does</p>



<a name="224236788"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224236788" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224236788">(Jan 27 2021 at 19:42)</a>:</h4>
<p>and it does fix some smt proofs</p>



<a name="224236899"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224236899" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224236899">(Jan 27 2021 at 19:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232736">Manuel Eberl</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds/near/224236715">said</a>:</p>
<blockquote>
<p>I just remember all kinds of problems arising from this kind of repackaging. People ask on the mailing list because something crashes or doesn't work and after some interrogation it transpires it's because of some repackaging issue and Makarius gets <em>really</em> annoyed by this because he wasted time tracking down an issue that only arises because people did something he specifically advises against.</p>
</blockquote>
<p>On has to say that this approach to packaging is not really sustainable (at least if many applications would do it).</p>



<a name="224236990"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224236990" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224236990">(Jan 27 2021 at 19:43)</a>:</h4>
<p>It would be quite easy to pin the versions with nix on the other hand.</p>



<a name="224237356"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224237356" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224237356">(Jan 27 2021 at 19:46)</a>:</h4>
<p>Thanks for making me aware. I am now using Isabelle from nixpkgs again.</p>



<a name="224237535"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224237535" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224237535">(Jan 27 2021 at 19:47)</a>:</h4>
<p>oh well, I guess one day this will annoy me enough for me to figure out how and where to put the printfs to debug this further</p>



<a name="224237585"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224237585" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224237585">(Jan 27 2021 at 19:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="232736">Manuel Eberl</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds/near/224236715">said</a>:</p>
<blockquote>
<p>I just remember all kinds of problems arising from this kind of repackaging. People ask on the mailing list because something crashes or doesn't work and after some interrogation it transpires it's because of some repackaging issue and Makarius gets <em>really</em> annoyed by this because he wasted time tracking down an issue that only arises because people did something he specifically advises against.</p>
</blockquote>
<p>Even further it is just not possible to run Isabelle on NixOS without patching it up first (at least not without ugly workarounds like FHSuserenv). Of course, the nix package also replaces some dependencies by their system versions (which may cause problems).</p>



<a name="224238543"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224238543" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224238543">(Jan 27 2021 at 19:55)</a>:</h4>
<p>Do you also need to rebuild the heap images if the Isabelle or PolyML version do not change? It seems weird to me because I never had the problem before and the paths should not change as well when the hash stays the same.</p>



<a name="224238904"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224238904" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224238904">(Jan 27 2021 at 19:58)</a>:</h4>
<p>I mean, the hash changes quite often because the dependency graph is quite deep</p>



<a name="224239121"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/224239121" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lukas Stevens <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#224239121">(Jan 27 2021 at 20:00)</a>:</h4>
<p>Ok, maybe it was just because I didn't pay much attention to it.</p>



<a name="225659393"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/225659393" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#225659393">(Feb 09 2021 at 08:55)</a>:</h4>
<p>I just stumbled upon the line <code>external_file "$POLYML_EXE"</code> in ML_Bootstrap.thy. Does this mean that the hash of the PolyML binary is a dependency?</p>



<a name="225665606"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/225665606" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#225665606">(Feb 09 2021 at 09:55)</a>:</h4>
<p>Stupid question: isn't polyml saving structure (used to save heaps), version-dependent? (Independently of what <code>external_file</code> does)</p>



<a name="225673050"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Debugging%20heap%20rebuilds/near/225673050" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Debugging.20heap.20rebuilds.html#225673050">(Feb 09 2021 at 11:07)</a>:</h4>
<p>yes, but the polyml version in question wasn't changing - just some paths embedded in the polyml binary</p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>