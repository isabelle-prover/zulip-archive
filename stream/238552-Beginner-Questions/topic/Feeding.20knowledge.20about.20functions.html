<html>
<head><meta charset="utf-8"><title>Feeding knowledge about functions · Beginner Questions · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/index.html">Beginner Questions</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html">Feeding knowledge about functions</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="224021583"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224021583" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gergely Buday <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224021583">(Jan 26 2021 at 10:42)</a>:</h4>
<p>Trying to prove</p>
<div class="codehilite"><pre><span></span><code>lemma aval_plus: &quot;  aval (Ex_3_1.plus (N (sumN t1)) (asimp (zeroN t1))) s = aval t1 s ⟹
       aval (Ex_3_1.plus (N (sumN t2)) (asimp (zeroN t2))) s = aval t2 s ⟹
       aval (Ex_3_1.plus (N (sumN t1 + sumN t2)) (Ex_3_1.plus (asimp (zeroN t1)) (asimp (zeroN t2)))) s = aval t1 s + aval t2 s
</code></pre></div>
<p>I have a vague feeling that the knowledge to prove this is within the knowledge of aval's, plus' and asimp's definition (induction rule?).</p>
<p>What is a good strategy when you find such a lemma? How to feed the necessary facts into the automated proof search procedures?</p>
<p>I tried (induction t1 arbitrary: t2) to no avail.</p>



<a name="224021968"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224021968" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Manuel Eberl <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224021968">(Jan 26 2021 at 10:46)</a>:</h4>
<p>Please also provide context, i.e. the definitions of all these constants (you can attach a .thy file).</p>



<a name="224023061"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224023061" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gergely Buday <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224023061">(Jan 26 2021 at 10:58)</a>:</h4>
<p>Here is a minimal version of the file:</p>
<p><a href="/user_uploads/14278/f3o4Qq7wm9r_yYPmGUqniGQX/AvalPlus.thy">AvalPlus.thy</a></p>



<a name="224024683"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224024683" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224024683">(Jan 26 2021 at 11:15)</a>:</h4>
<p>your theory file doesn't define <code>asimp</code>, so Isabelle wants you to prove this for all possible functions <code>asimp</code> (as can be seen by the name being blue)</p>



<a name="224024777"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224024777" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224024777">(Jan 26 2021 at 11:16)</a>:</h4>
<p>I assume the lemma you actually want to prove left you with this monstrosity after <code>simp</code>...</p>



<a name="224024820"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224024820" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224024820">(Jan 26 2021 at 11:16)</a>:</h4>
<p>could you post what you actually want to prove?</p>



<a name="224025222"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224025222" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224025222">(Jan 26 2021 at 11:20)</a>:</h4>
<p>My teaching intuition says that after simp, you are left with something that is calling for a <code>aval (asimp (zeronN t1)) = t1</code>theorem</p>



<a name="224025303"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224025303" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224025303">(Jan 26 2021 at 11:21)</a>:</h4>
<p>also, I don't think it's necessary to remove lemmas you've already proven about these definitions</p>



<a name="224025388"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224025388" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224025388">(Jan 26 2021 at 11:22)</a>:</h4>
<p>more like <code>aval (asimp (zeroN t1)) + sumN t1 = aval t1</code></p>



<a name="224025551"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224025551" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gergely Buday <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224025551">(Jan 26 2021 at 11:24)</a>:</h4>
<p><span class="user-mention" data-user-id="380931">@Jakub Kądziołka</span> here is a theory file with asimp's definition:</p>
<p><a href="/user_uploads/14278/NVC_5aVbSx49qHtYb9BbJcFf/AvalPlus.thy">AvalPlus.thy</a></p>



<a name="224025617"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224025617" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224025617">(Jan 26 2021 at 11:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="380931">Jakub Kądziołka</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions/near/224025388">said</a>:</p>
<blockquote>
<p>more like <code>aval (asimp (zeroN t1)) + sumN t1 = aval t1</code></p>
</blockquote>
<p>Good point, reading the theory files helps <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="224025887"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224025887" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gergely Buday <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224025887">(Jan 26 2021 at 11:27)</a>:</h4>
<p>Now with the final theorem and its definitions included:</p>
<p><a href="/user_uploads/14278/StE7jzc51_mT958XB7ryGRA9/AvalPlus.thy">AvalPlus.thy</a></p>



<a name="224025942"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224025942" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gergely Buday <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224025942">(Jan 26 2021 at 11:28)</a>:</h4>
<p><span class="user-mention" data-user-id="233198">@Mathias Fleury</span> yes reading helps but I am lost now and don't know what to look for.</p>



<a name="224025950"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224025950" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224025950">(Jan 26 2021 at 11:28)</a>:</h4>
<p><span class="user-mention" data-user-id="234198">@Gergely Buday</span> I opened the file, called <code>auto</code> and was like: "why on earth is <code>aval (plus ... ....)</code> not simplified to <code>aval ... + aval ...</code>?"</p>



<a name="224026118"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224026118" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224026118">(Jan 26 2021 at 11:30)</a>:</h4>
<p>do you have a lemma that says <code>aval (asimp a) s = aval a s</code>?</p>



<a name="224026148"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224026148" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224026148">(Jan 26 2021 at 11:30)</a>:</h4>
<p>You should really add the lemma on aval plus.</p>



<a name="224026161"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224026161" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224026161">(Jan 26 2021 at 11:30)</a>:</h4>
<p>it would compose with aval_sepN wonderfully</p>



<a name="224026349"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224026349" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224026349">(Jan 26 2021 at 11:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="380931">Jakub Kądziołka</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions/near/224026161">said</a>:</p>
<blockquote>
<p>it would compose with aval_sepN wonderfully</p>
</blockquote>
<p>both lemmas even deserve to be [simp] rules!</p>



<a name="224026362"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224026362" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gergely Buday <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224026362">(Jan 26 2021 at 11:32)</a>:</h4>
<p><span class="user-mention" data-user-id="380931">@Jakub Kądziołka</span> not yet but I go for it</p>



<a name="224029207"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224029207" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gergely Buday <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224029207">(Jan 26 2021 at 12:05)</a>:</h4>
<p>Sorry for being so uncomprehending. Digging through the Concrete Semantics sketch files I have found a lemma that was essential:</p>
<div class="codehilite"><pre><span></span><code>lemma aval_plus: &quot;aval (plus a1 a2) s = aval a1 s + aval a2 s&quot;
</code></pre></div>
<p>This is a more basic lemma, and this was the real lesson: I should find the most basic "trivial" but unproven statement. With this missing element proof automation completes the puzzle.</p>
<p><a href="/user_uploads/14278/NsPm7eqBAu7wr-ufHxjx3Ode/AvalPlus.thy">AvalPlus.thy</a></p>



<a name="224033773"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224033773" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gergely Buday <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224033773">(Jan 26 2021 at 12:52)</a>:</h4>
<p>Also, an answer to my original question on how to feed knowledge about functions into a proof: for "fun" functions this knowledge is automatically transferred into simplification, for "definition" functions they should be named as _defs, and the real question is the combination of functions for which the rules should be proven explicitly. Am I right?</p>



<a name="224048869"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224048869" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224048869">(Jan 26 2021 at 14:48)</a>:</h4>
<p>Yes, some_function.simps is automatically included in the simplifier rule set and is thus used automatically by <code>simp</code>, <code>auto</code>, <code>force</code>, and <code>fastforce</code>; for definitions you need to use <code>unfolding some_definition_def</code> or <code>apply (auto simp: some_definition_def)</code> (the former will inline the definition within your goal, the latter will tell the simplifier to unfold it even if it arises after some simplification was already done).</p>
<p>There's nothing special about "combinations of functions", it's just that the auxiliary properties required an induction in their proof.</p>



<a name="224049269"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224049269" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224049269">(Jan 26 2021 at 14:50)</a>:</h4>
<p>like, if you have <code>aval (asimp a) s</code>, there aren't any rules in the definition of asimp that apply to an arbitrary term <code>a</code>, so the simplifier can't do anything with that until you prove some lemma that has <code>asimp a</code> or <code>aval (asimp a) s</code> on the left-hand side of an equality</p>



<a name="224049446"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224049446" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224049446">(Jan 26 2021 at 14:51)</a>:</h4>
<p>that lemma would then have to be named explicitly in the general case (<code>apply (simp add: some_fact)</code>), but you can also tag your theorems as simplification rules with <code>lemma foo[simp]: "..."</code></p>



<a name="224049580"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224049580" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224049580">(Jan 26 2021 at 14:52)</a>:</h4>
<p>when you do that, the right-hand side of the equality should be 'simpler' in some way than the left-hand side</p>



<a name="224049793"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224049793" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224049793">(Jan 26 2021 at 14:54)</a>:</h4>
<p>when a lemma is already in the simpset, you can remove it for a one-off proof with <code>simp del: some_fact</code> (or <code>auto simp del: ...</code>). However, if you find yourself doing that too often, then that fact probably shouldn't be <code>[simp]</code> in the first place</p>



<a name="224050073"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224050073" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224050073">(Jan 26 2021 at 14:55)</a>:</h4>
<p>also, if you aren't careful, the simplifier may not terminate on some terms. <code>using [[simp_trace]] apply simp</code> is a useful way to debug that (there's also <code>using [[simp_trace_new]]</code>, which I find easier to read, but it doesn't tell you the names of the facts it uses to rewrite)</p>



<a name="224050174"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Feeding%20knowledge%20about%20functions/near/224050174" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakub Kądziołka <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Feeding.20knowledge.20about.20functions.html#224050174">(Jan 26 2021 at 14:56)</a>:</h4>
<p>FWIW, this is also useful to get an intuition for how the simplifier works</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>