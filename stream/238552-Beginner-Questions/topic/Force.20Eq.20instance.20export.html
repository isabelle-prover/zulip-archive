<html>
<head><meta charset="utf-8"><title>Force Eq instance export · Beginner Questions · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/index.html">Beginner Questions</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html">Force Eq instance export</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="306643850"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306643850" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hernán Rajchert <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306643850">(Oct 28 2022 at 12:29)</a>:</h4>
<p>How can I force an <code>Eq</code> Haskell instance export? I am able to export the equality functions, but I need to manually create the instances... and for some types the instances are created automatically.</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">export_code</span><span class="w"></span>
<span class="w">    </span><span class="o">--</span><span class="w"> </span><span class="ow">...</span><span class="w"></span>
<span class="w">    </span><span class="n">equal_TransactionWarning_inst.equal_TransactionWarning</span><span class="w"></span>
<span class="w">    </span><span class="n">equal_Payment_inst.equal_Payment</span><span class="w"></span>
<span class="w">    </span><span class="kp">in</span><span class="w"> </span><span class="n">Haskell</span><span class="w"> </span><span class="o">(</span><span class="n">string_classes</span><span class="o">)</span><span class="w"></span>
</code></pre></div>



<a name="306644671"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306644671" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306644671">(Oct 28 2022 at 12:33)</a>:</h4>
<p>maybe also export "(=) :: type_you_want =&gt; _"?</p>



<a name="306648811"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306648811" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hernán Rajchert <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306648811">(Oct 28 2022 at 12:55)</a>:</h4>
<p><a href="/user_uploads/14278/X_6n7w8zPYO5S5b87ui7-goI/Screen-Shot-2022-10-28-at-09.54.44.png">Screen-Shot-2022-10-28-at-09.54.44.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/14278/X_6n7w8zPYO5S5b87ui7-goI/Screen-Shot-2022-10-28-at-09.54.44.png" title="Screen-Shot-2022-10-28-at-09.54.44.png"><img src="/user_uploads/14278/X_6n7w8zPYO5S5b87ui7-goI/Screen-Shot-2022-10-28-at-09.54.44.png"></a></div>



<a name="306651188"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306651188" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306651188">(Oct 28 2022 at 13:06)</a>:</h4>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">datatype</span><span class="w"> </span><span class="n n-Type">'a</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n n-Type">'a</span><span class="w"></span>
<span class="k">export_code</span><span class="w"> </span><span class="s">"equal_class.equal :: 'a test ⇒ _"</span><span class="w"> </span><span class="kp">in</span><span class="w"> </span><span class="n">Haskell</span><span class="w"></span>
</code></pre></div>
<p>?</p>



<a name="306651806"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306651806" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306651806">(Oct 28 2022 at 13:09)</a>:</h4>
<p>(I don't understand Haskell… so this is just a guess)</p>



<a name="306653424"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306653424" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hernán Rajchert <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306653424">(Oct 28 2022 at 13:17)</a>:</h4>
<p>That by itselfs exports the following <a href="/user_uploads/14278/jISmykD09EcKpiZLCm9pV0uk/Screen-Shot-2022-10-28-at-10.17.01.png">Screen-Shot-2022-10-28-at-10.17.01.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/14278/jISmykD09EcKpiZLCm9pV0uk/Screen-Shot-2022-10-28-at-10.17.01.png" title="Screen-Shot-2022-10-28-at-10.17.01.png"><img src="/user_uploads/14278/jISmykD09EcKpiZLCm9pV0uk/Screen-Shot-2022-10-28-at-10.17.01.png"></a></div>



<a name="306653632"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306653632" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hernán Rajchert <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306653632">(Oct 28 2022 at 13:18)</a>:</h4>
<p>Not sure if you meant to use it like this, but this has the same problem than before <a href="/user_uploads/14278/Bml_CXnBsr-v945XEkMpbE_J/Screen-Shot-2022-10-28-at-10.17.57.png">Screen-Shot-2022-10-28-at-10.17.57.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/14278/Bml_CXnBsr-v945XEkMpbE_J/Screen-Shot-2022-10-28-at-10.17.57.png" title="Screen-Shot-2022-10-28-at-10.17.57.png"><img src="/user_uploads/14278/Bml_CXnBsr-v945XEkMpbE_J/Screen-Shot-2022-10-28-at-10.17.57.png"></a></div>



<a name="306654261"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306654261" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306654261">(Oct 28 2022 at 13:21)</a>:</h4>
<p>I expected that <code>equal_class.equal :: 'a test ⇒ _</code> would cover the second case…</p>



<a name="306654368"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306654368" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306654368">(Oct 28 2022 at 13:21)</a>:</h4>
<p>so exporting the first would be sufficient for your aim</p>



<a name="306654516"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306654516" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306654516">(Oct 28 2022 at 13:22)</a>:</h4>
<p>if not, I think that I need a MWE…</p>



<a name="306655618"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306655618" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hernán Rajchert <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306655618">(Oct 28 2022 at 13:27)</a>:</h4>
<p>MWE?</p>



<a name="306656096"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306656096" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306656096">(Oct 28 2022 at 13:29)</a>:</h4>
<p>minimal working example</p>



<a name="306659148"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306659148" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hernán Rajchert <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306659148">(Oct 28 2022 at 13:43)</a>:</h4>
<p>so, this code </p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">theory</span><span class="w"> </span><span class="n">Example</span><span class="w"></span>

<span class="kp">imports</span><span class="w"> </span><span class="n">Main</span><span class="w"></span>

<span class="k">begin</span><span class="w"></span>


<span class="k">datatype</span><span class="w"> </span><span class="n">Custom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">B</span><span class="w"></span>

<span class="k">datatype</span><span class="w"> </span><span class="n n-Type">'a</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n n-Type">'a</span><span class="w"></span>


<span class="k">export_code</span><span class="w"></span>
<span class="w">  </span><span class="n">equal_Custom_inst.equal_Custom</span><span class="w"></span>
<span class="w">  </span><span class="s">"equal_class.equal :: 'a test ⇒ _"</span><span class="w"> </span><span class="kp">in</span><span class="w"> </span><span class="n">Haskell</span><span class="w"></span>


<span class="k">end</span><span class="w"></span>
</code></pre></div>
<p>is exported as </p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="ow">{</span><span class="o">-</span><span class="n">#</span><span class="w"> </span><span class="n">LANGUAGE</span><span class="w"> </span><span class="n">EmptyDataDecls</span><span class="o">,</span><span class="w"> </span><span class="n">RankNTypes</span><span class="o">,</span><span class="w"> </span><span class="n">ScopedTypeVariables</span><span class="w"> </span><span class="n">#</span><span class="o">-</span><span class="ow">}</span><span class="w"></span>

<span class="n">module</span><span class="w"> </span><span class="n">Example</span><span class="o">(</span><span class="n">Test</span><span class="o">,</span><span class="w"> </span><span class="n">Custom</span><span class="o">,</span><span class="w"> </span><span class="n">equal_test</span><span class="o">,</span><span class="w"> </span><span class="n">equal_Custom</span><span class="o">)</span><span class="w"> </span><span class="kp">where</span><span class="w"> </span><span class="ow">{</span><span class="w"></span>

<span class="n">import</span><span class="w"> </span><span class="n">Prelude</span><span class="w"> </span><span class="o">((==),</span><span class="w"> </span><span class="o">(</span><span class="n">/</span><span class="o">=),</span><span class="w"> </span><span class="o">(</span><span class="n">&lt;</span><span class="o">),</span><span class="w"> </span><span class="o">(</span><span class="n">&lt;</span><span class="o">=),</span><span class="w"> </span><span class="o">(</span><span class="n">&gt;</span><span class="o">=),</span><span class="w"> </span><span class="o">(</span><span class="n">&gt;</span><span class="o">),</span><span class="w"> </span><span class="o">(+),</span><span class="w"> </span><span class="o">(-),</span><span class="w"> </span><span class="c">(*), (/), (**),</span>
<span class="c">  (&gt;&gt;=), (&gt;&gt;), (=&lt;&lt;), (&amp;&amp;), (||), (^), (^^), (.), ($), ($!), (++), (!!), Eq,</span>
<span class="c">  error, id, return, not, fst, snd, map, filter, concat, concatMap, reverse,</span>
<span class="c">  zip, null, takeWhile, dropWhile, all, any, Integer, negate, abs, divMod,</span>
<span class="c">  String, Bool(True, False), Maybe(Nothing, Just));</span>
<span class="c">import qualified Prelude;</span>

<span class="c">newtype Test a = T a;</span>

<span class="c">data Custom = A | B;</span>

<span class="c">equal_test :: forall a. (Eq a) =&gt; Test a -&gt; Test a -&gt; Bool;</span>
<span class="c">equal_test (T x) (T ya) = x == ya;</span>

<span class="c">equal_Custom :: Custom -&gt; Custom -&gt; Bool;</span>
<span class="c">equal_Custom A B = False;</span>
<span class="c">equal_Custom B A = False;</span>
<span class="c">equal_Custom B B = True;</span>
<span class="c">equal_Custom A A = True;</span>

<span class="c">}</span>
</code></pre></div>
<p>I can export equal_Custom, but I don't know how to export <code>Eq Custom</code>.</p>



<a name="306659265"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306659265" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hernán Rajchert <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306659265">(Oct 28 2022 at 13:44)</a>:</h4>
<p>In the real code, I do get some <code>Eq</code> instances generated, but I don't know what triggers them <a href="https://github.com/input-output-hk/marlowe/blob/master/isabelle/generated/SemanticsTypes.hs#L366">https://github.com/input-output-hk/marlowe/blob/master/isabelle/generated/SemanticsTypes.hs#L366</a></p>



<a name="306681084"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306681084" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simon Roßkopf <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306681084">(Oct 28 2022 at 15:13)</a>:</h4>
<p>I never tried exporting code to Haskell, but here is a hack that might help.  I guess the problem is that your code "never needs" the actual <code>Eq</code> instance, so it is not generated. </p>
<p>If we force a use of <code>Eq</code> by means of the following the instances are generated:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">definition</span><span class="w"> </span><span class="n">eq_wrap</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a ⇒ 'a ⇒ bool"</span><span class="w"> </span><span class="kp">where</span><span class="w"></span>
<span class="w">  </span><span class="s">"eq_wrap x y = (x=y)"</span><span class="w"></span>
<span class="k">definition</span><span class="w"> </span><span class="n">eq_export_helper_test</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a test ⇒ 'a test ⇒ bool"</span><span class="w"> </span><span class="kp">where</span><span class="w"></span>
<span class="w">  </span><span class="s">"eq_export_helper_test x y = eq_wrap x y"</span><span class="w"></span>
<span class="k">definition</span><span class="w"> </span><span class="n">eq_export_helper_Custom</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"Custom ⇒ Custom ⇒ bool"</span><span class="w"> </span><span class="kp">where</span><span class="w"></span>
<span class="w">  </span><span class="s">"eq_export_helper_Custom x y = eq_wrap x y"</span><span class="w"></span>

<span class="k">export_code</span><span class="w"> </span><span class="n">eq_export_helper_test</span><span class="w"> </span><span class="n">eq_export_helper_Custom</span><span class="w"> </span><span class="kp">in</span><span class="w"> </span><span class="n">Haskell</span><span class="w"></span>
</code></pre></div>
<p>Maybe this can give you an idea on how to proceed.</p>



<a name="306701955"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Force%20Eq%20instance%20export/near/306701955" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hernán Rajchert <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Force.20Eq.20instance.20export.html#306701955">(Oct 28 2022 at 16:42)</a>:</h4>
<p>This works</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">definition</span><span class="w"> </span><span class="n">eq_wrap</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a ⇒ 'a ⇒ bool"</span><span class="w"> </span><span class="kp">where</span><span class="w"></span>
<span class="w">  </span><span class="s">"eq_wrap x y = (x=y)"</span><span class="w"></span>

<span class="k">definition</span><span class="w"> </span><span class="n">eq_export_helper_Custom</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"Custom ⇒ Custom ⇒ bool"</span><span class="w"> </span><span class="kp">where</span><span class="w"></span>
<span class="w">  </span><span class="s">"eq_export_helper_Custom x y =  eq_wrap x y"</span><span class="w"></span>

<span class="k">export_code</span><span class="w">  </span><span class="n">eq_export_helper_Custom</span><span class="w"> </span><span class="kp">in</span><span class="w"> </span><span class="n">Haskell</span><span class="w"></span>
</code></pre></div>
<p>This doesn't.</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">definition</span><span class="w"> </span><span class="n">eq_export_helper_Custom</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"Custom ⇒ Custom ⇒ bool"</span><span class="w"> </span><span class="kp">where</span><span class="w"></span>
<span class="w">  </span><span class="s">"eq_export_helper_Custom x y =  (x = y)"</span><span class="w"></span>

<span class="k">export_code</span><span class="w">  </span><span class="n">eq_export_helper_Custom</span><span class="w"> </span><span class="kp">in</span><span class="w"> </span><span class="n">Haskell</span><span class="w"></span>
</code></pre></div>
<p>I assume because <code>eq_wrap</code> works generically on a type that has <code>Eq</code>... Not the pretiest solution, but it works :D.</p>
<p>Thanks!</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>