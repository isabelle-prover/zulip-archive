<html>
<head><meta charset="utf-8"><title>Is there already a theory for n-ary relation for n &gt; 2? · Beginner Questions · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/index.html">Beginner Questions</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html">Is there already a theory for n-ary relation for n &gt; 2?</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="472897515"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472897515" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472897515">(Sep 26 2024 at 13:29)</a>:</h4>
<p>Specifically: Given an n-ary relation R \subseteq W^n and a set X subseteq W. I want the closure of X generated from X in R. i.e. the smallest set X' such that X \subseteq X' and for all x1,...,xn, if x1 in X' and (x1,...,xn) in R, then all of x2,...,xn are in X'. Is there already a canonical way to obtain this set?</p>



<a name="472897575"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472897575" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472897575">(Sep 26 2024 at 13:29)</a>:</h4>
<p>If no obvious existing things, I will just do inductive relation.</p>



<a name="472902009"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472902009" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472902009">(Sep 26 2024 at 13:50)</a>:</h4>
<p>Isn't that just <code>‹{(a,a). a ∈X} × R›</code>?</p>



<a name="472902145"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472902145" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472902145">(Sep 26 2024 at 13:50)</a>:</h4>
<p>up to that giving <code>(x1, (x2, ..., xn))</code></p>



<a name="472913513"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472913513" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472913513">(Sep 26 2024 at 14:41)</a>:</h4>
<p>I am afraid I do not get it. Why does the closure condition hold? What I want is an "underlying set for the reflexive and transitive closure". If (x1,...,xn) in R and x1 in X', and if for xn we have (xn,v1,...,v_n-1) in R, then we include all the v's into X'. The product set is not even a subset of W (I am not searching for a subset of W^n).</p>



<a name="472914795"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472914795" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472914795">(Sep 26 2024 at 14:47)</a>:</h4>
<p>When n=2, this is the transitive closure of R over all elements in X right?</p>



<a name="472917849"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472917849" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472917849">(Sep 26 2024 at 15:02)</a>:</h4>
<p>This is what I understand from your description</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">context</span>
<span class="w">  </span><span class="kp">fixes</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">‹(('a × 'a × 'a) × ('a × 'a × 'a)) set›</span><span class="w"> </span><span class="kp">and</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">‹'a set›</span>
<span class="k">begin</span>

<span class="k">definition</span><span class="w"> </span><span class="n">my_rel</span><span class="w"> </span><span class="kp">where</span>
<span class="w">  </span><span class="s">‹my_rel = {(a,e). ∃b c d e f. ((a, b, c), (d, e, f)) ∈ R} ∪ {(a,f). ∃b c d e. ((a, b, c), (d, e, f)) ∈ R}›</span>

<span class="k">definition</span><span class="w"> </span><span class="n">my_set</span><span class="w"> </span><span class="kp">where</span>
<span class="w"> </span><span class="s">‹my_set = my_rel⇧*›</span>

<span class="kn">lemma</span>
<span class="w">  </span><span class="kp">assumes</span><span class="w"> </span><span class="s">‹x1 ∈ X›</span><span class="w"> </span><span class="kp">and</span><span class="w"> </span><span class="s">‹((x1, x2,x3), (v1, v2, v3)) ∈ R›</span>
<span class="w">  </span><span class="kp">shows</span><span class="w"> </span><span class="s">‹(x1, v2) ∈ my_set›</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">fastforce</span><span class="w"> </span><span class="n">simp</span><span class="o">:</span><span class="w"> </span><span class="n">my_set_def</span><span class="w"> </span><span class="n">my_rel_def</span><span class="o">)</span>
<span class="k">end</span>
</code></pre></div>



<a name="472918083"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472918083" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472918083">(Sep 26 2024 at 15:03)</a>:</h4>
<p>Basically you are reinterpreting you predicate R as binary relation where every reachable tuple is reachable in your binary relation (<code>my_rel</code>) and then you do the transitive closure</p>



<a name="472918223"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472918223" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472918223">(Sep 26 2024 at 15:04)</a>:</h4>
<p>I have never seen such concept before</p>



<a name="472920699"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472920699" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472920699">(Sep 26 2024 at 15:16)</a>:</h4>
<p>The R :: ‹(('a × 'a × 'a) × ('a × 'a × 'a)) set› seems to be a binary relation on tuples. Is this "R" already and re-interpretation? Sorry for my poor description if it is confusing. When n = 2, yes, it is the underlying set of the transitive closure (I will not bother with extending the relation in a proper way, but just want to get the "reachable points" from a n-ary predicate, that is why I emphasise "underlying set"). But for R :: ‹(('a × 'a × 'a) × ('a × 'a × 'a)) set›, it seems like R is already a binary relation on tuples, not an arbitrary relation. If this is my misunderstanding and this R is intended to be a 6-ary predicate instead, I still need some hints to get it.</p>



<a name="472921473"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472921473" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472921473">(Sep 26 2024 at 15:20)</a>:</h4>
<p>I do not intend to make "{(a,e). ∃b c d e f. ((a, b, c), (d, e, f)) ∈ R}" if R is a 3-ary relation: <br>
In the case we have (a,b,c) in R and (b,c,e) in R, than yes, e can be reached from a. But (a,b,c) and (d,e,f) are not connected, so I do not want (a,e) to be included in the closure.</p>



<a name="472923611"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472923611" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472923611">(Sep 26 2024 at 15:31)</a>:</h4>
<p>So:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">context</span>
<span class="w">  </span><span class="kp">fixes</span><span class="w"> </span><span class="n">R</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">‹('a × 'a × 'a × 'a × 'a × 'a) set›</span><span class="w"> </span><span class="kp">and</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">‹'a set›</span>
<span class="k">begin</span>

<span class="k">definition</span><span class="w"> </span><span class="n">my_rel</span><span class="w"> </span><span class="kp">where</span>
<span class="w">  </span><span class="s">‹my_rel = {(a,e). ∃b c d e f. (a, b, c, d, e, f) ∈ R} ∪</span>
<span class="s">            {(a,c). ∃b   d e f. (a, b, c, d, e, f) ∈ R} ∪</span>
<span class="s">            {(a,d). ∃b c   e f. (a, b, c, d, e, f) ∈ R} ∪</span>
<span class="s">            {(a,e). ∃b c d   f. (a, b, c, d, e, f) ∈ R} ∪</span>
<span class="s">            {(a,f). ∃b c d e  . (a, b, c, d, e, f) ∈ R}›</span>

<span class="k">definition</span><span class="w"> </span><span class="n">my_set</span><span class="w"> </span><span class="kp">where</span>
<span class="w"> </span><span class="s">‹my_set = my_rell⇧+`` X›</span>

<span class="kn">lemma</span>
<span class="w">  </span><span class="kp">assumes</span><span class="w"> </span><span class="s">‹x1 ∈ X›</span><span class="w"> </span><span class="kp">and</span><span class="w"> </span><span class="s">‹(x1, x2,x3, v1, v2, v3) ∈ R›</span>
<span class="w">  </span><span class="kp">shows</span><span class="w"> </span><span class="s">‹(v2) ∈ my_set›</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">auto</span><span class="w"> </span><span class="n">intro</span><span class="o">!:</span><span class="w"> </span><span class="n">bexI</span><span class="o">[</span><span class="n">of</span><span class="w"> </span><span class="o">_</span><span class="w"> </span><span class="n">x1</span><span class="o">]</span><span class="w"> </span><span class="n">simp</span><span class="o">:</span><span class="w"> </span><span class="n">my_set_def</span><span class="w"> </span><span class="n">my_rel_def</span><span class="w"> </span><span class="n">Image_iff</span><span class="o">)</span>
<span class="k">end</span>
</code></pre></div>



<a name="472924070"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472924070" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472924070">(Sep 26 2024 at 15:33)</a>:</h4>
<p>with proper usage of X now</p>



<a name="472924681"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472924681" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472924681">(Sep 26 2024 at 15:36)</a>:</h4>
<p>I think I see. A wise way to reuse instead of reinvent! I will check the details of the notational technology in your code when I encounter them! Many thanks!</p>



<a name="472924844"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472924844" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472924844">(Sep 26 2024 at 15:37)</a>:</h4>
<p>The most important for notation: control-click to see the definitions</p>



<a name="472925272"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Is%20there%20already%20a%20theory%20for%20n-ary%20relation%20for%20n%20%3E%202%3F/near/472925272" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Is.20there.20already.20a.20theory.20for.20n-ary.20relation.20for.20n.20.3E.202.3F.html#472925272">(Sep 26 2024 at 15:39)</a>:</h4>
<p>Thank you! I am told about this, and recently find it is not always possible, but I believe it will work in this case!</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>