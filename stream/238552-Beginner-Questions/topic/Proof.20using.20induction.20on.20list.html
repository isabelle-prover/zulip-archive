<html>
<head><meta charset="utf-8"><title>Proof using induction on list · Beginner Questions · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/index.html">Beginner Questions</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html">Proof using induction on list</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="421137018"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421137018" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421137018">(Feb 12 2024 at 21:57)</a>:</h4>
<p>Hi, I am writing a proof by induction with a list.</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">fun</span><span class="w"> </span><span class="n">calc_votes</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'b list ⇒ 'b Profile ⇒'b Votes ⇒ 'b Votes"</span><span class="w"> </span><span class="kp">where</span>
<span class="w">  </span><span class="s">"calc_votes [ ] prof votes = votes"</span><span class="w"> </span><span class="o">|</span>
<span class="w">  </span><span class="s">"calc_votes (party # parties) prof votes =</span>
<span class="s">      calc_votes parties prof (cnt_votes party prof empty_v 0)"</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">calc_votes_permutation</span><span class="o">:</span>
<span class="w">  </span><span class="kp">fixes</span>
<span class="w">    </span><span class="n">p1</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'b Parties"</span><span class="w"> </span><span class="kp">and</span>
<span class="w">    </span><span class="n">p2</span><span class="w"> </span><span class="o">::</span><span class="s">"'b Parties"</span><span class="w"> </span><span class="kp">and</span>
<span class="w">    </span><span class="n">profl</span><span class="w"> </span><span class="o">::</span><span class="s">"'b Profile"</span><span class="w"> </span><span class="kp">and</span>
<span class="w">    </span><span class="n">votes</span><span class="o">::</span><span class="s">"'b Votes"</span>
<span class="w">  </span><span class="kp">assumes</span><span class="w"> </span><span class="s">"p1 &lt;~~&gt; p2"</span>
<span class="w">  </span><span class="kp">shows</span><span class="w"> </span><span class="s">"calc_votes p1 profl votes = calc_votes p2 profl votes"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induction</span><span class="w"> </span><span class="n">p1</span><span class="o">)</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">Nil</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"p2 = []"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="n">perm_empty_imp</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">Cons</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">p1</span><span class="o">)</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="s">"calc_votes (a # p1) profl votes =</span>
<span class="s">             calc_votes p1 profl (cnt_votes a profl empty_v 0)"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"calc_votes (a # p2) profl votes =</span>
<span class="s">             calc_votes p2 profl (cnt_votes a profl empty_v 0)"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">obtain</span><span class="w"> </span><span class="n">v'</span><span class="w"> </span><span class="kp">where</span><span class="w"> </span><span class="s">"v' = (cnt_votes a profl empty_v 0)"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"calc_votes p1 profl v' =</span>
<span class="s">             calc_votes p2 profl v'"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"calc_votes (a # p1) profl votes =</span>
<span class="s">             calc_votes (a # p2) profl votes"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="k">qed</span>
</code></pre></div>
<p>First: Nil case should be trivial but even <code>"p1 = [ ]" using assms by simp</code> does not work. How is this possible if Nil itself is "[ ]" as I read in the documentation?<br>
Second: in Cons, I am stuck on the step where I use v' (I introduced it to make it clearer). I know the induction proof is assuming as true that <code>"calc_votes p1 profl v = calc_votes p2 profl v"</code> , while in the step I have v', which is different. The only solution I could think of brings me to useless unrolling of the recursion. How do I solve this? TIA</p>



<a name="421180695"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421180695" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421180695">(Feb 13 2024 at 05:52)</a>:</h4>
<p>I don't know for sure without more context, however, your induction doesn't look like it is set up correctly. you probably want the following :</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="ow">...</span>
<span class="k">using</span><span class="w"> </span><span class="n">assms</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induction</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="n">arbitrary</span><span class="o">:</span><span class="w"> </span><span class="n">p2</span><span class="o">)</span>
<span class="ow">...</span>
</code></pre></div>
<p>which means to use the assumptions <code>p1 &lt;~~&gt; p2</code> when as part of the predicate instantiating the induction theorem and also to generalize over p2</p>



<a name="421180930"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421180930" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421180930">(Feb 13 2024 at 05:55)</a>:</h4>
<p>I really think (also after <a href="#narrow/stream/238552-Beginner-Questions/topic/Foldr.20invariant.20on.20permutations/near/419800146">https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner-Questions/topic/Foldr.20invariant.20on.20permutations/near/419800146</a>) that you should start with an Isabelle tutorial like the prog-prove.</p>



<a name="421187027"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421187027" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421187027">(Feb 13 2024 at 07:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="234226">Yong Kiam</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421180695">said</a>:</p>
<blockquote>
<p>I don't know for sure without more context, however, your induction doesn't look like it is set up correctly. you probably want the following :</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="ow">...</span>
<span class="k">using</span><span class="w"> </span><span class="n">assms</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induction</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="n">arbitrary</span><span class="o">:</span><span class="w"> </span><span class="n">p2</span><span class="o">)</span>
<span class="ow">...</span>
</code></pre></div>
<p>which means to use the assumptions <code>p1 &lt;~~&gt; p2</code> when as part of the predicate instantiating the induction theorem and also to generalize over p2</p>
</blockquote>
<p>Thanks, but I had already tried and it did not work.</p>



<a name="421187280"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421187280" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421187280">(Feb 13 2024 at 07:14)</a>:</h4>
<p>You are missing the "using assms" before the proof induction</p>



<a name="421187353"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421187353" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421187353">(Feb 13 2024 at 07:15)</a>:</h4>
<p>Isabelle's induction method does <em>not</em> work by assuming "p1 = []" but by replacing p1 by [] at all occurrences</p>



<a name="421187416"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421187416" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421187416">(Feb 13 2024 at 07:16)</a>:</h4>
<p>and if you forget some occurrences (like not putting the assms), then you cannot prove anything</p>



<a name="421187547"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421187547" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421187547">(Feb 13 2024 at 07:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421180930">said</a>:</p>
<blockquote>
<p>I really think (also after <a href="#narrow/stream/238552-Beginner-Questions/topic/Foldr.20invariant.20on.20permutations/near/419800146">https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner-Questions/topic/Foldr.20invariant.20on.20permutations/near/419800146</a>) that you should start with an Isabelle tutorial like the prog-prove.</p>
</blockquote>
<p>I already read the prog-prove but I will try to do some exercises from here, thanks.</p>



<a name="421187666"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421187666" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421187666">(Feb 13 2024 at 07:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421187280">said</a>:</p>
<blockquote>
<p>You are missing the "using assms" before the proof induction</p>
</blockquote>
<p>You mean like the example provided by <span class="user-mention" data-user-id="234226">@Yong Kiam</span> , right? I put it, still it does not work.</p>



<a name="421187794"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421187794" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421187794">(Feb 13 2024 at 07:20)</a>:</h4>
<p>and what does not work? can you provide an error message?</p>



<a name="421188251"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421188251" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421188251">(Feb 13 2024 at 07:25)</a>:</h4>
<p>and if the problem is <code>calc_votes p1 profl v = calc_votes p2 profl v</code>: you have told Isabelle that you want to use the IH at this point</p>



<a name="421189314"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421189314" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421189314">(Feb 13 2024 at 07:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421187794">said</a>:</p>
<blockquote>
<p>and what does not work? can you provide an error message?</p>
</blockquote>
<p>Nevermind, I fixed it, thanks</p>



<a name="421190225"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421190225" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421190225">(Feb 13 2024 at 07:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421188251">said</a>:</p>
<blockquote>
<p>and if the problem is <code>calc_votes p1 profl v = calc_votes p2 profl v</code>: you have told Isabelle that you want to use the IH at this point</p>
</blockquote>
<p>It's not working because I am inducting on p1, having <code>(a # p1)</code> but since I am not inducting on p2 I have p2 and not what I actually would need, which is <code>(a # p2)</code>. So my induction proof is proving <code>calc_votes (a # p1) ... = calc_votes p2 ...</code> , while I should prove  <code>calc_votes (a # p1) ... = calc_votes (a # p2) ... </code>. Maybe I should use some  <code>obtain</code> ? I hope I was clear.</p>



<a name="421190394"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421190394" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421190394">(Feb 13 2024 at 07:46)</a>:</h4>
<p>Also, I will look in the doc to check if there is some similar case/example.</p>



<a name="421194315"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421194315" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421194315">(Feb 13 2024 at 08:15)</a>:</h4>
<p>in the inductive case, you will probably need to unfold the assumption <code>a # p_1 &lt;~~&gt; p_2</code> a little in order to apply the inductive hypothesis</p>



<a name="421200331"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421200331" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421200331">(Feb 13 2024 at 08:57)</a>:</h4>
<p>you need to obtain a p_2' such that mset p_2 = mset (a # p_2') yeas</p>



<a name="421233184"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421233184" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421233184">(Feb 13 2024 at 12:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421200331">said</a>:</p>
<blockquote>
<p>you need to obtain a p_2' such that mset p_2 = mset (a # p_2') yeas</p>
</blockquote>
<p>Actually p_2 is a list, not a multiset (also because I use permutation operator). Maybe you meant <code>p_2' = mset (a # p_2)</code> and then proving the inductive case on (a # p1) and p_2' (indeed, a # p_2)?</p>



<a name="421233710"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421233710" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421233710">(Feb 13 2024 at 12:29)</a>:</h4>
<p>You are getting the induction wrong. You have a p_2 (the list). From this list you could remove the element a. This yields the p_2' I was writing about</p>



<a name="421237283"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421237283" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421237283">(Feb 13 2024 at 12:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421233710">said</a>:</p>
<blockquote>
<p>You are getting the induction wrong. You have a p_2 (the list). From this list you could remove the element a. This yields the p_2' I was writing about</p>
</blockquote>
<p>I understand, you mean something like this right?<br>
<code>obtain p2' where "p2 &lt;~~&gt; (a # p2')" using assms by (metis Cons.prems)</code></p>



<a name="421237494"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421237494" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421237494">(Feb 13 2024 at 12:51)</a>:</h4>
<p>I would have written it directly as <code>obtain p2' where "a # p1 &lt;~~&gt; (a # p2')"</code>, but yes (this is one transitivity step away from your version)</p>



<a name="421239683"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421239683" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421239683">(Feb 13 2024 at 13:03)</a>:</h4>
<p>BTW, I'm not sure induction on lists is the best way to prove your goal (as it involves permutation), perhaps you may have better luck with induction on permutations (I don't have Isabelle open at the moment to see what the permutation induction is called)</p>



<a name="421241377"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421241377" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421241377">(Feb 13 2024 at 13:14)</a>:</h4>
<p>Or using multisets directly…</p>



<a name="421244273"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421244273" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421244273">(Feb 13 2024 at 13:32)</a>:</h4>
<p>I already tried to wrote it with Multisets with fold_mset but I found it a bit hard for my case. I'll try again today then</p>



<a name="421245413"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421245413" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421245413">(Feb 13 2024 at 13:39)</a>:</h4>
<p>You can also continue with the current approach… you are not far away from proving this theorem</p>



<a name="421245440"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421245440" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421245440">(Feb 13 2024 at 13:39)</a>:</h4>
<p>The real question is probably what comes next</p>



<a name="421245814"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421245814" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421245814">(Feb 13 2024 at 13:41)</a>:</h4>
<p>In general, the more complicated your structures are, the more proof you will require. For example, lists are multisets + order on the elements. So it is more complicated. Like here: the p_2' would be <code>remove1 a p_2</code> compared to <code>p_1 - {#a#}</code></p>



<a name="421314070"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421314070" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421314070">(Feb 13 2024 at 19:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421245413">said</a>:</p>
<blockquote>
<p>You can also continue with the current approach… you are not far away from proving this theorem</p>
</blockquote>
<p>I continued, I got to this point in the proving:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">Cons</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">p1</span><span class="o">)</span>
<span class="w">  </span><span class="k">obtain</span><span class="w"> </span><span class="n">p2'</span><span class="w"> </span><span class="kp">where</span><span class="w"> </span><span class="s">"p2 &lt;~~&gt; (a # p2')"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">metis</span><span class="w"> </span><span class="n">Cons.prems</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"(a # p1) &lt;~~&gt; (a # p2')"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="n">Cons.prems</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"calc_votes (a # p1) profl votes =</span>
<span class="s">             calc_votes p1 profl (cnt_votes a profl empty_v 0)"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… =</span>
<span class="s">             calc_votes p2' profl (cnt_votes a profl empty_v 0)"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span>
<span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">metis</span><span class="w"> </span><span class="n">Cons.IH</span><span class="w"> </span><span class="n">Cons.prems</span><span class="w"> </span><span class="s">‹mset p2 = mset (a # p2')›</span><span class="w"> </span><span class="n">calc_votes.simps</span><span class="o">(</span><span class="n">2</span><span class="o">)</span><span class="w"> </span><span class="n">cons_perm_imp_perm</span><span class="w"> </span><span class="n">list.exhaust</span><span class="w"> </span><span class="n">mset_zero_iff_right</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = calc_votes (a # p2') profl votes"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = calc_votes p2 profl votes"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="k">qed</span>
</code></pre></div>
<p>but I cannot do the last step, since p2 is not equal to (a # p2') but it's a permutation. So to do this step I would require exactly the lemma i am proving and I don't know how to do this otherwise.</p>



<a name="421352224"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421352224" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421352224">(Feb 14 2024 at 01:06)</a>:</h4>
<p>you may need to prove a helper lemma (e.g., something saying you can pull an element from within a list to the front)</p>
<p>alternatively, go for <code>mset</code> or an induction principle for permutations</p>



<a name="421382364"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421382364" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421382364">(Feb 14 2024 at 07:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="234226">Yong Kiam</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421352224">said</a>:</p>
<blockquote>
<p>you may need to prove a helper lemma (e.g., something saying you can pull an element from within a list to the front)</p>
<p>alternatively, go for <code>mset</code> or an induction principle for permutations</p>
</blockquote>
<p>I don't understand, how would the helper lemma you wrote help my case?</p>
<p>for mset you mean to write the function itself with Multisets? alternatively, do you know where I can find infos about induction on permutations?</p>



<a name="421383449"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421383449" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421383449">(Feb 14 2024 at 07:16)</a>:</h4>
<p>I'm actually not sure what the appropriate induction is called in Isabelle, maybe someone else could chime in, but this is the induction principle that's used in HOL4:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="w">   </span><span class="o">[</span><span class="n">PERM_IND</span><span class="o">]</span><span class="w">  </span><span class="n">Theorem</span>
<span class="w">      </span><span class="n">⊢</span><span class="w"> </span><span class="n">∀P.</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="o">(</span><span class="n">∀x</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2.</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">⇒</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">l1</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">l2</span><span class="o">))</span><span class="w"> </span><span class="n">∧</span>
<span class="w">            </span><span class="o">(</span><span class="n">∀x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2.</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">⇒</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">y</span><span class="o">::</span><span class="n">l1</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">y</span><span class="o">::</span><span class="n">x</span><span class="o">::</span><span class="n">l2</span><span class="o">))</span><span class="w"> </span><span class="n">∧</span>
<span class="w">            </span><span class="o">(</span><span class="n">∀l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">l3.</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">l3</span><span class="w"> </span><span class="n">⇒</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l3</span><span class="o">)</span><span class="w"> </span><span class="n">⇒</span>
<span class="w">            </span><span class="n">∀l1</span><span class="w"> </span><span class="n">l2.</span><span class="w"> </span><span class="n">PERM</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">⇒</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span>
</code></pre></div>
<p>going for <code>mset</code> as <span class="user-mention" data-user-id="233198">@Mathias Fleury</span> suggested seems like the right way to go to me.<br>
concretely: define another function that works over multisets, prove that your list version is equivalent to the <code>mset</code> version in some adequate way, then the permutation results follow for free</p>



<a name="421551631"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421551631" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yutaka Nagashima <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421551631">(Feb 14 2024 at 23:30)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="671670">@Salvatore Francesco Rossetta</span> . </p>
<p>I am building an induction prover inside Isabelle. </p>
<p>(This might be a bit confusing, but in the video, I refer to it as 'abduction prover' because of the search algorithm I use within the prover. However, it is primarily designed for solving inductive problems.)<br>
<a href="https://youtu.be/rXU-lJxP_GI">https://youtu.be/rXU-lJxP_GI</a></p>
<div class="youtube-video message_inline_image"><a data-id="rXU-lJxP_GI" href="https://youtu.be/rXU-lJxP_GI"><img src="https://uploads.zulipusercontent.net/5cafcd521ae910e84c565218750620f29e34e597/68747470733a2f2f692e7974696d672e636f6d2f76692f7258552d6c4a78505f47492f64656661756c742e6a7067"></a></div><p>It might be able to find a proof for you if you're lucky.<br>
You can get the induction prover for Isabelle here: <a href="https://github.com/data61/PSL">https://github.com/data61/PSL</a></p>
<p>The tool may not handle the use of <code>assumes</code> very well.<br>
So, it might prefer </p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="n">prove</span><span class="w">  </span><span class="s">"(p1 &lt;~~&gt; p2) ==&gt; calc_votes p1 profl votes = calc_votes p2 profl votes"</span>
</code></pre></div>
<p>rather than </p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="kp">assumes</span><span class="w"> </span><span class="s">"p1 &lt;~~&gt; p2"</span>
<span class="w"> </span><span class="n">prove</span><span class="w"> </span><span class="s">"calc_votes p1 profl votes = calc_votes p2 profl votes"</span>
</code></pre></div>
<p>Also, please note that it takes a while for this tool to find a proof. Once, I waited for more than 30 minutes before it delivered a proof to me.</p>



<a name="421729029"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421729029" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421729029">(Feb 15 2024 at 19:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="234226">Yong Kiam</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421383449">said</a>:</p>
<blockquote>
<p>I'm actually not sure what the appropriate induction is called in Isabelle, maybe someone else could chime in, but this is the induction principle that's used in HOL4:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="w">   </span><span class="o">[</span><span class="n">PERM_IND</span><span class="o">]</span><span class="w">  </span><span class="n">Theorem</span>
<span class="w">      </span><span class="n">⊢</span><span class="w"> </span><span class="n">∀P.</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="o">(</span><span class="n">∀x</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2.</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">⇒</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">l1</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">l2</span><span class="o">))</span><span class="w"> </span><span class="n">∧</span>
<span class="w">            </span><span class="o">(</span><span class="n">∀x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2.</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">⇒</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">y</span><span class="o">::</span><span class="n">l1</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">y</span><span class="o">::</span><span class="n">x</span><span class="o">::</span><span class="n">l2</span><span class="o">))</span><span class="w"> </span><span class="n">∧</span>
<span class="w">            </span><span class="o">(</span><span class="n">∀l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">l3.</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">l3</span><span class="w"> </span><span class="n">⇒</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l3</span><span class="o">)</span><span class="w"> </span><span class="n">⇒</span>
<span class="w">            </span><span class="n">∀l1</span><span class="w"> </span><span class="n">l2.</span><span class="w"> </span><span class="n">PERM</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">⇒</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span>
</code></pre></div>
<p>going for <code>mset</code> as <span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> suggested seems like the right way to go to me.<br>
concretely: define another function that works over multisets, prove that your list version is equivalent to the <code>mset</code> version in some adequate way, then the permutation results follow for free</p>
</blockquote>
<p>wait actually permutations are defined as multiset equality. I forgot that.</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="n">src/HOL/Combinatorics/List_Permutation.thy</span><span class="o">:</span><span class="k">abbreviation</span><span class="w"> </span><span class="o">(</span><span class="n">input</span><span class="o">)</span><span class="w"> </span><span class="n">perm</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="ss">\&lt;open&gt;</span><span class="s">'a list </span><span class="ss">\&lt;Rightarrow&gt;</span><span class="s"> 'a list </span><span class="ss">\&lt;Rightarrow&gt;</span><span class="s"> bool</span><span class="ss">\&lt;close&gt;</span><span class="w">  </span><span class="o">(</span><span class="kp">infixr</span><span class="w"> </span><span class="ss">\&lt;open&gt;</span><span class="s">&lt;~~&gt;</span><span class="ss">\&lt;close&gt;</span><span class="w"> </span><span class="n">50</span><span class="o">)</span>
<span class="n">src/HOL/Combinatorics/List_Permutation.thy</span><span class="o">:</span><span class="w">  </span><span class="kp">where</span><span class="w"> </span><span class="ss">\&lt;open&gt;</span><span class="s">xs &lt;~~&gt; ys </span><span class="ss">\&lt;equiv&gt;</span><span class="s"> mset xs = mset ys</span><span class="ss">\&lt;close&gt;</span>
</code></pre></div>
<p>So we do not have a permutation induction (at least no a builtin one).</p>



<a name="421729629"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421729629" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421729629">(Feb 15 2024 at 19:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="671670">Salvatore Francesco Rossetta</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421314070">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421245413">said</a>:</p>
<blockquote>
<p>You can also continue with the current approach… you are not far away from proving this theorem</p>
</blockquote>
<p>I continued, I got to this point in the proving:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">Cons</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">p1</span><span class="o">)</span>
<span class="w">  </span><span class="k">obtain</span><span class="w"> </span><span class="n">p2'</span><span class="w"> </span><span class="kp">where</span><span class="w"> </span><span class="s">"p2 &lt;~~&gt; (a # p2')"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">metis</span><span class="w"> </span><span class="n">Cons.prems</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"(a # p1) &lt;~~&gt; (a # p2')"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="n">Cons.prems</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"calc_votes (a # p1) profl votes =</span>
<span class="s">             calc_votes p1 profl (cnt_votes a profl empty_v 0)"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"… =</span>
<span class="s">             calc_votes p2' profl (cnt_votes a profl empty_v 0)"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span>
<span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">metis</span><span class="w"> </span><span class="n">Cons.IH</span><span class="w"> </span><span class="n">Cons.prems</span><span class="w"> </span><span class="s">‹mset p2 = mset (a # p2')›</span><span class="w"> </span><span class="n">calc_votes.simps</span><span class="o">(</span><span class="n">2</span><span class="o">)</span><span class="w"> </span><span class="n">cons_perm_imp_perm</span><span class="w"> </span><span class="n">list.exhaust</span><span class="w"> </span><span class="n">mset_zero_iff_right</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = calc_votes (a # p2') profl votes"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = calc_votes p2 profl votes"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="k">qed</span>
</code></pre></div>
<p>but I cannot do the last step, since p2 is not equal to (a # p2') but it's a permutation. So to do this step I would require exactly the lemma i am proving and I don't know how to do this otherwise.</p>
</blockquote>
<p>Right, so this would mean that you have to generalize your assumptions somehow and change your induction principle. Maybe actually induction on the length of <code>l1</code>?</p>



<a name="421729748"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421729748" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421729748">(Feb 15 2024 at 19:54)</a>:</h4>
<p>(BTW I would still like to get the full theory with all the definitions)</p>



<a name="421785147"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421785147" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421785147">(Feb 16 2024 at 04:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421729029">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="234226">Yong Kiam</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421383449">said</a>:</p>
<blockquote>
<p>I'm actually not sure what the appropriate induction is called in Isabelle, maybe someone else could chime in, but this is the induction principle that's used in HOL4:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="w">   </span><span class="o">[</span><span class="n">PERM_IND</span><span class="o">]</span><span class="w">  </span><span class="n">Theorem</span>
<span class="w">      </span><span class="n">⊢</span><span class="w"> </span><span class="n">∀P.</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="o">[]</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="o">(</span><span class="n">∀x</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2.</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">⇒</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">l1</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">l2</span><span class="o">))</span><span class="w"> </span><span class="n">∧</span>
<span class="w">            </span><span class="o">(</span><span class="n">∀x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2.</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">⇒</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">(</span><span class="n">x</span><span class="o">::</span><span class="n">y</span><span class="o">::</span><span class="n">l1</span><span class="o">)</span><span class="w"> </span><span class="o">(</span><span class="n">y</span><span class="o">::</span><span class="n">x</span><span class="o">::</span><span class="n">l2</span><span class="o">))</span><span class="w"> </span><span class="n">∧</span>
<span class="w">            </span><span class="o">(</span><span class="n">∀l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">l3.</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">∧</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">l3</span><span class="w"> </span><span class="n">⇒</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l3</span><span class="o">)</span><span class="w"> </span><span class="n">⇒</span>
<span class="w">            </span><span class="n">∀l1</span><span class="w"> </span><span class="n">l2.</span><span class="w"> </span><span class="n">PERM</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span><span class="w"> </span><span class="n">⇒</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="n">l1</span><span class="w"> </span><span class="n">l2</span>
</code></pre></div>
<p>going for <code>mset</code> as <span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> suggested seems like the right way to go to me.<br>
concretely: define another function that works over multisets, prove that your list version is equivalent to the <code>mset</code> version in some adequate way, then the permutation results follow for free</p>
</blockquote>
<p>wait actually permutations are defined as multiset equality. I forgot that.</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="n">src/HOL/Combinatorics/List_Permutation.thy</span><span class="o">:</span><span class="k">abbreviation</span><span class="w"> </span><span class="o">(</span><span class="n">input</span><span class="o">)</span><span class="w"> </span><span class="n">perm</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="ss">\&lt;open&gt;</span><span class="s">'a list </span><span class="ss">\&lt;Rightarrow&gt;</span><span class="s"> 'a list </span><span class="ss">\&lt;Rightarrow&gt;</span><span class="s"> bool</span><span class="ss">\&lt;close&gt;</span><span class="w">  </span><span class="o">(</span><span class="kp">infixr</span><span class="w"> </span><span class="ss">\&lt;open&gt;</span><span class="s">&lt;~~&gt;</span><span class="ss">\&lt;close&gt;</span><span class="w"> </span><span class="n">50</span><span class="o">)</span>
<span class="n">src/HOL/Combinatorics/List_Permutation.thy</span><span class="o">:</span><span class="w">  </span><span class="kp">where</span><span class="w"> </span><span class="ss">\&lt;open&gt;</span><span class="s">xs &lt;~~&gt; ys </span><span class="ss">\&lt;equiv&gt;</span><span class="s"> mset xs = mset ys</span><span class="ss">\&lt;close&gt;</span>
</code></pre></div>
<p>So we do not have a permutation induction (at least no a builtin one).</p>
</blockquote>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="kn">lemma</span><span class="w"> </span><span class="n">perm_induct</span><span class="o">:</span>
<span class="w">  </span><span class="kp">assumes</span><span class="w"> </span><span class="s">"P [] []"</span>
<span class="w">  </span><span class="kp">assumes</span><span class="w"> </span><span class="s">"⋀x xs ys. P (x # xs) (x # ys)"</span>
<span class="w">  </span><span class="kp">assumes</span><span class="w"> </span><span class="s">"⋀x y xs ys. P (x # y # xs) (y # x # ys)"</span>
<span class="w">  </span><span class="kp">assumes</span><span class="w"> </span><span class="s">"⋀xs ys zs. P xs ys ⟹ P ys zs ⟹ P xs zs"</span>
<span class="w">  </span><span class="kp">shows</span><span class="w"> </span><span class="s">"mset xs = mset ys ⟹ P xs ys"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induction</span><span class="w"> </span><span class="n">xs</span><span class="w"> </span><span class="n">arbitrary</span><span class="o">:</span><span class="w"> </span><span class="n">ys</span><span class="o">)</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">Nil</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">Cons</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">xs</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">metis</span><span class="w"> </span><span class="n">neq_Nil_conv</span><span class="w"> </span><span class="n">perm_empty2</span><span class="o">)</span>
<span class="k">qed</span>
</code></pre></div>



<a name="421806066"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421806066" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421806066">(Feb 16 2024 at 07:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421729629">said</a>:</p>
<blockquote>
<p>Right, so this would mean that you have to generalize your assumptions somehow and change your induction principle. Maybe actually induction on the length of <code>l1</code>?</p>
</blockquote>
<p>At this point, if the problem is that my p2 is p2 &lt;~~&gt; a # p2', can't i define it simply as p2 =a # p2' so I can do the last step?</p>



<a name="421806797"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421806797" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421806797">(Feb 16 2024 at 07:52)</a>:</h4>
<p>I don't get what you mean here, but the point is that p2 does <em>not</em> necessarily start with <code>a</code>, it's a permutation of <code>a # p_1</code></p>



<a name="421806913"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421806913" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421806913">(Feb 16 2024 at 07:54)</a>:</h4>
<p>if you want to assume something stronger about <code>p_2</code>, you'll have to use induction on a different (more general) statement, or use a different induction principle, as Mathias mentioned</p>



<a name="421810031"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421810031" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421810031">(Feb 16 2024 at 08:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="671670">Salvatore Francesco Rossetta</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421806066">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="233198">Mathias Fleury</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421729629">said</a>:</p>
<blockquote>
<p>Right, so this would mean that you have to generalize your assumptions somehow and change your induction principle. Maybe actually induction on the length of <code>l1</code>?</p>
</blockquote>
<p>At this point, if the problem is that my p2 is p2 &lt;~~&gt; a # p2', can't i define it simply as p2 =a # p2' so I can do the last step?</p>
</blockquote>
<p>You are doing an induction. You are not allowed to define anything. You get variables and you have to work with them.</p>



<a name="421812828"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421812828" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Salvatore Francesco Rossetta <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421812828">(Feb 16 2024 at 08:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="234226">Yong Kiam</span> <a href="#narrow/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list/near/421806913">said</a>:</p>
<blockquote>
<p>if you want to assume something stronger about <code>p_2</code>, you'll have to use induction on a different (more general) statement, or use a different induction principle, as Mathias mentioned</p>
</blockquote>
<p>Now I get it, to say that p2= a # p2' means this would be proved only with p2 having a as a first element, while I want the more general case, right?<br>
So on a general level, as an idea, I should do induction on length of p1 and in the ≠0 case do some obtain like p1' &lt;~~&gt; a # p1 and same with p2 right? I don't know if I was clear</p>



<a name="421829681"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Proof%20using%20induction%20on%20list/near/421829681" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yong Kiam <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Proof.20using.20induction.20on.20list.html#421829681">(Feb 16 2024 at 10:23)</a>:</h4>
<p>you can do something like this, but I'm not sure it will help you in this case, what about trying to use <code>perm_induct</code> which I wrote above?</p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>