<html>
<head><meta charset="utf-8"><title>Simple Number theory proof · Beginner Questions · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/index.html">Beginner Questions</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Simple.20Number.20theory.20proof.html">Simple Number theory proof</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="536989133"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Simple%20Number%20theory%20proof/near/536989133" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Simple.20Number.20theory.20proof.html#536989133">(Aug 31 2025 at 15:10)</a>:</h4>
<p>I made the following proof but got an error message on the last lines finally show ?thesis .qed</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">theory</span><span class="w"> </span><span class="n">MWE</span>
<span class="w">  </span><span class="kp">imports</span><span class="w"> </span><span class="n">Main</span>
<span class="k">begin</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">power_mod_nat</span><span class="o">:</span>
<span class="w">  </span><span class="kp">fixes</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">nat</span>
<span class="w">  </span><span class="kp">shows</span><span class="w"> </span><span class="s">"(a ^ n) mod m = ((a mod m) ^ n) mod m"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induction</span><span class="w"> </span><span class="n">n</span><span class="o">)</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">0</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">Suc</span><span class="w"> </span><span class="n">n</span><span class="o">)</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="s">"(a ^ Suc n) mod m = (a * a ^ n) mod m"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = (((a mod m) * a ^ n) mod m)"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">mod_mult_left_eq</span><span class="o">)</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = (((a mod m) * ((a ^ n) mod m)) mod m)"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">mod_mult_right_eq</span><span class="o">)</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = (((a mod m) * (((a mod m) ^ n) mod m)) mod m)"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">Suc.IH</span><span class="o">)</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = (((a mod m) * ((a mod m) ^ n)) mod m)"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">mod_mult_right_eq</span><span class="o">)</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = ((a mod m) ^ Suc n) mod m"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">finally</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="ow">.</span>
<span class="k">qed</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">power_mult_nat</span><span class="o">:</span>
<span class="w">  </span><span class="kp">fixes</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">nat</span>
<span class="w">  </span><span class="kp">shows</span><span class="w"> </span><span class="s">"a ^ (m * n) = (a ^ m) ^ n"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induction</span><span class="w"> </span><span class="n">n</span><span class="o">)</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">0</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">Suc</span><span class="w"> </span><span class="n">n</span><span class="o">)</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="s">"a ^ (m * Suc n) = a ^ (m*n + m)"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">add.commute</span><span class="o">)</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = a ^ (m*n) * a ^ m"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">power_add</span><span class="o">)</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = (a ^ m) ^ n * a ^ m"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">Suc.IH</span><span class="o">)</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = (a ^ m) ^ Suc n"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">finally</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="ow">.</span>
<span class="k">qed</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">pow4_mod3</span><span class="o">:</span><span class="w"> </span><span class="s">"((4::nat) ^ m) mod 3 = 1"</span>
<span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">power_mod_nat</span><span class="o">)</span>

<span class="c">(* 2. Even exponent: 2^(2m) = (2^2)^m = 4^m *)</span>
<span class="kn">lemma</span><span class="w"> </span><span class="n">pow2_mod3_even</span><span class="o">:</span>
<span class="w">  </span><span class="kp">assumes</span><span class="w"> </span><span class="s">"even l"</span>
<span class="w">  </span><span class="kp">shows</span><span class="w"> </span><span class="s">"2 ^ l mod 3 = 1"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">  </span><span class="k">obtain</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="kp">where</span><span class="w"> </span><span class="n">L</span><span class="o">:</span><span class="w"> </span><span class="s">"l = 2*m"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">assms</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">erule</span><span class="w"> </span><span class="n">evenE</span><span class="o">)</span>
<span class="w">  </span><span class="k">have</span><span class="w"> </span><span class="s">"2 ^ l mod 3 = (2 ^ (2*m)) mod 3"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">L</span><span class="o">)</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = (((2::nat) ^ 2) ^ m) mod 3"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">power_mult_nat</span><span class="o">)</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = (4 ^ m) mod 3"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">also</span><span class="w"> </span><span class="k">have</span><span class="w"> </span><span class="s">"... = 1"</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">rule</span><span class="w"> </span><span class="n">pow4_mod3</span><span class="o">)</span>
<span class="w">  </span><span class="k">finally</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span><span class="w"> </span><span class="ow">.</span>
<span class="k">qed</span>

<span class="k">end</span>
</code></pre></div>
<p>Any ideas why?</p>



<a name="537009989"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Simple%20Number%20theory%20proof/near/537009989" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christian Pardillo Laursen <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Simple.20Number.20theory.20proof.html#537009989">(Aug 31 2025 at 21:33)</a>:</h4>
<p>You need to specify that the numbers in your last proof are naturals. Switching the show line to <br>
  shows "(2 :: nat) ^ l mod 3 = 1" works.</p>



<a name="537012018"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Simple%20Number%20theory%20proof/near/537012018" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig Alan Feinstein <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Simple.20Number.20theory.20proof.html#537012018">(Aug 31 2025 at 22:12)</a>:</h4>
<p>indeed it did work, thank you</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>