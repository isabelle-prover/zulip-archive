<html>
<head><meta charset="utf-8"><title>Treatment of this pattern · Beginner Questions · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/index.html">Beginner Questions</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Treatment.20of.20this.20pattern.html">Treatment of this pattern</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="469917115"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Treatment%20of%20this%20pattern/near/469917115" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Treatment.20of.20this.20pattern.html#469917115">(Sep 13 2024 at 09:53)</a>:</h4>
<p>Problem:<br>
<a href="/user_uploads/14278/dajooSX8AYrkqRcaPGAM_2OF/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/14278/dajooSX8AYrkqRcaPGAM_2OF/image.png" title="image.png"><img data-original-dimensions="2138x1064" src="/user_uploads/thumbnail/14278/dajooSX8AYrkqRcaPGAM_2OF/image.png/840x560.webp"></a></div>



<a name="469917204"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Treatment%20of%20this%20pattern/near/469917204" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Treatment.20of.20this.20pattern.html#469917204">(Sep 13 2024 at 09:54)</a>:</h4>
<p>Code:</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">datatype</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VAR</span><span class="w"> </span><span class="s">"num"</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">FALSE</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">DISJ</span><span class="w"> </span><span class="s">"form"</span><span class="w"> </span><span class="s">"form"</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">NOT</span><span class="w"> </span><span class="s">"form"</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">DIAM</span><span class="w"> </span><span class="s">"form"</span>

<span class="k">record</span><span class="w"> </span><span class="n n-Type">'a</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="n">world</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a ⇒ bool"</span>
<span class="w">  </span><span class="n">rel</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a ⇒ 'a ⇒ bool"</span>


<span class="k">record</span><span class="w"> </span><span class="n n-Type">'a</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"'a frame"</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="n">valt</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"num ⇒ 'a ⇒ bool"</span>

<span class="k">fun</span><span class="w"> </span><span class="n">satis</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"'a model ⇒ 'a ⇒ form ⇒ bool"</span>
<span class="kp">where</span>
<span class="s">"satis M w (VAR p) ⟷ (valt M p w ∧ world M w)"</span>
<span class="o">|</span><span class="w"> </span><span class="s">"satis M w FALSE ⟷ False"</span>
<span class="o">|</span><span class="w"> </span><span class="s">"satis M w (NOT f) ⟷ world M w ∧ ¬ satis M w f"</span>
<span class="o">|</span><span class="w"> </span><span class="s">"satis M w (DISJ f1 f2) ⟷ satis M w f1 ∨ satis M w f2"</span>
<span class="o">|</span><span class="w"> </span><span class="s">"satis M w (DIAM f) ⟷ world M w ∧ (∃ v. rel M w v ∧ world M v ∧ satis M v f)"</span>


<span class="kn">lemma</span><span class="w"> </span><span class="n">satis_in_worlds</span><span class="o">:</span><span class="w"> </span><span class="s">"satis M w f ⟹ world M w"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induct</span><span class="w"> </span><span class="n">rule</span><span class="o">:</span><span class="n">form.induct</span><span class="o">)</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">DISJ</span><span class="w"> </span><span class="n">x1a</span><span class="w"> </span><span class="n">x2</span><span class="o">)</span>
<span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span><span class="w"> </span><span class="c">(* not sure if this works, but auto is roughly simp + blast *)</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">DIAM</span><span class="w"> </span><span class="n">x</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span>
<span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="n">fastforce</span>
<span class="k">qed</span><span class="w"> </span><span class="n">simp_all</span>

<span class="k">definition</span><span class="w"> </span><span class="n">BOX_def</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"BOX f = NOT (DIAM (NOT f))"</span>

<span class="k">definition</span><span class="w"> </span><span class="n">AND_def</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"AND f1 f2 = NOT (DISJ (NOT f1) (NOT f2))"</span>

<span class="k">definition</span><span class="w"> </span><span class="n">TRUE_def</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"TRUE = NOT FALSE"</span>

<span class="k">fun</span><span class="w"> </span><span class="n">subst</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"(num ⇒ form) ⇒ form ⇒ form"</span>
<span class="w">  </span><span class="kp">where</span>
<span class="w">   </span><span class="s">"subst s FALSE = FALSE"</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="s">"subst s (VAR p) = s p"</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="s">"subst s (DISJ f1 f2) = DISJ (subst s f1) (subst s f2)"</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="s">"subst s (NOT f) = NOT (subst s f)"</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="s">"subst s (DIAM f) = DIAM (subst s f)"</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">subst_BOX</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"subst f (BOX form) = BOX (subst f form)"</span>
<span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">BOX_def</span><span class="o">)</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">satis_AND</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"satis M w (AND f1 f2) ⟷ satis M w f1 ∧ satis M w f2"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">AND_def</span><span class="o">)</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">meson</span><span class="w"> </span><span class="n">satis_in_worlds</span><span class="o">)</span>
<span class="k">qed</span>

<span class="k">definition</span><span class="w"> </span><span class="n">satis_set_def</span><span class="w"> </span><span class="o">:</span>
<span class="s">"satis_set M w Σ ≡ (⋀a. a ∈ Σ ⟹ satis M w a)"</span>

<span class="c">(*</span>

<span class="c">val demodalize_def = Define`</span>
<span class="c">demodalize FALSE = FALSE /\</span>
<span class="c">demodalize (VAR p) = VAR p /\</span>
<span class="c">demodalize (DISJ form1 form2) = DISJ (demodalize form1) (demodalize form2) /\</span>
<span class="c">demodalize (NOT form) = NOT (demodalize form) /\</span>
<span class="c">demodalize (DIAM form) = demodalize form`;</span>

<span class="c">*)</span>

<span class="k">fun</span><span class="w"> </span><span class="n">demodalize</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"form ⇒ form"</span>
<span class="w">  </span><span class="kp">where</span>
<span class="w">    </span><span class="s">"demodalize FALSE = FALSE"</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="s">"demodalize (VAR p) = VAR p"</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="s">"demodalize (DISJ form1 form2) = DISJ (demodalize form1) (demodalize form2)"</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="s">"demodalize (NOT form) = NOT (demodalize form)"</span>
<span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="s">"demodalize (DIAM form) = demodalize form"</span>

<span class="kt">thm</span><span class="w"> </span><span class="n">HOL.eq_reflection</span>

<span class="k">fun</span><span class="w"> </span><span class="n">propform</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"form ⇒ bool"</span>
<span class="w">  </span><span class="kp">where</span>
<span class="w">   </span><span class="s">"propform FALSE = True"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"propform (VAR p) = True"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"propform (DISJ f1 f2) = (propform f1 ∧ propform f2)"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"propform (NOT f) = propform f"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"propform (DIAM f) = False"</span>

<span class="k">definition</span><span class="w"> </span><span class="n">IMP_def</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"IMP f1 f2 = DISJ (NOT f1) f2"</span>

<span class="k">fun</span><span class="w"> </span><span class="n">peval</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"(num ⇒ bool) ⇒ form ⇒ bool"</span><span class="w"> </span><span class="kp">where</span>
<span class="w">   </span><span class="s">"peval σ (VAR p) = σ p"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"peval σ (DISJ f1 f2) = (peval σ f1 ∨ peval σ f2)"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"peval σ FALSE = False"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"peval σ (NOT f) = (¬ peval σ f)"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"peval σ (DIAM f) = False"</span>

<span class="k">definition</span><span class="w"> </span><span class="n">ptaut_def</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"ptaut f ⟷ propform f ∧ (∀σ. peval σ f)"</span>

<span class="k">inductive</span><span class="w"> </span><span class="n">Kproof</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="s">"form list ⇒ bool"</span><span class="w"> </span><span class="kp">where</span>
<span class="w">   </span><span class="s">"Kproof []"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"Kproof p ∧ List.member p (IMP f1 f2) ∧ List.member p f1 ⟹ Kproof (p @ [f2])"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"Kproof p ∧ List.member p f ⟹ Kproof (p @ [subst σ f])"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"Kproof p ∧ List.member p f ⟹ Kproof (p @ [BOX f])"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"Kproof p ⟹ Kproof (p @ [IMP (BOX (IMP form1 form2)) (IMP (BOX form1) (BOX form2))])"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"Kproof p ⟹  Kproof (p @ [IMP (DIAM form) (NOT (BOX (NOT form)))])"</span>
<span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">"Kproof p ∧ ptaut f ⟹ Kproof (p @ [f])"</span>




<span class="kt">value</span><span class="w"> </span><span class="s">"demodalize (IMP (BOX (IMP form1 form2)) (IMP (BOX form1) (BOX form2)))"</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">demodalize_IMP</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"demodalize (IMP f1 f2) = IMP (demodalize f1) (demodalize f2)"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span>
<span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">IMP_def</span><span class="o">)</span>
<span class="k">qed</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">ptaut_MP</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kp">assumes</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"ptaut (IMP f1 f2)"</span><span class="w"> </span><span class="kp">and</span><span class="w"> </span><span class="n">a2</span><span class="o">:</span><span class="w"> </span><span class="s">"ptaut f1"</span><span class="w"> </span><span class="kp">shows</span><span class="w"> </span><span class="n">b</span><span class="o">:</span><span class="w"> </span><span class="s">"ptaut f2"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">IMP_def</span><span class="w"> </span><span class="n">ptaut_def</span><span class="o">)</span>
<span class="k">qed</span>

<span class="kt">find_theorems</span><span class="w"> </span><span class="s">"List.member (a @ [b])"</span>




<span class="k">definition</span><span class="w"> </span><span class="n">valid_frame_state_def</span><span class="o">:</span>
<span class="s">"valid_frame_state Fr w phi ≡ (⋀M. frame.truncate M = Fr ⟹ satis M w phi)"</span>


<span class="kn">lemma</span><span class="w"> </span><span class="n">propform_demodalize</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"propform (demodalize f)"</span>
<span class="w">  </span><span class="gr">sorry</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">demodalize_subst</span><span class="o">:</span><span class="w"> </span><span class="s">"demodalize (subst f form) = demodalize (subst f (demodalize form))"</span>
<span class="w">  </span><span class="gr">sorry</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">peval_demodalize_subst_eq</span><span class="o">:</span>
<span class="w">    </span><span class="s">"propform form ⟹</span>
<span class="s">     (peval σ (demodalize (subst f form))</span>
<span class="s">    ≡ peval (peval σ o demodalize o f) form)"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induct</span><span class="w"> </span><span class="n">rule</span><span class="o">:</span><span class="n">form.induct</span><span class="o">)</span><span class="w"> </span><span class="k">qed</span><span class="w"> </span><span class="n">simp_all</span>

<span class="c">(*</span>
<span class="c">lemma peval_demodalize_subst_eq :</span>
<span class="c"> " propform form ⟹</span>
<span class="c">  (peval σ (demodalize (subst f form)) \&lt;equiv&gt; peval (peval σ o demodalize o f) form)"</span>
<span class="c">  sorry*)</span>
<span class="kt">thm</span><span class="w"> </span><span class="n">disjE</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">demodalize_BOX</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"demodalize (BOX form) = NOT (NOT (demodalize form))"</span>
<span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">BOX_def</span><span class="o">)</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">peval_not_not</span><span class="o">:</span><span class="w"> </span><span class="s">"peval σ (NOT (NOT f)) = peval σ f"</span>
<span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">ptaut_not_not</span><span class="o">:</span><span class="w"> </span><span class="s">"ptaut f ⟹ ptaut (NOT (NOT f))"</span>
<span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">ptaut_def</span><span class="o">)</span>


<span class="kn">lemma</span><span class="w"> </span><span class="n">demodalize_ax1_ptaut</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"ptaut (demodalize (IMP (BOX (IMP form1 form2)) (IMP (BOX form1) (BOX form2))))"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span><span class="w"> </span><span class="k">unfolding</span><span class="w"> </span><span class="n">ptaut_def</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">propform_demodalize</span><span class="o">)</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">IMP_def</span><span class="w"> </span><span class="n">demodalize_BOX</span><span class="o">)</span>
<span class="k">qed</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">demodalize_ax2_ptaut</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"ptaut (demodalize (IMP (DIAM form) (NOT (BOX (NOT form)))))"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span><span class="w"> </span><span class="k">unfolding</span><span class="w"> </span><span class="n">ptaut_def</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">propform_demodalize</span><span class="o">)</span>
<span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">IMP_def</span><span class="w"> </span><span class="n">demodalize_BOX</span><span class="o">)</span>
<span class="k">qed</span>

<span class="kn">lemma</span><span class="w"> </span><span class="n">demodalize_ax3_ptaut</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"ptaut (demodalize (IMP (NOT (BOX (NOT form))) (DIAM form)))"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span><span class="w"> </span><span class="k">unfolding</span><span class="w"> </span><span class="n">ptaut_def</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">propform_demodalize</span><span class="o">)</span>
<span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">IMP_def</span><span class="w"> </span><span class="n">demodalize_BOX</span><span class="o">)</span>
<span class="k">qed</span>



<span class="kn">lemma</span><span class="w"> </span><span class="n">exercise_1_6_2</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"Kproof p ⟹ List.member p f ⟹ ptaut (demodalize f)"</span>
<span class="k">proof</span><span class="w"> </span><span class="o">(</span><span class="n">induction</span><span class="w"> </span><span class="n">arbitrary</span><span class="o">:</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">rule</span><span class="o">:</span><span class="w"> </span><span class="n">Kproof.induct</span><span class="o">)</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">1</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span>
<span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">member_rec</span><span class="o">(</span><span class="n">2</span><span class="o">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">force</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">a</span><span class="o">:(</span><span class="n">2</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">f1</span><span class="w"> </span><span class="n">f2</span><span class="o">)</span>
<span class="w">  </span><span class="k">hence</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"List.member p f ∨ f = f2"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">metis</span><span class="w"> </span><span class="n">in_set_member</span><span class="w"> </span><span class="n">rotate1.simps</span><span class="o">(</span><span class="n">2</span><span class="o">)</span><span class="w"> </span><span class="n">set_ConsD</span><span class="w"> </span><span class="n">set_rotate1</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">metis</span><span class="w"> </span><span class="n">a.IH</span><span class="w"> </span><span class="n">demodalize_IMP</span><span class="w"> </span><span class="n">ptaut_MP</span><span class="o">)</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">(</span><span class="n">3</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">σ</span><span class="w"> </span><span class="n">g</span><span class="o">)</span>
<span class="w">  </span><span class="k">hence</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">"List.member p g ∨ g = subst σ f"</span>
<span class="w">   </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">metis</span><span class="w"> </span><span class="n">member_def</span><span class="w"> </span><span class="n">rotate1.simps</span><span class="o">(</span><span class="n">2</span><span class="o">)</span><span class="w"> </span><span class="n">set_ConsD</span><span class="w"> </span><span class="n">set_rotate1</span><span class="o">)</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="o">(</span><span class="n">rule</span><span class="w"> </span><span class="n">disjE</span><span class="w"> </span><span class="o">[</span><span class="n">OF</span><span class="w"> </span><span class="s">"a1"</span><span class="o">])</span><span class="w"> </span><span class="gr">sorry</span>

<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="n">c4</span><span class="o">:</span><span class="w"> </span><span class="o">(</span><span class="n">4</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">f0</span><span class="w"> </span><span class="n">f</span><span class="o">)</span>
<span class="w">  </span><span class="k">hence</span><span class="w"> </span><span class="n">a2</span><span class="o">:</span><span class="w"> </span><span class="s">"List.member p f ∨ f = BOX f0"</span>
<span class="w">  </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">metis</span><span class="w"> </span><span class="n">in_set_member</span><span class="w"> </span><span class="n">rotate1.simps</span><span class="o">(</span><span class="n">2</span><span class="o">)</span><span class="w"> </span><span class="n">set_ConsD</span><span class="w"> </span><span class="n">set_rotate1</span><span class="o">)</span>
<span class="w">  </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="kp">apply</span><span class="w"> </span><span class="o">(</span><span class="n">rule</span><span class="w"> </span><span class="n">disjE</span><span class="o">[</span><span class="n">OF</span><span class="w"> </span><span class="s">"a2"</span><span class="o">])</span>
<span class="w">  </span><span class="k">proof</span><span class="w"> </span><span class="o">-</span>
<span class="w">    </span><span class="k">assume</span><span class="w"> </span><span class="n">dj1</span><span class="o">:</span><span class="w"> </span><span class="s">"List.member p f"</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">c4</span><span class="w"> </span><span class="n">dj1</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">simp</span>
<span class="w">  </span><span class="k">next</span>
<span class="w">    </span><span class="k">assume</span><span class="w"> </span><span class="n">dj2</span><span class="o">:</span><span class="w"> </span><span class="s">"f = BOX f0"</span>
<span class="w">    </span><span class="k">have</span><span class="w"> </span><span class="s">"ptaut (demodalize f0)"</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">c4</span><span class="w"> </span><span class="n">dj2</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">blast</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">dj2</span>
<span class="w">      </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">simp</span><span class="w"> </span><span class="n">add</span><span class="o">:</span><span class="w"> </span><span class="n">demodalize_BOX</span><span class="w"> </span><span class="n">ptaut_not_not</span><span class="o">)</span>
<span class="w">  </span><span class="k">qed</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">5</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">form1</span><span class="w"> </span><span class="n">form2</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="gr">sorry</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">6</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">form</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="gr">sorry</span>
<span class="k">next</span>
<span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">7</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">f</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span><span class="w"> </span><span class="gr">sorry</span>
<span class="k">qed</span>
</code></pre></div>



<a name="469917559"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Treatment%20of%20this%20pattern/near/469917559" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Treatment.20of.20this.20pattern.html#469917559">(Sep 13 2024 at 09:55)</a>:</h4>
<p>For the goal in the screenshot, I want to say: as f is a member of p @[g], either f in p or f = g. And in the first case, the goal will be killed by the second item in the list of "this".</p>



<a name="469917680"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Treatment%20of%20this%20pattern/near/469917680" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Treatment.20of.20this.20pattern.html#469917680">(Sep 13 2024 at 09:55)</a>:</h4>
<p>But I do not have a way of a neat treatment. You can see from above I always state hence "... \/ ...", and solve each case by hand.</p>



<a name="469917810"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Treatment%20of%20this%20pattern/near/469917810" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Treatment.20of.20this.20pattern.html#469917810">(Sep 13 2024 at 09:56)</a>:</h4>
<p>I believe there is a neater treatment for mature users, could you please teach me?</p>



<a name="469947159"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Treatment%20of%20this%20pattern/near/469947159" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Treatment.20of.20this.20pattern.html#469947159">(Sep 13 2024 at 12:01)</a>:</h4>
<p>Use "p \&lt;in&gt; set f"</p>



<a name="469968933"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Treatment%20of%20this%20pattern/near/469968933" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Treatment.20of.20this.20pattern.html#469968933">(Sep 13 2024 at 13:38)</a>:</h4>
<p>Sorry, do you mean <code>f in (set p)</code>, where <code>p</code> is the list? How does it  help?</p>



<a name="469970943"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Treatment%20of%20this%20pattern/near/469970943" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Treatment.20of.20this.20pattern.html#469970943">(Sep 13 2024 at 13:44)</a>:</h4>
<p>You will stop fighting the automation provided by auto</p>



<a name="469971950"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Treatment%20of%20this%20pattern/near/469971950" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Treatment.20of.20this.20pattern.html#469971950">(Sep 13 2024 at 13:49)</a>:</h4>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">5</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">form1</span><span class="w"> </span><span class="n">form2</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">demodalize_ax1_ptaut</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">force</span><span class="w"> </span><span class="n">simp</span><span class="o">:</span><span class="w"> </span><span class="n">List.member_def</span><span class="o">)</span>
</code></pre></div>



<a name="469972832"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Treatment%20of%20this%20pattern/near/469972832" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Treatment.20of.20this.20pattern.html#469972832">(Sep 13 2024 at 13:51)</a>:</h4>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="o">(</span><span class="n">5</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">form1</span><span class="w"> </span><span class="n">form2</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="n">consider</span>
<span class="w">    </span><span class="o">(</span><span class="n">f_IMP</span><span class="o">)</span><span class="w"> </span><span class="s">"f = IMP (BOX (IMP form1 form2))</span>
<span class="s">        (IMP (BOX form1) (BOX form2))"</span><span class="w"> </span><span class="o">|</span>
<span class="w">    </span><span class="o">(</span><span class="n">pf</span><span class="o">)</span><span class="w"> </span><span class="s">"List.member p f"</span>
<span class="w">    </span><span class="k">by</span><span class="w"> </span><span class="o">(</span><span class="n">auto</span><span class="w"> </span><span class="n">simp</span><span class="o">:</span><span class="w"> </span><span class="n">List.member_def</span><span class="o">)</span>
<span class="w">  </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="k">case</span>
<span class="w">  </span><span class="k">proof</span><span class="w"> </span><span class="n">cases</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="n">pf</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="n">5</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">auto</span>
<span class="w">  </span><span class="k">next</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="n">f_IMP</span>
<span class="w">    </span><span class="k">then</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="o">?</span><span class="n">thesis</span>
<span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="n">demodalize_ax1_ptaut</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">force</span>
<span class="w">  </span><span class="k">qed</span>
</code></pre></div>



<a name="469975476"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Treatment%20of%20this%20pattern/near/469975476" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yiming Xu <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Treatment.20of.20this.20pattern.html#469975476">(Sep 13 2024 at 13:58)</a>:</h4>
<p>Thank you! I see. Found in page 24 of <a href="https://isabelle.in.tum.de/doc/isar-ref.pdf">https://isabelle.in.tum.de/doc/isar-ref.pdf</a> !</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>