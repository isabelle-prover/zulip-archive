<html>
<head><meta charset="utf-8"><title>Why does map_t function fails · Beginner Questions · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/index.html">Beginner Questions</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html">Why does map_t function fails</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="378468928"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378468928" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hongjian Jiang <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378468928">(Jul 25 2023 at 13:08)</a>:</h4>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">datatype</span><span class="w"> </span><span class="o">(</span><span class="n">atoms</span><span class="o">:</span><span class="w"> </span><span class="n n-Type">'a</span><span class="o">)</span><span class="w"> </span><span class="n">rexp</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="n">is_Zero</span><span class="o">:</span><span class="w"> </span><span class="n">Zero</span><span class="w"> </span><span class="o">|</span>
<span class="w">  </span><span class="n">is_One</span><span class="o">:</span><span class="w"> </span><span class="n">One</span><span class="w"> </span><span class="o">|</span>
<span class="w">  </span><span class="n">Symbol</span><span class="w"> </span><span class="s">"'a ⇒ bool"</span><span class="w"> </span><span class="o">|</span>
<span class="w">  </span><span class="n">Plus</span><span class="w"> </span><span class="s">"('a rexp)"</span><span class="w"> </span><span class="s">"('a rexp)"</span><span class="w"> </span><span class="o">|</span>
<span class="w">  </span><span class="n">Times</span><span class="w"> </span><span class="s">"('a rexp)"</span><span class="w"> </span><span class="s">"('a rexp)"</span><span class="w"> </span><span class="o">|</span>
<span class="w">  </span><span class="n">Star</span><span class="w"> </span><span class="s">"('a rexp)"</span>
</code></pre></div>
<p>I have defined regular expression type, but I found the function of <code>map_rexp</code>, <code>rexp.map_comp</code>are both failed.</p>
<p>Why does this happen, how to fix it.</p>



<a name="378471956"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378471956" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378471956">(Jul 25 2023 at 13:18)</a>:</h4>
<p>And I am sure that you tried your example, reduced it (by removing branches) until map was generated. So you realized that the problem is <code>Symbol "'a ⇒ bool"</code>.</p>



<a name="378472107"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378472107" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378472107">(Jul 25 2023 at 13:18)</a>:</h4>
<p>So what was the question?</p>



<a name="378473069"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378473069" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hongjian Jiang <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378473069">(Jul 25 2023 at 13:21)</a>:</h4>
<p>My initial idea is the Symbol means a predicate, take any input, then return a boolean value.</p>



<a name="378473253"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378473253" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hongjian Jiang <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378473253">(Jul 25 2023 at 13:21)</a>:</h4>
<p>Is that such definition not work in the datatype context</p>



<a name="378473558"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378473558" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378473558">(Jul 25 2023 at 13:22)</a>:</h4>
<p>how would you define it?</p>



<a name="378473713"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378473713" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378473713">(Jul 25 2023 at 13:23)</a>:</h4>
<p>Your map has type <code>('a ⇒ 'b) ⇒ 'a rexp ⇒ 'b rexp</code></p>



<a name="378473870"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378473870" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378473870">(Jul 25 2023 at 13:23)</a>:</h4>
<p>how would you convert a function <code>'a ⇒  bool</code>?</p>



<a name="378473959"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378473959" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378473959">(Jul 25 2023 at 13:23)</a>:</h4>
<p>This is a real question, I have absolutely no clue</p>



<a name="378474207"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378474207" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378474207">(Jul 25 2023 at 13:24)</a>:</h4>
<p>if the type was <code>('a ⇒ 'a) ⇒ 'a rexp ⇒ 'a rexp</code> then I can image function composition in Symbol, but not here</p>



<a name="378475147"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378475147" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hongjian Jiang <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378475147">(Jul 25 2023 at 13:26)</a>:</h4>
<p>I have seen an example <code>datatype ('a, 'b) ite = ITE "'a ⇒ bool" "'a ⇒ 'b" "'a ⇒ 'b"</code> here</p>



<a name="378475256"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378475256" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hongjian Jiang <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378475256">(Jul 25 2023 at 13:27)</a>:</h4>
<p>it takes a predicate in the condition</p>



<a name="378475399"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378475399" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hongjian Jiang <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378475399">(Jul 25 2023 at 13:27)</a>:</h4>
<p>Sorry for unfamilr with the type function</p>



<a name="378476648"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378476648" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Hongjian Jiang <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378476648">(Jul 25 2023 at 13:30)</a>:</h4>
<p>maybe this would work, if you have any suggestion.</p>
<div class="codehilite" data-code-language="Isabelle"><pre><span></span><code><span class="k">datatype</span><span class="w"> </span><span class="o">(</span><span class="n">atoms</span><span class="o">:</span><span class="n n-Type">'a</span><span class="o">,</span><span class="w"> </span><span class="n n-Type">'b</span><span class="o">)</span><span class="w"> </span><span class="n">rexp</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="n">is_Zero</span><span class="o">:</span><span class="w"> </span><span class="n">Zero</span><span class="w"> </span><span class="o">|</span>
<span class="w">  </span><span class="n">is_One</span><span class="o">:</span><span class="w"> </span><span class="n">One</span><span class="w"> </span><span class="o">|</span>
<span class="w">  </span><span class="n">Symbol</span><span class="w"> </span><span class="s">"'a ⇒ bool"</span><span class="w"> </span><span class="o">|</span>
<span class="w">  </span><span class="n">Plus</span><span class="w"> </span><span class="s">"('a, 'b) rexp"</span><span class="w"> </span><span class="s">"('a, 'b) rexp"</span><span class="w"> </span><span class="o">|</span>
<span class="w">  </span><span class="n">Times</span><span class="w"> </span><span class="s">"('a, 'b) rexp""('a, 'b) rexp"</span><span class="w"> </span><span class="o">|</span>
<span class="w">  </span><span class="n">Star</span><span class="w"> </span><span class="s">"('a, 'b) rexp"</span>
</code></pre></div>



<a name="378477788"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378477788" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378477788">(Jul 25 2023 at 13:34)</a>:</h4>
<p>Then you should report this to the mailing list…</p>



<a name="378478039"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378478039" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378478039">(Jul 25 2023 at 13:35)</a>:</h4>
<p>maybe <span class="user-mention" data-user-id="402444">@Martin Desharnais</span> or <span class="user-mention" data-user-id="361271">@Dmitriy Traytel</span>   know why adding a second type parameter makes the map function work suddenly</p>



<a name="378545892"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378545892" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simon Roßkopf <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378545892">(Jul 25 2023 at 16:55)</a>:</h4>
<p>I do not think it is possible to generate such a map function. As Mathias said: How would such a function look.</p>
<p>Note that the map function for your <code>ITE</code> example only maps over the return types of the functions (the <code>'b</code>s). There is no mapping over the <code>'a</code>s happening there</p>



<a name="378554559"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378554559" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378554559">(Jul 25 2023 at 17:26)</a>:</h4>
<p>that what I though too, but for the second version with the 'b it works…</p>



<a name="378554744"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378554744" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mathias Fleury <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378554744">(Jul 25 2023 at 17:26)</a>:</h4>
<p>(but I did not check how the definition looks like)</p>



<a name="378559200"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/238552-Beginner%20Questions/topic/Why%20does%20map_t%20function%20fails/near/378559200" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Simon Roßkopf <a href="http://isabelle.systems/zulip-archive/stream/238552-Beginner-Questions/topic/Why.20does.20map_t.20function.20fails.html#378559200">(Jul 25 2023 at 17:43)</a>:</h4>
<p>It does generate a map function, but only one mapping over the second type argument.</p>
<p><code>"map_rexp"  :: "('a ⇒ 'b) ⇒ ('c, 'a) rexp ⇒ ('c, 'b) rexp</code></p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>