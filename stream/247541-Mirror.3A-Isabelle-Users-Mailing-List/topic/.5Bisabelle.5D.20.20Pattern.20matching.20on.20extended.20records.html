<html>
<head><meta charset="utf-8"><title>[isabelle]  Pattern matching on extended records · Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20.20Pattern.20matching.20on.20extended.20records.html">[isabelle]  Pattern matching on extended records</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="322541075"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20%20Pattern%20matching%20on%20extended%20records/near/322541075" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20.20Pattern.20matching.20on.20extended.20records.html#322541075">(Jan 20 2023 at 15:29)</a>:</h4>
<p>From: Rebecca Ghidini &lt;<a href="mailto:ghidini@in.tum.de">ghidini@in.tum.de</a>&gt;<br>
Hello,</p>
<p>I'm trying to write a function which uses pattern matching on an <br>
extended record.</p>
<p>For example, if I define the following record:</p>
<p>record normal_record =<br>
t1 :: nat<br>
t2 ::  nat</p>
<p>I can define functions with pattern matching on the fields of the <br>
record:</p>
<p>fun test1 :: "normal_record =&gt; nat"<br>
   where<br>
"test1 ((|t1 = a, t2 = b|)) = b"</p>
<p>Then I define an extended record:</p>
<p>record extended_record = normal_record +<br>
t3 :: nat</p>
<p>But when I try to define a function in the same way as before, I get an <br>
error:</p>
<p>fun test2 :: "extended_record =&gt; nat"<br>
   where<br>
"test2 ((|t1 = a, t2 = b, t3 = c|)) = b + c"</p>
<p>This is the error:</p>
<p>exception THM 0 raised (line 755 of "drule.ML"):<br>
   infer_instantiate_types: type ?'z extended_record_scheme of variable <br>
?r<br>
   cannot be unified with type (|t3 :: nat|) of term _av4<br>
   (⋀t1 t2 t3 more. ?r = (|t1 = t1, t2 = t2, t3 = t3, … = more|) ⟹ ?C) ⟹ <br>
?C</p>
<p>I tried to define the function in different ways, for example using "'a <br>
extended_record_scheme"<br>
instead of "extended_record" or adding the "more" field explicitly, but <br>
I always get the same error.<br>
I also tried pattern matching with "case … of", but it doesn't work, <br>
because record is not a datatype constructor.</p>
<p>Obviously I could define the function like this:</p>
<p>fun test4 :: "extended_record =&gt; nat"<br>
  where<br>
     "test4 rec = t2 rec + t3 rec"</p>
<p>But given that I am working with larger records and more complicated <br>
functions, I was wondering if there is a more<br>
elegant way to write this function, by using pattern matching.</p>
<p>Thank you,<br>
Rebecca</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>