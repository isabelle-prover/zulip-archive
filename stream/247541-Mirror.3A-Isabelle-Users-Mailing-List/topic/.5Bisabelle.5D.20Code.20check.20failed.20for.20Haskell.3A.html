<html>
<head><meta charset="utf-8"><title>[isabelle] Code check failed for Haskell: · Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Code.20check.20failed.20for.20Haskell.3A.html">[isabelle] Code check failed for Haskell:</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="491106452"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Code%20check%20failed%20for%20Haskell%3A/near/491106452" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Code.20check.20failed.20for.20Haskell.3A.html#491106452">(Dec 28 2024 at 17:14)</a>:</h4>
<p>From: Tobias Nipkow &lt;<a href="mailto:nipkow@in.tum.de">nipkow@in.tum.de</a>&gt;<br>
When building AFP/devel/Collections:</p>
<p>Collections FAILED (see also "isabelle build_log -H Error Collections")<br>
*** Code check failed for Haskell: "$ISABELLE_GHC" -XEmptyDataDecls -XRankNTypes <br>
-XScopedTypeVariables -odir build -hidir build -stubdir build -e "" <br>
Generated_Code.hs<br>
*** At command "export_code" (line 90 of <br>
"$AFP/Collections/ICF/tools/Locale_Code_Ex.thy")<br>
*** Code check failed for Haskell: "$ISABELLE_GHC" -XEmptyDataDecls -XRankNTypes <br>
-XScopedTypeVariables -odir build -hidir build -stubdir build -e "" <br>
Generated_Code.hs<br>
*** At command "export_code" (line 1095 of "$AFP/Collections/Lib/Diff_Array.thy")</p>
<p>What is happening here? How can I avoid this?</p>
<p>I am on AFP c69ba7047b69 and isabelle 4219bb3951de</p>
<p>Thanks<br>
Tobias</p>
<p>PS I know isabelle-dev is the correct destination but I am having problems with <br>
that one.</p>
<p><a href="/user_uploads/14278/45EuyC0mPaW3eoDx2sg_sMrJ/smime.p7s">smime.p7s</a></p>



<a name="491118475"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Code%20check%20failed%20for%20Haskell%3A/near/491118475" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Code.20check.20failed.20for.20Haskell.3A.html#491118475">(Dec 28 2024 at 20:36)</a>:</h4>
<p>From: Tobias Nipkow &lt;<a href="mailto:nipkow@in.tum.de">nipkow@in.tum.de</a>&gt;<br>
Florian,</p>
<p>That seems to have been the problem. I have backed out that changeset and pushed <br>
that.</p>
<p>Tobias</p>
<p>On 28/12/2024 19:09, Florian Haftmann wrote:</p>
<blockquote>
<p>Hi Tobias,</p>
<p>Am 28.12.24 um 18:13 schrieb Tobias Nipkow:</p>
<blockquote>
<p>When building AFP/devel/Collections:</p>
<p>Collections FAILED (see also "isabelle build_log -H Error Collections")<br>
*** Code check failed for Haskell: "$ISABELLE_GHC" -XEmptyDataDecls - <br>
XRankNTypes -XScopedTypeVariables -odir build -hidir build -stubdir build -e <br>
"" Generated_Code.hs<br>
*** At command "export_code" (line 90 of "$AFP/Collections/ICF/tools/ <br>
Locale_Code_Ex.thy")<br>
*** Code check failed for Haskell: "$ISABELLE_GHC" -XEmptyDataDecls - <br>
XRankNTypes -XScopedTypeVariables -odir build -hidir build -stubdir build -e <br>
"" Generated_Code.hs<br>
*** At command "export_code" (line 1095 of "$AFP/Collections/Lib/ <br>
Diff_Array.thy")</p>
<p>What is happening here? How can I avoid this?</p>
<p>I am on AFP c69ba7047b69 and isabelle 4219bb3951de</p>
</blockquote>
<p>it might be related to some extension I made recently in <a href="https://isabelle-">https://isabelle-</a> <br>
<a href="http://dev.sketis.net/rISABELLE0ca0a47235e53ec93bce681e2a149726b829db61">dev.sketis.net/rISABELLE0ca0a47235e53ec93bce681e2a149726b829db61</a> – although <br>
isabelle build_task reported no issues (maybe I accidentally checked the wrong <br>
points in history?).</p>
<p>Unfortunately I am currently away from anything and can’t check myself what’s <br>
going on. Feel free to back out the changeset 0ca0a47235e5 (hg backout) and if <br>
that helps, push that also.</p>
<blockquote>
<p>PS I know isabelle-dev is the correct destination but I am having problems <br>
with that one.</p>
</blockquote>
<p>Me too, I made a new account using my @cit.tum.de mail address. Maybe this is <br>
related of the enforced turning down of well-established domains like <br>
informatik.tu-muenchen.de…</p>
<p>Cheers,<br>
     Florian<br>
</p>
</blockquote>
<p><a href="/user_uploads/14278/a_FN6Rs18CTD7OfZmOx_G76y/smime.p7s">smime.p7s</a></p>



<a name="492001704"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Code%20check%20failed%20for%20Haskell%3A/near/492001704" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Code.20check.20failed.20for.20Haskell.3A.html#492001704">(Jan 05 2025 at 21:55)</a>:</h4>
<p>From: Florian Haftmann &lt;<a href="mailto:florian.haftmann@cit.tum.de">florian.haftmann@cit.tum.de</a>&gt;<br>
Hi Tobias,</p>
<p>Am 28.12.24 um 18:13 schrieb Tobias Nipkow:</p>
<blockquote>
<p>When building AFP/devel/Collections:</p>
<p>Collections FAILED (see also "isabelle build_log -H Error Collections")<br>
*** Code check failed for Haskell: "$ISABELLE_GHC" -XEmptyDataDecls - <br>
XRankNTypes -XScopedTypeVariables -odir build -hidir build -stubdir <br>
build -e "" Generated_Code.hs<br>
*** At command "export_code" (line 90 of "$AFP/Collections/ICF/tools/ <br>
Locale_Code_Ex.thy")<br>
*** Code check failed for Haskell: "$ISABELLE_GHC" -XEmptyDataDecls - <br>
XRankNTypes -XScopedTypeVariables -odir build -hidir build -stubdir <br>
build -e "" Generated_Code.hs<br>
*** At command "export_code" (line 1095 of "$AFP/Collections/Lib/ <br>
Diff_Array.thy")</p>
<p>What is happening here? How can I avoid this?</p>
<p>I am on AFP c69ba7047b69 and isabelle 4219bb3951de</p>
</blockquote>
<p>it might be related to some extension I made recently in <br>
<a href="https://isabelle-dev.sketis.net/rISABELLE0ca0a47235e53ec93bce681e2a149726b829db61">https://isabelle-dev.sketis.net/rISABELLE0ca0a47235e53ec93bce681e2a149726b829db61</a> <br>
– although isabelle build_task reported no issues (maybe I accidentally <br>
checked the wrong points in history?).</p>
<p>Unfortunately I am currently away from anything and can’t check myself <br>
what’s going on. Feel free to back out the changeset 0ca0a47235e5 (hg <br>
backout) and if that helps, push that also.</p>
<blockquote>
<p>PS I know isabelle-dev is the correct destination but I am having <br>
problems with that one.</p>
</blockquote>
<p>Me too, I made a new account using my @cit.tum.de mail address. Maybe <br>
this is related of the enforced turning down of well-established domains <br>
like informatik.tu-muenchen.de…</p>
<p>Cheers,<br>
    Florian</p>
<p><a href="/user_uploads/14278/R8SfGxCLJdK9PSRWT6KeN1-9/OpenPGP_0xA707172232CFA4E9.asc">OpenPGP_0xA707172232CFA4E9.asc</a><br>
<a href="/user_uploads/14278/cMV5WbuthBmak61YZ3wVTk6f/OpenPGP_signature.asc">OpenPGP_signature.asc</a></p>



<a name="492283530"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Code%20check%20failed%20for%20Haskell%3A/near/492283530" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Code.20check.20failed.20for.20Haskell.3A.html#492283530">(Jan 07 2025 at 10:37)</a>:</h4>
<p>From: Fabian Huch &lt;<a href="mailto:huch@in.tum.de">huch@in.tum.de</a>&gt;</p>
<blockquote>
<blockquote>
<p>Collections FAILED (see also "isabelle build_log -H Error Collections")<br>
*** Code check failed for Haskell: "$ISABELLE_GHC" -XEmptyDataDecls - <br>
XRankNTypes -XScopedTypeVariables -odir build -hidir build -stubdir <br>
build -e "" Generated_Code.hs<br>
*** At command "export_code" (line 90 of "$AFP/Collections/ICF/tools/ <br>
Locale_Code_Ex.thy")<br>
*** Code check failed for Haskell: "$ISABELLE_GHC" -XEmptyDataDecls - <br>
XRankNTypes -XScopedTypeVariables -odir build -hidir build -stubdir <br>
build -e "" Generated_Code.hs<br>
*** At command "export_code" (line 1095 of "$AFP/Collections/Lib/ <br>
Diff_Array.thy") <br>
isabelle build_task reported no issues (maybe I accidentally checked <br>
the wrong points in history?).</p>
</blockquote>
</blockquote>
<p>Note that clusterized builds do not have a Haskell environment, because <br>
the underlying Build_Cluster does not support remote *_setup operations <br>
for its nodes yet (and would ignore these components even if set up by <br>
hand). This means that such code checks will be skipped (cf. the <br>
'undefined ISABELLE_GHC' warnings in the log).</p>
<p>Fabian</p>



<a name="492327064"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Code%20check%20failed%20for%20Haskell%3A/near/492327064" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Code.20check.20failed.20for.20Haskell.3A.html#492327064">(Jan 07 2025 at 15:05)</a>:</h4>
<p>From: Fabian Huch &lt;<a href="mailto:huch@in.tum.de">huch@in.tum.de</a>&gt;</p>
<p>On 1/7/25 11:29, Fabian Huch wrote:</p>
<blockquote>
<blockquote>
<blockquote>
<p>Collections FAILED (see also "isabelle build_log -H Error Collections")<br>
*** Code check failed for Haskell: "$ISABELLE_GHC" -XEmptyDataDecls <br>
- XRankNTypes -XScopedTypeVariables -odir build -hidir build <br>
-stubdir build -e "" Generated_Code.hs<br>
*** At command "export_code" (line 90 of <br>
"$AFP/Collections/ICF/tools/ Locale_Code_Ex.thy")<br>
*** Code check failed for Haskell: "$ISABELLE_GHC" -XEmptyDataDecls <br>
- XRankNTypes -XScopedTypeVariables -odir build -hidir build <br>
-stubdir build -e "" Generated_Code.hs<br>
*** At command "export_code" (line 1095 of "$AFP/Collections/Lib/ <br>
Diff_Array.thy") <br>
isabelle build_task reported no issues (maybe I accidentally checked <br>
the wrong points in history?).</p>
</blockquote>
</blockquote>
<p>Note that clusterized builds do not have a Haskell environment, <br>
because the underlying Build_Cluster does not support remote *_setup <br>
operations for its nodes yet (and would ignore these components even <br>
if set up by hand). This means that such code checks will be skipped <br>
(cf. the 'undefined ISABELLE_GHC' warnings in the log).</p>
</blockquote>
<p>Correction, now that the server is back online: There is indeed a <br>
manually set up ISABELLE_GHC on there, since this one only depends on <br>
accidental file system state -- other components (e.g. ISABELLE_GO) <br>
require explicit management.</p>
<p>Fabian</p>



<a name="492337696"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Code%20check%20failed%20for%20Haskell%3A/near/492337696" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Code.20check.20failed.20for.20Haskell.3A.html#492337696">(Jan 07 2025 at 15:58)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On 07/01/2025 16:05, Fabian Huch wrote:</p>
<blockquote>
<blockquote>
<p>Note that clusterized builds do not have a Haskell environment, because the <br>
underlying Build_Cluster does not support remote *_setup operations for its <br>
nodes yet (and would ignore these components even if set up by hand). This <br>
means that such code checks will be skipped (cf. the 'undefined <br>
ISABELLE_GHC' warnings in the log).</p>
</blockquote>
<p>Correction, now that the server is back online: There is indeed a manually set <br>
up ISABELLE_GHC on there, since this one only depends on accidental file <br>
system state -- other components (e.g. ISABELLE_GO) require explicit management.</p>
</blockquote>
<p>First note, that my plan for Isabelle2025-RC1 is to provide the missing <br>
Other_Isabelle operations to do "isabelle go_setup" or "isabelle ghc_setup" on <br>
the target environment, in a way that works for historic versions, too.</p>
<p>Further, I wonder what the uninformative test by Florian really looked like, <br>
and if there were other reasons for the problem.</p>
<p>Many years ago, when we came up with the "isabelle ghc_setup" plan via <br>
"stack", the overall prospect was more optimistic. In the meantime I've see <br>
too many odd failures: the setup is not as well-defined or "statically <br>
closed", as it should be. (GHC/Stack is much better than OCaml/OPAM, though.)</p>
<p>Makarius</p>



<a name="492374402"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Code%20check%20failed%20for%20Haskell%3A/near/492374402" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Code.20check.20failed.20for.20Haskell.3A.html#492374402">(Jan 07 2025 at 19:37)</a>:</h4>
<p>From: Florian Haftmann &lt;<a href="mailto:florian.haftmann@cit.tum.de">florian.haftmann@cit.tum.de</a>&gt;</p>
<blockquote>
<blockquote>
<p>Note that clusterized builds do not have a Haskell environment, <br>
because the underlying Build_Cluster does not support remote *_setup <br>
operations for its nodes yet (and would ignore these components even <br>
if set up by hand). This means that such code checks will be skipped <br>
(cf. the 'undefined ISABELLE_GHC' warnings in the log).</p>
</blockquote>
<p>Correction, now that the server is back online: There is indeed a <br>
manually set up ISABELLE_GHC on there, since this one only depends on <br>
accidental file system state -- other components (e.g. ISABELLE_GO) <br>
require explicit management.</p>
</blockquote>
<p>My check was to leave out the question mark after Haskell in</p>
<p><a href="https://isabelle.in.tum.de/repos/isabelle/file/tip/src/HOL/Codegenerator_Test/Generate.thy#l18">https://isabelle.in.tum.de/repos/isabelle/file/tip/src/HOL/Codegenerator_Test/Generate.thy#l18</a></p>
<p>and schedule that as build task.</p>
<p>Now with that background information I am aware that this just worked by <br>
accident.</p>
<p>So for the moment I will apply traditional build-all if needed.</p>
<p>Cheers,<br>
    Florian</p>
<p><a href="/user_uploads/14278/BHMUEyLntXTy7uIliKdoXhce/OpenPGP_0xA707172232CFA4E9.asc">OpenPGP_0xA707172232CFA4E9.asc</a><br>
<a href="/user_uploads/14278/bpPl83_QleivwXfRiolTYhe8/OpenPGP_signature.asc">OpenPGP_signature.asc</a></p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>