<html>
<head><meta charset="utf-8"><title>[isabelle] Isabelle2023-RC2: Sledgehammer prioritized ove... · Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2023-RC2.3A.20Sledgehammer.20prioritized.20ove.2E.2E.2E.html">[isabelle] Isabelle2023-RC2: Sledgehammer prioritized ove...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="379985741"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2023-RC2%3A%20Sledgehammer%20prioritized%20ove.../near/379985741" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2023-RC2.3A.20Sledgehammer.20prioritized.20ove.2E.2E.2E.html#379985741">(Jul 30 2023 at 10:17)</a>:</h4>
<p>From: Dominique Unruh &lt;<a href="mailto:cl-isabelle-users@lists.cam.ac.uk">cl-isabelle-users@lists.cam.ac.uk</a>&gt;<br>
Hello,</p>
<p>in RC2 (and also prior RCs), when I run sledgehammer (as a command), <br>
then Isabelle uses all available threads to do the sledgehammer, without <br>
continuing to parse the document after the sledgehammer.</p>
<p>The following example (also attached as a .thy) illustrates this:</p>
<p>Until the sledgehammer is finished, nothing happens in the rest of the <br>
proof.</p>
<p>In Isabelle 2022, the behavior was different (on the same system). Even <br>
with a sledgehammer command still running, parsing of the rest of the <br>
document would continue. Even methods would be evaluated (e.g., apply <br>
simp etc.) albeit a bit slower.</p>
<p>The previous behavior was highly convenient: It was possible leave <br>
sledgehammer running on some subgoals while already working on the goals <br>
below, considerably speeding up the proof and removing idle times.</p>
<p><a href="/user_uploads/14278/XPNYwdUBpUw6BjuIlGdqQ3-V/VyA8ivCdj4PBBrnA.png">VyA8ivCdj4PBBrnA.png</a><br>
<a href="/user_uploads/14278/SQP2bl_JYVwPzUEKFIzZyOIx/Scratch.thy">Scratch.thy</a></p>
<div class="message_inline_image"><a href="/user_uploads/14278/XPNYwdUBpUw6BjuIlGdqQ3-V/VyA8ivCdj4PBBrnA.png" title="VyA8ivCdj4PBBrnA.png"><img src="/user_uploads/14278/XPNYwdUBpUw6BjuIlGdqQ3-V/VyA8ivCdj4PBBrnA.png"></a></div>



<a name="380222881"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2023-RC2%3A%20Sledgehammer%20prioritized%20ove.../near/380222881" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2023-RC2.3A.20Sledgehammer.20prioritized.20ove.2E.2E.2E.html#380222881">(Jul 31 2023 at 07:36)</a>:</h4>
<p>From: Jasmin Blanchette &lt;<a href="mailto:jasmin.blanchette@ifi.lmu.de">jasmin.blanchette@ifi.lmu.de</a>&gt;<br>
Dear Dominique,</p>
<p>I wasn't aware of the back-and-forth of behavior you are describing. I suspect the behavior is originating from Isabelle/PIDE, because even when the user invokes Sledgehammer with the "dont_slice" option (which instructs Sledgehammer to use only one thread), with recent development versions processing does not continue. This is the behavior I'm familiar with, but I can see why the other behavior is useful.</p>
<p>Have you tried the Sledgehammer panel? It should allow you to continue with your proof. (If you prefer the command to the panel, I'd be curious to hear why.)</p>
<p>Best,<br>
Jasmin</p>



<a name="380234055"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2023-RC2%3A%20Sledgehammer%20prioritized%20ove.../near/380234055" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2023-RC2.3A.20Sledgehammer.20prioritized.20ove.2E.2E.2E.html#380234055">(Jul 31 2023 at 08:13)</a>:</h4>
<p>From: Dominique Unruh &lt;<a href="mailto:cl-isabelle-users@lists.cam.ac.uk">cl-isabelle-users@lists.cam.ac.uk</a>&gt;<br>
Dear Jasmin,</p>
<p>indeed, the panel seems to block the processing less for some reason. <br>
(It's hard to tell whether the amount of blocking is the same as it was <br>
in 2022, but at least processing continues.)</p>
<p>I have stopped using the panel at some point and started using the <br>
command because the following workflow enables a very fast use of <br>
sledgehammer that the panel cannot keep up with:</p>
<p>* I write my Isar proof steps one by one (e.g., have "..." also have<br>
    "..." also have "..." etc.)</p>
<p>* After each proof step, I insert a sledgehammer command (via<br>
    configured abbreviation /sl//ctrl-;/ which inserts three lines /try0<br>
    sledgehammer by -///).</p>
<p>* In steps that sledgehammer cannot process, I can also add some<br>
    method calls before the sledgehammer command.</p>
<p>The advantages of this:</p>
<p>* I can start several sledgehammers at once. Of course, only I have a<br>
    very powerful machine they will be processed one by one anyway, but<br>
    at least I don't need to manually trigger one when the previous<br>
    finishes as I would do with the panel.</p>
<p>* I can see due to the coloring which ones have finished.<br>
  * Should I notice a problem with some proof step higher up  and fix<br>
    it, the sledgehammers of steps below it will restart automatically,<br>
    I don't need to restart them as I would with the panel.</p>
<p>* For changes that break a bunch of proof steps throughout the theory<br>
    (e.g., minor change in a definition), it is a highly efficient<br>
    process to first go through all broken steps and put the<br>
    sledgehammer command there, go away for a while, and then come back<br>
    when all is done and see which steps need manual attention.<br>
    (Important: go through the finished sledgehammers last-to-first,<br>
    otherwise all the others restart.)</p>
<p>It may sound a little complicated, but this workflow speeds things up a <br>
lot for heavy sledgehammer use. It would be quite sad if the blocking <br>
behavior of the sledgehammer command would be permanent... I understand <br>
too little of PIDE to see how it happens.</p>
<p>Best wishes,<br>
Dominique.</p>



<a name="380239341"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2023-RC2%3A%20Sledgehammer%20prioritized%20ove.../near/380239341" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2023-RC2.3A.20Sledgehammer.20prioritized.20ove.2E.2E.2E.html#380239341">(Jul 31 2023 at 08:28)</a>:</h4>
<p>From: Peter Lammich &lt;<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>&gt;<br>
I'm indeed using a very similar workflow, copying in lines of the form</p>
<p>subgoal sledgehammer sorry</p>
<p>into my apply scripts, getting myself a coffee, and then see how many <br>
goals I still have to solve myself. Very useful on subgoals prodcued <br>
from verification condition generators. (The ideal feature here would be <br>
an option to sledgehammer to stop processing as soon as the first proof <br>
has been found)</p>



<a name="380250894"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2023-RC2%3A%20Sledgehammer%20prioritized%20ove.../near/380250894" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2023-RC2.3A.20Sledgehammer.20prioritized.20ove.2E.2E.2E.html#380250894">(Jul 31 2023 at 09:01)</a>:</h4>
<p>From: Jasmin Blanchette &lt;<a href="mailto:jasmin.blanchette@ifi.lmu.de">jasmin.blanchette@ifi.lmu.de</a>&gt;<br>
Hi Peter,</p>
<p>Have you tried "sledgehammer [max_proofs = 1]"? You can also set it once and for all globally as</p>
<p>sledgehammer_params [max_proofs = 1]</p>
<p>in your theory file.</p>
<p>Best,<br>
Jasmin</p>



<a name="380336899"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2023-RC2%3A%20Sledgehammer%20prioritized%20ove.../near/380336899" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2023-RC2.3A.20Sledgehammer.20prioritized.20ove.2E.2E.2E.html#380336899">(Jul 31 2023 at 13:10)</a>:</h4>
<p>From: Peter Lammich &lt;<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>&gt;<br>
Addendum:</p>
<p>I also observe the reported blocking behaviour in my workflow. In 2022, <br>
Isabelle would process about four "subgoal sledgehammer sorry" lines in <br>
parallel, while they are now processed one by one.</p>
<p>This is a regression against 2022 (at least for my main-usage pattern of <br>
sledgehammer)</p>
<p>Also parameters like [dont_slice, max_proofs=1] have no effect any more. <br>
In the below example, 2022 would process all subgoals in parallel, while <br>
2023 goes through them one-by-one, utilizing only one thread.</p>



<a name="380984913"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2023-RC2%3A%20Sledgehammer%20prioritized%20ove.../near/380984913" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2023-RC2.3A.20Sledgehammer.20prioritized.20ove.2E.2E.2E.html#380984913">(Aug 02 2023 at 10:37)</a>:</h4>
<p>From: Dominique Unruh &lt;<a href="mailto:cl-isabelle-users@lists.cam.ac.uk">cl-isabelle-users@lists.cam.ac.uk</a>&gt;<br>
Dear all,</p>
<p>one thing that maybe helps to narrow this down: The same effect happens <br>
with <em>try0</em>. It's harder to notice because <em>try0</em> usually is quite fast, <br>
but sometimes it does take several seconds. So it seems it is not <br>
something related to sledgehammer itself.</p>
<p>Best wishes,<br>
Dominique.</p>
<p><a href="/user_uploads/14278/KLsjM2cIrIi1wvu4YQGGxNDK/VyA8ivCdj4PBBrnA.png">VyA8ivCdj4PBBrnA.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/14278/KLsjM2cIrIi1wvu4YQGGxNDK/VyA8ivCdj4PBBrnA.png" title="VyA8ivCdj4PBBrnA.png"><img src="/user_uploads/14278/KLsjM2cIrIi1wvu4YQGGxNDK/VyA8ivCdj4PBBrnA.png"></a></div>



<a name="382361922"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2023-RC2%3A%20Sledgehammer%20prioritized%20ove.../near/382361922" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2023-RC2.3A.20Sledgehammer.20prioritized.20ove.2E.2E.2E.html#382361922">(Aug 06 2023 at 13:24)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
This sounds like another case for "hg bisect" together with isabelle/Admin/init</p>
<p>Without tangible evidence from the history, discussions make hardly any sense.</p>
<p>Makarius</p>



<a name="382553616"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2023-RC2%3A%20Sledgehammer%20prioritized%20ove.../near/382553616" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2023-RC2.3A.20Sledgehammer.20prioritized.20ove.2E.2E.2E.html#382553616">(Aug 07 2023 at 09:20)</a>:</h4>
<p>From: Peter Lammich &lt;<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>&gt;<br>
I get</p>
<p>The first bad revision is:<br>
changeset:   76406:40a365360680<br>
user:        wenzelm<br>
date:        Wed Nov 02 11:34:24 2022 +0100<br>
summary:     more accurate outer syntax keywords (see also <br>
94b2690ad494): base session could be anything, e.g. ZF vs. HOL;</p>
<p>Note that this is the same changeset that introduced the regression with <br>
proof state not being displayed!</p>
<p>Here's a summary if the regressions that have been reported, and the <br>
first bad revisions:</p>
<p>print-theorems displays too much: at 76813:92a547feec88<br>
no proof-state in Output after commands (other than lemma): 40a365360680<br>
sledgehammer blocks all threads: 76406:40a365360680</p>



<a name="383008378"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2023-RC2%3A%20Sledgehammer%20prioritized%20ove.../near/383008378" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2023-RC2.3A.20Sledgehammer.20prioritized.20ove.2E.2E.2E.html#383008378">(Aug 08 2023 at 16:02)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Yes, because 'sledgehammer' needs to be categorized as "diag" command in order <br>
to be made parallel by default.</p>
<p>So the change <br>
<a href="https://isabelle.sketis.net/repos/isabelle-release/rev/40d50936484c">https://isabelle.sketis.net/repos/isabelle-release/rev/40d50936484c</a> restores <br>
the parallel "subgoal sledgehammer [dont_slice,max_proofs=1] sorry" of yours.</p>
<p>I don't know of the other fine points that have been discussion on this thread <br>
have changed as well.</p>
<p>If someone wants to try the above release repository version and finds <br>
remaining regressions from Isabelle2022, then "hg bisect" will greatly help to <br>
sort it out.</p>
<p>(There are &lt; 48h left to produce Isabelle2023-RC3 and I am still busy in other <br>
corners.)</p>
<p>Makarius</p>



<a name="384011278"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2023-RC2%3A%20Sledgehammer%20prioritized%20ove.../near/384011278" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2023-RC2.3A.20Sledgehammer.20prioritized.20ove.2E.2E.2E.html#384011278">(Aug 11 2023 at 15:32)</a>:</h4>
<p>From: Dominique Unruh &lt;<a href="mailto:cl-isabelle-users@lists.cam.ac.uk">cl-isabelle-users@lists.cam.ac.uk</a>&gt;<br>
Hello,</p>
<p>I can confirm that the problem disappeared for me in RC3. :)</p>
<p>Best wishes,<br>
Dominique.</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>