<html>
<head><meta charset="utf-8"><title>[isabelle] exception Size raised (line 183 of &quot;./basis/Li... · Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20exception.20Size.20raised.20.28line.20183.20of.20.22.2E.2Fbasis.2FLi.2E.2E.2E.html">[isabelle] exception Size raised (line 183 of &quot;./basis/Li...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="518364122"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20exception%20Size%20raised%20%28line%20183%20of%20%22./basis/Li.../near/518364122" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20exception.20Size.20raised.20.28line.20183.20of.20.22.2E.2Fbasis.2FLi.2E.2E.2E.html#518364122">(May 15 2025 at 17:40)</a>:</h4>
<p>From: Peter Lammich &lt;<a href="mailto:cl-isabelle-users@lists.cam.ac.uk">cl-isabelle-users@lists.cam.ac.uk</a>&gt;<br>
Hi List,</p>
<p>an innocent print_codesetup (at the end of some sizeable development) <br>
will fail with exception Size raised (line 183 of <br>
"./basis/LibrarySupport.sml").</p>
<p>Just under Main it works fine. What is happening here? And can I still <br>
inspect the code setup?</p>
<p>Example:</p>
<p>theory Scratch<br>
imports Refine_Imperative_HOL.IICF (* from AFP *)<br>
begin</p>
<p>print_codesetup</p>
<p>(<em>exception Size raised (line 183 of "./basis/LibrarySupport.sml")</em>)<br>
end</p>
<p>--</p>
<p>Peter</p>



<a name="518366675"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20exception%20Size%20raised%20%28line%20183%20of%20%22./basis/Li.../near/518366675" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20exception.20Size.20raised.20.28line.20183.20of.20.22.2E.2Fbasis.2FLi.2E.2E.2E.html#518366675">(May 15 2025 at 17:54)</a>:</h4>
<p>From: Jan van Brügge &lt;<a href="mailto:jan@vanbruegge.de">jan@vanbruegge.de</a>&gt;<br>
Hi Peter,</p>
<p>this error is thrown when there is not enough memory for the ML process. <br>
By default Isabelle uses the 32-bit version of PolyML, so switching on <br>
the option "ML_system_64" should fix that.</p>
<p>Cheers,<br>
Jan</p>
<p>Am 15.05.25 um 18:39 schrieb Peter Lammich (via cl-isabelle-users <br>
Mailing List):</p>
<blockquote>
<p>Hi List,</p>
<p>an innocent print_codesetup (at the end of some sizeable development) <br>
will fail with exception Size raised (line 183 of <br>
"./basis/LibrarySupport.sml").</p>
<p>Just under Main it works fine. What is happening here? And can I still <br>
inspect the code setup?</p>
<p>Example:</p>
<p>theory Scratch<br>
imports Refine_Imperative_HOL.IICF (* from AFP *)<br>
begin</p>
<p>print_codesetup</p>
<p>(<em>exception Size raised (line 183 of "./basis/LibrarySupport.sml")</em>)<br>
end</p>
<p>-- </p>
<p>Peter</p>
</blockquote>



<a name="519621196"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20exception%20Size%20raised%20%28line%20183%20of%20%22./basis/Li.../near/519621196" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20exception.20Size.20raised.20.28line.20183.20of.20.22.2E.2Fbasis.2FLi.2E.2E.2E.html#519621196">(May 21 2025 at 14:03)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On 15/05/2025 19:39, Peter Lammich (via cl-isabelle-users Mailing List) wrote:</p>
<blockquote>
<p>Hi List,</p>
<p>an innocent print_codesetup (at the end of some sizeable development) will <br>
fail with exception Size raised (line 183 of "./basis/LibrarySupport.sml").</p>
<p>Just under Main it works fine. What is happening here? And can I still inspect <br>
the code setup?</p>
</blockquote>
<p>This problem is new in Isabelle2025, because that provides much more markup in <br>
pretty-printed output (types, terms, theorems etc.). You can avoid it by <br>
disabling most markup like this:</p>
<p>declare [[show_markup = false]]</p>
<p>The underlying problem is a size limit for Poly/ML strings, which is 64MB for <br>
the default 64_32 memory model. The limit is much larger for bulky 64 bit <br>
mode. So ML_system_64 = true in etc/preferences is an alternative approach.</p>
<p>In the meantime I have refined the situation in various respects. The <br>
non-scalability of print_codesetup is addressed here:</p>
<p>changeset:   82586:7415414bd9d8<br>
user:        wenzelm<br>
date:        Fri Apr 25 11:22:25 2025 +0200<br>
files:       src/HOL/Library/code_lazy.ML <br>
src/HOL/SPARK/Tools/spark_commands.ML <br>
src/HOL/Tools/Quickcheck/find_unused_assms.ML src/HOL/Tools/inductive.ML <br>
src/Provers/classical.ML src/Pure/General/pretty.ML src/Pure/Isar/attrib.ML <br>
src/Pure/Isar/bundle.ML src/Pure/Isar/calculation.ML src/Pure/Isar/class.ML <br>
src/Pure/Isar/code.ML src/Pure/Isar/context_rules.ML src/Pure/Isar/method.ML <br>
src/Pure/Isar/outer_syntax.ML src/Pure/Isar/proof_context.ML src/Pure/Pure.thy <br>
src/Pure/Syntax/syntax.ML src/Pure/Syntax/syntax_phases.ML <br>
src/Pure/Thy/document_antiquotation.ML src/Tools/Code/code_preproc.ML <br>
src/Tools/induct.ML src/Tools/subtyping.ML<br>
description:<br>
more scalable: discontinue odd shortcuts from 6b3739fee456, which produce <br>
bulky strings internally;</p>
<blockquote>
<p>Example:</p>
<p>theory Scratch<br>
imports Refine_Imperative_HOL.IICF (* from AFP *)<br>
begin</p>
<p>print_codesetup</p>
<p>(<em>exception Size raised (line 183 of "./basis/LibrarySupport.sml")</em>)<br>
end</p>
</blockquote>
<p>Just for fun, I have measured the size of the output in current <br>
Isabelle/b5b3082c9866 + AFP/d6aa42f2ef8d:</p>
<p>* show_markup = true: approx. 70MB<br>
   * show_markup = false: approx. 10MB</p>
<p>That shows that my old saying when introducing markup in pretty-printing some <br>
decades ago is still correct: "We don't print several GBs of text". Java <br>
String is actually limited by 1G, but both in Isabelle/ML and Isabelle/Scala <br>
the key types Pretty.T and XML.Tree are not limited by that. Transfer of <br>
messages now also works via Bytes.T, which can get very large.</p>
<p>The remaining problems are nostalgic (and usually pointless) uses of type <br>
string, like we have seen here.</p>
<p>Makarius</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>