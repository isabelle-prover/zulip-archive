<html>
<head><meta charset="utf-8"><title>[isabelle] Code equations for Rep in lift_definition with... · Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/index.html">Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Code.20equations.20for.20Rep.20in.20lift_definition.20with.2E.2E.2E.html">[isabelle] Code equations for Rep in lift_definition with...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="242443098"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Code%20equations%20for%20Rep%20in%20lift_definition%20with.../near/242443098" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Code.20equations.20for.20Rep.20in.20lift_definition.20with.2E.2E.2E.html#242443098">(Jun 12 2021 at 10:42)</a>:</h4>
<p>From: "C.A. Watt" &lt;<a href="mailto:caw77@cam.ac.uk">caw77@cam.ac.uk</a>&gt;<br>
Dear list</p>
<p>I am stuck trying to get an example to generate executable code. A <br>
stripped down version is attached. I define a type "my_nat", set up as a <br>
trivial quotient of nat. I lift a definition</p>
<p>definition all_zeros :: "nat list =&gt; bool"</p>
<p>to</p>
<p>lift_definition my_all_zeros :: "my_nat list =&gt; bool" is all_zeros .</p>
<p>When I attempt to export the code of the lifted function, I get the <br>
error "No code equations for Rep_my_nat".</p>
<p>It looks like this is caused by the code equation for my_all_zeros <br>
working out as</p>
<p>my_all_zeros ?xa ≡ all_zeros (map Rep_my_nat ?xa)</p>
<p>Is there a way to make code generation work with this quotient/lifting <br>
setup? I found the "code_dt" flag to lift_definition, which seems to be <br>
documented in isar-ref as dealing with something vaguely related, but it <br>
doesn't affect the behaviour here.</p>
<p>Best wishes<br>
Conrad Watt<br>
<a href="/user_uploads/14278/HDgTu9Fj6pmMrcFh-MFmOLl0/Test.thy">Test.thy</a></p>



<a name="242522656"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Code%20equations%20for%20Rep%20in%20lift_definition%20with.../near/242522656" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Code.20equations.20for.20Rep.20in.20lift_definition.20with.2E.2E.2E.html#242522656">(Jun 13 2021 at 17:56)</a>:</h4>
<p>From: "C.A. Watt" &lt;<a href="mailto:caw77@cam.ac.uk">caw77@cam.ac.uk</a>&gt;<br>
To follow up, Mark Wassell pointed out to me that changing the <br>
definition of my_nat to</p>
<p>typedef my_nat = "{ n :: nat . True }" by auto</p>
<p>causes code generation to work as expected. It seems that, as part of <br>
the above definition, a lemma</p>
<p>Rep_my_nat: "Rep_my_nat (Abs_my_nat ?x) ≡ ?x"</p>
<p>is generated and used as a code equation, allowing extraction to work.</p>
<p>The declaration in my original example</p>
<p>typedef my_nat = "UNIV :: (nat) set" ..</p>
<p>also causes a lemma of the same name to be generated, but of a very <br>
different form, which presumably can't be used as a code equation, hence <br>
my issues:</p>
<p>Rep_my_nat: "Rep_my_nat ?x \in UNIV"</p>
<p>If I prove the lemma generated by Mark's definition myself and declare <br>
it as [code], extraction works as desired. Does anyone have any insight <br>
as to why these two typedef forms have different behaviour here?</p>
<p>Best wishes<br>
Conrad</p>



<hr><p>Last updated: Jul 15 2022 at 23:21 UTC</p>
</html>