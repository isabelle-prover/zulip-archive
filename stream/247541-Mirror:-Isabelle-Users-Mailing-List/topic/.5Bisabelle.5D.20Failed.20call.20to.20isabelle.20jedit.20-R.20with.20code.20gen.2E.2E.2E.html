<html>
<head><meta charset="utf-8"><title>[isabelle] Failed call to isabelle jedit -R with code gen... · Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/index.html">Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Failed.20call.20to.20isabelle.20jedit.20-R.20with.20code.20gen.2E.2E.2E.html">[isabelle] Failed call to isabelle jedit -R with code gen...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="236307042"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Failed%20call%20to%20isabelle%20jedit%20-R%20with%20code%20gen.../near/236307042" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Failed.20call.20to.20isabelle.20jedit.20-R.20with.20code.20gen.2E.2E.2E.html#236307042">(Apr 27 2021 at 09:26)</a>:</h4>
<p>From: Jonathan Julián Huerta y Munive &lt;<a href="mailto:jonjulian23@gmail.com">jonjulian23@gmail.com</a>&gt;<br>
Hello,</p>
<p>When I try to do <code>isabelle jedit -R Some_Session_with_code_generation</code><br>
Isabelle fails to do the heap build and throws the following error:</p>
<div class="codehilite"><pre><span></span><code>Some_Session_with_code_generation FAILED
(see also
/Users/user/.isabelle/Isabelle2021/heaps/polyml-5.8.2_x86_64_32-darwin/log/Some_Session_with_code_generation)
*** Failed to load theory &quot;Some_Session_with_code_generation.Examples&quot;
(unresolved &quot;Some_Session_with_code_generation.Theory_with_Code&quot;)
*** Code check failed for OCaml: &quot;$ISABELLE_OCAMLFIND&quot; ocamlopt -w pu
-package zarith -linkpkg ROOT.ml &lt;/dev/null
*** At command &quot;export_code&quot; (line 42 of
&quot;~/.../thys/Some_Session_with_code_generation/Theory_with_Code.thy&quot;)
Some_Session_with_code_generation_requirements(Some_Session_with_code_generation)
CANCELLED
Unfinished session(s):
Some_Session_with_code_generation_requirements(Some_Session_with_code_generation)
Return code: 1 (ERROR)
</code></pre></div>
<p>Things that I have tried to not have the error:</p>
<ul>
<li>Doing <code>isabelle ocaml_setup</code> before <code>isabelle jedit -R ...</code></li>
<li>
<p>Changing manually ISABELLE_OCAMLFIND as suggested here:<br>
<a href="https://mailmanbroy.informatik.tu-muenchen.de/pipermail/isabelle-dev/2019-March/016793.html">https://mailmanbroy.informatik.tu-muenchen.de/pipermail/isabelle-dev/2019-March/016793.html</a></p>
</li>
<li>
<p>Changing manually ISABELLE_OCAML_VERSION to the latest ocaml as the ocaml<br>
people suggest an upgrade to the ocaml compiler (<br>
<a href="https://github.com/ocaml/opam-repository/issues/18586">https://github.com/ocaml/opam-repository/issues/18586</a>)</p>
</li>
</ul>
<p>As an average user, I'd appreciate any specific set of instructions to<br>
remove the error (my computer specifications appear in the github link).</p>
<p>Best wishes,</p>



<a name="236316490"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Failed%20call%20to%20isabelle%20jedit%20-R%20with%20code%20gen.../near/236316490" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Failed.20call.20to.20isabelle.20jedit.20-R.20with.20code.20gen.2E.2E.2E.html#236316490">(Apr 27 2021 at 10:57)</a>:</h4>
<p>From: Fabian Huch &lt;<a href="mailto:huch@in.tum.de">huch@in.tum.de</a>&gt;<br>
You might be missing some system packages, see <br>
<a href="https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2021-April/msg00007.html">https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2021-April/msg00007.html</a></p>
<p>I had the same issue after a major system update (with the packages <br>
installed), and it turned out that opam was broken -- removing the <br>
~/.opam folder and re-running ocaml_setup solved that for me.</p>
<p>Fabian</p>



<a name="236421336"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Failed%20call%20to%20isabelle%20jedit%20-R%20with%20code%20gen.../near/236421336" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Failed.20call.20to.20isabelle.20jedit.20-R.20with.20code.20gen.2E.2E.2E.html#236421336">(Apr 27 2021 at 22:42)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Your system is macOS Big Sur on Apple Silicon (ARM64), and the problem is<br>
ultimately to build OCaml (with zlib) on it, with or without opam.</p>
<p>Some years ago, I provided the "isabelle ocaml_setup" tool to simplify that<br>
process, but now I am unsure if that was actually a good idea: opam has too<br>
many implicit dependencies on the operating system and easily breaks.</p>
<p>I've briefly tried it on my Apple M1 test machine and failed on missing<br>
libgmp: so maybe it actually works after more tinkering. When doing the<br>
Isabelle2021 release some months ago, native OCaml was still not visible on<br>
the horizon.</p>
<p>If you do manage to build OCaml on arm64-darwin, I will take the result into<br>
account of the next Isabelle release --- presumably Nov/Dec-2021.</p>
<p>Makarius</p>



<a name="236421649"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Failed%20call%20to%20isabelle%20jedit%20-R%20with%20code%20gen.../near/236421649" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Failed.20call.20to.20isabelle.20jedit.20-R.20with.20code.20gen.2E.2E.2E.html#236421649">(Apr 27 2021 at 22:45)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
With "zarith", not "zlib".</p>
<p>Makarius</p>



<a name="236466273"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Failed%20call%20to%20isabelle%20jedit%20-R%20with%20code%20gen.../near/236466273" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Failed.20call.20to.20isabelle.20jedit.20-R.20with.20code.20gen.2E.2E.2E.html#236466273">(Apr 28 2021 at 08:02)</a>:</h4>
<p>From: Florian Märkl &lt;<a href="mailto:isabelle-users@florianmaerkl.de">isabelle-users@florianmaerkl.de</a>&gt;<br>
What works quite well on arm64 macOS is ocaml from MacPorts:<br>
<a href="https://ports.macports.org/port/ocaml">https://ports.macports.org/port/ocaml</a><br>
<a href="https://ports.macports.org/port/ocaml-zarith">https://ports.macports.org/port/ocaml-zarith</a><br>
<a href="https://ports.macports.org/port/opam">https://ports.macports.org/port/opam</a></p>
<p>I can recommend setting "buildfromsource always“ in /opt/local/etc/macports/macports.conf to force it to always build from source natively instead of trying to possibly fetch x86 binaries.</p>
<p>Their build scripts can also be used as a reference for building outside of MacPorts, for example:<br>
<a href="https://github.com/macports/macports-ports/blob/master/lang/ocaml/Portfile">https://github.com/macports/macports-ports/blob/master/lang/ocaml/Portfile</a></p>
<p>Though in this case it looks quite straightforward.</p>
<p>Florian</p>



<hr><p>Last updated: Jul 15 2022 at 23:21 UTC</p>
</html>