<html>
<head><meta charset="utf-8"><title>[isabelle] How do I set --maxheap greater than 16G on Linux? · Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/index.html">Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20How.20do.20I.20set.20--maxheap.20greater.20than.2016G.20on.20Linux.3F.html">[isabelle] How do I set --maxheap greater than 16G on Linux?</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="212892381"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20How%20do%20I%20set%20--maxheap%20greater%20than%2016G%20on%20Linux%3F/near/212892381" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20How.20do.20I.20set.20--maxheap.20greater.20than.2016G.20on.20Linux.3F.html#212892381">(Oct 10 2020 at 01:12)</a>:</h4>
<p>From: "Eugene W. Stark" &lt;<a href="mailto:isabelle-users@starkeffect.com">isabelle-users@starkeffect.com</a>&gt;<br>
I am using Ubuntu 18.04.  I am finding that the ML heap seems to be limited to 16G and I need to use<br>
a bit more.  I haven't really been able to find a comprehensible description of how to do this in<br>
the documentation I have looked at, so I attempted to follow the settings reported in the Jenkins<br>
nightly build logs, which seem to use --maxheap 20G.  I put the following in ~/.isabelle/etc/settings:</p>
<p>ML_PLATFORM="x86_64-linux"<br>
ML_SYSTEM="polyml-5.8.2"<br>
ML_OPTIONS="-H 4000 --maxheap 20G"</p>
<p>However, when I start Isabelle/JEdit I get the message shown below.  How can I get around this?<br>
Thanks for any help.</p>
<p>-- Gene Stark</p>
<p>Value of --maxheap option must not exceeed 16Gbytes<br>
-H &lt;Initial heap size (MB)&gt;<br>
--minheap &lt;Minimum heap size (MB)&gt;<br>
--maxheap &lt;Maximum heap size (MB)&gt;<br>
--gcpercent &lt;Target percentage time in GC (1-99)&gt;<br>
--stackspace &lt;Space to reserve for thread stacks and C++ heap(MB)&gt;<br>
--gcthreads &lt;Number of threads to use for garbage collection&gt;<br>
--debug &lt;Debug options: checkmem, gc, x&gt;<br>
--logfile &lt;Logging file (default is to log to stdout)&gt;<br>
--exportstats &lt;Enable another process to read the statistics&gt;<br>
Debug options:<br>
checkmem &lt;Perform additional debugging checks on memory&gt;<br>
gc &lt;Log summary garbage-collector information&gt;<br>
gcenhanced &lt;Log enhanced garbage-collector information&gt;<br>
gcdetail &lt;Log detailed garbage-collector information&gt;<br>
memmgr &lt;Memory manager information&gt;<br>
threads &lt;Thread related information&gt;<br>
gctasks &lt;Log multi-thread GC information&gt;<br>
heapsize &lt;Log heap resizing data&gt;<br>
x &lt;Log X-windows information&gt;<br>
sharing &lt;Information from PolyML.shareCommonData&gt;<br>
locks &lt;Information about contended locks&gt;<br>
rts &lt;General run-time system calls&gt;<br>
saving &lt;Saving and loading state; exporting&gt;<br>
HOL CANCELLED<br>
Unfinished session(s): HOL, Pure<br>
Return code: 1</p>
<p>Session build failed -- prover process remains inactive!</p>



<a name="212924297"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20How%20do%20I%20set%20--maxheap%20greater%20than%2016G%20on%20Linux%3F/near/212924297" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20How.20do.20I.20set.20--maxheap.20greater.20than.2016G.20on.20Linux.3F.html#212924297">(Oct 10 2020 at 16:57)</a>:</h4>
<p>From: "Eugene W. Stark" &lt;<a href="mailto:isabelle-users@starkeffect.com">isabelle-users@starkeffect.com</a>&gt;<br>
After reading various of the Isabelle settings and start-up scripts, and also some trial and error,<br>
I found that the following in my settings file produced the behavior I wanted:</p>
<p>ML_SYSTEM="polyml-5.8.1-20200228"<br>
ML_HOME=$ISABELLE_HOME/contrib/$ML_SYSTEM/x86_64-linux<br>
ML_OPTIONS="--maxheap 20G"<br>
ML_PLATFORM="x86_64-linux"</p>
<p>I don't have any idea whether this is the "right" way of doing it, though.</p>



<a name="215973829"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20How%20do%20I%20set%20--maxheap%20greater%20than%2016G%20on%20Linux%3F/near/215973829" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20How.20do.20I.20set.20--maxheap.20greater.20than.2016G.20on.20Linux.3F.html#215973829">(Nov 07 2020 at 21:14)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Did it work out for you? 20G for x86_64 is not so much, compared to 16G for<br>
x86_64_32 (where everything is more compact).</p>
<p>Note that the minimum setup works like this:</p>
<p>* $ISABELLE_HOME_USER/etc/settings:<br>
      ML_OPTIONS="--maxheap 20G"</p>
<p>* $ISABELLE_HOME_USER/etc/preferences:<br>
      ML_system_64 = true</p>
<p>If you have Isabelle/jEdit running, you can edit ML_system_64 in the Plugin<br>
Options dialog; on shutdown the preferences will be saved/overwritten.</p>
<p>Makarius</p>



<a name="215976066"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20How%20do%20I%20set%20--maxheap%20greater%20than%2016G%20on%20Linux%3F/near/215976066" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20How.20do.20I.20set.20--maxheap.20greater.20than.2016G.20on.20Linux.3F.html#215976066">(Nov 07 2020 at 22:14)</a>:</h4>
<p>From: "Eugene W. Stark" &lt;<a href="mailto:isabelle-users@starkeffect.com">isabelle-users@starkeffect.com</a>&gt;<br>
Thanks for the reply.</p>
<p>Yes, it did work out.  I was able to process the session in a reasonable amount of time<br>
with a heap limit of 20-22G.  The 16GB heap under x86_64_32 was no longer cutting the mustard.<br>
I replaced my existing 2x4GB DRAM with 2x8GB, to get a total of 32GB, which maxes out this<br>
motherboard.  It is a stretch to run Isabelle/JEdit on this system with a heap limit of more<br>
than about 22GB, because Java takes a few GB itself and thrashing starts to set in when the<br>
heap reaches the maximum.</p>
<p>I did notice that the "cold start" time on x86_64 was slower than on x86_64_32.  Perhaps this<br>
is because I didn't bother to set the minimum heap size.</p>
<p>If I start feeling rich due to all the money I am saving by not going anywhere or doing anything<br>
during the pandemic, I will build an i9 system to replace this 6-year-old i5 and put more memory<br>
on it.  But I am not there yet.</p>



<hr><p>Last updated: Jul 15 2022 at 23:21 UTC</p>
</html>