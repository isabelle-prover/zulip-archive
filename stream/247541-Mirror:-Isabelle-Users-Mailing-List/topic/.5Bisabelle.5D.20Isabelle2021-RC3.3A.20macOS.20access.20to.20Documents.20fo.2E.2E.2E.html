<html>
<head><meta charset="utf-8"><title>[isabelle] Isabelle2021-RC3: macOS access to Documents fo... · Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/index.html">Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html">[isabelle] Isabelle2021-RC3: macOS access to Documents fo...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="223836861"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2021-RC3%3A%20macOS%20access%20to%20Documents%20fo.../near/223836861" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html#223836861">(Jan 24 2021 at 21:37)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
There have been reports about problems accessing folders like "Desktop",<br>
"Documents", "Downloads" etc.</p>
<ul>
<li>
<p>When starting from the Terminal, e.g. as<br>
"<a href="http://Isabelle2021-RC3.app/Isabelle/bin/isabelle">Isabelle2021-RC3.app/Isabelle/bin/isabelle</a> jedit" an open operation in the<br>
editor will provoke a system security dialog on behalf of the <a href="http://Terminal.app">Terminal.app</a>.</p>
</li>
<li>
<p>When starting the <a href="http://Isabelle2021-RC3.app">Isabelle2021-RC3.app</a> directly in the finder, there is no<br>
such dialog, only an empty directory listing (e.g. in the file-open dialog).</p>
</li>
</ul>
<p>It looks like macOS is becoming more an more like a fortress.</p>
<p>Maybe some macOS exports know some ways out of this security nightmare.</p>
<p>Makarius</p>



<a name="223907379"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2021-RC3%3A%20macOS%20access%20to%20Documents%20fo.../near/223907379" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html#223907379">(Jan 25 2021 at 14:54)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
For some years now, I believe, MacOS has informed the user when a particular app seeks to access certain critical resources, including the folders you mention. This is to protect the user against malicious code. </p>
<p>It is only necessary to approve the access once for each app.</p>
<p>Larry</p>



<a name="223911771"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2021-RC3%3A%20macOS%20access%20to%20Documents%20fo.../near/223911771" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html#223911771">(Jan 25 2021 at 15:24)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
But this approval does not work: it is a consequence of my change to an older<br>
form of .app with a toplevel shell script, instead of actual executable. See<br>
<a href="https://isabelle-dev.sketis.net/rISABELLEa95f5ae5a12">https://isabelle-dev.sketis.net/rISABELLEa95f5ae5a12</a> and further changes on<br>
top of it.</p>
<p>The motivation was to make a hybrid app for Java x86_64-darwin and<br>
arm64-darwin (Apple Silicon).</p>
<p>It might have been better to ignore Apple Silicon for now --- I would also<br>
have preferred to ignore macOS Big Sur, but in the last consequence it would<br>
mean to ignore all of Apple (which has become the most powerful HW/SW tech<br>
giant on the planet).</p>
<p>Makarius</p>



<a name="223914571"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2021-RC3%3A%20macOS%20access%20to%20Documents%20fo.../near/223914571" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html#223914571">(Jan 25 2021 at 15:42)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
Interesting. What I am finding is different: I can read files on the Desktop and Downloads folders without granting permission. However, even if I use the System Preferences &gt; Security &amp; Privacy &gt; Privacy panel to grant “full disk access”, the app seems unable to see any files in the Documents folder. Weird but not a serious problem, if documented.</p>
<p>Larry</p>



<a name="223924183"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2021-RC3%3A%20macOS%20access%20to%20Documents%20fo.../near/223924183" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html#223924183">(Jan 25 2021 at 16:39)</a>:</h4>
<p>From: Frédéric Boulanger &lt;<a href="mailto:frederic.boulanger@lri.fr">frederic.boulanger@lri.fr</a>&gt;<br>
I am not sure if this could solve the M1/Big Sur issue, but I just tried to use an AppleScript exported as an Application to launch Isabelle, and the first time I try to open a file under "Documents", I am asked if I want to allow that, and the setting is remembered when I quit Isabelle and launch it again through the AppleScript App. The "applet" binary inside the exported Application has both x86_64 and arm64 architectures.</p>
<p>Here is the (simple) code I wrote to launch Isabelle :</p>
<p>on run do<br>
    set isabelle to the quoted form of POSIX path of "/Applications/Isabelle2021-RC3.app/Contents/Resources/Isabelle2021-RC3/bin/isabelle"<br>
    do shell script isabelle &amp; " jedit"<br>
end run</p>
<p>on open (dropedItems)<br>
    set isabelle to the quoted form of POSIX path of "/Applications/Isabelle2021-RC3.app/Contents/Resources/Isabelle2021-RC3/bin/isabelle"<br>
    set myFiles to " "<br>
    repeat with f in dropedItems<br>
        set myFiles to myFiles &amp; " " &amp; the quoted form of POSIX path of f<br>
    end repeat<br>
    do shell script isabelle &amp; " jedit" &amp; myFiles<br>
end open</p>
<p>The "open" handler is useful for opening files when launching Isabelle, but this is too basic to handle files dropped on the application while Isabelle is already running.</p>
<p>Frédéric</p>
<p>Frédéric Boulanger<br>
CentraleSupélec - Département Informatique  Laboratoire Méthodes Formelles (LMF)<br>
3 rue Joliot-Curie, 91192 Gif-sur-Yvette cedex  Bât. 650 - 1 rue Raimond Castaing, 91190 Gif-sur-Yvette<br>
+33 [0]1 69 85 14 84</p>



<a name="223924910"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2021-RC3%3A%20macOS%20access%20to%20Documents%20fo.../near/223924910" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html#223924910">(Jan 25 2021 at 16:44)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
Remark: The existing Isabelle Mac App already provides some basic Mac-like functionality, but it would be great to see it upgraded with code such as this. Though maybe not in time for 2021 :-(</p>
<p>Larry</p>



<a name="223926408"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2021-RC3%3A%20macOS%20access%20to%20Documents%20fo.../near/223926408" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html#223926408">(Jan 25 2021 at 16:54)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
The formal task is now <a href="https://isabelle-dev.sketis.net/T37">https://isabelle-dev.sketis.net/T37</a> --- I have also<br>
added some links to discussions about this problems for Fontforge, Gimp, Inkscape.</p>
<p>This was first reported almost 1 year ago, so there is an indication that<br>
Apple does not care about Unix-style shell script apps.</p>
<p>Makarius</p>



<a name="224016617"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2021-RC3%3A%20macOS%20access%20to%20Documents%20fo.../near/224016617" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html#224016617">(Jan 26 2021 at 09:48)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
Today I tried a different experiment: to access the Documents folder (which I seldom normally use) from Isabelle2020. I got the expected pop-up, clicked okay and finally was able to open a theory file I had put there. With the Isabelle2021 release candidate however, there was no pop-up and the Documents folder was displayed as empty.</p>
<p>This difference is odd given that the application bundles are surely produced from the Isabelle sources in the same way, but I did notice major differences in the respective copies of info.plist and conceivably something like that is where the explanation lies.</p>
<p>Larry</p>



<a name="224019028"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2021-RC3%3A%20macOS%20access%20to%20Documents%20fo.../near/224019028" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html#224019028">(Jan 26 2021 at 10:15)</a>:</h4>
<p>From: Frédéric Boulanger &lt;<a href="mailto:frederic.boulanger@lri.fr">frederic.boulanger@lri.fr</a>&gt;<br>
This difference comes from the fact that what is executed when you launch the RC is a shell script (/Applications/Isabelle2021-RC3.app/Isabelle2021-RC3), while it is a Mach-O executable in the case of Isabelle2020 (/Applications/Isabelle2020.app/Contents/MacOS/JavaAppLauncher). It seems that MacOS does not handle authorizations in the same way for scripts and for binary executables.</p>
<p>If I remember well, when you start Isabelle in the terminal using "isabelle jedit", the authorization to access the "Documents" folder is given to the Terminal application, not to the isabelle shell script.</p>
<p>Frédéric</p>
<p>Frédéric Boulanger<br>
CentraleSupélec - Département Informatique  Laboratoire Méthodes Formelles (LMF)<br>
3 rue Joliot-Curie, 91192 Gif-sur-Yvette cedex  Bât. 650 - 1 rue Raimond Castaing, 91190 Gif-sur-Yvette<br>
+33 [0]1 69 85 14 84</p>



<a name="224024038"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2021-RC3%3A%20macOS%20access%20to%20Documents%20fo.../near/224024038" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html#224024038">(Jan 26 2021 at 11:08)</a>:</h4>
<p>From: Jakub Kądziołka &lt;<a href="mailto:kuba@kadziolka.net">kuba@kadziolka.net</a>&gt;<br>
On Mon Jan 25, 2021 at 5:38 PM CET, Frédéric Boulanger wrote:</p>
<blockquote>
<p>Here is the (simple) code I wrote to launch Isabelle :</p>
<p>on run do<br>
  set isabelle to the quoted form of POSIX path of "/Applications/Isabelle2021-RC3.app/Contents/Resources/Isabelle2021-RC3/bin/isabelle"<br>
  do shell script isabelle &amp; " jedit"<br>
end run</p>
<p>on open (dropedItems)</p>
</blockquote>
<p>Is this typo (droped with a single p) a part of the Apple API, or would<br>
it be possible to correct it?</p>
<blockquote>
<p>set isabelle to the quoted form of POSIX path of "/Applications/Isabelle2021-RC3.app/Contents/Resources/Isabelle2021-RC3/bin/isabelle"<br>
  set myFiles to " "<br>
  repeat with f in dropedItems<br>
      set myFiles to myFiles &amp; " " &amp; the quoted form of POSIX path of f<br>
  end repeat<br>
  do shell script isabelle &amp; " jedit" &amp; myFiles<br>
end open</p>
</blockquote>
<p>Regards,<br>
Jakub Kądziołka</p>



<a name="224031449"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2021-RC3%3A%20macOS%20access%20to%20Documents%20fo.../near/224031449" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html#224031449">(Jan 26 2021 at 12:29)</a>:</h4>
<p>From: Frédéric Boulanger &lt;<a href="mailto:frederic.boulanger@lri.fr">frederic.boulanger@lri.fr</a>&gt;<br>
Just a typo. It is just the name of the argument on the "open" handler, you can use any valid identifier.</p>
<p>See <a href="https://help.apple.com/applescript/mac/10.9/#apscrpt1131">https://help.apple.com/applescript/mac/10.9/#apscrpt1131</a> &lt;<a href="https://help.apple.com/applescript/mac/10.9/#apscrpt1131">https://help.apple.com/applescript/mac/10.9/#apscrpt1131</a>&gt;</p>
<p>Best regards,<br>
Frédéric</p>
<p>Frédéric Boulanger<br>
CentraleSupélec - Département Informatique  Laboratoire Méthodes Formelles (LMF)<br>
3 rue Joliot-Curie, 91192 Gif-sur-Yvette cedex  Bât. 650 - 1 rue Raimond Castaing, 91190 Gif-sur-Yvette<br>
+33 [0]1 69 85 14 84</p>



<a name="224061273"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2021-RC3%3A%20macOS%20access%20to%20Documents%20fo.../near/224061273" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html#224061273">(Jan 26 2021 at 16:06)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Yes, the new shell script is an indirect consequence of of supporting both<br>
arm64-darwin and x86_64-darwin while replacing Adopt OpenJDK by Zulu OpenJDK.</p>
<p>Afterwards the old JavaAppLauncher stopped working: it refers to a particular<br>
shared library of Java, which is unlikely to be able to change from x86_64 to<br>
arm64 on the spot.</p>
<p>In contrast, the Rosetta 2 system is able to run x86_64 Java, but it is one<br>
level of extra indirection: JVM-bytecode translation followed by x86_64<br>
machine code translation. I wanted to reduce this insanity a bit by using<br>
native arm64 JDK.</p>
<p>In the space of possibilities there are surely other points of stability ---<br>
like the Apple Script app or maybe just a plain C app wrapper like we have for<br>
Linux:<br>
<a href="https://isabelle.sketis.net/repos/isabelle-release/file/Isabelle2021-RC3/Admin/Linux/Isabelle.c">https://isabelle.sketis.net/repos/isabelle-release/file/Isabelle2021-RC3/Admin/Linux/Isabelle.c</a></p>
<p>I will continue the experiments.</p>
<p>Makarius</p>



<a name="224113100"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247541-Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2021-RC3%3A%20macOS%20access%20to%20Documents%20fo.../near/224113100" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247541-Mirror:-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2021-RC3.3A.20macOS.20access.20to.20Documents.20fo.2E.2E.2E.html#224113100">(Jan 26 2021 at 22:19)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
The plain C app wrapper works and the solution will be in the next release<br>
candidate (first week of February).</p>
<p>See also <a href="https://isabelle-dev.sketis.net/T37#479">https://isabelle-dev.sketis.net/T37#479</a></p>
<p>Makarius</p>



<hr><p>Last updated: Jul 15 2022 at 23:21 UTC</p>
</html>