<html>
<head><meta charset="utf-8"><title>Failure of AFP/Native_Word_Test_SMLNJ2 with SML/NJ · Mirror: Isabelle Development Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/index.html">Mirror: Isabelle Development Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Failure.20of.20AFP.2FNative_Word_Test_SMLNJ2.20with.20SML.2FNJ.html">Failure of AFP/Native_Word_Test_SMLNJ2 with SML/NJ</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="495980482"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Failure%20of%20AFP/Native_Word_Test_SMLNJ2%20with%20SML/NJ/near/495980482" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Failure.20of.20AFP.2FNative_Word_Test_SMLNJ2.20with.20SML.2FNJ.html#495980482">(Jan 26 2025 at 16:29)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
We have a failure of AFP/Native_Word_Test_SMLNJ2 with SML/NJ, using <br>
Isabelle/989e661398d6 + AFP/5cb6756ec5b0 and ISABELLE_SMLNJ=/usr/bin/sml in <br>
$ISABELLE_HOME_USER/etc/settings (e.g. with the regular Ubuntu package for smlnj):</p>
<p>/tmp/isabelle-makarius/process8926374598986055100/Code_Test5534440/generated.sml:222.22-223.61 <br>
Error: case object and rules don't agree [tycon mismatch]<br>
   rule domain: ?.int * int<br>
   object: int * int<br>
   in expression:<br>
     (case ((div_mod k) max_index)<br>
       of (b,s) =&gt; word_of_int s :: (replicate &lt;exp&gt;) word_max_index)</p>
<p>uncaught exception Error</p>
<p>Makarius</p>



<a name="495980599"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Failure%20of%20AFP/Native_Word_Test_SMLNJ2%20with%20SML/NJ/near/495980599" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Failure.20of.20AFP.2FNative_Word_Test_SMLNJ2.20with.20SML.2FNJ.html#495980599">(Jan 26 2025 at 16:30)</a>:</h4>
<p>From: Florian Haftmann &lt;<a href="mailto:florian.haftmann@cit.tum.de">florian.haftmann@cit.tum.de</a>&gt;<br>
Seems like my business.</p>
<p>Thanks for reporting.</p>
<p>Florian</p>
<p>Am 26.01.25 um 17:28 schrieb Makarius:</p>
<blockquote>
<p>We have a failure of AFP/Native_Word_Test_SMLNJ2 with SML/NJ, using <br>
Isabelle/989e661398d6 + AFP/5cb6756ec5b0 and ISABELLE_SMLNJ=/usr/bin/sml <br>
in $ISABELLE_HOME_USER/etc/settings (e.g. with the regular Ubuntu <br>
package for smlnj):</p>
<p>/tmp/isabelle-makarius/process8926374598986055100/Code_Test5534440/ <br>
generated.sml:222.22-223.61 Error: case object and rules don't agree <br>
[tycon mismatch]<br>
   rule domain: ?.int * int<br>
   object: int * int<br>
   in expression:<br>
     (case ((div_mod k) max_index)<br>
       of (b,s) =&gt; word_of_int s :: (replicate &lt;exp&gt;) word_max_index)</p>
<p>uncaught exception Error</p>
<p>Makarius<br>
</p>
</blockquote>
<p><a href="/user_uploads/14278/NVIt1WqWhwJzwk5IhdQwhMpF/OpenPGP_0xA707172232CFA4E9.asc">OpenPGP_0xA707172232CFA4E9.asc</a><br>
<a href="/user_uploads/14278/cuqU_eq0TOYbo6a6PBYL5nbI/OpenPGP_signature.asc">OpenPGP_signature.asc</a></p>



<a name="496045740"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Failure%20of%20AFP/Native_Word_Test_SMLNJ2%20with%20SML/NJ/near/496045740" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Failure.20of.20AFP.2FNative_Word_Test_SMLNJ2.20with.20SML.2FNJ.html#496045740">(Jan 27 2025 at 06:41)</a>:</h4>
<p>From: Florian Haftmann &lt;<a href="mailto:florian.haftmann@cit.tum.de">florian.haftmann@cit.tum.de</a>&gt;<br>
See now <a href="https://isabelle.in.tum.de/repos/isabelle/rev/e23bd621eddb">https://isabelle.in.tum.de/repos/isabelle/rev/e23bd621eddb</a></p>
<p>I plan to add an explicit check on that also.</p>
<p>Florian</p>
<p>Am 26.01.25 um 17:30 schrieb Florian Haftmann:</p>
<blockquote>
<p>Seems like my business.</p>
<p>Thanks for reporting.</p>
<p>Florian</p>
<p>Am 26.01.25 um 17:28 schrieb Makarius:</p>
<blockquote>
<p>We have a failure of AFP/Native_Word_Test_SMLNJ2 with SML/NJ, using <br>
Isabelle/989e661398d6 + AFP/5cb6756ec5b0 and ISABELLE_SMLNJ=/usr/bin/ <br>
sml in $ISABELLE_HOME_USER/etc/settings (e.g. with the regular Ubuntu <br>
package for smlnj):</p>
<p>/tmp/isabelle-makarius/process8926374598986055100/Code_Test5534440/ <br>
generated.sml:222.22-223.61 Error: case object and rules don't agree <br>
[tycon mismatch]<br>
   rule domain: ?.int * int<br>
   object: int * int<br>
   in expression:<br>
     (case ((div_mod k) max_index)<br>
       of (b,s) =&gt; word_of_int s :: (replicate &lt;exp&gt;) word_max_index)</p>
<p>uncaught exception Error</p>
<p>Makarius</p>
</blockquote>
</blockquote>
<p><a href="/user_uploads/14278/3AEVGpMz0NgOoWlcQMQ5e5st/OpenPGP_0xA707172232CFA4E9.asc">OpenPGP_0xA707172232CFA4E9.asc</a><br>
<a href="/user_uploads/14278/TNjEpbN7ZwUbH1_9HXew-trw/OpenPGP_signature.asc">OpenPGP_signature.asc</a></p>



<a name="496101842"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Failure%20of%20AFP/Native_Word_Test_SMLNJ2%20with%20SML/NJ/near/496101842" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Failure.20of.20AFP.2FNative_Word_Test_SMLNJ2.20with.20SML.2FNJ.html#496101842">(Jan 27 2025 at 11:43)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On 26/01/2025 17:43, Lawrence Paulson wrote:</p>
<blockquote>
<p>Didn’t we drop support for SML/NJ about 100 years ago?</p>
</blockquote>
<p>We still have it as target for codegeneration from HOL. It can be considered a <br>
clean implementation of Standard ML, and usually does not cause problems.</p>
<p>We also have Mlton in that position: It does cause problems, especially on macOS.</p>
<p>My inclination is to keep both SML platforms in our portfolio: this means I <br>
need to revisit Mlton once again for this release.</p>
<p>Makarius</p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>