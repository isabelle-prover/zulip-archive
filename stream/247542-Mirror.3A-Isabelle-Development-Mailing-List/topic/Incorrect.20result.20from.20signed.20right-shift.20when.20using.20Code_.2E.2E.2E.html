<html>
<head><meta charset="utf-8"><title>Incorrect result from signed right-shift when using Code_... · Mirror: Isabelle Development Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/index.html">Mirror: Isabelle Development Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html">Incorrect result from signed right-shift when using Code_...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="562000798"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/562000798" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#562000798">(Dec 05 2025 at 00:44)</a>:</h4>
<p><strong>From:</strong> Daniel Matichuk via isabelle-dev &lt;<a href="mailto:isabelle-dev@mailman.proof.cit.tum.de">isabelle-dev@mailman.proof.cit.tum.de</a>&gt;</p>
<p>In Isabelle-2025-RC1 the following theory yields an incorrect result from<br>
"value" (Hex_Words is optional):</p>
<p><em>theory</em> "Scratch"<br>
<em>imports</em> "HOL-Library.Word"  "HOL-Library.Code_Target_Numeral"<br>
"Word_Lib.Hex_Words"<br>
<em>begin</em></p>
<p><em>value</em> "signed_drop_bit 5 ((0x80000010 :: 32 word))"<br>
(* "0xFC000001" :: "32 word" *)</p>
<p><em>end</em></p>
<p>However the correct result (0xFC000000) is given if Code_Target_Numeral is<br>
not imported.</p>
<p>After some investigation I've determined that this is an issue that was<br>
introduced in PolyML 5.6.2, which I've reported here:</p>
<p><a href="https://github.com/polyml/polyml/issues/243">https://github.com/polyml/polyml/issues/243</a></p>



<a name="562090346"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/562090346" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#562090346">(Dec 05 2025 at 12:34)</a>:</h4>
<p><strong>From:</strong> Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;</p>
<p>On 05/12/2025 01:43, Daniel Matichuk via isabelle-dev wrote:</p>
<blockquote>
<p>After some investigation I've determined that this is an issue that was <br>
introduced in PolyML 5.6.2, which I've reported here:</p>
<p><a href="https://github.com/polyml/polyml/issues/243">https://github.com/polyml/polyml/issues/243</a> &lt;<a href="https://github.com/polyml/polyml/">https://github.com/polyml/polyml/</a> <br>
issues/243&gt;</p>
</blockquote>
<p>Thanks for the report. It is very relevant for the Isabelle2025-1 release: in <br>
the worst case we need to switch back to Poly/ML 5.9.1, see also <br>
Isabelle/08722f90a439.</p>
<p>For now, lets hope that David Matthews will do something on the spot --- I've <br>
added some further bits of information to the above ticket.</p>
<p>Makarius</p>



<a name="562103762"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/562103762" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#562103762">(Dec 05 2025 at 13:45)</a>:</h4>
<p><strong>From:</strong> Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;</p>
<p>On 05/12/2025 13:34, Makarius wrote:</p>
<blockquote>
<blockquote>
<p><a href="https://github.com/polyml/polyml/issues/243">https://github.com/polyml/polyml/issues/243</a> &lt;<a href="https://github.com/polyml/">https://github.com/polyml/</a> <br>
polyml/ issues/243&gt;</p>
</blockquote>
<p>Thanks for the report. It is very relevant for the Isabelle2025-1 release: in <br>
the worst case we need to switch back to Poly/ML 5.9.1, see also <br>
Isabelle/08722f90a439.</p>
</blockquote>
<p>The worst case is probably not that bad: it should be sufficient to revert <br>
this change: <a href="https://github.com/polyml/polyml/commit/ed1ff06d7b53">https://github.com/polyml/polyml/commit/ed1ff06d7b53</a></p>
<p>There is also an interesting comment in the old version:</p>
<p>(* These could be implemented in the RTS although I doubt if it's<br>
      really worth it. *)</p>
<p>Makarius</p>



<a name="562186715"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/562186715" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#562186715">(Dec 05 2025 at 21:34)</a>:</h4>
<p><strong>From:</strong> Daniel Matichuk via isabelle-dev &lt;<a href="mailto:isabelle-dev@mailman.proof.cit.tum.de">isabelle-dev@mailman.proof.cit.tum.de</a>&gt;</p>
<p>I tried to test the updated polyml version, but ran into an issue with<br>
component_polyml:</p>
<p>./bin/isabelle component_polyml -V 64eb08b0a4bcb20d39167550034f30d05a61f121<br>
Creating component directory<br>
"/Users/dmatichuk/Code/isabelle/polyml-64eb08b0a4bcb20d39167550034f30d05a61f121"<br>
Getting "<a href="https://gmplib.org/download/gmp/gmp-6.3.0.tar.bz2">https://gmplib.org/download/gmp/gmp-6.3.0.tar.bz2</a>"<br>
Building GMP library ...<br>
Getting "<br>
<a href="https://github.com/polyml/polyml/archive/64eb08b0a4bcb20d39167550034f30d05a61f121.tar.gz">https://github.com/polyml/polyml/archive/64eb08b0a4bcb20d39167550034f30d05a61f121.tar.gz</a><br>
"<br>
Getting "<a href="https://files.sketis.net/sha1/archive/0ce12663fe76.tar.gz">https://files.sketis.net/sha1/archive/0ce12663fe76.tar.gz</a>"<br>
Building Poly/ML arm64_32-darwin<br>
*** error: /Library/Developer/CommandLineTools/usr/bin/install_name_tool:<br>
more than one input file specified (poly and poly)<br>
*** Usage: /Library/Developer/CommandLineTools/usr/bin/install_name_tool<br>
[-change old new] ... [-rpath old new] ... [-add_rpath new] ...<br>
[-delete_rpath old] ... [-id name] input</p>
<p>A quick fix was to simply modify executable.scala/library_closure to<br>
instead call install_name_tool multiple times.</p>
<p>On Fri, Dec 5, 2025 at 5:44 AM Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt; wrote:</p>
<blockquote>
<p>On 05/12/2025 13:34, Makarius wrote:</p>
<blockquote>
<blockquote>
<p><a href="https://github.com/polyml/polyml/issues/243">https://github.com/polyml/polyml/issues/243</a> &lt;<a href="https://github.com/polyml/">https://github.com/polyml/</a><br>
polyml/ issues/243&gt;</p>
</blockquote>
<p>Thanks for the report. It is very relevant for the Isabelle2025-1<br>
release: in<br>
the worst case we need to switch back to Poly/ML 5.9.1, see also<br>
Isabelle/08722f90a439.</p>
</blockquote>
<p>The worst case is probably not that bad: it should be sufficient to revert<br>
this change: <a href="https://github.com/polyml/polyml/commit/ed1ff06d7b53">https://github.com/polyml/polyml/commit/ed1ff06d7b53</a></p>
<p>There is also an interesting comment in the old version:</p>
<p>(* These could be implemented in the RTS although I doubt if it's<br>
      really worth it. *)</p>
<p>Makarius</p>
</blockquote>



<a name="562187703"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/562187703" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#562187703">(Dec 05 2025 at 21:42)</a>:</h4>
<p><strong>From:</strong> Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;</p>
<p>On 05/12/2025 22:33, Daniel Matichuk wrote:</p>
<blockquote>
<p>I tried to test the updated polyml version, but ran into an issue with <br>
component_polyml:</p>
<p>./bin/isabelle component_polyml -V 64eb08b0a4bcb20d39167550034f30d05a61f121<br>
Creating component directory "/Users/dmatichuk/Code/isabelle/ <br>
polyml-64eb08b0a4bcb20d39167550034f30d05a61f121"</p>
</blockquote>
<blockquote>
<p>*** error: /Library/Developer/CommandLineTools/usr/bin/install_name_tool: more <br>
than one input file specified (poly and poly)<br>
*** Usage: /Library/Developer/CommandLineTools/usr/bin/install_name_tool [- <br>
change old new] ... [-rpath old new] ... [-add_rpath new] ... [-delete_rpath <br>
old] ... [-id name] input</p>
<p>A quick fix was to simply modify executable.scala/library_closure to instead <br>
call install_name_tool multiple times.</p>
</blockquote>
<p>That is a conflict of a locally installed libgmp with the one that is built <br>
via "isabelle component_polyml". The usual workaround is to remove that other <br>
libgmp, which is usually in /usr/local.</p>
<p>That is indeed a bit awkward, but "isabelle component_polyml" is merely an <br>
administrative tool for limited contexts. I usually need several attempts to <br>
make it work with "current" OS versions, whatever they are.</p>
<p>Right now our main problem is that 64eb08b0a4bc is on top of "latest" Poly/ML <br>
development and experiments. Thus it does not quite work for Isabelle yet, <br>
especially HOL-Codegenerator_Test. For the release the change needs to sit on <br>
top of official v5.9.2.</p>
<p>Makarius</p>



<a name="562189399"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/562189399" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#562189399">(Dec 05 2025 at 21:59)</a>:</h4>
<p><strong>From:</strong> Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;</p>
<p>On 05/12/2025 22:42, Makarius wrote:</p>
<blockquote>
<p>Right now our main problem is that 64eb08b0a4bc is on top of "latest" Poly/ML <br>
development and experiments. Thus it does not quite work for Isabelle yet, <br>
especially HOL-Codegenerator_Test. For the release the change needs to sit on <br>
top of official v5.9.2.</p>
</blockquote>
<p>I now see 638379c583a5, and that looks fine so far in a quick test of <br>
HOL-Codegenerator_Test ...</p>
<p>Makarius</p>



<a name="562191608"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/562191608" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#562191608">(Dec 05 2025 at 22:18)</a>:</h4>
<p><strong>From:</strong> Daniel Matichuk via isabelle-dev &lt;<a href="mailto:isabelle-dev@mailman.proof.cit.tum.de">isabelle-dev@mailman.proof.cit.tum.de</a>&gt;</p>
<p>Some quick tests with the code generator indicate that this revision seems<br>
to have resolved the issue (compiled with GMP enabled, using arm64_32).</p>
<p>On Fri, Dec 5, 2025 at 1:58 PM Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt; wrote:</p>
<blockquote>
<p>On 05/12/2025 22:42, Makarius wrote:</p>
<blockquote>
<p>Right now our main problem is that 64eb08b0a4bc is on top of "latest"<br>
Poly/ML<br>
development and experiments. Thus it does not quite work for Isabelle<br>
yet,<br>
especially HOL-Codegenerator_Test. For the release the change needs to<br>
sit on<br>
top of official v5.9.2.</p>
</blockquote>
<p>I now see 638379c583a5, and that looks fine so far in a quick test of<br>
HOL-Codegenerator_Test ...</p>
<p>Makarius</p>
</blockquote>



<a name="562224976"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/562224976" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#562224976">(Dec 06 2025 at 07:32)</a>:</h4>
<p><strong>From:</strong> Peter Lammich &lt;<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>&gt;</p>
<p>We have to disable code generator setup that could cause by eval to<br>
malfunction, when this buggy polyml makes it into the release. And check that<br>
Isabelle itself doesn't rely on the shift operation </p>
<p>On 5 Dec 2025 14:44, Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt; wrote:  </p>
<blockquote>
<p>On 05/12/2025 13:34, Makarius wrote:  </p>
<blockquote>
<blockquote>
<p><a href="https://github.com/polyml/polyml/issues/243">https://github.com/polyml/polyml/issues/243</a> &lt;<a href="https://github.com/polyml/">https://github.com/polyml/</a>  <br>
polyml/ issues/243&gt;  </p>
</blockquote>
<p>Thanks for the report. It is very relevant for the Isabelle2025-1<br>
release: in  <br>
the worst case we need to switch back to Poly/ML 5.9.1, see also  <br>
Isabelle/08722f90a439.  </p>
</blockquote>
<p>The worst case is probably not that bad: it should be sufficient to revert  <br>
 this change: <a href="https://github.com/polyml/polyml/commit/ed1ff06d7b53">https://github.com/polyml/polyml/commit/ed1ff06d7b53</a>  </p>
<p>There is also an interesting comment in the old version:  </p>
<p>(* These could be implemented in the RTS although I doubt if it's  <br>
       really worth it. *)  </p>
<p>Makarius  </p>
</blockquote>



<a name="562238446"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/562238446" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#562238446">(Dec 06 2025 at 12:13)</a>:</h4>
<p><strong>From:</strong> Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;</p>
<blockquote>
<p>On 5 Dec 2025 14:44, Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt; wrote:</p>
<p>On 05/12/2025 13:34, Makarius wrote:<br>
     &gt;&gt;<br>
     &gt;&gt; <a href="https://github.com/polyml/polyml/issues/243">https://github.com/polyml/polyml/issues/243</a> &lt;<a href="https://github.com/polyml/">https://github.com/polyml/</a><br>
     &gt;&gt; polyml/ issues/243&gt;<br>
     &gt;<br>
     &gt; Thanks for the report. It is very relevant for the Isabelle2025-1<br>
    release: in<br>
     &gt; the worst case we need to switch back to Poly/ML 5.9.1, see also<br>
     &gt; Isabelle/08722f90a439.</p>
<p>The worst case is probably not that bad: it should be sufficient to revert<br>
    this change: <a href="https://github.com/polyml/polyml/commit/ed1ff06d7b53">https://github.com/polyml/polyml/commit/ed1ff06d7b53</a></p>
<p>There is also an interesting comment in the old version:</p>
<p>(* These could be implemented in the RTS although I doubt if it's<br>
           really worth it. *)</p>
</blockquote>
<p>On 05/12/2025 18:20, Peter Lammich wrote:</p>
<blockquote>
<p>We have to disable code generator setup that could cause by eval to <br>
malfunction, when this buggy polyml makes it into the release. And check that <br>
Isabelle itself doesn't rely on the shift operation</p>
</blockquote>
<p>It is clear that this version will not be in the final release. There will <br>
already be a different polyml setup for Isabelle2025-1-RC4, published next week.</p>
<p>Makarius</p>



<a name="562249326"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/562249326" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#562249326">(Dec 06 2025 at 15:45)</a>:</h4>
<p><strong>From:</strong> Florian Haftmann &lt;<a href="mailto:florian.haftmann@cit.tum.de">florian.haftmann@cit.tum.de</a>&gt;</p>
<p>Am 05.12.25 um 22:58 schrieb Makarius:</p>
<blockquote>
<p>On 05/12/2025 22:42, Makarius wrote:</p>
<blockquote>
<p>Right now our main problem is that 64eb08b0a4bc is on top of "latest" <br>
Poly/ML development and experiments. Thus it does not quite work for <br>
Isabelle yet, especially HOL-Codegenerator_Test. For the release the <br>
change needs to sit on top of official v5.9.2.</p>
</blockquote>
<p>I now see 638379c583a5, and that looks fine so far in a quick test of <br>
HOL-Codegenerator_Test ...</p>
</blockquote>
<p>It is interesting that this remained undiscovered – AFP session <br>
Native_Word contains considerable tests for code generation for word types.</p>
<p>I’ll investigate what is missing there.</p>
<p>Cheers,<br>
    Florian</p>
<p><a href="/user_uploads/14278/08dhkSUEnPjmnLf6WQZzmNpO/OpenPGP_0xA707172232CFA4E9.asc">OpenPGP_0xA707172232CFA4E9.asc</a><br>
<a href="/user_uploads/14278/qIIA3yPdlRWz0AZwtAaEQwX9/OpenPGP_signature.asc">OpenPGP_signature.asc</a></p>



<a name="562270625"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/562270625" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#562270625">(Dec 06 2025 at 23:01)</a>:</h4>
<p><strong>From:</strong> Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;</p>
<p>On 06/12/2025 16:44, Florian Haftmann wrote:</p>
<blockquote>
<p>It is interesting that this remained undiscovered – AFP session Native_Word <br>
contains considerable tests for code generation for word types.</p>
<p>I’ll investigate what is missing there.</p>
</blockquote>
<p>Maybe this version on isabelle-release helps:</p>
<p>changeset:   83716:4885450ab48d<br>
tag:         tip<br>
user:        wenzelm<br>
date:        Sat Dec 06 23:01:40 2025 +0100<br>
files:       src/Pure/ML/ml_init.ML<br>
description:<br>
expose bad IntInf shift operations in Poly/ML via explicit exceptions;</p>
<p>Testing it with afp-2025-1/3af26ffddf1b (-X slow) does not expose any errors, <br>
though.</p>
<p>Makarius</p>



<a name="562270739"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/562270739" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#562270739">(Dec 06 2025 at 23:03)</a>:</h4>
<p><strong>From:</strong> Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;</p>
<p>The isabelle-release repository now has this changeset:</p>
<p>changeset:   83717:f274b63c5b44<br>
tag:         tip<br>
user:        wenzelm<br>
date:        Sat Dec 06 23:51:17 2025 +0100<br>
files:       Admin/components/components.sha1 Admin/components/main<br>
description:<br>
update to polyml-5.9.2-2 version ccd3e3717f72 from branch fixes-5.9.2, which <br>
provides a corrected implementation of IntInf right shift;<br>
keep redundant checks for further testing;</p>
<p>The plan is to publish it in Isabelle2025-1-RC4 next week (probably Monday), <br>
and remove the redundant check for the final release.</p>
<p>The changeset will return to isabelle-dev shortly after Isabelle2025-1-RC4.</p>
<p>Makarius</p>



<a name="562551590"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/562551590" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#562551590">(Dec 08 2025 at 20:24)</a>:</h4>
<p><strong>From:</strong> Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;</p>
<p>On 07/12/2025 00:03, Makarius wrote:</p>
<blockquote>
<p>The isabelle-release repository now has this changeset:</p>
<p>changeset:   83717:f274b63c5b44<br>
tag:         tip<br>
user:        wenzelm<br>
date:        Sat Dec 06 23:51:17 2025 +0100<br>
files:       Admin/components/components.sha1 Admin/components/main<br>
description:<br>
update to polyml-5.9.2-2 version ccd3e3717f72 from branch fixes-5.9.2, which <br>
provides a corrected implementation of IntInf right shift;<br>
keep redundant checks for further testing;</p>
<p>The plan is to publish it in Isabelle2025-1-RC4 next week (probably Monday), <br>
and remove the redundant check for the final release.</p>
<p>The changeset will return to isabelle-dev shortly after Isabelle2025-1-RC4.</p>
</blockquote>
<p>That is now isabelle-dev/c445b16fd5a9: it means that the state of affairs is <br>
the same as for the final stage of the Isabelle2025-1 release process.</p>
<p>Makarius</p>



<a name="564105038"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/Incorrect%20result%20from%20signed%20right-shift%20when%20using%20Code_.../near/564105038" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror.3A-Isabelle-Development-Mailing-List/topic/Incorrect.20result.20from.20signed.20right-shift.20when.20using.20Code_.2E.2E.2E.html#564105038">(Dec 16 2025 at 18:09)</a>:</h4>
<p><strong>From:</strong> Florian Haftmann &lt;<a href="mailto:florian.haftmann@cit.tum.de">florian.haftmann@cit.tum.de</a>&gt;</p>
<p>For the record:</p>
<blockquote>
<blockquote>
<blockquote>
<p>Right now our main problem is that 64eb08b0a4bc is on top of "latest" <br>
Poly/ML development and experiments. Thus it does not quite work for <br>
Isabelle yet, especially HOL-Codegenerator_Test. For the release the <br>
change needs to sit on top of official v5.9.2.</p>
</blockquote>
<p>I now see 638379c583a5, and that looks fine so far in a quick test of <br>
HOL-Codegenerator_Test ...</p>
</blockquote>
<p>It is interesting that this remained undiscovered – AFP session <br>
Native_Word contains considerable tests for code generation for word types.</p>
</blockquote>
<p>In <a href="https://isabelle.in.tum.de/repos/isabelle/rev/490ffe526eeb">https://isabelle.in.tum.de/repos/isabelle/rev/490ffe526eeb</a> that <br>
situation is now explicitly checked.</p>
<p>My statement concerning word types was misleading – the example does not <br>
use target language word types but a generic word type which is <br>
implemented by integers, where the target language operation for right <br>
bit shift obviously was not implemented correctly in the underlying system.</p>
<p>Cheers,<br>
    Florian</p>
<p><a href="/user_uploads/14278/zQ9yoKSHT_hZ7Ll7aaEbRpcl/OpenPGP_0xA707172232CFA4E9.asc">OpenPGP_0xA707172232CFA4E9.asc</a><br>
<a href="/user_uploads/14278/USqbuRX5MXHT3ZfSOXXquEBv/OpenPGP_signature.asc">OpenPGP_signature.asc</a></p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>