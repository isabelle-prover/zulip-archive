<html>
<head><meta charset="utf-8"><title>[isabelle-dev] AFP build times out in file/theory present... · Mirror: Isabelle Development Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror:-Isabelle-Development-Mailing-List/index.html">Mirror: Isabelle Development Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror:-Isabelle-Development-Mailing-List/topic/.5Bisabelle-dev.5D.20AFP.20build.20times.20out.20in.20file.2Ftheory.20present.2E.2E.2E.html">[isabelle-dev] AFP build times out in file/theory present...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="261600299"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/%5Bisabelle-dev%5D%20AFP%20build%20times%20out%20in%20file/theory%20present.../near/261600299" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror:-Isabelle-Development-Mailing-List/topic/.5Bisabelle-dev.5D.20AFP.20build.20times.20out.20in.20file.2Ftheory.20present.2E.2E.2E.html#261600299">(Nov 16 2021 at 05:42)</a>:</h4>
<p>From: Gerwin Klein &lt;<a href="mailto:kleing@unsw.edu.au">kleing@unsw.edu.au</a>&gt;<br>
It looks like since 12 Nov at isabelle@2b212c8138a5 the AFP build has been timing out towards the end of theory/file presentation despite everything else being successful (logs at <a href="https://ci.isabelle.systems/jenkins/job/isabelle-all/3298/">https://ci.isabelle.systems/jenkins/job/isabelle-all/3298/</a> for the morbidly curious). For some reason Jenkins decided that no emails needed to be sent for that.</p>
<p>I haven't been able to reproduce the problem locally, but this is happening even for small AFP changes where the proofs are finished after a few minutes, e.g. in <a href="https://ci.isabelle.systems/jenkins/job/isabelle-all/3301/consoleText">https://ci.isabelle.systems/jenkins/job/isabelle-all/3301/consoleText</a> (for afp-devel@7c831b848ada135a and isabelle@4f1c1c7eb95f4) so it's not the global timeout that is the issue. It does really seem to either hang or take very long for the presentation part.</p>
<p>To make testing worse, the entry Complex_Bounded_Operators is currently broken since (I think) Manuel's recent afp-devel commit 7aec7688b019. Manuel, could you please have a look at that?</p>
<p>In any case, I can't do the AFP release fork in this state, and will have to postpone until we've figured out what is going on with the presentation part.</p>
<p>Cheers,<br>
Gerwin</p>
<hr>
<p>isabelle-dev mailing list<br>
<a href="mailto:isabelle-dev@in.tum.de">isabelle-dev@in.tum.de</a><br>
<a href="https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev">https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev</a></p>



<a name="261607393"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/%5Bisabelle-dev%5D%20AFP%20build%20times%20out%20in%20file/theory%20present.../near/261607393" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror:-Isabelle-Development-Mailing-List/topic/.5Bisabelle-dev.5D.20AFP.20build.20times.20out.20in.20file.2Ftheory.20present.2E.2E.2E.html#261607393">(Nov 16 2021 at 07:53)</a>:</h4>
<p>From: Manuel Eberl &lt;<a href="mailto:manuel@pruvisto.org">manuel@pruvisto.org</a>&gt;<br>
Have you tested Complex_Bounded_Operators with the latest <br>
isabelle-release? <a href="https://isabelle.sketis.net/repos/isabelle-release">https://isabelle.sketis.net/repos/isabelle-release</a></p>
<p>That afp-devel push of mine was to adapt Complex_Bounded_Operators to <br>
the changes I had Makarius add to isabelle-release. At least on my <br>
machine it built fine.</p>
<p>Manuel</p>
<hr>
<p>isabelle-dev mailing list<br>
<a href="mailto:isabelle-dev@in.tum.de">isabelle-dev@in.tum.de</a><br>
<a href="https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev">https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev</a></p>



<a name="261609007"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/%5Bisabelle-dev%5D%20AFP%20build%20times%20out%20in%20file/theory%20present.../near/261609007" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror:-Isabelle-Development-Mailing-List/topic/.5Bisabelle-dev.5D.20AFP.20build.20times.20out.20in.20file.2Ftheory.20present.2E.2E.2E.html#261609007">(Nov 16 2021 at 08:16)</a>:</h4>
<p>From: Gerwin Klein &lt;<a href="mailto:kleing@unsw.edu.au">kleing@unsw.edu.au</a>&gt;<br>
You were too fast :-), afp-devel is is for isabelle-devel, it shouldn't have isabelle-release changes in it.</p>
<p>It's unfortunate that isabelle-release has already diverged in content. Not a real problem, just a bit more overhead.</p>
<p>Ok, so I'll make an afp-2021-1 fork now, and it would be good if somebody could set up Jenkins to test this branch against isabelle-release. Lars used to do that -- I'm not sure who has taken over Jenkins.</p>
<p>After the fork we should temporarily revert that commit for Complex_Bounded_Operators in afp-devel (but keep it on afp-2021-1) until the release has happened. We should try to fix the timeout problem on the afp-2021-1/isabelle-release combination. After the release those changes will then be merged into both devel versions.</p>
<p>Cheers,<br>
Gerwin</p>
<hr>
<p>isabelle-dev mailing list<br>
<a href="mailto:isabelle-dev@in.tum.de">isabelle-dev@in.tum.de</a><br>
<a href="https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev">https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev</a></p>



<a name="261610729"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/%5Bisabelle-dev%5D%20AFP%20build%20times%20out%20in%20file/theory%20present.../near/261610729" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror:-Isabelle-Development-Mailing-List/topic/.5Bisabelle-dev.5D.20AFP.20build.20times.20out.20in.20file.2Ftheory.20present.2E.2E.2E.html#261610729">(Nov 16 2021 at 08:37)</a>:</h4>
<p>From: Fabian Huch &lt;<a href="mailto:huch@in.tum.de">huch@in.tum.de</a>&gt;<br>
On 11/16/21 09:16, Gerwin Klein wrote:</p>
<blockquote>
<p>You were too fast :-), afp-devel is is for isabelle-devel, it shouldn't have isabelle-release changes in it.</p>
<p>It's unfortunate that isabelle-release has already diverged in content. Not a real problem, just a bit more overhead.</p>
<p>Ok, so I'll make an afp-2021-1 fork now, and it would be good if somebody could set up Jenkins to test this branch against isabelle-release. Lars used to do that -- I'm not sure who has taken over Jenkins.</p>
</blockquote>
<p>I'm responsible for that now and will set that up.</p>
<p>Fabian</p>
<blockquote>
<p>After the fork we should temporarily revert that commit for Complex_Bounded_Operators in afp-devel (but keep it on afp-2021-1) until the release has happened. We should try to fix the timeout problem on the afp-2021-1/isabelle-release combination. After the release those changes will then be merged into both devel versions.</p>
<p>Cheers,<br>
Gerwin</p>
<p>On 16 Nov 2021, at 18:53, Manuel Eberl &lt;<a href="mailto:manuel@pruvisto.org">manuel@pruvisto.org</a>&gt; wrote:</p>
<blockquote>
<p>Have you tested Complex_Bounded_Operators with the latest isabelle-release? <a href="https://isabelle.sketis.net/repos/isabelle-release">https://isabelle.sketis.net/repos/isabelle-release</a></p>
<p>That afp-devel push of mine was to adapt Complex_Bounded_Operators to the changes I had Makarius add to isabelle-release. At least on my machine it built fine.</p>
<p>Manuel</p>
</blockquote>
<p>On 16/11/2021 06:42, Gerwin Klein wrote:</p>
<blockquote>
<blockquote>
<p>It looks like since 12 Nov at isabelle@2b212c8138a5 the AFP build has been timing out towards the end of theory/file presentation despite everything else being successful (logs at <a href="https://ci.isabelle.systems/jenkins/job/isabelle-all/3298/">https://ci.isabelle.systems/jenkins/job/isabelle-all/3298/</a> for the morbidly curious). For some reason Jenkins decided that no emails needed to be sent for that.</p>
<p>I haven't been able to reproduce the problem locally, but this is happening even for small AFP changes where the proofs are finished after a few minutes, e.g. in <a href="https://ci.isabelle.systems/jenkins/job/isabelle-all/3301/consoleText">https://ci.isabelle.systems/jenkins/job/isabelle-all/3301/consoleText</a> (for afp-devel@7c831b848ada135a and isabelle@4f1c1c7eb95f4) so it's not the global timeout that is the issue. It does really seem to either hang or take very long for the presentation part.</p>
<p>To make testing worse, the entry Complex_Bounded_Operators is currently broken since (I think) Manuel's recent afp-devel commit 7aec7688b019. Manuel, could you please have a look at that?</p>
<p>In any case, I can't do the AFP release fork in this state, and will have to postpone until we've figured out what is going on with the presentation part.</p>
<p>Cheers,<br>
Gerwin</p>
<hr>
<p>isabelle-dev mailing list<br>
<a href="mailto:isabelle-dev@in.tum.de">isabelle-dev@in.tum.de</a><br>
<a href="https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev">https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev</a></p>
</blockquote>
<hr>
<p>isabelle-dev mailing list<br>
<a href="mailto:isabelle-dev@in.tum.de">isabelle-dev@in.tum.de</a><br>
<a href="https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev">https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev</a></p>
</blockquote>
<hr>
<p>isabelle-dev mailing list<br>
<a href="mailto:isabelle-dev@in.tum.de">isabelle-dev@in.tum.de</a><br>
<a href="https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev">https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev</a></p>
</blockquote>
<hr>
<p>isabelle-dev mailing list<br>
<a href="mailto:isabelle-dev@in.tum.de">isabelle-dev@in.tum.de</a><br>
<a href="https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev">https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev</a></p>



<a name="261611102"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/%5Bisabelle-dev%5D%20AFP%20build%20times%20out%20in%20file/theory%20present.../near/261611102" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror:-Isabelle-Development-Mailing-List/topic/.5Bisabelle-dev.5D.20AFP.20build.20times.20out.20in.20file.2Ftheory.20present.2E.2E.2E.html#261611102">(Nov 16 2021 at 08:42)</a>:</h4>
<p>From: Gerwin Klein &lt;<a href="mailto:kleing@unsw.edu.au">kleing@unsw.edu.au</a>&gt;<br>
Perfect, thanks. The push is still running, turns out the afp has grown quite<br>
a bit. Will let you know when it's there.</p>
<p>Cheers,</p>
<p>Gerwin</p>



<a name="261613646"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/%5Bisabelle-dev%5D%20AFP%20build%20times%20out%20in%20file/theory%20present.../near/261613646" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror:-Isabelle-Development-Mailing-List/topic/.5Bisabelle-dev.5D.20AFP.20build.20times.20out.20in.20file.2Ftheory.20present.2E.2E.2E.html#261613646">(Nov 16 2021 at 09:08)</a>:</h4>
<p>From: Gerwin Klein &lt;<a href="mailto:kleing@unsw.edu.au">kleing@unsw.edu.au</a>&gt;<br>
&lt;ssh://hg@foss.heptapod.net/isa-afp/afp-2021-1&gt; is now available.</p>
<p>Cheers,</p>
<p>Gerwin</p>



<a name="261615671"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/%5Bisabelle-dev%5D%20AFP%20build%20times%20out%20in%20file/theory%20present.../near/261615671" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror:-Isabelle-Development-Mailing-List/topic/.5Bisabelle-dev.5D.20AFP.20build.20times.20out.20in.20file.2Ftheory.20present.2E.2E.2E.html#261615671">(Nov 16 2021 at 09:31)</a>:</h4>
<p>From: Fabian Huch &lt;<a href="mailto:huch@in.tum.de">huch@in.tum.de</a>&gt;<br>
Appropriate build job is also online: <br>
<a href="https://ci.isabelle.systems/jenkins/job/isabelle-2021-1/">https://ci.isabelle.systems/jenkins/job/isabelle-2021-1/</a></p>
<p>Fabian</p>



<a name="261627368"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/%5Bisabelle-dev%5D%20AFP%20build%20times%20out%20in%20file/theory%20present.../near/261627368" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror:-Isabelle-Development-Mailing-List/topic/.5Bisabelle-dev.5D.20AFP.20build.20times.20out.20in.20file.2Ftheory.20present.2E.2E.2E.html#261627368">(Nov 16 2021 at 11:24)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On 16/11/2021 09:16, Gerwin Klein wrote:</p>
<blockquote>
<p>You were too fast :-), afp-devel is is for isabelle-devel, it shouldn't have isabelle-release changes in it.</p>
</blockquote>
<p>We have had this time of uncertainty of the pair isabelle-dev vs. afp-devel<br>
after the fork of isabelle-dev to isabelle-release routinely in the past few<br>
years.</p>
<p>From the Isabelle side, the "window of uncertainty" is only 30min .. 2h. For<br>
AFP we often had many days, sometimes 1-2 weeks (IIRC).</p>
<p>So can this be organized in a better way?<br>
E.g. have the "call to finalize AFP" earlier in the process and maybe have a<br>
separate "afp-release" fork for it.</p>
<blockquote>
<p>After the fork we should temporarily revert that commit for Complex_Bounded_Operators in afp-devel (but keep it on afp-2021-1) until the release has happened.<br>
Note that I will occasionally merge isabelle-release back to isabelle-dev<br>
before final lift-off. It will happen within 2-3 days, for example.</p>
</blockquote>
<p>Makarius</p>
<hr>
<p>isabelle-dev mailing list<br>
<a href="mailto:isabelle-dev@in.tum.de">isabelle-dev@in.tum.de</a><br>
<a href="https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev">https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev</a></p>



<a name="261721687"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/247542-Mirror%3A%20Isabelle%20Development%20Mailing%20List/topic/%5Bisabelle-dev%5D%20AFP%20build%20times%20out%20in%20file/theory%20present.../near/261721687" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/247542-Mirror:-Isabelle-Development-Mailing-List/topic/.5Bisabelle-dev.5D.20AFP.20build.20times.20out.20in.20file.2Ftheory.20present.2E.2E.2E.html#261721687">(Nov 16 2021 at 23:14)</a>:</h4>
<p>From: Gerwin Klein &lt;<a href="mailto:kleing@unsw.edu.au">kleing@unsw.edu.au</a>&gt;</p>
<blockquote>
<p>On 16 Nov 2021, at 22:24, Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt; wrote:</p>
<p>On 16/11/2021 09:16, Gerwin Klein wrote:</p>
<blockquote>
<p>You were too fast :-), afp-devel is is for isabelle-devel, it shouldn't have isabelle-release changes in it.</p>
</blockquote>
<p>We have had this time of uncertainty of the pair isabelle-dev vs. afp-devel<br>
after the fork of isabelle-dev to isabelle-release routinely in the past few<br>
years.</p>
<p>From the Isabelle side, the "window of uncertainty" is only 30min .. 2h. For<br>
AFP we often had many days, sometimes 1-2 weeks (IIRC).</p>
<p>So can this be organized in a better way?<br>
E.g. have the "call to finalize AFP" earlier in the process and maybe have a<br>
separate "afp-release" fork for it.</p>
</blockquote>
<p>You're right that the uncertainty period is not really ideal. It relies on there not being any major content changes in isabelle-release. Often that works fine, but occasionally content drift does happen as it did this cycle.</p>
<p>What I've usually done in the past (and now) when content drift occurs, is what you suggest, i.e. an afp-release fork, which here is directly getting the name afp-2021-1. It can get that name, because the model for the AFP is that the release remains a separate fork, so what now operates as the pre-release fork will become the official release fork when everything is done.</p>
<p>We could remove the uncertainty period by always doing that and coordinating on the fork time. I'd be happy to try that out for the next release. </p>
<blockquote>
<blockquote>
<p>After the fork we should temporarily revert that commit for Complex_Bounded_Operators in afp-devel (but keep it on afp-2021-1) until the release has happened.<br>
Note that I will occasionally merge isabelle-release back to isabelle-dev<br>
before final lift-off. It will happen within 2-3 days, for example.</p>
</blockquote>
</blockquote>
<p>That is nice, and makes the situation with afp-devel a bit easier to manage (the smaller the merge in the end, the less work there is at the actual release point).</p>
<p>Cheers,<br>
Gerwin</p>
<hr>
<p>isabelle-dev mailing list<br>
<a href="mailto:isabelle-dev@in.tum.de">isabelle-dev@in.tum.de</a><br>
<a href="https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev">https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev</a></p>



<hr><p>Last updated: Jul 15 2022 at 23:21 UTC</p>
</html>