<html>
<head><meta charset="utf-8"><title>[isabelle] Adding a type constraint in a checking phase · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Adding.20a.20type.20constraint.20in.20a.20checking.20phase.html">[isabelle] Adding a type constraint in a checking phase</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294830123"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Adding%20a%20type%20constraint%20in%20a%20checking%20phase/near/294830123" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Adding.20a.20type.20constraint.20in.20a.20checking.20phase.html#294830123">(Aug 23 2022 at 09:17)</a>:</h4>
<p>From: Manuel Eberl &lt;<a href="mailto:eberlm@in.tum.de">eberlm@in.tum.de</a>&gt;<br>
Hello,</p>
<p>I want to write a checking phase that runs at the same stage as type<br>
inference. The purpose of that phase is to constrain the type of certain<br>
constants under certain conditions.</p>
<p>Suppose I encounter a certain constant c during checking with some<br>
polymorphic type attached to it. I now want to add a constraint that<br>
this type conforms to a certain pattern (whose variables are supposed to<br>
be disjoint from everything else in the context).</p>
<p>Error messages arising from this constraint should appear to the user<br>
just like normal type unification errors during type checking.</p>
<p>For instance, if I see a constant "coeff :: 'a poly ⇒ 'b ⇒ 'c", I would<br>
like to unify its type with the pattern "'a list ⇒ nat ⇒ 'a" (after<br>
renaming the variables in the latter).</p>
<p>I see two ways of doing this:</p>
<ol>
<li>add a constraint (using Type.constraint) to the list of terms</li>
<li>unify the types manually and propagate the resulting substitution</li>
</ol>
<p>The first one seems easier to me, although I would probably have to<br>
ensure I don't add constraints that are already there (or can I assume<br>
that by the time my phase is called, all constraints have already been<br>
resolved?).</p>
<p>In both cases, I am not sure what I have to do to make sure the<br>
variables in my type pattern are fresh.</p>
<p>There are probably some established patterns to follow here</p>
<p>Manuel</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>