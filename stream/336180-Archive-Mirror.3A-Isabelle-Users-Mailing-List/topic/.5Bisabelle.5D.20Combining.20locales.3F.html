<html>
<head><meta charset="utf-8"><title>[isabelle] Combining locales? · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Combining.20locales.3F.html">[isabelle] Combining locales?</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294148209"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Combining%20locales%3F/near/294148209" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Combining.20locales.3F.html#294148209">(Aug 18 2022 at 18:45)</a>:</h4>
<p>From: Randy Pollack &lt;<a href="mailto:rpollack@inf.ed.ac.uk">rpollack@inf.ed.ac.uk</a>&gt;<br>
I want to have a locale combining two different lattices, and using<br>
the infix syntax.  This goes back to help I got from this list several<br>
months ago.  Here is a script that worked in Isabelle2011 (and I've<br>
developed significant work in this locale) and fails in<br>
Isabelle2011-1:</p>
<p>theory localeTypeUnif imports Main begin</p>
<p>locale labelAuth =<br>
 label: lattice lblle lbllt lblinf lblsup<br>
 +<br>
 auth: lattice authle authlt authinf authsup<br>
 for lblle::"'a \&lt;Rightarrow&gt; 'a \&lt;Rightarrow&gt; bool"    (infix<br>
"\&lt;sqsubseteq&gt;" 50)<br>
 and lbllt::"'a \&lt;Rightarrow&gt; 'a \&lt;Rightarrow&gt; bool"    (infix<br>
"\&lt;sqsubset&gt;"  50)<br>
 and lblinf::"'a \&lt;Rightarrow&gt; 'a \&lt;Rightarrow&gt; 'a"     (infixl<br>
"\&lt;sqinter&gt;" 70)<br>
 and lblsup::"'a \&lt;Rightarrow&gt; 'a \&lt;Rightarrow&gt; 'a"     (infixl<br>
"\&lt;squnion&gt;" 65)<br>
 and authle:: "'b \&lt;Rightarrow&gt; 'b \&lt;Rightarrow&gt; bool"  (infix<br>
"\&lt;sqsubseteq&gt;" 50)<br>
 and authlt:: "'b \&lt;Rightarrow&gt; 'b \&lt;Rightarrow&gt; bool"  (infix<br>
"\&lt;sqsubset&gt;"  50)<br>
 and authinf::"'b \&lt;Rightarrow&gt; 'b \&lt;Rightarrow&gt; 'b"    (infixl<br>
"\&lt;sqinter&gt;" 70)<br>
 and authsup::"'b \&lt;Rightarrow&gt; 'b \&lt;Rightarrow&gt; 'b"    (infixl<br>
"\&lt;squnion&gt;" 65)</p>
<p>*** Type unification failed</p>
<hr>
<p>*** Failed to meet type constraint:</p>
<hr>
<p>*** Term:  op \&lt;sqsubseteq&gt; :: 'a \&lt;Rightarrow&gt; 'a \&lt;Rightarrow&gt; bool<br>
*** Type:  'a \&lt;Rightarrow&gt; 'a \&lt;Rightarrow&gt; 'a</p>
<hr>
<p>*** At command "locale" (line 3 of<br>
"/home/rpollack/work/seas/crash/ubreeze/isabelle/experiments/localeTypeUnif.thy")</p>
<p>What is the problem?  Thanks for any help.</p>
<p>Randy</p>



<a name="294148250"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Combining%20locales%3F/near/294148250" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Combining.20locales.3F.html#294148250">(Aug 18 2022 at 18:45)</a>:</h4>
<p>From: Florian Haftmann &lt;<a href="mailto:florian.haftmann@informatik.tu-muenchen.de">florian.haftmann@informatik.tu-muenchen.de</a>&gt;<br>
Hi Randy,</p>
<p>I dimly remember that there have been changes in the type class import<br>
hierarchy which changed the order of arguments for locale predicates,<br>
but I can't recall exactly which.  Maybe somebody else can comment?</p>
<p>Cheers,<br>
    Florian<br>
<a href="/user_uploads/14278/JadUaGZ0HCOy9LwNt9vi3HHl/signature.asc">signature.asc</a></p>



<a name="294148264"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Combining%20locales%3F/near/294148264" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Combining.20locales.3F.html#294148264">(Aug 18 2022 at 18:45)</a>:</h4>
<p>From: Alexander Krauss &lt;<a href="mailto:krauss@in.tum.de">krauss@in.tum.de</a>&gt;<br>
Hi Randy,</p>
<p>The change was 5e51075cbd97, and here is the NEWS entry:</p>
<ul>
<li>Added syntactic classes "inf" and "sup" for the respective<br>
constants.  INCOMPATIBILITY: Changes in the argument order of the<br>
(mostly internal) locale predicates for some derived classes.</li>
</ul>
<p>Your definition works again, when lblinf/authinf are moved to the front. <br>
The dependence of the predicate arguments on the specifics of the <br>
hierarchy is a bit unfortunate...</p>
<p>Alex</p>



<a name="294148277"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Combining%20locales%3F/near/294148277" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Combining.20locales.3F.html#294148277">(Aug 18 2022 at 18:45)</a>:</h4>
<p>From: Clemens Ballarin &lt;<a href="mailto:ballarin@in.tum.de">ballarin@in.tum.de</a>&gt;<br>
If this resolves the problem, then not only the order of the arguments  <br>
of the locale predicate but also the order of the locale parameters  <br>
has changed.  The latter is, of course, not internal if a class is  <br>
used as a locale.</p>
<p>Randy can make the locale expression invariant to such changes by  <br>
using named instantiation syntax like this:</p>
<p>labelAuth =<br>
  label: lattice<br>
    where le = lblle and lt = lbllt and inf = lblinf and sup = lblsup +<br>
  auth: lattice<br>
    ...</p>
<p>Clemens</p>
<p>Quoting Alexander Krauss &lt;<a href="mailto:krauss@in.tum.de">krauss@in.tum.de</a>&gt;:</p>



<a name="294148288"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Combining%20locales%3F/near/294148288" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Combining.20locales.3F.html#294148288">(Aug 18 2022 at 18:45)</a>:</h4>
<p>From: Randy Pollack &lt;<a href="mailto:rpollack@inf.ed.ac.uk">rpollack@inf.ed.ac.uk</a>&gt;<br>
Hi Clemens,</p>
<p>I like your suggestion.  However I guess I didn't understand it.</p>
<p>locale labelAuth =<br>
  label: lattice where<br>
  le = lblle and lt = lbllt and inf = lblinf and sup = lblsup<br>
  +<br>
  auth: lattice where<br>
  le = authle and lt = authlt and inf = authinf and sup = authsup</p>
<p>returns error message</p>
<p>*** "le" not a parameter of instantiated expression<br>
*** At command "locale" (line 3 of<br>
"/home/rpollack/work/seas/crash/ubreeze/isabelle/experiments/localeTypeUnif.thy")</p>
<p>I tried a few other syntaxes without success, e.g.</p>
<p>locale labelAuth =<br>
  label: lattice where label.le = lblle</p>
<p>*** Outer syntax error (line 4 of<br>
"/home/rpollack/work/seas/crash/ubreeze/isabelle/experiments/localeTypeUnif.thy"):<br>
command expected,<br>
*** but keyword where (line 4 of<br>
"/home/rpollack/work/seas/crash/ubreeze/isabelle/experiments/localeTypeUnif.thy")<br>
was found</p>
<p>I'm completely floundering.  I found no explanation I could understand<br>
in the Tutorial on Locales.</p>
<p>Best,<br>
Randy</p>



<a name="294148333"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Combining%20locales%3F/near/294148333" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Combining.20locales.3F.html#294148333">(Aug 18 2022 at 18:45)</a>:</h4>
<p>From: Clemens Ballarin &lt;<a href="mailto:ballarin@in.tum.de">ballarin@in.tum.de</a>&gt;<br>
Oops.  Sorry, I did not look up the parameter names of lattice when I  <br>
wrote this.  They are less_eq, less, inf and sup.</p>
<p>locale labelAuth =<br>
   label: lattice where<br>
   less_eq = lblle and less = lbllt and inf = lblinf and sup = lblsup<br>
   for lblle and lbllt and lblinf and lblsup</p>
<p>will work.  An instantiation 'name = term' means that the parameter  <br>
'name' of lattice is instantiated with 'term', which is an expression  <br>
over the parameters of the declared locale.  You still need the for  <br>
clause, and in your case of importing two instances you will need the  <br>
parameter type declarations as well in order share the type parameters.</p>
<p>The Isabelle/Isar reference manual documents named instantiation, but  <br>
there are indeed no examples.</p>
<p>Sorry again for the confusion.</p>
<p>Clemens</p>
<p>Randy Pollack &lt;<a href="mailto:rpollack@inf.ed.ac.uk">rpollack@inf.ed.ac.uk</a>&gt;:</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>