<html>
<head><meta charset="utf-8"><title>[isabelle] Concurrent/counter.ML · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Concurrent.2Fcounter.2EML.html">[isabelle] Concurrent/counter.ML</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294743979"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Concurrent/counter.ML/near/294743979" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Concurrent.2Fcounter.2EML.html#294743979">(Aug 22 2022 at 18:24)</a>:</h4>
<p>From: <a href="mailto:Michael.Norrish@data61.csiro.au">Michael.Norrish@data61.csiro.au</a><br>
Why is the increment amount﻿ 2?  (Or 3 in those setups where Thread_Data.is_virtual = true.)</p>
<p>Michael</p>



<a name="294744089"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Concurrent/counter.ML/near/294744089" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Concurrent.2Fcounter.2EML.html#294744089">(Aug 22 2022 at 18:25)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
To understand the Isabelle sources, you need to look at the history.</p>
<p>I have actually changed the above recently, because it was not as<br>
planned (but did not notice because it was not strictly relevant so far).</p>
<p>See <a href="http://isabelle.in.tum.de/repos/isabelle/rev/cbde6e3b132b">http://isabelle.in.tum.de/repos/isabelle/rev/cbde6e3b132b</a></p>
<p>Makarius</p>



<a name="294744110"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Concurrent/counter.ML/near/294744110" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Concurrent.2Fcounter.2EML.html#294744110">(Aug 22 2022 at 18:25)</a>:</h4>
<p>From: Bertram Felgenhauer via Cl-isabelle-users &lt;<a href="mailto:cl-isabelle-users@lists.cam.ac.uk">cl-isabelle-users@lists.cam.ac.uk</a>&gt;<br>
Dear Makarius,</p>
<p>Makarius wrote:<br>
I have trouble reading between the lines. Is this something that can<br>
cause problems (i.e., duplicate "unique" ids) in the Isabelle2018<br>
release, which predates cbde6e3b132b?</p>
<p>Cheers,</p>
<p>Bertram</p>



<a name="294744130"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Concurrent/counter.ML/near/294744130" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Concurrent.2Fcounter.2EML.html#294744130">(Aug 22 2022 at 18:25)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Reading between the lines of sources is not required, if you actually<br>
follow the history.</p>
<p>The rev cbde6e3b132b above points to a5853334c179 from 09-Apr-2016,<br>
where I introduced the idea of disjoint physical/virtual counters, but<br>
they were not disjoint, and not really required to be disjoint.</p>
<p>To avoid this confusion, I have recently made them disjoint. At some<br>
later stage this might be actually required.</p>
<p>Makarius</p>



<a name="294744266"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Concurrent/counter.ML/near/294744266" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Concurrent.2Fcounter.2EML.html#294744266">(Aug 22 2022 at 18:26)</a>:</h4>
<p>From: <a href="mailto:Michael.Norrish@data61.csiro.au">Michael.Norrish@data61.csiro.au</a><br>
Thanks for the discussion.  My summary is that the increments were used to ensure that numbers emitted by different sorts of counter would be kept in disjoint sets.  The later commit, updating the code I looked at, actually ensures this by using odd and even numbers (rather than multiples of 2 and 3).</p>
<p>Michael</p>
<p>﻿</p>



<a name="294744380"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Concurrent/counter.ML/near/294744380" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Concurrent.2Fcounter.2EML.html#294744380">(Aug 22 2022 at 18:27)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
The implicit context of this thread is actually HOL4, which is in the<br>
process to adopt more and more parallel functional programming<br>
facilities from Isabelle/ML. I generally welcome this.</p>
<p>Poly/ML is a great platform, and it is good to see HOL4 make more use of<br>
its potential. I also recommend to give up the obsolete Moscow ML<br>
support eventually: this will loosen further brakes.</p>
<p>When copying around sources, it requires the usual care to avoid odd<br>
clones and old copies from outdated Isabelle modules. Things are<br>
gradually changing over the years. For example, just a few days ago, I<br>
have again reconsidered old questions about the interaction of<br>
interrupts, parallel evaluation and lazy evaluation, although I am still<br>
not finished with it. BTW, your Susp module in HOL4 is still for<br>
sequential programming only, without interrupts.</p>
<p>There are also subtle side-conditions about the overall ML runtime<br>
environment, e.g. default thread parameters for interrupts, and the<br>
avoidance of certain "standard" I/O operations that are not thread-safe.</p>
<p>The "implementation" manual explains some of this from the perspective<br>
of Isabelle/ML users. If there are questions about the implementation<br>
and design decisions behind that, it is better done in the proper<br>
context, i.e. the HOL mailing list; or the isabelle-dev mailing list if<br>
it is about ongoing changes on the Isabelle repository.</p>
<p>Makarius</p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>