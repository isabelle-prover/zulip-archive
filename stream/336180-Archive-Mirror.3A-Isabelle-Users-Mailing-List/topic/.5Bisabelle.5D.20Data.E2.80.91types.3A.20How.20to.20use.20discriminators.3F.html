<html>
<head><meta charset="utf-8"><title>[isabelle] Data‑types: How to use discriminators? · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Data.E2.80.91types.3A.20How.20to.20use.20discriminators.3F.html">[isabelle] Data‑types: How to use discriminators?</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294259264"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Data%E2%80%91types%3A%20How%20to%20use%20discriminators%3F/near/294259264" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Data.E2.80.91types.3A.20How.20to.20use.20discriminators.3F.html#294259264">(Aug 19 2022 at 12:55)</a>:</h4>
<p>From: Yannick &lt;<a href="mailto:yannick_duchene@yahoo.fr">yannick_duchene@yahoo.fr</a>&gt;<br>
On Mon, 09 Dec 2013 10:44:27 +0100, Andreas Lochbihler  <br>
&lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt; wrote:</p>
<blockquote>
<p>Hi Yannik,</p>
<blockquote>
<p>What is a destructor? Isn't it pattern matching?<br>
A destructor (or more precisely, a selector) is a function that returns  <br>
one of the arguments of a constructor. For example, hd and tl are the  <br>
selectors for list, they return the arguments of a Cons.</p>
</blockquote>
<p>The new datatype package (keyword datatype_new) generates such  <br>
discriminators and selectors, the old one (keyword datatype) does not.  <br>
In Isabelle2013-1, the datatypes in HOL are generated by the old  <br>
datatype package. To use the new datatype package, you must import  <br>
~~/src/HOL/BNF/BNF. But of course, you can always define your own  <br>
discriminators and selectors.</p>
</blockquote>
<p>So I will try this one.</p>
<blockquote>
<blockquote>
<p>lemma "isα t ⟹ t = α a" sorry -- No way too<br>
This is not provable, you probably want to have "isα t ⟹ EX a. t = α a".<br>
Try by(cases t)(auto simp add: isα_def)</p>
</blockquote>
</blockquote>
<p>Yes, that was the intent. I though this was the same as to say there exist  <br>
an “a” such that “t = α a”. Or else, this just mean nothing, unless “a” is  <br>
fixed and in which case this is indeed not provable. Is “a” implicitly  <br>
fixed in the proposition I tested? If so, I didn't suspected it, and will  <br>
be aware of it since now.</p>
<p>Thanks for the precious comments :)</p>



<a name="294259277"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Data%E2%80%91types%3A%20How%20to%20use%20discriminators%3F/near/294259277" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Data.E2.80.91types.3A.20How.20to.20use.20discriminators.3F.html#294259277">(Aug 19 2022 at 12:55)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Yannik,</p>
<p>Yes, fresh variables in theorem statements are implicitly fixed. You can also specify <br>
variables that you can instantiate later, as in</p>
<p>schematic_lemma "isα t ==&gt; t = α ?a"</p>
<p>but this does not work well with Isar proofs, parallelisation of proof checking, and (in <br>
this case) proof automation. So it's better to explicitly use an existential quantifier here.</p>
<p>Best,<br>
Andreas</p>



<a name="294259284"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Data%E2%80%91types%3A%20How%20to%20use%20discriminators%3F/near/294259284" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Data.E2.80.91types.3A.20How.20to.20use.20discriminators.3F.html#294259284">(Aug 19 2022 at 12:55)</a>:</h4>
<p>From: Yannick &lt;<a href="mailto:yannick_duchene@yahoo.fr">yannick_duchene@yahoo.fr</a>&gt;<br>
I missed it (as it was not my first time in “datatypes.pdf”, I missed this  <br>
change in the introduction). Also HOL-BNF can be selected as the default  <br>
image in jEdit.</p>
<p>Now there are theorems “t.discI(n)” which indeed do what's needed. The  <br>
functions “t.is_Cn” do the same as explicitly defined functions (in a  <br>
prior message).</p>
<p>Is it OK to use HOL-BNF or is it still subject to big change? What would  <br>
you recommend between “datatype” and “datatype_new”?</p>



<a name="294259338"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Data%E2%80%91types%3A%20How%20to%20use%20discriminators%3F/near/294259338" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Data.E2.80.91types.3A.20How.20to.20use.20discriminators.3F.html#294259338">(Aug 19 2022 at 12:56)</a>:</h4>
<p>From: Yannick &lt;<a href="mailto:yannick_duchene@yahoo.fr">yannick_duchene@yahoo.fr</a>&gt;<br>
I forget to comment on this: “thm isα_def” just says “isα ≡ isα_sumC”, and  <br>
“isα_sumC” is just a constant of type “t =&gt; bool”, so it was not usable  <br>
(HOL-BNF has a really usable “is_Atom_def”).</p>



<a name="294259352"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Data%E2%80%91types%3A%20How%20to%20use%20discriminators%3F/near/294259352" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Data.E2.80.91types.3A.20How.20to.20use.20discriminators.3F.html#294259352">(Aug 19 2022 at 12:56)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
This is what you get with the function package. In that case, isα.simps is what you need. <br>
With definition, the theorem is usually names &lt;constant name&gt;_def. In your example above, <br>
however, you renamed the definition theorem to isα, so apply(simp add: isα) should work.</p>
<p>Best,<br>
Andreas</p>



<a name="294262769"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Data%E2%80%91types%3A%20How%20to%20use%20discriminators%3F/near/294262769" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Data.E2.80.91types.3A.20How.20to.20use.20discriminators.3F.html#294262769">(Aug 19 2022 at 13:16)</a>:</h4>
<p>From: "Yannick Duchêne (Hibou57 )" &lt;<a href="mailto:yannick_duchene@yahoo.fr">yannick_duchene@yahoo.fr</a>&gt;<br>
I was seeking for something like constructor predicates, I mean something  <br>
which says whether or not an instance of that data‑type is from a  <br>
particular constructor of a that data‑type.</p>
<p>In “datatypes.pdf”, in “2.3 Generated Constants” there is the mention of  <br>
discriminators of the form “t.is_Cn” where “Cn” is the name of a  <br>
constructor of the type “t”.</p>
<p>I could not find anything like this in the theory context, so searched the  <br>
web for “Isabelle HOL is_Cons is_Nil” with the hope this could pop up some  <br>
examples on the topic. I could just find this, which did not help to  <br>
understand:<br>
<a href="http://isabelle.in.tum.de/repos/isabelle/file/3d520eec2746/src/HOL/Codatatype/Tools/bnf_wrap.ML">http://isabelle.in.tum.de/repos/isabelle/file/3d520eec2746/src/HOL/Codatatype/Tools/bnf_wrap.ML</a></p>
<p>For the practical issue, I encountered a case where I needed but failed to  <br>
prove this: “a ≠ ω b ⟹ a ≠ ω (c # d)”. I can't prove it, as “a” is not  <br>
produced by “ω” there is no “b” and no way to compare the latter to “(c #  <br>
d)”. The case seemed a bit paradoxical to me, when I started to think I  <br>
finally need something to say “a” is not produced by the constructor “ω”.</p>
<p>Also I noticed “datatypes.pdf” talks about “datatype_new” and some others,  <br>
which seems not to be recognized. Is this an error or something old or  <br>
something new to come?</p>



<a name="294262886"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Data%E2%80%91types%3A%20How%20to%20use%20discriminators%3F/near/294262886" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Data.E2.80.91types.3A.20How.20to.20use.20discriminators.3F.html#294262886">(Aug 19 2022 at 13:17)</a>:</h4>
<p>From: "Yannick Duchêne (Hibou57 )" &lt;<a href="mailto:yannick_duchene@yahoo.fr">yannick_duchene@yahoo.fr</a>&gt;<br>
I fell back to this:</p>
<p>datatype "term" =<br>
     Any                  ("ε")<br>
   | Atom atom            ("α")<br>
   | Variable variable    ("υ")<br>
   | Compound "term list" ("ω")<br>
   ;</p>
<p>primrec isυ :: "term ⇒ bool" where<br>
       "isυ ε = False"<br>
     | "isυ (α _) = False"<br>
     | "isυ (υ _) = True"<br>
     | "isυ (ω _) = False"</p>
<p>(* And so on for the other three constructors… *)</p>
<p>“isυ” is what is supposed to be “term.is_Variable” after “datatypes.pdf”,  <br>
but which does not seems to be there.</p>
<p>The simplifier seems to be able to deal with this in proof.</p>
<p>I noticed something I don't understand. Isabelle/jEdit tells me in the  <br>
output pan and about the primrec: “No function definition for datatype  <br>
"List.list"”.</p>



<a name="294262915"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Data%E2%80%91types%3A%20How%20to%20use%20discriminators%3F/near/294262915" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Data.E2.80.91types.3A.20How.20to.20use.20discriminators.3F.html#294262915">(Aug 19 2022 at 13:17)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
It’s actually quite rare to need destructor or discriminator functions in datatypes. You should use pattern-matching instead, or the built-in case expression. With the latter, you can also get the simplifier to perform rewriting with case-splitting automatically.</p>
<p>Larry Paulson</p>



<a name="294262947"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Data%E2%80%91types%3A%20How%20to%20use%20discriminators%3F/near/294262947" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Data.E2.80.91types.3A.20How.20to.20use.20discriminators.3F.html#294262947">(Aug 19 2022 at 13:17)</a>:</h4>
<p>From: Yannick &lt;<a href="mailto:yannick_duchene@yahoo.fr">yannick_duchene@yahoo.fr</a>&gt;<br>
On Sun, 08 Dec 2013 15:24:49 +0100, Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
wrote:</p>
<blockquote>
<p>It’s actually quite rare to need destructor or discriminator functions  <br>
in datatypes.</p>
</blockquote>
<p>What is a destructor? Isn't it pattern matching?</p>
<p>I guess too it may be perhaps quite rare, but it's unavoidable for my  <br>
actual practical case. Using pattern matching in propositions is not  <br>
always OK, as it can lead to paradoxical cases where its needed to prove a  <br>
relation between things which don't exist. That's why I need a predicates  <br>
which really says “t is as this” or “t is not as this”.</p>
<blockquote>
<p>You should use pattern-matching instead, or the built-in case  <br>
expression. With the latter, you can also get the simplifier to perform  <br>
rewriting with case-splitting automatically.</p>
</blockquote>
<p>I tried with a definition and a function:</p>
<p>definition isα: "isα t ≡ (case t of α a ⇒ True | _ ⇒ False)"</p>
<p>lemma "t = α a ⟹ isα t" sorry -- No way, and unfolding does not help<br>
     lemma "isα t ⟹ t = α a" sorry -- No way too</p>
<p>Or:</p>
<p>fun isα where "isα t = (case t of α a ⇒ True | _ ⇒ False)"</p>
<p>lemma "t = α a ⟹ isα t" sorry -- OK<br>
     lemma "isα t ⟹ t = α a" by simp -- But no way with this one</p>
<p>None seems to work as expectable and even “try” fails to find a solution.</p>



<a name="294262959"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Data%E2%80%91types%3A%20How%20to%20use%20discriminators%3F/near/294262959" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Data.E2.80.91types.3A.20How.20to.20use.20discriminators.3F.html#294262959">(Aug 19 2022 at 13:17)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Yannik,</p>
<blockquote>
<p>What is a destructor? Isn't it pattern matching?<br>
A destructor (or more precisely, a selector) is a function that returns one of the <br>
arguments of a constructor. For example, hd and tl are the selectors for list, they return <br>
the arguments of a Cons.</p>
</blockquote>
<p>The new datatype package (keyword datatype_new) generates such discriminators and <br>
selectors, the old one (keyword datatype) does not. In Isabelle2013-1, the datatypes in <br>
HOL are generated by the old datatype package. To use the new datatype package, you must <br>
import ~~/src/HOL/BNF/BNF. But of course, you can always define your own discriminators <br>
and selectors.</p>
<blockquote>
<p>I tried with a definition and a function:</p>
<p>definition isα: "isα t ≡ (case t of α a ⇒ True | _ ⇒ False)"</p>
<p>lemma "t = α a ⟹ isα t" sorry -- No way, and unfolding does not help<br>
Have you tried apply(simp add: isα_def)? It should do the job.</p>
</blockquote>
<blockquote>
<p>lemma "isα t ⟹ t = α a" sorry -- No way too<br>
This is not provable, you probably want to have "isα t ⟹ EX a. t = α a".<br>
Try by(cases t)(auto simp add: isα_def)</p>
</blockquote>
<p>Hope this helps,<br>
Andreas</p>



<a name="294262969"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Data%E2%80%91types%3A%20How%20to%20use%20discriminators%3F/near/294262969" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Data.E2.80.91types.3A.20How.20to.20use.20discriminators.3F.html#294262969">(Aug 19 2022 at 13:17)</a>:</h4>
<p>From: Jasmin Blanchette &lt;<a href="mailto:jasmin.blanchette@gmail.com">jasmin.blanchette@gmail.com</a>&gt;<br>
Hi Yannick,</p>
<blockquote>
<p>Also I noticed “datatypes.pdf” talks about “datatype_new” and some others, which seems not to be recognized. Is this an error or something old or something new to come?</p>
</blockquote>
<p>The answer is in the introduction of that document (p. 4):</p>
<p>To use the package, it is necessary to import the BNF theory, which can be precompiled into the HOL-BNF image. The following commands show how to launch jEdit/PIDE with the image loaded and how to build the image without launching jEdit:</p>
<p>isabelle jedit -l HOL-BNF<br>
    isabelle build -b HOL-BNF</p>
<p>Regards,</p>
<p>Jasmin</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>