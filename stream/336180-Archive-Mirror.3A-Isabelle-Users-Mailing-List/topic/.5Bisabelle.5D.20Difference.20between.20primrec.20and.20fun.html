<html>
<head><meta charset="utf-8"><title>[isabelle] Difference between primrec and fun · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Difference.20between.20primrec.20and.20fun.html">[isabelle] Difference between primrec and fun</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294763679"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Difference%20between%20primrec%20and%20fun/near/294763679" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Difference.20between.20primrec.20and.20fun.html#294763679">(Aug 22 2022 at 20:40)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
Dear Dominique,</p>
<p>It’s important to remember that Isabelle/HOL is based on higher-order logic and that most of its extensions, including recursive functions, types and predicates, are derived from first principles. So there is a bootstrapping process. A general well-founded recursion theorem is proved and the recursive data type definition package makes use of that to make primrec available on the types it introduces.</p>
<p>If you look at these session graph at <a href="https://isabelle.in.tum.de/dist/library/HOL/HOL/session_graph.pdf">https://isabelle.in.tum.de/dist/library/HOL/HOL/session_graph.pdf</a></p>
<p>it turns out that primrec is already available in theory Nat, where it provides primitive recursion on natural numbers, well before the function definition package in Fun_Def.</p>
<p>The specific advantages described by others on this list are possible because primrec maps straightforwardly to internal recursion combinators with no need to check termination or deal with pattern matching.</p>
<p>Larry Paulson</p>



<a name="294763741"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Difference%20between%20primrec%20and%20fun/near/294763741" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Difference.20between.20primrec.20and.20fun.html#294763741">(Aug 22 2022 at 20:41)</a>:</h4>
<p>From: Dominique Unruh &lt;<a href="mailto:unruh@ut.ee">unruh@ut.ee</a>&gt;<br>
Thanks for your answers.</p>
<p>So, as an executive summary of the executive summary (including Manuel's <br>
answer), we could say: There are cases where primrec works and fun <br>
doesn't and vice versa. And if both work, use primrec because it's <br>
faster and some things might be easier later.</p>
<p>Please correct me if that rule of thumb is wrong.</p>
<p>I think it might be useful to cover primrec in the function definition <br>
tutorial.</p>
<p>Best wishes,<br>
Dominique.</p>



<a name="294763994"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Difference%20between%20primrec%20and%20fun/near/294763994" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Difference.20between.20primrec.20and.20fun.html#294763994">(Aug 22 2022 at 20:43)</a>:</h4>
<p>From: Jasmin Blanchette via Cl-isabelle-users &lt;<a href="mailto:cl-isabelle-users@lists.cam.ac.uk">cl-isabelle-users@lists.cam.ac.uk</a>&gt;<br>
I'm not in charge of the "functions" tutorial, but a reference the other way does make sense. We already mentioned fun/function in the "datatypes" tutorial, but now I've just added (Isabelle/13d6b561b0ea) a paragraph capturing the essence of this thread.</p>
<p>Jasmin</p>



<a name="294764225"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Difference%20between%20primrec%20and%20fun/near/294764225" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Difference.20between.20primrec.20and.20fun.html#294764225">(Aug 22 2022 at 20:45)</a>:</h4>
<p>From: Dominique Unruh &lt;<a href="mailto:unruh@ut.ee">unruh@ut.ee</a>&gt;<br>
Dear all,</p>
<p>Isabelle has different commands for introducing recursive functions: <br>
fun, function, primrec.</p>
<p>The relationship between fun and function is clear to me: fun is just a <br>
convenience command that invokes function with some useful defaults.</p>
<p>But I cannot figure out what primrec is meant for. From the <br>
documentation (isar-ref), primrec does the same as fun, except that it <br>
imposes additional limitations on the structure of the recursive <br>
function. (And in contrast to the fun/function difference, it is not <br>
easier/more compact to write.)</p>
<p>So my question is: Is there any difference between primrec and fun in <br>
cases when both can be used? In that case: which command tends to be <br>
preferable? Why does primrec exist?</p>
<p>Best wishes,<br>
Dominique.</p>



<a name="294764359"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Difference%20between%20primrec%20and%20fun/near/294764359" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Difference.20between.20primrec.20and.20fun.html#294764359">(Aug 22 2022 at 20:46)</a>:</h4>
<p>From: Traytel  Dmitriy &lt;<a href="mailto:traytel@inf.ethz.ch">traytel@inf.ethz.ch</a>&gt;<br>
Hi Dominique,</p>
<p>this is a recurring topic on this mailing list. See e.g.:</p>
<p><a href="https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2017-July/msg00032.html">https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2017-July/msg00032.html</a><br>
<a href="https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2016-May/msg00037.html">https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2016-May/msg00037.html</a></p>
<p>The executive summary is: Reasons fo using the more low-level but also light-weight primrec include:</p>
<ul>
<li>primrec works for infinitely branching or mutually recursive datatypes, cases in which fun frequently fails (e.g., due to lack of a size function) and function requires manual termination proofs</li>
<li>documentation purposes (primrec means structural induction can be used when proving things about the functions; whereas fun may require structural or computational induction)</li>
<li>speed</li>
</ul>
<p>Dmitriy</p>



<a name="294764464"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Difference%20between%20primrec%20and%20fun/near/294764464" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Difference.20between.20primrec.20and.20fun.html#294764464">(Aug 22 2022 at 20:47)</a>:</h4>
<p>From: Manuel Eberl &lt;<a href="mailto:eberlm@in.tum.de">eberlm@in.tum.de</a>&gt;<br>
There are also some things like parametricity and measurability that are<br>
fairly easy to prove for primitive-recursive functions but can become<br>
quite tedious for functions defined with ‘fun’.</p>
<p>Manuel</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>