<html>
<head><meta charset="utf-8"><title>[isabelle] Eta-expansion of .elims generated by fun · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Eta-expansion.20of.20.2Eelims.20generated.20by.20fun.html">[isabelle] Eta-expansion of .elims generated by fun</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294642006"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Eta-expansion%20of%20.elims%20generated%20by%20fun/near/294642006" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Eta-expansion.20of.20.2Eelims.20generated.20by.20fun.html#294642006">(Aug 22 2022 at 10:01)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Dear Isabelle wizards,</p>
<p>I have defined a function with several arguments with the function package, but not all <br>
arguments are supplied in the definition. For example,</p>
<p>fun foo :: "bool ⇒ bool ⇒ bool"<br>
where<br>
   "foo True = id"<br>
| "foo False = Not"</p>
<p>The function package generates an elimination rule foo.elims to do case distinctions on <br>
foo. For the function foo, it generates the rule</p>
<p>⟦foo ?x = ?y; ⟦?x; ?y = id⟧ ⟹ ?P; ⟦¬ ?x; ?y = Not⟧ ⟹ ?P⟧ ⟹ ?P</p>
<p>Unfortunately, this rule cannot be used directly if the function is fully applied as in</p>
<p>notepad begin<br>
   fix x y<br>
   assume "foo x y = True"<br>
   then have "x = y"<br>
   proof(cases rule: foo.elims)</p>
<p>Is there any clever way to transform foo.elims such that I can use it in such a situation? <br>
I.e., I'd like to transform the rule to something like</p>
<p>⟦foo ?x ?z = ?y; ⟦?x; ?y = id ?z⟧ ⟹ ?P; ⟦¬ ?x; ?y = Not ?z⟧ ⟹ ?P⟧ ⟹ ?P</p>
<p>(In this case, I could of course use foo.cases, but this does not work if I want to do the <br>
case splits automatically with auto &amp; friends.)</p>
<p>I'd prefer to leave the definition eta-contracted, because it is clearer and the <br>
simplifier rewrites partially applied occurrences of foo (which is important because <br>
congruence rules and the induction method sporadically eta-expand terms and then cause <br>
strange effects).</p>
<p>Cheers,<br>
Andreas</p>



<a name="294642025"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Eta-expansion%20of%20.elims%20generated%20by%20fun/near/294642025" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Eta-expansion.20of.20.2Eelims.20generated.20by.20fun.html#294642025">(Aug 22 2022 at 10:01)</a>:</h4>
<p>From: Larry Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
But you could just as easily use the expanded form in the definition, and then derive the contracted forms afterwards. That is likely to be clearer than any massaging of the elimination and induction rules.</p>
<p>Larry Paulson</p>



<a name="294642047"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Eta-expansion%20of%20.elims%20generated%20by%20fun/near/294642047" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Eta-expansion.20of.20.2Eelims.20generated.20by.20fun.html#294642047">(Aug 22 2022 at 10:01)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Larry,</p>
<p>You are right that I can almost derive the eta-contracted simp rules with <br>
foo.simp[abs_def]. However, the generated cases rule then also requires all arguments of <br>
the function (given as a tuple). Do you know a way to manipulate the .cases rule? Is that <br>
easier than manipulating .elims?</p>
<p>Andreas</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>