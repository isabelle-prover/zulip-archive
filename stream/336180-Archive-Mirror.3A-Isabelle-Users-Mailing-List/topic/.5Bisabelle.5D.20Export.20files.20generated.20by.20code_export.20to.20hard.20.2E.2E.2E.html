<html>
<head><meta charset="utf-8"><title>[isabelle] Export files generated by code_export to hard ... · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Export.20files.20generated.20by.20code_export.20to.20hard.20.2E.2E.2E.html">[isabelle] Export files generated by code_export to hard ...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294754151"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Export%20files%20generated%20by%20code_export%20to%20hard%20.../near/294754151" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Export.20files.20generated.20by.20code_export.20to.20hard.20.2E.2E.2E.html#294754151">(Aug 22 2022 at 19:30)</a>:</h4>
<p>From: "Max W. Haslbeck" &lt;<a href="mailto:max.haslbeck@gmx.de">max.haslbeck@gmx.de</a>&gt;<br>
Hi,</p>
<p>I’m using the development version of Isabelle and I’m doing a lot of code exporting to Haskell these days.</p>
<p>When using the following code</p>
<hr>
<p>theory Scratch<br>
imports Main<br>
begin</p>
<p>export_code binomial in Haskell</p>
<p>end</p>
<hr>
<p>Isabelle generates 6 .hs files in the virtual "isabelle-export:" directory. Is there a way to quickly export all of these to a non-virtual folder on my hard drive? </p>
<p>Right now I open all of these in Isabelle/jedit and use "Save as" from the "File" menu. My use case has a number of .hs files which change frequently, so using "Save as" every time is rather tedious.</p>
<p>Gruß<br>
Max</p>



<a name="294754174"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Export%20files%20generated%20by%20code_export%20to%20hard%20.../near/294754174" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Export.20files.20generated.20by.20code_export.20to.20hard.20.2E.2E.2E.html#294754174">(Aug 22 2022 at 19:31)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
the "File" menu. My use case has a number of .hs files which change<br>
frequently, so using "Save as" every time is rather tedious.</p>
<p>No, as far as I understand the IO model of jEdit this is a remaining<br>
inconvenience of the VFS approach. I wonder if jEdit has multi-file or<br>
directory operations somewhere that still need to be (re)discovered.</p>
<p>Since export_code uses Generated_Files internally (apart from Export),<br>
you could experiment with Generated_Files.write_file or better use the<br>
command 'compile_generated_files' to turn the individual sources into<br>
some derived artifact. Thus the shell programming happens in Isabelle/ML.</p>
<p>Side-remark: When you say "hard drive" (or "disk") to mean the<br>
"file-system", it is a verbal violation of OS abstractions that are<br>
common-place since 1980. That is particular odd today, since most<br>
machines don't even have a hard drive anymore, and a solid state "disk"<br>
(SSD) is not a disk either.</p>
<p>Makarius</p>



<a name="294754185"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Export%20files%20generated%20by%20code_export%20to%20hard%20.../near/294754185" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Export.20files.20generated.20by.20code_export.20to.20hard.20.2E.2E.2E.html#294754185">(Aug 22 2022 at 19:31)</a>:</h4>
<p>From: "Max W. Haslbeck" &lt;<a href="mailto:max.haslbeck@gmx.de">max.haslbeck@gmx.de</a>&gt;<br>
Thanks for the pointer. For now I use the following Isabelle/ML script:</p>
<p>====================<br>
theory Scratch<br>
  imports Main<br>
begin</p>
<p>export_code binomial in Haskell</p>
<p>ML ‹<br>
val gen_files = Generated_Files.get_files (Proof_Context.theory_of @{context})<br>
val output_dir = Path.explode "~/output_hs/"<br>
›</p>
<p>(*<br>
(* The next line creates output_dir and writes the files there *)<br>
ML ‹map (Generated_Files.write_file write_dir) gen_files›<br>
*)</p>
<p>end<br>
====================</p>



<a name="294754194"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Export%20files%20generated%20by%20code_export%20to%20hard%20.../near/294754194" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Export.20files.20generated.20by.20code_export.20to.20hard.20.2E.2E.2E.html#294754194">(Aug 22 2022 at 19:31)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
In some sense this emulates the Isabelle2018 behaviour of export_code.</p>
<p>Just out of curiosity: What happens with the content of the global<br>
~/output_hs directory? Is it just for information, our do other tools<br>
take over the content?</p>
<p>Makarius</p>



<a name="294754202"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Export%20files%20generated%20by%20code_export%20to%20hard%20.../near/294754202" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Export.20files.20generated.20by.20code_export.20to.20hard.20.2E.2E.2E.html#294754202">(Aug 22 2022 at 19:31)</a>:</h4>
<p>From: "<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>" &lt;<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>&gt;<br>
What will be exported by this? Ie what does generated files contain. All files<br>
ever generated by the session?  </p>
<p>Peter</p>



<a name="294754217"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Export%20files%20generated%20by%20code_export%20to%20hard%20.../near/294754217" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Export.20files.20generated.20by.20code_export.20to.20hard.20.2E.2E.2E.html#294754217">(Aug 22 2022 at 19:31)</a>:</h4>
<p>From: Peter Lammich &lt;<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>&gt;<br>
I have use-cases where other tools, like the MlTon compiler or LLVM,<br>
shall take over. They then compile the generated code together with<br>
some other (non-generated) source file.</p>
<p>And I also need to integrate the Isabelle code generator into a larger<br>
build-process controlled by a Makefile/build-script.</p>
<p>How do I do that sort of stuff with the new code generator? </p>
<ul>
<li>
<p>Is there an Isabelle command line tool to "export" the generated<br>
files from Isabelle to the real file system? </p>
</li>
<li>
<p>Max solution has a hard-coded target directory. This is highly non-<br>
portable. How to export the files to a directory that is determined by<br>
my build-script/Makefile?</p>
</li>
</ul>



<a name="294756194"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Export%20files%20generated%20by%20code_export%20to%20hard%20.../near/294756194" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Export.20files.20generated.20by.20code_export.20to.20hard.20.2E.2E.2E.html#294756194">(Aug 22 2022 at 19:46)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
All files from the current theory, unless you filter more specifically.</p>
<p>Makarius</p>



<a name="294756326"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Export%20files%20generated%20by%20code_export%20to%20hard%20.../near/294756326" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Export.20files.20generated.20by.20code_export.20to.20hard.20.2E.2E.2E.html#294756326">(Aug 22 2022 at 19:47)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On 01/05/2019 00:51, Peter Lammich wrote:</p>
<blockquote>
<blockquote>
<p>Just out of curiosity: What happens with the content of the global<br>
~/output_hs directory? Is it just for information, our do other tools<br>
take over the content?</p>
</blockquote>
<p>I have use-cases where other tools, like the MlTon compiler or LLVM,<br>
shall take over. They then compile the generated code together with<br>
some other (non-generated) source file.</p>
</blockquote>
<p>This sounds like an application of the command 'compile_generated_files'<br>
e.g. in Isabelle2019-RC0. You can read about it in NEWS, the isar-ref<br>
manual, or do hypersearch for a few applications in Isabelle + AFP to<br>
get an idea.</p>
<blockquote>
<p>And I also need to integrate the Isabelle code generator into a larger<br>
build-process controlled by a Makefile/build-script.</p>
</blockquote>
<p>Most of that should no longer be required: you simply do all of the<br>
compilation and assembly inside Isabelle/ML, and only export the final<br>
artifacts.</p>
<p>See also documentation (or examples) on 'export_files' within ROOT<br>
files. This helps to wrap up everything nicely such that only "isabelle<br>
build -e" is required to materialize the final result in the file-system.</p>
<blockquote>
<ul>
<li>Max solution has a hard-coded target directory. This is highly non-<br>
portable. How to export the files to a directory that is determined by<br>
my build-script/Makefile?</li>
</ul>
</blockquote>
<p>You can choose export names (relative to the theory), and maybe strip<br>
some path components in the 'export_files' specification. There is no<br>
support for general renamings: I have tried to keep things simple.</p>
<p>By default, the build-script/Makefile is a candidate for deletion. The<br>
question should be: What are its remaining uses?</p>
<p>If there are fine points in new generated files / exported files that<br>
still make old Makefiles necessary, we have a short time-window before<br>
the Isabelle2019 release to sort this out.</p>
<p>Makarius</p>



<a name="294756985"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Export%20files%20generated%20by%20code_export%20to%20hard%20.../near/294756985" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Export.20files.20generated.20by.20code_export.20to.20hard.20.2E.2E.2E.html#294756985">(Aug 22 2022 at 19:52)</a>:</h4>
<p>From: "Max W. Haslbeck" &lt;<a href="mailto:max.haslbeck@gmx.de">max.haslbeck@gmx.de</a>&gt;<br>
It’s mainly for information, so that I can setup the corresponding Haskell code correctly. We’re trying to reason about LLVM programs in Isabelle/HOL. Right now im using llvm-hs[1] to generate an AST of LLVM code which I then use with Isabelle’s generated code for small test runs. All of this is in its early stages, so it’s useful to have a way to quickly export the generated code.</p>
<p>Gruß<br>
Max</p>
<p>[1] <a href="https://hackage.haskell.org/package/llvm-hs">https://hackage.haskell.org/package/llvm-hs</a></p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>