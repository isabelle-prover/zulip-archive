<html>
<head><meta charset="utf-8"><title>[isabelle] Here&#x27;s 54 ML_file imports from SML/NJ Library;... · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Here.27s.2054.20ML_file.20imports.20from.20SML.2FNJ.20Library.3B.2E.2E.2E.html">[isabelle] Here&#x27;s 54 ML_file imports from SML/NJ Library;...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294275898"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Here%27s%2054%20ML_file%20imports%20from%20SML/NJ%20Library%3B.../near/294275898" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Here.27s.2054.20ML_file.20imports.20from.20SML.2FNJ.20Library.3B.2E.2E.2E.html#294275898">(Aug 19 2022 at 14:19)</a>:</h4>
<p>From: Gottfried Barrow &lt;<a href="mailto:igbi@gmx.com">igbi@gmx.com</a>&gt;<br>
(At the bottom, I talk about how I have Lueng's extension of SML/NJ <br>
RegExp all imported, with only errors in two files, in particular <br>
"regexp-fn.sml". What I really want is his functions in <br>
"regexp-lib.sml", such as grep, findall, subst, substAll, replace, <br>
replaceAll, and 5 more. )</p>
<p>Consider me the unofficial marketing guy, like the unofficial mascot, in <br>
the stands, for a pro sports team. The management tolerates him, but <br>
it's inevitable he'll eventually be asked to leave, since he, at times, <br>
tarnishes the team image, a prestigious one, acquired over many years.</p>
<p>A professional programmer will have a different perspective about ML <br>
than myself. Only doing ML programming for 3 weeks or so, I see that it <br>
has its own special attributes. It seems streamlined in some ways, <br>
though anything with enough nested levels gets complex.</p>
<p>Signatures give a high-level overview, and by necessity separate values <br>
and functions from their details. Looking at signatures helps me find a <br>
lot of what I need. The syntax is not as streamlined as Haskell, but <br>
most syntax isn't, though Isar and Isabelle/HOL are very competitive.</p>
<p>But in the end, ML is the only language a person can do native <br>
programming inside Isabelle/HOL, though I suspect that will change with <br>
an official SC{<em>...</em>} command, someday, which will allow Scala to easily <br>
interact globally with a ML{<em>...</em>}.</p>
<p><em>There's Isabelle/ML and Poly/ML Library Support Already</em></p>
<p>First, it is as Makarius Wenzel said. There is actually already a lot of <br>
ML library support in Isabelle/ML, such as in file.ML, library.ML, <br>
path.ML, with even the ability to create squiggly lines with the <br>
messages in output.ML. Squiggly lines. Graphics. Modern computing. Yea. <br>
Yes. Si, senior. Ja, mate.</p>
<p>There also are some extra functions in David Mathews Poly/ML Basis, such <br>
as HashArray, and after searching to make sure its special, Google took <br>
me to Poly/ML's web page. There is "polyml-5.5.1-1\src\mlsource", which <br>
contains some Windows libraries, so I'll have to check that out.</p>
<p><a href="http://www.polyml.org/docs/Overview.html">http://www.polyml.org/docs/Overview.html</a></p>
<p><em>THE ZIP FILE</em></p>
<p>I attach a zip file, SMLNJ_lib_and_Luengs_RegExp_extension.zip.</p>
<p>In that file, there is one main file, NJlib.thy. That theory imports 54 <br>
SML/NJ files without errors, for me. After learning some ML, the files <br>
only required a minimal amount of edits, to add fully qualified names <br>
for functions, like "ord", "chr", "ref", etc. I tested a few things, but <br>
not much.</p>
<p>There are URLs in the file to the SML/NJ Library page, and I only <br>
imported what was potentially useful to me, among which are an Awk <br>
RegExp engine (though lacking in easy functions to use it), iteraters, <br>
random generators (one taken from Larry Paulson's book), hash tables, <br>
atoms, arrays, and a fifo.</p>
<p>*What I Really Want In the Big Ocean of Life Here on the Terrestrial <br>
Inhabitating Location*</p>
<p>I couldn't get Lueng's RegExp library working. I document the basic <br>
problems in "ml_lueng/Lueng.thy". What I really want is his high-level <br>
functions for regex use, not so much his Perl extension.</p>
<p>These functions are in "ml_lueng/RegExp/regexp-lib.sml", which I put in <br>
"ml_lueng/Lueng_regexp_lib_sig_and_sml.thy".</p>
<p>Lueng extended "match", which may not be the problem, but it's related <br>
to that.</p>
<p>All of Lueng's code in include, but I only include the RegExp and Util <br>
folders from SML/NJ Library.</p>
<p><a href="http://www.smlnj.org/doc/smlnj-lib/Manual/toc.html">http://www.smlnj.org/doc/smlnj-lib/Manual/toc.html</a><br>
<a href="http://www.cs.nyu.edu/leunga/sml-software.html">http://www.cs.nyu.edu/leunga/sml-software.html</a></p>
<p>Regards<br>
GB<br>
<a href="/user_uploads/14278/rLA2uN1UdPISaFXyuLywy6PY/SMLNJ_lib_and_Luengs_RegExp_extension.zip">SMLNJ_lib_and_Luengs_RegExp_extension.zip</a></p>



<a name="294276109"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Here%27s%2054%20ML_file%20imports%20from%20SML/NJ%20Library%3B.../near/294276109" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Here.27s.2054.20ML_file.20imports.20from.20SML.2FNJ.20Library.3B.2E.2E.2E.html#294276109">(Aug 19 2022 at 14:20)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
I made some progress. There were sharing issues, and SML/NJ seems to have some nonstandard extensions that were causing errors.</p>
<p>But I’m still stuck on errors in perl-engine.sml and the discrepancy between the Basis type char and the type R.Char.char.</p>
<p>Debugging ML within PIDE is quite interesting.</p>
<p>Larry Paulson<br>
<a href="/user_uploads/14278/o8CXOsQbwECh6YaQXCy10g4p/SMLNJ_lib_and_Luengs_RegExp_extension.zip">SMLNJ_lib_and_Luengs_RegExp_extension.zip</a></p>



<a name="294276120"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Here%27s%2054%20ML_file%20imports%20from%20SML/NJ%20Library%3B.../near/294276120" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Here.27s.2054.20ML_file.20imports.20from.20SML.2FNJ.20Library.3B.2E.2E.2E.html#294276120">(Aug 19 2022 at 14:20)</a>:</h4>
<p>From: Gottfried Barrow &lt;<a href="mailto:igbi@gmx.com">igbi@gmx.com</a>&gt;<br>
Larry,</p>
<p>Thanks a lot for the help. That helped me find one of the problems for sure.</p>
<p>One problem is that the type of StringCvt.cs in Poly/ML is "datatype cs <br>
= Index of word". In SML/NJ it's this: "type cs = int".</p>
<p>I include a file, "Lueng_regexp_lib_fun.thy". There's a function <br>
"search", which uses "StringCvt.scanString : ((char, cs) reader -&gt; ('a, <br>
cs) reader) -&gt; string -&gt; 'a option". So that's where the problem is for <br>
that file.</p>
<p>Five of the 11 functions I want now work. There's the statement <br>
"StringCvt.scanString (RE.find (compile regexp)) text", and I need to <br>
convert "int" to "word" at the return value of "RE.find".</p>
<p>I think the problem with "perl-engine-sig.sml" has to do with the <br>
differences between the "Char" structures of Poly/ML and SML/NJ. "Char" <br>
is in "String.sml" for Poly/ML, and "char.sml" for SML/NJ. The two <br>
different Char structures look substantially different, and they involve <br>
"StringCvt.reader", which is related to all this.</p>
<p>In the zip file, I include the SML/NJ files "char.sml" and <br>
"string-cvt.sml", along with the .sig files.</p>
<p>Thanks again,<br>
GB<br>
<a href="/user_uploads/14278/IiN6oifunD3FHfICTyxNh6Hh/i140417b__ml_lueng.zip">i140417b__ml_lueng.zip</a></p>



<a name="294276128"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Here%27s%2054%20ML_file%20imports%20from%20SML/NJ%20Library%3B.../near/294276128" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Here.27s.2054.20ML_file.20imports.20from.20SML.2FNJ.20Library.3B.2E.2E.2E.html#294276128">(Aug 19 2022 at 14:20)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
I don’t understand these problems, unless the code somehow breaks the abstraction barriers for the libraries. And that should be impossible.</p>
<p>Type cs is abstract. Structures like Char and String are specified by their signatures. The implementations should not matter at all.</p>
<p>It is possible that Isabelle’s own libraries modify some of these things (Char possibly), creating incompatibilities with the SML Basis Library.</p>
<p>This code is one problem:</p>
<p>fun getArgs text children = <br>
   let fun walk (M.Match(SOME{pos,len},children)) = <br>
           let val s = String.substring(text,pos,len)</p>
<p>String.substring expects a string and two ints.</p>
<p>fun search regexp text =<br>
       StringCvt.scanString (RE.find (compile regexp)) text</p>
<p>Find seems to include type cs in its result.</p>
<p>fun grep regexp text = <br>
       case (search regexp text) of<br>
         NONE =&gt; NONE<br>
       | SOME(M.Match(_,children)) =&gt; SOME(getArgs text children)</p>
<p>Using getArgs and search together tries to identify types int and cs. But I don’t know how this code ever compiled, unless SML/NJ doesn’t implement signature matching correctly.</p>
<p>Larry Paulson</p>



<a name="294276143"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Here%27s%2054%20ML_file%20imports%20from%20SML/NJ%20Library%3B.../near/294276143" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Here.27s.2054.20ML_file.20imports.20from.20SML.2FNJ.20Library.3B.2E.2E.2E.html#294276143">(Aug 19 2022 at 14:20)</a>:</h4>
<p>From: Gottfried Barrow &lt;<a href="mailto:igbi@gmx.com">igbi@gmx.com</a>&gt;<br>
Larry,</p>
<p>I might finally be understanding what you're saying.</p>
<p>The signature STRING_CVT is the same for both Poly/ML and SML/NJ, which <br>
is where the signatures of cs, reader, and scanstring are defined.</p>
<p>All I know is that I can't experiment with loading a modified SML/NJ <br>
StringCvt because the things it wants to load are at the compiler level.</p>
<p>I need to look at trying to run regexp-lib.sml under SML/NJ. If I can't <br>
get it to run under SML/NJ, it might make sense.</p>
<p>Thanks,<br>
GB</p>



<a name="294276161"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Here%27s%2054%20ML_file%20imports%20from%20SML/NJ%20Library%3B.../near/294276161" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Here.27s.2054.20ML_file.20imports.20from.20SML.2FNJ.20Library.3B.2E.2E.2E.html#294276161">(Aug 19 2022 at 14:20)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
See also <br>
<a href="http://isabelle.in.tum.de/repos/isabelle/file/Isabelle2013-2/src/Pure/ML-Systems/proper_int.ML">http://isabelle.in.tum.de/repos/isabelle/file/Isabelle2013-2/src/Pure/ML-Systems/proper_int.ML</a></p>
<p>SML basis with type int representing proper integers, not machine words.</p>
<p>Isabelle/ML is not Standard ML, it is what Standard ML could have been if <br>
that had not been messed up in the late 1990-ies.</p>
<p>If you want to continue this regexp comilation experiment seriously, you <br>
should probably move over to isabelle-dev and do it as a test for the <br>
forthcoming SML IDE, which integrates official SML into the Isabelle <br>
environment.</p>
<p>That might require some further adjustments of these relatively new <br>
things, but that is then part of the continuous development process over <br>
there.</p>
<p>Makarius</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>