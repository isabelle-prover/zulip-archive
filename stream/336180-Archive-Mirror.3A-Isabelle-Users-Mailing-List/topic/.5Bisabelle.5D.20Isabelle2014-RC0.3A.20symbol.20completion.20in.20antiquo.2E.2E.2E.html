<html>
<head><meta charset="utf-8"><title>[isabelle] Isabelle2014-RC0: symbol completion in antiquo... · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC0.3A.20symbol.20completion.20in.20antiquo.2E.2E.2E.html">[isabelle] Isabelle2014-RC0: symbol completion in antiquo...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294281834"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC0%3A%20symbol%20completion%20in%20antiquo.../near/294281834" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC0.3A.20symbol.20completion.20in.20antiquo.2E.2E.2E.html#294281834">(Aug 19 2022 at 14:50)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
There are many fine points like that, which I would have liked to see in <br>
forthcoming Isabelle2014, but did not make it due to still existing <br>
baggage of Proof General legacy.</p>
<p>Maybe after next week at Vienna we have a better impression how many <br>
remaining uses of Proof General are left over (as well as remaining <br>
users).</p>
<p>Everyone is invited to discuss that not just with me, but with any of the <br>
Isabelle/jEdit veterans.  Early adopters have jumped on the train in <br>
October 2011 with the first stable release of the Prover IDE, and the <br>
coming one is already version 5 in the internal counting.</p>
<p>Makarius</p>



<a name="294286523"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC0%3A%20symbol%20completion%20in%20antiquo.../near/294286523" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC0.3A.20symbol.20completion.20in.20antiquo.2E.2E.2E.html#294286523">(Aug 19 2022 at 15:14)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Makarius,</p>
<p>I am wondering why symbol completion in antiquotations inside text blocks behaves <br>
differently from symbol completion in ordinary term statements. Here's an example:</p>
<p>If I type a symbol name like \alpha in a lemma statement such as</p>
<p>lemma "\alpha"</p>
<p>then I can tell Isabelle to replace \alpha by α. (In fact, I have enabled immediate <br>
completion, so \alp suffices.) Inside antiquotations, however, this does not seem to work.</p>
<p>text {* @{term "\alpha"} *} makes Isabelle complain about a "bad escape character in <br>
string". In order to get α, I now have to type \&lt;alpha&gt; and then press Ctrl-B. This <br>
becomes particularly annoying with longer symbol names like \&lt;rightharpoonup&gt;.</p>
<p>Is this difference intentional? I would have expected that antiquotations switch back to <br>
"inner syntax mode" and thus behave as in ordinary term statements.</p>
<p>Andreas</p>



<a name="294287011"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC0%3A%20symbol%20completion%20in%20antiquo.../near/294287011" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC0.3A.20symbol.20completion.20in.20antiquo.2E.2E.2E.html#294287011">(Aug 19 2022 at 15:16)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On Tue, 8 Jul 2014, Andreas Lochbihler wrote:</p>
<blockquote>
<p>I am wondering why symbol completion in antiquotations inside text blocks <br>
behaves differently from symbol completion in ordinary term statements. <br>
Here's an example:</p>
<p>If I type a symbol name like \alpha in a lemma statement such as</p>
<p>lemma "\alpha"</p>
<p>then I can tell Isabelle to replace \alpha by α. (In fact, I have enabled <br>
immediate completion, so \alp suffices.) Inside antiquotations, however, this <br>
does not seem to work.</p>
<p>text {* @{term "\alpha"} *} makes Isabelle complain about a "bad escape <br>
character in string". In order to get α, I now have to type \&lt;alpha&gt; and then <br>
press Ctrl-B. This becomes particularly annoying with longer symbol names <br>
like \&lt;rightharpoonup&gt;.</p>
</blockquote>
<p>In June I wrote a very long section on Completion for the Isabelle/jEdit <br>
manual.  It might or might not shed light on this, and I would be <br>
interested to get feedback about the text.</p>
<p>The problem seen here is one of "language context" in the completion <br>
mechanism.  In certain situations, a \foo sequence is syntactically <br>
invalid and destroys the intended language context, dropping out of the <br>
syntax of a certain sub-language.  Thus the "symbols" flag of the language <br>
might get lost, and symbols are not completed.</p>
<p>I have presently no better answer than using a valid \&lt;foo&gt; symbol and <br>
complete on that.</p>
<p>Note that the problem would be absent, if the traditional quotes were <br>
replaced by the more robust cartouches.  But this is a bit speculative at <br>
the moment.</p>
<blockquote>
<p>Is this difference intentional? I would have expected that <br>
antiquotations switch back to "inner syntax mode" and thus behave as in <br>
ordinary term statements.</p>
</blockquote>
<p>The general intention of completion is to provide a "Do what I mean" <br>
mechanism for the Prover IDE, but the more it advances and becomes <br>
smarter, the more surprising the breakdowns.</p>
<p>For the moment we should just continue collecting observations, and <br>
further hints how to work smoothly with the system as it is now.</p>
<p>Makarius</p>



<a name="294287214"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC0%3A%20symbol%20completion%20in%20antiquo.../near/294287214" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC0.3A.20symbol.20completion.20in.20antiquo.2E.2E.2E.html#294287214">(Aug 19 2022 at 15:17)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Makarius,</p>
<p>On 09/07/14 17:27, Makarius wrote:</p>
<blockquote>
<blockquote>
<p>I am wondering why symbol completion in antiquotations inside text blocks behaves<br>
differently from symbol completion in ordinary term statements. Here's an example:</p>
<p>If I type a symbol name like \alpha in a lemma statement such as</p>
<p>lemma "\alpha"</p>
<p>then I can tell Isabelle to replace \alpha by α. (In fact, I have enabled immediate<br>
completion, so \alp suffices.) Inside antiquotations, however, this does not seem to work.</p>
<p>text {* @{term "\alpha"} *} makes Isabelle complain about a "bad escape character in<br>
string". In order to get α, I now have to type \&lt;alpha&gt; and then press Ctrl-B. This<br>
becomes particularly annoying with longer symbol names like \&lt;rightharpoonup&gt;.</p>
</blockquote>
<p>In June I wrote a very long section on Completion for the Isabelle/jEdit manual.  It might<br>
or might not shed light on this, and I would be interested to get feedback about the text.<br>
I read the text on completion, but I must admit that I would not have been able to figure <br>
out your explanation with dropping out of the language context. As is usual in the <br>
Isabelle documentation, your text describes the general principles, but not the concrete <br>
instances that one encounters in practice. For example, I was not able to figure out which <br>
language contexts exist (in a plain Isabelle/HOL session) and when language contexts are <br>
switched.</p>
</blockquote>
<p>There probably are the contexts "outer syntax", "inner syntax", "LaTeX text", ML source, <br>
but there could also be something like "inner syntax inside the antiquotation text" which <br>
might behave differently from "inner syntax inside the antiquotation term" and "inner <br>
syntax inside the antiquotation const". I don't know how I could find out which language <br>
context I am currently working in. Maybe it suffices to display the language context of <br>
the curser somewhere in Isabelle (e.g., in the status bar as Emacs used to do it).</p>
<p>I remember a presentation you gave long ago (possibly at the workshop in Cambridge in <br>
2010) in which you showed that you can nest an term antiquotation inside an ML <br>
antiquotation inside ... inside a text block. That made me think that there is probably <br>
not one separate language context for each antiquotation, but that I might expect the same <br>
behaviour as with normal inner syntax.</p>
<p>Andreas</p>
<blockquote>
<p>The problem seen here is one of "language context" in the completion mechanism.  In<br>
certain situations, a \foo sequence is syntactically invalid and destroys the intended<br>
language context, dropping out of the syntax of a certain sub-language.  Thus the<br>
"symbols" flag of the language might get lost, and symbols are not completed.</p>
<p>I have presently no better answer than using a valid \&lt;foo&gt; symbol and complete on that.</p>
<p>Note that the problem would be absent, if the traditional quotes were replaced by the more<br>
robust cartouches.  But this is a bit speculative at the moment.</p>
<blockquote>
<p>Is this difference intentional? I would have expected that antiquotations switch back to<br>
"inner syntax mode" and thus behave as in ordinary term statements.</p>
</blockquote>
<p>The general intention of completion is to provide a "Do what I mean" mechanism for the<br>
Prover IDE, but the more it advances and becomes smarter, the more surprising the breakdowns.</p>
<p>For the moment we should just continue collecting observations, and further hints how to<br>
work smoothly with the system as it is now.</p>
<p>Makarius</p>
</blockquote>



<a name="294287430"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC0%3A%20symbol%20completion%20in%20antiquo.../near/294287430" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC0.3A.20symbol.20completion.20in.20antiquo.2E.2E.2E.html#294287430">(Aug 19 2022 at 15:18)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
This is done with the ubiquitious C-hover idiom: it produces a popup <br>
saying "language: NAME".  The other flags for the language are not <br>
printed, but accessible dynamically in SideKick with "isabelle-markup" <br>
parser in the status window:</p>
<p>&lt;language name="NAME" symbols="false" antiquotes="false" delimited="true"/&gt;</p>
<p>Or you look in ~~/src/Pure/PIDE/markup.ML for the language contexts that <br>
are presently used in Isabelle/Pure -- but tools could invent their own.</p>
<p>To make this exploration more fun, consider this formal Isar source:</p>
<p>text ‹ see @{file "~~/src/Pure/PIDE/markup.ML"} ›</p>
<p>Here the file-system path specification has language context "path", <br>
because the "file" antiquotation has provided that semantic information. <br>
This means that file-name completion is active in PIDE: you can type some <br>
prefix of it and use C+b to get more from the directory content.</p>
<p>If this is madness, there is method in it ...</p>
<p>Makarius</p>



<a name="294287619"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC0%3A%20symbol%20completion%20in%20antiquo.../near/294287619" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC0.3A.20symbol.20completion.20in.20antiquo.2E.2E.2E.html#294287619">(Aug 19 2022 at 15:19)</a>:</h4>
<p>From: Christian Sternagel &lt;<a href="mailto:c.sternagel@gmail.com">c.sternagel@gmail.com</a>&gt;<br>
Does that mean that cartouches for antiquotations will not be part of <br>
Isabelle2014? Just for the record: I would like to have</p>
<p>@{term ‹α something›}</p>
<p>since, as you said, this would avoid some problems with symbol completion.</p>
<p>cheers</p>
<p>chris</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>