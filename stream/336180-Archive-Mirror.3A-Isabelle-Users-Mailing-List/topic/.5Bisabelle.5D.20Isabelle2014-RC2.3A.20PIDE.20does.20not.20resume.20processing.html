<html>
<head><meta charset="utf-8"><title>[isabelle] Isabelle2014-RC2: PIDE does not resume processing · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html">[isabelle] Isabelle2014-RC2: PIDE does not resume processing</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294287867"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294287867" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294287867">(Aug 19 2022 at 15:20)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Apart from a protocol crash, there might be non-termination in the <br>
protocol handler, e.g. because of problems to cancel old command <br>
transactions.  Normally the protocol loop is detached from actual <br>
execution, though.</p>
<p>A "PIDE greyout" means that the important assign_update message is not <br>
received, e.g. due to heavy overloading, long GC, or actual breakdown of <br>
the ML side.</p>
<p>I am including a changeset for testing, which produces syslog messages <br>
about the critical protocol phases.  This works via the "Syslog" panel, <br>
which is buffered and also restricted in size.</p>
<p>Makarius<br>
<a href="/user_uploads/14278/tX7cZfDGc4Tu9xLvozv_o96q/ch">ch</a></p>



<a name="294288336"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294288336" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294288336">(Aug 19 2022 at 15:23)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Makarius,</p>
<p>The greyout happened again (with Isabelle2014-RC3). This time, I had typed</p>
<p>thm $</p>
<p>and placed the cursor at $, then opened Query/Find theorems and searched for simp_implies.</p>
<p>I've attached the activity log and the output of the syslog. The Prover.echo command still <br>
works. There are no exceptions in the shell from which I have started PIDE.</p>
<p>Hope this helps<br>
Andreas<br>
<a href="/user_uploads/14278/zIUaCaDVmrHJy6rDzNS2rnIz/greyout.zip">greyout.zip</a></p>



<a name="294288597"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294288597" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294288597">(Aug 19 2022 at 15:24)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Thanks for continued testing.</p>
<p>Looking at the results, I would say there is a deadlock in the main <br>
Document.update operation -- as you have pointed out earlier that the CPU <br>
use of the poly process is 0.</p>
<p>We somehow need to get to the bottom if it.  Such problems are sometimes <br>
hardware specific, but if we are lucky it is just a soft mistake in my own <br>
machine room of Isabelle/ML.</p>
<p>Can you just continue testing with threads_trace = "5" in <br>
$ISABELLE_HOME_USER/etc/preferences?  You need to edit that file offline, <br>
while Isabelle/jEdit is not running.  That option will produce massive <br>
amounts of tracing information for syslog, but while the panel is <em>not</em> <br>
open the performance hit should be bearable.  Once the greyout happens <br>
again, you open an instance of the panel and look at the tail end of the <br>
last 100 messages.</p>
<p>Makarius</p>



<a name="294288610"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294288610" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294288610">(Aug 19 2022 at 15:24)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
That conclusion is actually too quick, because it is in conflict with the <br>
following observation:</p>
<blockquote>
<p>The Prover.echo command still works.</p>
</blockquote>
<p>On the other hand ...</p>
<blockquote>
<p>There are no exceptions in the shell from which I have started PIDE.</p>
</blockquote>
<p>but the latter refers to JVM exceptions.</p>
<p>If Prover.echo still works after the greyout, the protocol thread is alive <br>
and not dead-locked.  The abrupt end of the syslog after Document.update <br>
could also mean that it just crashed, but then we need to see ML <br>
exceptions on Raw Output.  The latter is unbuffered, though.  Did you have <br>
Raw Output open <em>before</em> the incident?</p>
<p>Makarius</p>



<a name="294288721"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294288721" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294288721">(Aug 19 2022 at 15:25)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Just to make sure here is an example for protocol commands that crash:</p>
<p>ML ‹<br>
   Isabelle_Process.protocol_command "error" (fn _ =&gt; error "Error");<br>
   Isabelle_Process.protocol_command "interrupt" (fn _ =&gt; Exn.interrupt ());<br>
›</p>
<p>Now the Scala console within Isabelle/jEdit can invoke them like this:</p>
<p>PIDE.session.protocol_command("error")<br>
   PIDE.session.protocol_command("interrupt")</p>
<p>The (unbuffered) result in Raw Output will be like this:</p>
<p>Isabelle protocol command failure: "interrupt"<br>
   Interrupt<br>
   Isabelle protocol command failure: "error"<br>
   Error</p>
<p>So if the Raw Output panel is active in this mysterious PIDE greyout, and <br>
the ML protocol command loop failing, it should be visible there.</p>
<p>One reason for Document.update crashing could be a resource problem, which <br>
leads to implicit interrupt in Poly/ML.  Above we see that this is printed <br>
explicitly, unlike in the normal user space error output, since this is <br>
the PIDE machine room.</p>
<p>Makarius</p>



<a name="294288767"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294288767" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294288767">(Aug 19 2022 at 15:25)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Makarius,</p>
<p>I opened Raw Output after the greyout. I'll keep Raw Output open the whole time when I <br>
continue testing.</p>
<p>Andreas</p>



<a name="294288790"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294288790" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294288790">(Aug 19 2022 at 15:25)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
OK, thanks.</p>
<p>Some more details about jEdit dockables: the instance gets created the <br>
first time you open it in the dock and it remains active while visually <br>
closed; it is detroyed only via explicit undocking.  In contrast, a <br>
floating instance exists exactly during the livetime of the visible <br>
window.</p>
<p>Makarius</p>



<a name="294288807"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294288807" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294288807">(Aug 19 2022 at 15:25)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Thanks for the hint. That also explains why sledgehammer aborts a running search when I <br>
change the position of the docked sledgehammer panel (say, from dock at bottom to dock at <br>
right).</p>
<p>Andreas</p>



<a name="294289011"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294289011" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294289011">(Aug 19 2022 at 15:27)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Some days ago, I've run myself into a situation of permanent "PIDE <br>
greyout" while editing some ML files within Isabelle/HOL, which <br>
automatically means it is under heavy load, because of the immense size of <br>
that session. This was presumably due to a Document.update protocol crash, <br>
but I did not have the Raw Output panel open to confirm it. The <br>
Prover.echo protocol command still worked afterwards.</p>
<p>For the next release candidate, which will be published later today, I <br>
have made an end to this game: PIDE protocol exceptions will be part of <br>
the buffered syslog channel.  Thus they can be retrieved later, in the <br>
rare situations when such a breakdown happens.</p>
<p>Moreover, I have made two rounds through the sources, to see where such a <br>
crash can happen theoretically.  I found nothing particular about query <br>
commands, but the protocol for PIDE document "garbage collection" had a <br>
weakness stemming from its first implementation 3 years ago: depending on <br>
timing, it was possible to have the ML process refer to undefined items <br>
and thus crash.</p>
<p>My own crash of ML blob editing fits exactly into this pattern, although I <br>
could not reproduce it systematically.  The query crash might be the same <br>
or something different.  If something like that ever happens again (after <br>
Isabelle2014-RC4), it is important to preserve the content of the Syslog <br>
panel afterwards and show that to me.</p>
<p>Makarius</p>



<a name="294294369"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294294369" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294294369">(Aug 19 2022 at 15:48)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Dear Makarius,</p>
<p>When I use the Query and Sledgehammer panels heavily, PIDE regularly gets into a state <br>
where the theory text has a grey background, but I cannot get it to resume working any <br>
more (There is also no process running, the CPU is idle). The GUI itself is reactive, but <br>
I cannot get any feedback from Isabelle any more. The Syslog only shows the welcome <br>
message and Raw Output is empty. I then have to shut down jEdit and restart PIDE. I am <br>
afraid that I don't know how to come up with a better description.</p>
<p>My system parameters:</p>
<p>Intel® Core™ i7-3630QM CPU @ 2.40GHz, 16GB memory<br>
Ubuntu 12.04 LTS</p>
<p>ML_PLATFORM="x86-linux"<br>
ML_HOME="/home/andreloc/isabelle/Isabelle2014-RC2/contrib/polyml-5.5.2-1/x86-linux"<br>
ML_SYSTEM="polyml-5.5.2"<br>
ML_OPTIONS="-H 500 --gcthreads 4"<br>
ISABELLE_JAVA_SYSTEM_OPTIONS=-Dfile.encoding=UTF-8 -server<br>
JEDIT_JAVA_OPTIONS=-Xms128m -Xmx3072m -Xss2m</p>
<p>Andreas</p>



<a name="294294440"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294294440" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294294440">(Aug 19 2022 at 15:49)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
There must have been a protocol crash somewhere at the bottom.  The next <br>
time when this happens, there are a few things that can be checked to pin <br>
it down more precisely:</p>
<p>* jEdit menu Utilities / Troubleshooting / Activity Log for JVM<br>
     exception traces -- if you run "isabelle jedit" on the command line<br>
     there should be information on the terminal as well.</p>
<p>* The following simple test of the ML/Scala protocol handler:</p>
<p>- open Raw Output panel, to make it active before trying anything</p>
<p>- open Console/Scala and emit this command:</p>
<p>PIDE.session.protocol_command("Prover.echo", "test")</p>
<p>The result "test" should appear on raw output.  This is the command<br>
       loop of the prover process in PIDE wrapping.</p>
<p>Makarius</p>



<a name="294294742"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294294742" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294294742">(Aug 19 2022 at 15:50)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Makarius,</p>
<p>Today, I experienced a PIDE greyout again, this time in Isabelle2014 while running <br>
quickcheck. I've attached the Syslog content and the output of error messages in the <br>
terminal from which I had started Isabelle/jEdit.</p>
<p>Hope this helps in narrowing down the problem,<br>
Andreas<br>
<a href="/user_uploads/14278/yj9Z3e2-HW0yjX2F9EeUePA8/greyout.zip">greyout.zip</a></p>



<a name="294316292"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294316292" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294316292">(Aug 19 2022 at 16:13)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Makarius,</p>
<p>Here is another datapoint in the greyout story with Isabelle2014. The attached syslog ends <br>
with a DUP exception. This time there were no exceptions on the command line. The greyout <br>
happened again while I was using the query panel to find theorems.</p>
<p>My setings are:</p>
<p>JEDIT_JAVA_OPTIONS="-Xms1024m -Xmx4096m -Xss4m"<br>
ML_OPTIONS="-H 500 --gcthreads 4"q</p>
<p>Hope this helps,<br>
Andreas<br>
<a href="/user_uploads/14278/FhmAp_CAivTOC6sE7G-hgVbq/syslog.zip">syslog.zip</a></p>



<a name="294316481"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294316481" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294316481">(Aug 19 2022 at 16:13)</a>:</h4>
<p>From: Harry Butterworth &lt;<a href="mailto:heb1001@gmail.com">heb1001@gmail.com</a>&gt;<br>
I have also been having to occasionally quit and restart Isabelle 2014<br>
jedit when it stops working.</p>
<p>Here is the syslog from the latest problem:</p>
<p>Welcome to Isabelle/HOL (Isabelle2014: August 2014)<br>
poly: gc_mark_phase.cpp:439: virtual void<br>
MTGCProcessMarkPointers::ScanAddressesInObject(PolyObject*, POLYUNSIGNED):<br>
Assertion `baseAddr &gt; (PolyWord<em>)obj &amp;&amp; baseAddr &lt; ((PolyWord</em>)obj)+length'<br>
failed.</p>
<p>message_output terminated<br>
/usr/local/Isabelle2014/lib/scripts/run-polyml-5.5.2: line 84:  1645<br>
Aborted                 (core dumped) "$POLY" -q -i $ML_OPTIONS --eval<br>
"$(perl "$ISABELLE_HOME/lib/scripts/recode.pl" "$MLTEXT")" --error-exit &lt;<br>
/dev/null</p>
<p>rmdir: failed to remove `/tmp/isabelle-harry1631': Directory not empty</p>
<p>standard_error terminated<br>
standard_output terminated<br>
process terminated<br>
command_input terminated<br>
process_manager terminated<br>
Return code: 134</p>



<a name="294317146"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294317146" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294317146">(Aug 19 2022 at 16:16)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
(This thread is already quite old, but not forgotten.  After several weeks <br>
I am back to normal network connectivity, to make a clean sweep ...)</p>
<p>Do you remember anything specific about the situation?  E.g. a very big <br>
message being output, say a large subgoal?</p>
<p>The bash output looks like a stack-overflow in <br>
isabelle.Protocol.clean_message, although the trace is truncated and the <br>
exception header is missing.</p>
<p>The JVM is very unflexible in thread stack management: the value given on <br>
startup is taken for all newly created threads, and cannot be changed at <br>
runtime.  This makes it hard to guess right once and for all, and for <br>
everyone.</p>
<p>The Isabelle/jEdit settings have these defaults for heap and stack:</p>
<p>JEDIT_JAVA_OPTIONS="-Xms128m -Xmx1024m -Xss2m"</p>
<p>I am using myself this one on a modest 8GB 64bit machine:</p>
<p>JEDIT_JAVA_OPTIONS="-Xms1024m -Xmx4096m -Xss4m"</p>
<p>Bigger machines should easily afford -Xss8m or more.</p>
<p>Oracle basically ships a Harley-Davidson -- it requires a lot of polishing <br>
and handywork from the power-user.</p>
<p>David Matthews provides more flexibility in Poly/ML: the stack can grow <br>
dynamically to some GBs, but even then it is possible to drive the system <br>
to the limits ...</p>
<p>Makarius</p>



<a name="294317205"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294317205" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294317205">(Aug 19 2022 at 16:16)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Makarius,</p>
<p>On 08/10/14 22:51, Makarius wrote:</p>
<blockquote>
<blockquote>
<p>Today, I experienced a PIDE greyout again, this time in Isabelle2014 while running<br>
quickcheck. I've attached the Syslog content and the output of error messages in the<br>
terminal from which I had started Isabelle/jEdit.</p>
</blockquote>
<p>Do you remember anything specific about the situation?  E.g. a very big message being<br>
output, say a large subgoal?</p>
<p>No, everything was quite small, actually. At that time, I was preparing exercises for the <br>
Isabelle course at ETH, so I just had a single theory file based on HOL/Main, and <br>
quickcheck normally outputs only small counterexamples.</p>
</blockquote>
<blockquote>
<p>The Isabelle/jEdit settings have these defaults for heap and stack:</p>
<p>JEDIT_JAVA_OPTIONS="-Xms128m -Xmx1024m -Xss2m"</p>
<p>I am using myself this one on a modest 8GB 64bit machine:</p>
<p>JEDIT_JAVA_OPTIONS="-Xms1024m -Xmx4096m -Xss4m"</p>
<p>I had the -Xmx4096m option set before, but I will now also adapt your settings for -Xss <br>
and -Xms. Let's see what happens.</p>
</blockquote>
<p>Andreas</p>



<a name="294317380"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294317380" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294317380">(Aug 19 2022 at 16:17)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
I will keep an eye on the JVM stack, and experiment with bigger values for <br>
a future release.</p>
<p>The memory problem is mainly due to the 32bit limitation of our JVM <br>
bundle, especially for Windows.  Of course there is a proper 64bit Java <br>
for that platform, but we don't use it yet.</p>
<p>Makarius</p>
<hr>
<p><a href="http://stop-ttip.org">http://stop-ttip.org</a></p>
<hr>



<a name="294318718"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294318718" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294318718">(Aug 19 2022 at 16:24)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
This is a hard crash of the Poly/ML runtime-system.  It has been reported <br>
sporadically since about 1 year, e.g. see <br>
<a href="https://lists.cam.ac.uk/mailman/htdig/cl-isabelle-users/2013-December/msg00090.html">https://lists.cam.ac.uk/mailman/htdig/cl-isabelle-users/2013-December/msg00090.html</a></p>
<p>My impression is that it occurs more often with big application or tight <br>
memory size, e.g. on Windows/Cygwin.</p>
<p>What is the approximative size of your application?  What is your OS <br>
platform?</p>
<p>Makarius</p>
<hr>
<p><a href="http://stop-ttip.org">http://stop-ttip.org</a>  777,282 people so far</p>
<hr>



<a name="294318827"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294318827" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294318827">(Aug 19 2022 at 16:24)</a>:</h4>
<p>From: Peter Lammich &lt;<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>&gt;<br>
With Isabelle-2014 + jedit, I get grayouts every day. Some of them<br>
resolve themselves after a few seconds (up to a minute), one or two<br>
times a day I have to restart the IDE. It's annoying, but you get used<br>
to it :(</p>
<p>When I got such a grayout during an Isabelle tutorial recently, I asked<br>
the students who of them had already experienced such a grayout, and had<br>
to restart. Almost all arms raised immediately!</p>



<a name="294318860"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294318860" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294318860">(Aug 19 2022 at 16:25)</a>:</h4>
<p>From: Joachim Breitner &lt;<a href="mailto:breitner@kit.edu">breitner@kit.edu</a>&gt;<br>
Hi,</p>
<p>thanks for the definition; I’ll pay closer attention to it from now, but<br>
I believe I have experienced this or similar effects when there is a<br>
looping procedure. My usual reaction is to go to the beginning of the<br>
file and change something in the theory header, hoping to reset the<br>
processing. It often works, but that does not mean that I’m not just<br>
cargo-culting :-)</p>
<p>Greetings,<br>
Joachim<br>
<a href="/user_uploads/14278/6UKmaXOkfGVFpSVU3DeLRl-o/signature.asc">signature.asc</a></p>



<a name="294319212"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294319212" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294319212">(Aug 19 2022 at 16:26)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On Thu, 20 Nov 2014, Peter Lammich wrote:</p>
<blockquote>
<p>With Isabelle-2014 + jedit, I get grayouts every day. Some of them <br>
resolve themselves after a few seconds (up to a minute), one or two <br>
times a day I have to restart the IDE. It's annoying, but you get used <br>
to it :(</p>
</blockquote>
<p>Getting used to problems means they are likely to remain indefinitely. <br>
It is important that users invest a minimum of time to figure out what is <br>
actually the situation and provide useful feedback on that.</p>
<p>I can only repeat that I am not aware of any such open problems in <br>
Isabelle2014.  I need tangible reports to do anything to increase the <br>
general system quality again one step further.</p>
<blockquote>
<p>Informal definition of "grayout": The text in the proof buffer becomes <br>
gray, and the prover is not responding any more. You can still edit the <br>
text.</p>
</blockquote>
<p>This is correct, and just a normal consequence how PIDE works: the editor <br>
is always ready to accept edits, and sends them continously to the prover. <br>
The prover reports eventually on the results.</p>
<p>The aspect "not responding any more" is a delicate one.  For example, <br>
garbage collection on the ML side or overloading with many long-running <br>
tasks could lead to seconds of delay, sometimes half a minute.  This is <br>
normal and not an immediate problem.  The situation can be improved by <br>
using an adequate machine (e.g. 4 cores and 8 GB is very little by today's <br>
standards).</p>
<p>Actual breakdown of the prover process is something else.  The Syslog <br>
panel should show ML exeptions if anything like that has happened.  By <br>
showing me that, I can figure out more.  By keeping the information <br>
secret, chances for improvement are much diminished.</p>
<p>Makarius</p>
<hr>
<p><a href="http://stop-ttip.org">http://stop-ttip.org</a>  925,412 people so far</p>
<hr>



<a name="294322310"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294322310" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294322310">(Aug 19 2022 at 16:42)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
The syslog ultimately says this:</p>
<p>Isabelle protocol command failure: "Document.update"<br>
   exception DUP ~5951 raised (line 261 of "General/table.ML")</p>
<p>which refers to Table.update_new.</p>
<p>Looking at the source, I did not find a plausible way how this exception <br>
could have happened -- there are normally handlers to say something more <br>
specific like ERROR "Duplicate command: ~5951".</p>
<p>If you see anything like this again, please tell me about it.</p>
<p>In Isabelle/f4e9bd04e1d5 I have reduced the chances of such low-level DUP <br>
exceptions, although that might not be directly relevant. We should <br>
continue this on isabelle-dev next time.</p>
<p>Makarius</p>
<hr>
<p><a href="http://stop-ttip.org">http://stop-ttip.org</a></p>
<hr>



<a name="294322374"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294322374" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294322374">(Aug 19 2022 at 16:42)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Dear Makarius,</p>
<p>These DUP exceptions (with varying values) occur several times a day with Isabelle2014. <br>
They happen when I heavily use find_theorems (with session image HOL-Probability). Most <br>
likely, when I start the search while there is no valid context (e.g., because the current <br>
theory file is part of HOL-Probability or because there is a syntax error), or when I <br>
restart the search while another search is still going on. A week ago, I switched to the <br>
repository version (currently 059ba950a657). Since then I have not experienced any of <br>
these greyouts. I'll let you know on isabelle-dev when they reappear.</p>
<p>Andreas</p>



<a name="294322390"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294322390" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294322390">(Aug 19 2022 at 16:42)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On Wed, 19 Nov 2014, Andreas Lochbihler wrote:</p>
<blockquote>
<p>These DUP exceptions (with varying values) occur several times a day with <br>
Isabelle2014.</p>
</blockquote>
<p>I was not aware of any such problem in the official release.  As usual, <br>
problems that are kept secret will remain so over indefinite time.</p>
<blockquote>
<blockquote>
<p>In Isabelle/f4e9bd04e1d5 I have reduced the chances of such low-level<br>
 DUP exceptions, although that might not be directly relevant.</p>
</blockquote>
</blockquote>
<p>It could be worth trying this tiny change <br>
<a href="http://isabelle.in.tum.de/repos/isabelle/rev/f4e9bd04e1d5">http://isabelle.in.tum.de/repos/isabelle/rev/f4e9bd04e1d5</a> on official <br>
Isabelle2014, just by editing $ISABELLE_HOME/src/Pure/General/table.ML <br>
accordingly and rebooting the system.</p>
<p>Makarius</p>
<hr>
<p><a href="http://stop-ttip.org">http://stop-ttip.org</a>  911,984 people so far</p>
<hr>



<a name="294322422"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294322422" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294322422">(Aug 19 2022 at 16:42)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Makarius,</p>
<p>On 19/11/14 11:01, Makarius wrote:</p>
<blockquote>
<blockquote>
<p>These DUP exceptions (with varying values) occur several times a day with Isabelle2014.</p>
</blockquote>
<p>I was not aware of any such problem in the official release.  As usual, problems that are<br>
kept secret will remain so over indefinite time.<br>
I did not get these exceptions during the test phase of release candidates, but I was not <br>
working as intensively with Isabelle at that time, either. You cannot complain that I have <br>
not reported this problem with DUP. I just did not want to send you an e-mail every time <br>
the same failure occurs.</p>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>In Isabelle/f4e9bd04e1d5 I have reduced the chances of such low-level<br>
 DUP exceptions, although that might not be directly relevant.</p>
</blockquote>
</blockquote>
<p>It could be worth trying this tiny change<br>
<a href="http://isabelle.in.tum.de/repos/isabelle/rev/f4e9bd04e1d5">http://isabelle.in.tum.de/repos/isabelle/rev/f4e9bd04e1d5</a> on official Isabelle2014, just<br>
by editing $ISABELLE_HOME/src/Pure/General/table.ML accordingly and rebooting the system.<br>
I'll do that, but I cannot promise that I will have time to thoroughly test it during <br>
work. My work now has moved to the repository version and no longer runs with <br>
Isabelle2014, but I have a bunch of other theories that I might get back to some time.</p>
</blockquote>
<p>Andreas</p>



<a name="294322438"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294322438" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294322438">(Aug 19 2022 at 16:42)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
I did not complain.  My impression is that the testing of the Isabelle2014 <br>
release candidates resulted in a fairly good release.</p>
<p>It is just a reminder to everyone who sees practical relevant problems to <br>
report them.  Something that fails at intervals of weeks or months is <br>
merely a fine point (still to be considered eventually).  Something that <br>
fails daily is getting in the way of practical work.</p>
<p>But frequent and reliable failure also means it is relatively easy to pin <br>
down and eliminate.</p>
<p>Makarius</p>
<hr>
<p><a href="http://stop-ttip.org">http://stop-ttip.org</a></p>
<hr>



<a name="294322609"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294322609" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294322609">(Aug 19 2022 at 16:43)</a>:</h4>
<p>From: Peter Lammich &lt;<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>&gt;</p>
<blockquote>
<p>OK, I recommend to apply the tiny change from <br>
<a href="http://isabelle.in.tum.de/repos/isabelle/rev/f4e9bd04e1d5">http://isabelle.in.tum.de/repos/isabelle/rev/f4e9bd04e1d5</a> by editing <br>
Isabelle2014/src/Pure/General/table.ML accordingly, and rebooting (which <br>
will cause an automatic rebuild of logic images).</p>
<p>If anything like that happens again, just keep me informed.<br>
</p>
</blockquote>
<p>Again, a permanent grayout, which did not recover itself. This time,<br>
syslog sais:</p>
<p>Welcome to Isabelle/CAVA_Base (Isabelle2014: August 2014)<br>
Isabelle protocol command failure: "Document.update"<br>
exception Thread "Thread creation failed" raised (line 48 of<br>
"ML-Systems/polyml.ML")<br>
Isabelle protocol command failure: "Document.update"<br>
Undefined document version: -60998<br>
Isabelle protocol command failure: "Document.remove_versions"<br>
Attempt to remove execution version -60993</p>



<a name="294322730"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294322730" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294322730">(Aug 19 2022 at 16:44)</a>:</h4>
<p>From: Peter Lammich &lt;<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>&gt;<br>
This is what syslog printed on my last grayout, which did not recover<br>
itself:</p>
<p>Welcome to Isabelle/CAVA_Base (Isabelle2014: August 2014)<br>
Isabelle protocol command failure: "Document.update"<br>
exception DUP ~111048 raised (line 261 of "General/table.ML")</p>



<a name="294322769"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294322769" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294322769">(Aug 19 2022 at 16:44)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
OK, I recommend to apply the tiny change from <br>
<a href="http://isabelle.in.tum.de/repos/isabelle/rev/f4e9bd04e1d5">http://isabelle.in.tum.de/repos/isabelle/rev/f4e9bd04e1d5</a> by editing <br>
Isabelle2014/src/Pure/General/table.ML accordingly, and rebooting (which <br>
will cause an automatic rebuild of logic images).</p>
<p>If anything like that happens again, just keep me informed.</p>
<p>Makarius</p>
<hr>
<p><a href="http://stop-ttip.org">http://stop-ttip.org</a>  1,015,195 people so far</p>
<hr>



<a name="294322894"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294322894" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294322894">(Aug 19 2022 at 16:45)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
A java process with 100% (and a few GB memory) could mean that the <br>
specified heap is full and GC failing to continue properly.  This is a <br>
well-known "feature" of the JVM.  You need to give more room in advance, <br>
e.g. like this in $ISABELLE_HOME_USER/etc/settings:</p>
<p>JEDIT_JAVA_OPTIONS="-Xms1024m -Xmx4096m -Xss4m"</p>
<p>There are a few more examples in <br>
$ISABELLE_HOME/src/Tools/jEdit/etc/settings -- you need to restart the <br>
application afterwards.</p>
<p>This only refers the "isabelle jedit" command-line tool, or the Linux <br>
toplevel "app" script.  For Mac OS X, the Info.plist provides similar JVM <br>
properties.  Likewise for Windows in the Isabelle2014.ini file.</p>
<p>Note that the defaults are for a 2-4 GB machine in 32bit mode, where JVM <br>
memory is tight.  On Linux or Mac OS X the JVM is usually in 64bit mode, <br>
and bigger heap as above can be easily afforded.  On Windows the bundled <br>
JVM is always for 32bit, though, but a 64bit one could be installed <br>
manually, e.g. by replacing the Isabelle2014/contrib/jdk directory.</p>
<p>Makarius</p>
<hr>
<p><a href="http://stop-ttip.org">http://stop-ttip.org</a>  1,023,025 people so far</p>
<hr>



<a name="294323073"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294323073" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294323073">(Aug 19 2022 at 16:46)</a>:</h4>
<p>From: Gottfried Barrow &lt;<a href="mailto:igbi@gmx.com">igbi@gmx.com</a>&gt;<br>
Makarius wrote:</p>
<blockquote>
<p>A java process with 100% (and a few GB memory) could mean that the <br>
specified heap is full and GC failing to continue properly. This is a <br>
well-known "feature" of the JVM. You need to give more room in <br>
advance, e.g. like this in $ISABELLE_HOME_USER/etc/settings:<br>
JEDIT_JAVA_OPTIONS="-Xms1024m -Xmx4096m -Xss4m"</p>
</blockquote>
<p>I'm not having any big problems, but when I try that with 32-bit Java, <br>
on a PC with 16G of RAM, the PIDE tries to start, but quickly terminates.</p>
<blockquote>
<p>...the defaults are for a 2-4 GB machine in 32bit mode, where JVM <br>
memory is tight. ... On Windows the bundled JVM is always for 32bit, <br>
though, but a 64bit one could be installed manually, e.g. by replacing <br>
the Isabelle2014/contrib/jdk directory.</p>
</blockquote>
<p>So, I did this:</p>
<p>*) Install the 64-bit JDK: <br>
<a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html">http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html</a></p>
<p>*) Copy 'C:\Program Files\java\jdk1.7.0_71' to <br>
'Isabelle2014\contrib\jdk\jdk1.7.0_71'</p>
<p>*) Rename 'Isabelle2014\contrib\jdk\x86-cygwin' to 'jdk\x86-cygwin__OLD'</p>
<p>*) Rename 'Isabelle2014\contrib\jdk\jdk1.7.0_71' to 'jdk\x86-cygwin'</p>
<p>I'm using these settings on a PC with 16G of RAM and cheap 8-core AMD <br>
FX-8320:</p>
<p>JEDIT_JAVA_OPTIONS="-Xms4G -Xmx8G -Xss4m"</p>
<p>It's working so far. Thanks for the info.</p>
<p>Regards,<br>
GB</p>



<a name="294323100"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294323100" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294323100">(Aug 19 2022 at 16:46)</a>:</h4>
<p>From: Gottfried Barrow &lt;<a href="mailto:igbi@gmx.com">igbi@gmx.com</a>&gt;<br>
With 64-bit Java it worked out and is working out because I set the <br>
environment with a batch file, and then I start 'isabelle' with a <br>
combination of a batch file and bash file like this:</p>
<p>BATCH:</p>
<p>start /MIN mintty.exe -i /Cygwin-Terminal.ico "%~dp0%~n0.bash"</p>
<p>BASH:</p>
<p>isabelle jedit -l HOL</p>
<p>If I try to use 'Isabelle2014.exe' directly, or us it in a batch file, I <br>
get a window that says, "Error starting Java VM".</p>
<p>It doesn't matter to me, but someone else may need the info to use <br>
64-bit Java.</p>
<p>Regards,<br>
GB</p>



<a name="294323119"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294323119" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294323119">(Aug 19 2022 at 16:46)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Indeed.  This is actually the main reason why Isabelle on Windows does not <br>
have the 64 bit option yet: the .exe already determines the platform <br>
personality, and it is not possible to switch that later.</p>
<p>Java 8 has a slightly different .exe for applications, but it is also <br>
quite new.  Maybe that can be used in the next release.</p>
<p>Makarius</p>
<hr>
<p><a href="http://stop-ttip.org">http://stop-ttip.org</a>  1,061,642 people so far</p>
<hr>



<a name="294324471"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294324471" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294324471">(Aug 19 2022 at 16:54)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
This might be of concern to David Matthews, the man behind Poly/ML.</p>
<p>I just want to point out, that Isabelle/ML can quite easily cope with a <br>
situation, where Thread.fork may sporadically fail due to resource <br>
problems, in a way where exceptions won't crash the system infrastructure. <br>
It will be done like that in the next Isabelle release.</p>
<p>Until then the same procedure as everytime: tangible problem reports lead <br>
to eventual resolution; non-tangible or secret problems will remain <br>
indefinitely.</p>
<p>Makarius</p>



<a name="294324498"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294324498" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294324498">(Aug 19 2022 at 16:54)</a>:</h4>
<p>From: Peter Lammich &lt;<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>&gt;<br>
Again the assertion error from the garbage-collector, again from jedit<br>
under heavy load.</p>
<p>This (probably Poly/ML) problem starts to get annyoing ...</p>
<p>Peter</p>
<hr>
<p>Welcome to Isabelle/HOL (Isabelle2014: August 2014)<br>
poly: gc_mark_phase.cpp:439: virtual void<br>
MTGCProcessMarkPointers::ScanAddressesInObject(PolyObject*,<br>
POLYUNSIGNED): Assertion `baseAddr &gt; (PolyWord*)obj &amp;&amp; baseAddr &lt;<br>
((PolyWord*)obj)+length' failed.</p>
<p>message_output terminated</p>



<a name="294325638"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294325638" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294325638">(Aug 19 2022 at 17:00)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On Tue, 30 Dec 2014, Peter Lammich wrote:</p>
<blockquote>
<blockquote>
<p>OK, I recommend to apply the tiny change from<br>
<a href="http://isabelle.in.tum.de/repos/isabelle/rev/f4e9bd04e1d5">http://isabelle.in.tum.de/repos/isabelle/rev/f4e9bd04e1d5</a> by editing<br>
Isabelle2014/src/Pure/General/table.ML accordingly, and rebooting (which<br>
will cause an automatic rebuild of logic images).</p>
<p>If anything like that happens again, just keep me informed.<br>
</p>
</blockquote>
<p>Again, a permanent grayout, which did not recover itself.</p>
</blockquote>
<p>Thanks for reporting that.  As always, it is important for me get an <br>
impression about two things:</p>
<p>(1) What kind of crashes can happen.</p>
<p>(2) The approximate frequency they happen.</p>
<p>In that sense, just keep me informed if you see something like this again.</p>
<p>Anyone else who sees the same or similar breakdowns is welcome to say so, <br>
too.</p>
<blockquote>
<p>This time, syslog sais:</p>
<p>Welcome to Isabelle/CAVA_Base (Isabelle2014: August 2014)<br>
Isabelle protocol command failure: "Document.update"<br>
exception Thread "Thread creation failed" raised (line 48 of "ML-Systems/polyml.ML")</p>
</blockquote>
<blockquote>
<p>Isabelle protocol command failure: "Document.update"<br>
Undefined document version: -60998<br>
Isabelle protocol command failure: "Document.remove_versions"<br>
Attempt to remove execution version -60993</p>
</blockquote>
<p>Here I was first distracted by the latter part, which would have been an <br>
integrity problem within the PIDE protocol state, i.e. in my own <br>
department.</p>
<p>The relevant bit is "Thread creation failed", though, which is produced by <br>
the Poly/ML runtime system, when the system function pthread_create fails <br>
(according to libpolyml/processes.cpp).  The man page for that function <br>
says about error situations:</p>
<p>EAGAIN Insufficient resources to create another thread,  or  a  system-<br>
               imposed  limit  on  the  number of threads was encountered.  The<br>
               latter case  may  occur  in  two  ways:  the  RLIMIT_NPROC  soft<br>
               resource  limit  (set via setrlimit(2)), which limits the number<br>
               of process for a real user ID, was reached; or the kernel's sys‐<br>
               tem-wide   limit   on  the  number  of  threads,  /proc/sys/ker‐<br>
               nel/threads-max, was reached.</p>
<p>We can probably ignore the explicit /proc/sys/kernel/threads-max -- it is <br>
a very high value on my Ubuntu system.</p>
<p>In other words, we are back to the usual guess of insufficient resources <br>
-- unless your application was unexpectedly tiny.</p>
<p>It should be explicitly noted that stack space was already sucessfully <br>
allocated -- there is a different exception for that: "Unable to allocate <br>
thread stack".</p>
<p>Maybe we are slowly moving out of the 32-bit era, but there might be a <br>
completely different reason.</p>
<p>Makarius</p>



<a name="294325829"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294325829" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294325829">(Aug 19 2022 at 17:02)</a>:</h4>
<p>From: Peter Lammich &lt;<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>&gt;<br>
Here is the next one. Putting Isabelle under heavy load seems not to be<br>
a good idea nowadays :( </p>
<p>A few years ago, Isabelle used to be very stable, even on big stuff ...</p>
<p>Welcome to Isabelle/HOL (Isabelle2014: August 2014)<br>
poly: gc_mark_phase.cpp:439: virtual void<br>
MTGCProcessMarkPointers::ScanAddressesInObject(PolyObject*,<br>
POLYUNSIGNED): Assertion `baseAddr &gt; (PolyWord*)obj &amp;&amp; baseAddr &lt;<br>
((PolyWord*)obj)+length' failed.</p>
<p>Malformed message:<br>
bad chunk (unexpected EOF after 3012 of 4431 bytes)<br>
message_output terminated<br>
/home/lammich/opt/Isabelle2014/lib/scripts/run-polyml-5.5.2: line 84:<br>
7861 Aborted                 (core dumped) "$POLY" -q -i $ML_OPTIONS<br>
--eval "$(perl "$ISABELLE_HOME/lib/scripts/recode.pl" "$MLTEXT")"<br>
--error-exit &lt; /dev/null</p>
<p>standard_error terminated<br>
standard_output terminated<br>
process terminated<br>
command_input terminated<br>
process_manager terminated<br>
Return code: 134</p>



<a name="294326105"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2014-RC2%3A%20PIDE%20does%20not%20resume%20processing/near/294326105" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2014-RC2.3A.20PIDE.20does.20not.20resume.20processing.html#294326105">(Aug 19 2022 at 17:03)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On Fri, 9 Jan 2015, Peter Lammich wrote:</p>
<blockquote>
<p>Here is the next one. Putting Isabelle under heavy load seems not to be<br>
a good idea nowadays :(</p>
<p>A few years ago, Isabelle used to be very stable, even on big stuff ...</p>
</blockquote>
<p>This impression is not based on facts: the applications today are much <br>
larger than in the past, and we are actually doing quite well.</p>
<p>There was always a hidden concrete wall, and some applications / users <br>
have driven very fast towards it without being aware of normal resource <br>
limitations on concrete computing infrastructure.  That concrete wall has <br>
been moved many times over many years, such that today we can do insanely <br>
large applications in a quite stable environment.</p>
<p>Now that TTY and Proof General support has been finally deleted from the <br>
code-base, I can revisit some old problems in a better way, to make the <br>
system even more stable.</p>
<blockquote>
<p>Welcome to Isabelle/HOL (Isabelle2014: August 2014)<br>
poly: gc_mark_phase.cpp:439: virtual void<br>
MTGCProcessMarkPointers::ScanAddressesInObject(PolyObject*,<br>
POLYUNSIGNED): Assertion `baseAddr &gt; (PolyWord*)obj &amp;&amp; baseAddr &lt;<br>
((PolyWord*)obj)+length' failed.</p>
</blockquote>
<p>See also this thread "Report of Crash of Isabelle 2014" <br>
<a href="https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2014-December/msg00097.html">https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2014-December/msg00097.html</a></p>
<p>Makarius</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>