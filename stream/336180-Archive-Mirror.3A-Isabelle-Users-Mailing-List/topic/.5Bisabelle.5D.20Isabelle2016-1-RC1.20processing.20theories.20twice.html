<html>
<head><meta charset="utf-8"><title>[isabelle] Isabelle2016-1-RC1 processing theories twice · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2016-1-RC1.20processing.20theories.20twice.html">[isabelle] Isabelle2016-1-RC1 processing theories twice</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294684940"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2016-1-RC1%20processing%20theories%20twice/near/294684940" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2016-1-RC1.20processing.20theories.20twice.html#294684940">(Aug 22 2022 at 14:14)</a>:</h4>
<p>From: Jasmin Blanchette &lt;<a href="mailto:jasmin.blanchette@inria.fr">jasmin.blanchette@inria.fr</a>&gt;<br>
For the record, I have been running into these issues too on my Mac for the past several months. I have also showed them to Makarius during ITP, so it should be on his radar.</p>
<p>Jasmin</p>



<a name="294684952"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2016-1-RC1%20processing%20theories%20twice/near/294684952" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2016-1-RC1.20processing.20theories.20twice.html#294684952">(Aug 22 2022 at 14:14)</a>:</h4>
<p>From: Manuel Eberl &lt;<a href="mailto:eberlm@in.tum.de">eberlm@in.tum.de</a>&gt;<br>
I also noticed this. Additionally, it seems that the IDE gets very<br>
unresponsive if you change stuff in an "early" theory in the dependency<br>
tree. Sometimes it's so bad that I have to restart the entire thing.</p>
<p>Manuel</p>



<a name="294699624"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2016-1-RC1%20processing%20theories%20twice/near/294699624" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2016-1-RC1.20processing.20theories.20twice.html#294699624">(Aug 22 2022 at 14:32)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On 31/10/16 18:37, Mathias Fleury wrote:</p>
<blockquote>
<p>Steps to reproduce:<br>
Run isabelle such that it loads some theories, e.g.:<br>
   isabelle jedit -l Pure src/HOL/List.thy</p>
<p>Wait until all of the theories are processed. </p>
<p>Scroll in the buffer List.</p>
<p>Isabelle/jEdit first starts processing List and then restarts processing the buffers from the beginning.</p>
<p>Instead of waiting that all theories are processed, one can also do some random clicking in the List buffer.</p>
</blockquote>
<p>I still cannot reproduce it -- I've seen it last summer on the machine<br>
of Jasmin once, but never anywhere else.</p>
<p>Is that really a fresh Isabelle2016-1-RC1 without any special options or<br>
preferences?</p>
<blockquote>
<p>The described reprocessing of the files is done only once. It appears on both macOS (running Sierra) and Linux (archlinux, so another unsupported OS…).</p>
</blockquote>
<p>Arch Linux is just untested, but not unsupported. The reason for that is<br>
due to the nature of it being individually configured in every respect.<br>
It means anything could go wrong, but Arch users are the master of their<br>
system and can make it work.</p>
<p>In practice, I have never heard of a specific Arch Linux problem with<br>
Isabelle, although I occasionally see users of that platform.</p>
<blockquote>
<p>Is there anyway to give more informations?</p>
</blockquote>
<p>Any particular jEdit plugins and preferences. In particular, what is the<br>
Look-and-feel?</p>
<p>If it is reliably reproducible for you, you can also make a bisection on<br>
the repository to see where the problem is located in the history.</p>
<p>Makarius</p>



<a name="294699842"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2016-1-RC1%20processing%20theories%20twice/near/294699842" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2016-1-RC1.20processing.20theories.20twice.html#294699842">(Aug 22 2022 at 14:33)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
This sounds more like the normal situation when the JVM heap fills up --<br>
this is inherent in JVM memory menagement.  The default configuration<br>
for x86_64 platforms has -Xmx2560m in a platform-specific place. A<br>
typical value is -Xmx4096m and more can be tried depending on the hardware.</p>
<p>E.g. the new HOL-Analysis session is so big that it easily exhausts the<br>
defaults. I have tried it on the 32bit Windows version, where the JVM is<br>
confined to 1 or 1.5 GB, and it locks up almost immediately due to<br>
overfull heap.</p>
<p>Here is cumulative information from NEWS for Isabelle2016 and<br>
Isabelle2016-1:</p>
<ul>
<li>
<p>Java runtime options are determined separately for 32bit vs. 64bit<br>
platforms as follows.</p>
<ul>
<li>
<p>Isabelle desktop application: platform-specific files that are<br>
  associated with the main app bundle</p>
</li>
<li>
<p>isabelle jedit: settings<br>
  JEDIT_JAVA_SYSTEM_OPTIONS<br>
  JEDIT_JAVA_OPTIONS32 vs. JEDIT_JAVA_OPTIONS64</p>
</li>
</ul>
</li>
<li>
<p>Many Isabelle tools that require a Java runtime system refer to the<br>
settings ISABELLE_TOOL_JAVA_OPTIONS32 / ISABELLE_TOOL_JAVA_OPTIONS64,<br>
depending on the underlying platform.</p>
</li>
</ul>
<p>Instead of adding more options next time, I will try once again to tune<br>
the whole system such that it can carry even bigger application. That<br>
game is a variant of Tetris, but so far it could always be continued one<br>
step further.</p>
<p>Makarius</p>



<a name="294700204"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2016-1-RC1%20processing%20theories%20twice/near/294700204" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2016-1-RC1.20processing.20theories.20twice.html#294700204">(Aug 22 2022 at 14:35)</a>:</h4>
<p>From: Mathias Fleury &lt;<a href="mailto:mathias.fleury12@gmail.com">mathias.fleury12@gmail.com</a>&gt;<br>
Hello Makarius and Isabelle list,</p>
<p>@Jasmin and Manuel: a possible workaround consists in deactivating the auto_resolve in the Isabelle options.</p>
<p>Now the technical details:</p>
<blockquote>
<p>On 1 Nov 2016, at 22:32, Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt; wrote:</p>
<p>If it is reliably reproducible for you, you can also make a bisection on<br>
the repository to see where the problem is located in the history.</p>
</blockquote>
<p>I've finally done it and the issue is much older than had I expected: it goes back to commit <a href="https://isabelle.in.tum.de/repos/isabelle/rev/60916">https://isabelle.in.tum.de/repos/isabelle/rev/60916</a> &lt;<a href="https://isabelle.in.tum.de/repos/isabelle/rev/60916">https://isabelle.in.tum.de/repos/isabelle/rev/60916</a>&gt; and more precisely to the following part of the change:</p>
<ul>
<li>if (change.deps_changed &amp;&amp; PIDE.options.bool("jedit_auto_load")) PIDE.deps_changed()</li>
<li>if (PIDE.options.bool("jedit_auto_load") &amp;&amp; change.deps_changed ||</li>
<li>PIDE.options.bool("jedit_auto_resolve") &amp;&amp; change.version.nodes.undefined_blobs.nonEmpty)</li>
<li>PIDE.deps_changed()</li>
</ul>
<p>jedit_auto_resolve is activated (both in this version by default and in my setup). If there are non-processed blobs (i.e. a lot of SML files here) and I click in the List buffer, the processing restarts. I have no idea why the reprocessing happens only once (i.e. there are no undefined_blobs anymore…).</p>
<blockquote>
<blockquote>
<p>Is there anyway to give more informations?</p>
</blockquote>
<p>Any particular jEdit plugins and preferences. In particular, what is the<br>
Look-and-feel?<br>
</p>
</blockquote>
<p>Having a look at this part of the question showed me that opening and closing the option panel triggers the same reprocessing. Or even just activating the auto_resolve option.</p>
<ul>
<li>Mac OSX Look-and-feel.</li>
<li>No plugin.</li>
</ul>
<p>Is there a good way to give the list of the Isabelle-relevant options?</p>
<p>Mathias</p>
<blockquote>
<p>On 31/10/16 18:37, Mathias Fleury wrote:</p>
<blockquote>
<p>Steps to reproduce:<br>
Run isabelle such that it loads some theories, e.g.:<br>
  isabelle jedit -l Pure src/HOL/List.thy</p>
<p>Wait until all of the theories are processed. </p>
<p>Scroll in the buffer List.</p>
<p>Isabelle/jEdit first starts processing List and then restarts processing the buffers from the beginning.</p>
<p>Instead of waiting that all theories are processed, one can also do some random clicking in the List buffer.</p>
</blockquote>
<p>I still cannot reproduce it -- I've seen it last summer on the machine<br>
of Jasmin once, but never anywhere else.</p>
<p>Is that really a fresh Isabelle2016-1-RC1 without any special options or<br>
preferences?</p>
<blockquote>
<p>The described reprocessing of the files is done only once. It appears on both macOS (running Sierra) and Linux (archlinux, so another unsupported OS…).</p>
</blockquote>
<p>Arch Linux is just untested, but not unsupported. The reason for that is<br>
due to the nature of it being individually configured in every respect.<br>
It means anything could go wrong, but Arch users are the master of their<br>
system and can make it work.</p>
<p>In practice, I have never heard of a specific Arch Linux problem with<br>
Isabelle, although I occasionally see users of that platform.</p>
<blockquote>
<p>Is there anyway to give more informations?</p>
</blockquote>
<p>Any particular jEdit plugins and preferences. In particular, what is the<br>
Look-and-feel?</p>
<p>Makarius</p>
</blockquote>



<a name="294700269"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2016-1-RC1%20processing%20theories%20twice/near/294700269" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2016-1-RC1.20processing.20theories.20twice.html#294700269">(Aug 22 2022 at 14:35)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Thanks for doing the bisection.</p>
<p>The change above is from August 2015. There are more changes where<br>
jedit_auto_resolve fluctuates back and forth, without clear conclusion:<br>
see occurrences of "auto" in<br>
<a href="https://isabelle.in.tum.de/repos/isabelle/log/857acb970dfa/src/Tools/jEdit/etc/options">https://isabelle.in.tum.de/repos/isabelle/log/857acb970dfa/src/Tools/jEdit/etc/options</a></p>
<p>It is a genuine "feature": something added on the spot, without being<br>
properly thought out. I had it on my list over some months in 2015, but<br>
did not revisit it.</p>
<p>I will make one round of looking carefully how it behaves at the moment,<br>
and then see if it is put into proper shape for the release, or removed<br>
outright.</p>
<p>There is a bigger plan in the pipeline, to reform the management of all<br>
source files for a PIDE session. When that happens, both jedit_auto_load<br>
and jedit_auto_resolve become obsolete.</p>
<p>Makarius</p>



<a name="294700362"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2016-1-RC1%20processing%20theories%20twice/near/294700362" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2016-1-RC1.20processing.20theories.20twice.html#294700362">(Aug 22 2022 at 14:36)</a>:</h4>
<p>From: Mathias Fleury &lt;<a href="mailto:mathias.fleury12@gmail.com">mathias.fleury12@gmail.com</a>&gt;</p>
<blockquote>
<p>On 8 Nov 2016, at 12:26, Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt; wrote:</p>
<p>On 08/11/16 08:13, Mathias Fleury wrote:</p>
<blockquote>
<p>On 1 Nov 2016, at 22:32, Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a></p>
<blockquote>
<p>&lt;mailto:<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;&gt; wrote:</p>
<p>If it is reliably reproducible for you, you can also make a bisection on<br>
the repository to see where the problem is located in the history.</p>
</blockquote>
<p>I've finally done it and the issue is much older than had I expected: it<br>
goes back to<br>
commit <a href="https://isabelle.in.tum.de/repos/isabelle/rev/60916">https://isabelle.in.tum.de/repos/isabelle/rev/60916</a> and more<br>
precisely to the following part of the change:</p>
<ul>
<li>if (change.deps_changed &amp;&amp; PIDE.options.bool("jedit_auto_load"))<br>
PIDE.deps_changed() + if (PIDE.options.bool("jedit_auto_load") &amp;&amp;<br>
change.deps_changed || + PIDE.options.bool("jedit_auto_resolve") &amp;&amp;<br>
change.version.nodes.undefined_blobs.nonEmpty) + PIDE.deps_changed()</li>
</ul>
<p>jedit_auto_resolve is activated (both in this version by default and in<br>
my setup). If there are non-processed blobs (i.e. a lot of SML files<br>
here) and I click in the List buffer, the processing restarts. I have no<br>
idea why the reprocessing happens only once (i.e. there are no<br>
undefined_blobs anymore…).</p>
</blockquote>
<p>Thanks for doing the bisection.</p>
<p>The change above is from August 2015. There are more changes where<br>
jedit_auto_resolve fluctuates back and forth, without clear conclusion:<br>
see occurrences of "auto" in<br>
<a href="https://isabelle.in.tum.de/repos/isabelle/log/857acb970dfa/src/Tools/jEdit/etc/options">https://isabelle.in.tum.de/repos/isabelle/log/857acb970dfa/src/Tools/jEdit/etc/options</a> &lt;<a href="https://isabelle.in.tum.de/repos/isabelle/log/857acb970dfa/src/Tools/jEdit/etc/options">https://isabelle.in.tum.de/repos/isabelle/log/857acb970dfa/src/Tools/jEdit/etc/options</a>&gt;</p>
</blockquote>
<p>Indeed, but the culprit is the change in the if condition.</p>
<p>I looked a bit more at it and I failed to understand how the undefined_blobs is emptied when jedit_auto_resolve triggers a reprocessing. I don't even understand why this should happen at all: as far as I got it, the blobs are ML files and theories that have already been loaded in the session (I find the name loaded_theories for the loaded sessions very confusing by the way). So why should a reprocessing be triggered if there is no change in these files?</p>
<p>Mathias</p>
<blockquote>
<p>It is a genuine "feature": something added on the spot, without being<br>
properly thought out. I had it on my list over some months in 2015, but<br>
did not revisit it.</p>
<p>I will make one round of looking carefully how it behaves at the moment,<br>
and then see if it is put into proper shape for the release, or removed<br>
outright.</p>
</blockquote>
<blockquote>
<p>There is a bigger plan in the pipeline, to reform the management of all<br>
source files for a PIDE session. When that happens, both jedit_auto_load<br>
and jedit_auto_resolve become obsolete.</p>
<p>Makarius<br>
</p>
</blockquote>



<a name="294700487"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2016-1-RC1%20processing%20theories%20twice/near/294700487" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2016-1-RC1.20processing.20theories.20twice.html#294700487">(Aug 22 2022 at 14:37)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
This turned out rather unspectacular. It is just a feature that was not<br>
fully finished in 2015.</p>
<p>See now<br>
<a href="https://bitbucket.org/isabelle_project/isabelle-release/commits/812c22e556b9">https://bitbucket.org/isabelle_project/isabelle-release/commits/812c22e556b9</a></p>
<p>Makarius</p>



<a name="294700504"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Isabelle2016-1-RC1%20processing%20theories%20twice/near/294700504" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Isabelle2016-1-RC1.20processing.20theories.20twice.html#294700504">(Aug 22 2022 at 14:37)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On 08/11/16 15:42, Mathias Fleury wrote:</p>
<blockquote>
<p>I looked a bit more at it and I failed to understand how the<br>
undefined_blobs is emptied when jedit_auto_resolve triggers a<br>
reprocessing.</p>
</blockquote>
<p>Blobs start out as undefined. Resources.parse_changes and<br>
JEdit_Resources.commit is the place where incoming edits may request<br>
further resolution of dependencies -- via PIDE.deps_changed(). Thus<br>
blobs are loaded eventually and become defined in a later edit.</p>
<p>The problem was caused by the loss of a PIDE.deps_changed() event in a<br>
situation of unfinished pipelining of edits. Then after scrolling, which<br>
is an edit of the document perspective, that was finished and indirectly<br>
caused some theories to be reprocessed.</p>
<p>The deeper conceptual problem behind this: undefined blobs are silently<br>
loaded from the file-system by the prover. This was done on purpose, in<br>
order to be able to load Isabelle/HOL into the Prover IDE, on a small<br>
machine with "only" 8GB. Here the blobs are not part of the PIDE<br>
document content.</p>
<p>At some point this all needs to be revisited, to make it simpler and<br>
more scalable by default, without strange options that can cause problems.</p>
<blockquote>
<p>I find the name loaded_theories for the loaded sessions very confusing by the way.</p>
</blockquote>
<p>I don't understand the confusion. The background session image has<br>
certain theories that are already loaded (and cannot be edited). This<br>
set is called loaded_theories.</p>
<p>Makarius</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>