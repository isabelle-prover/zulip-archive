<html>
<head><meta charset="utf-8"><title>[isabelle] Issue with `Simpl` user guide `Fac` example · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Issue.20with.20.60Simpl.60.20user.20guide.20.60Fac.60.20example.html">[isabelle] Issue with `Simpl` user guide `Fac` example</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294276178"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Issue%20with%20%60Simpl%60%20user%20guide%20%60Fac%60%20example/near/294276178" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Issue.20with.20.60Simpl.60.20user.20guide.20.60Fac.60.20example.html#294276178">(Aug 19 2022 at 14:20)</a>:</h4>
<p>From: "Yannick Duchêne (Hibou57 )" &lt;<a href="mailto:yannick_duchene@yahoo.fr">yannick_duchene@yahoo.fr</a>&gt;<br>
Hi,</p>
<p>I wanted to have a look at Simpl. I built it from a local AFP copy. In the  <br>
documentation, there is a section titled “User Guide” (I jumped there  <br>
nearly immediately). In this section, at “34.3.4 Recursion”, there is a  <br>
sample <code>Fac</code> imperative function.</p>
<p>If I type exactly what's exemplified there, I get an error about a type  <br>
unification failure. I have to change <code>CALL</code> into <code>PROC</code> in order to make  <br>
it work:</p>
<p>theory Test_Simpl<br>
     imports "$AFP/Simpl/Simpl"<br>
     begin</p>
<p>primrec fac :: "nat ⇒ nat"<br>
         where "fac 0 = 1"<br>
             | "fac (Suc n) = (Suc n) * (fac n)";</p>
<p>procedures Fac (N :: nat | R :: nat)<br>
         "IF ´N = 0 THEN ´R :== 1<br>
          ELSE ´R :== PROC Fac(´N - 1);; ´R :== ´N * ´R<br>
          FI";</p>
<p>end</p>
<p>If I write <code>CALL</code> instead of <code>PROC</code> (the user guide really says <code>CALL</code>), I  <br>
get this:</p>
<p>Type unification failed: Clash of types "⦇A_' :: nat,<br>
                       B_' :: nat, C_' :: nat,<br>
                       I_' :: nat, M_' :: nat,<br>
                       N_' :: nat, R_' :: nat,<br>
                       S_' :: nat, Arr_' :: nat list,<br>
                       Abr_' :: char list,<br>
                       … ::<br>
                         _⦈" and "⦇locals :: _ ⇒ _,<br>
           … :: _⦈"</p>
<p>Type error in application: incompatible operand type</p>
<p>Operator:  locals ::<br>
       (??'a, ??'b, ??'c, ??'d) stateSP_scheme<br>
       ⇒ ??'b ⇒ ??'c<br>
     Operand:   s :: (??'a, ??'e) XVcgEx.vars_scheme</p>
<p>I feel disturbed. First the documentation seems wrong, and then, the  <br>
documentation which was generated by a fresh build, should have failed if  <br>
there is an error somewhere. Or am I wrong? Do I have to report this as a  <br>
bug to the author?</p>
<p>Also, a question aside: is it mandatory to import <code>$AFP/Simpl/Simpl</code>? It  <br>
takes long to load for me, near to ten minutes. Is there an alternative  <br>
sufficient subset?</p>



<a name="294276192"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Issue%20with%20%60Simpl%60%20user%20guide%20%60Fac%60%20example/near/294276192" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Issue.20with.20.60Simpl.60.20user.20guide.20.60Fac.60.20example.html#294276192">(Aug 19 2022 at 14:20)</a>:</h4>
<p>From: "Yannick Duchêne (Hibou57 )" &lt;<a href="mailto:yannick_duchene@yahoo.fr">yannick_duchene@yahoo.fr</a>&gt;<br>
Oops, my apologies. The imports was wrong. From the <code>UserGuide.thy</code> source  <br>
file, I changed it into the following, and it's OK with <code>CALL</code>:</p>
<p>imports<br>
       "$AFP/Simpl/HeapList"<br>
       "$AFP/Simpl/Vcg"<br>
       "~~/src/HOL/Statespace/StateSpaceSyntax"<br>
       "~~/src/HOL/Library/LaTeXsugar"</p>



<a name="294276282"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Issue%20with%20%60Simpl%60%20user%20guide%20%60Fac%60%20example/near/294276282" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Issue.20with.20.60Simpl.60.20user.20guide.20.60Fac.60.20example.html#294276282">(Aug 19 2022 at 14:21)</a>:</h4>
<p>From: Lars Noschinski &lt;<a href="mailto:noschinl@in.tum.de">noschinl@in.tum.de</a>&gt;<br>
Just start from the Simpl session image, then you only have to wait once.</p>
<p>isabelle -d '$AFP' -l Simpl</p>
<p>should do the trick.</p>
<p>-- Lars<br>
<a href="/user_uploads/14278/-AUSMKS5nHegDS3GS8ROwMA2/signature.asc">signature.asc</a></p>



<a name="294276292"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Issue%20with%20%60Simpl%60%20user%20guide%20%60Fac%60%20example/near/294276292" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Issue.20with.20.60Simpl.60.20user.20guide.20.60Fac.60.20example.html#294276292">(Aug 19 2022 at 14:21)</a>:</h4>
<p>From: "Yannick Duchêne (Hibou57 )" &lt;<a href="mailto:yannick_duchene@yahoo.fr">yannick_duchene@yahoo.fr</a>&gt;<br>
Hi Lars, and thanks for your care,</p>
<p>That's what I first did, I built an image, but it did not show up in the  <br>
jEdit theories list and launching Isabelle from the command line with the  <br>
<code>-l</code> option, thrown a dialogue complaining the cession was not  <br>
found: “Undefined session(s): "Simpl"”. I've checked the heap image was  <br>
built in the same directory as others (along with HOL, HOL-BNF and and  <br>
al). As far as I can tell, Isabelle was properly configured for the use of  <br>
the AFP (path specified in <code>~/.isabelle/etc/components</code>).</p>
<p>I have not investigated this issue further, as I'm busy reading the  <br>
<code>Imperative_HOL</code> theory source files for now.</p>



<a name="294276311"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Issue%20with%20%60Simpl%60%20user%20guide%20%60Fac%60%20example/near/294276311" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Issue.20with.20.60Simpl.60.20user.20guide.20.60Fac.60.20example.html#294276311">(Aug 19 2022 at 14:21)</a>:</h4>
<p>From: Lars Noschinski &lt;<a href="mailto:noschinl@in.tum.de">noschinl@in.tum.de</a>&gt;<br>
On 18.04.2014 22:07, Yannick Duchêne (Hibou57) wrote:</p>
<blockquote>
<p>Le Fri, 18 Apr 2014 21:50:41 +0200, Lars Noschinski &lt;<a href="mailto:noschinl@in.tum.de">noschinl@in.tum.de</a>&gt;<br>
a écrit:</p>
<p>On 18.04.2014 03:22, Yannick Duchêne (Hibou57) wrote:</p>
<blockquote>
<blockquote>
<p>Also, a question aside: is it mandatory to import <code>$AFP/Simpl/Simpl</code>? It<br>
takes long to load for me, near to ten minutes. Is there an alternative<br>
sufficient subset?</p>
</blockquote>
<p>Just start from the Simpl session image, then you only have to wait once.</p>
<p>isabelle -d '$AFP' -l Simpl</p>
</blockquote>
</blockquote>
<p>This should have been</p>
<p>isabelle jedit -d '$AFP' -l Simpl</p>
<blockquote>
<blockquote>
<p>should do the trick.</p>
</blockquote>
</blockquote>
<blockquote>
<p>That's what I first did, I built an image, but it did not show up in the<br>
jEdit theories list and launching Isabelle from the command line with<br>
the <code>-l</code> option, thrown a dialogue complaining the cession was not<br>
found: “Undefined session(s): "Simpl"”. I've checked the heap image was<br>
built in the same directory as others (along with HOL, HOL-BNF and and<br>
al). As far as I can tell, Isabelle was properly configured for the use<br>
of the AFP (path specified in <code>~/.isabelle/etc/components</code>).</p>
</blockquote>
<p>Since some time, the '-l' parameter does not specify a logic image<br>
anymore, but a session. Even if you have the AFP configured as a<br>
component, you need to pass "-d '$AFP'" to tell the session where the<br>
Simpl session is found.</p>
<p>-- Lars<br>
<a href="/user_uploads/14278/YCZtpj-gbiEh7iQwuMcMua0n/signature.asc">signature.asc</a></p>



<a name="294276331"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Issue%20with%20%60Simpl%60%20user%20guide%20%60Fac%60%20example/near/294276331" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Issue.20with.20.60Simpl.60.20user.20guide.20.60Fac.60.20example.html#294276331">(Aug 19 2022 at 14:21)</a>:</h4>
<p>From: "Yannick Duchêne (Hibou57 )" &lt;<a href="mailto:yannick_duchene@yahoo.fr">yannick_duchene@yahoo.fr</a>&gt;<br>
You're right, I checked it works (I initially did without -d, after a  <br>
thread on the StackOverflow forum). I will edit my Isabelle jEdit launcher  <br>
to always have this -d option, as it seems it does not disallow the use of  <br>
other heap images, like HOL.</p>



<a name="294276358"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Issue%20with%20%60Simpl%60%20user%20guide%20%60Fac%60%20example/near/294276358" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Issue.20with.20.60Simpl.60.20user.20guide.20.60Fac.60.20example.html#294276358">(Aug 19 2022 at 14:21)</a>:</h4>
<p>From: Lars Noschinski &lt;<a href="mailto:noschinl@in.tum.de">noschinl@in.tum.de</a>&gt;<br>
You can also add the line</p>
<p>$AFP</p>
<p>to a file name ROOTS in $ISABELLE_HOME_USER (i.e. ~/.isabelle/ on Unix).<br>
<a href="/user_uploads/14278/VBQT8zlSIgCTkKJAVcQdC_s1/signature.asc">signature.asc</a></p>



<a name="294276429"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Issue%20with%20%60Simpl%60%20user%20guide%20%60Fac%60%20example/near/294276429" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Issue.20with.20.60Simpl.60.20user.20guide.20.60Fac.60.20example.html#294276429">(Aug 19 2022 at 14:22)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Using a ROOTS file in the proper place is indeed the standard way these <br>
days, although that is little known.</p>
<p>Note that $ISABELLE_HOME_USER above only works for unnamed repository <br>
versions.  Luckily Isabelle/jEdit already knows $ISABELLE_HOME and <br>
$ISABELLE_HOME_USER in the file browser, so these symbolic names are <br>
univerally accepted (even on Windows in that notation).</p>
<p>Makarius</p>



<a name="294276445"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Issue%20with%20%60Simpl%60%20user%20guide%20%60Fac%60%20example/near/294276445" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Issue.20with.20.60Simpl.60.20user.20guide.20.60Fac.60.20example.html#294276445">(Aug 19 2022 at 14:22)</a>:</h4>
<p>From: Lars Noschinski &lt;<a href="mailto:noschinl@in.tum.de">noschinl@in.tum.de</a>&gt;<br>
One thing that annoys me a little when I set this, is that I lose the<br>
ability to say 'build everything in the distribution' (but not the AFP).</p>
<p>-- Lars<br>
<a href="/user_uploads/14278/GsSZ8drXgDSz-2QzrKRzZGuz/signature.asc">signature.asc</a></p>



<a name="294276461"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Issue%20with%20%60Simpl%60%20user%20guide%20%60Fac%60%20example/near/294276461" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Issue.20with.20.60Simpl.60.20user.20guide.20.60Fac.60.20example.html#294276461">(Aug 19 2022 at 14:22)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
That is the deeper reason why the $AFP entry point is not imposed on users <br>
by default, even with initialzed AFP component.</p>
<p>You don't have to include all of $AFP in ROOTS, but just the session root <br>
directories you care about (with manually completed dependencies), e.g.</p>
<p>$AFP_BASE/thys/Simpl</p>
<p>Such entries may be also commented out with # in the ROOTS file, when they <br>
are getting in the way at some point.</p>
<p>Makarius</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>