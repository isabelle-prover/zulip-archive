<html>
<head><meta charset="utf-8"><title>[isabelle] Loose bound variable · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Loose.20bound.20variable.html">[isabelle] Loose bound variable</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294099637"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Loose%20bound%20variable/near/294099637" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Loose.20bound.20variable.html#294099637">(Aug 18 2022 at 14:36)</a>:</h4>
<p>From: Stefan Berghofer &lt;<a href="mailto:berghofe@in.tum.de">berghofe@in.tum.de</a>&gt;<br>
Hi Andreas,</p>
<p>thanks for reporting this problem. The exception was caused by a bug in<br>
(r)trancl_tac, which is installed in the simpset as a solver. I have fixed<br>
this in the repository version of Isabelle, see<br>
<a href="http://isabelle.in.tum.de/repos/isabelle/rev/206e2f1759cc">http://isabelle.in.tum.de/repos/isabelle/rev/206e2f1759cc</a></p>
<p>Greetings,<br>
Stefan</p>



<a name="294102001"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Loose%20bound%20variable/near/294102001" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Loose.20bound.20variable.html#294102001">(Aug 18 2022 at 14:47)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@kit.edu">andreas.lochbihler@kit.edu</a>&gt;<br>
Hello,</p>
<p>I wanted to prove a lemma with an apply script. After some manipulations <br>
(induct, rule, drule, frule) of the goals, auto, fastsimp or force <br>
should easily solve the remaining goal. However, simp (and all methods <br>
that use the simplifier) produce only this error message:</p>
<p>*** exception TYPE raised (line 341 of "sign.ML"): Loose bound variable: B.4<br>
*** At command "apply".</p>
<p>What does this error message mean? And how can I avoid it? Is there <br>
something wrong with my simplifier setup?</p>
<p>The complete exception trace (with debugging turned on) is below.</p>
<p>Regards,<br>
Andreas</p>
<p>Exception trace for exception - TYPE raised in sign.ML line 341</p>
<p>Sign.type_check(2)typ_of(2)<br>
Sign.type_check(2)typ_of(2)<br>
Sign.type_check(2)typ_of(2)<br>
Sign.type_check(2)typ_of(2)<br>
Sign.type_check(2)<br>
Sign.certify'(1)(1)(1)(1)(1)(1)<br>
Trancl_Tac().prove(3)inst(1)<br>
Trancl_Tac().prove(3)pr(1)<br>
List.map(2)<br>
Trancl_Tac().rtrancl_tac(1)(2)(1)(6)<br>
Subgoal.GEN_FOCUS(5)<br>
Trancl_Tac().rtrancl_tac(1)(2)(1)<br>
Tactical.ORELSE(1)(1)<br>
Tactical.ORELSE(1)(1)<br>
Seq.map(2)(1)<br>
Seq.flat(1)(1)<br>
Seq.filter(2)copy(1)(1)<br>
Seq.append(2)copy(1)(1)<br>
Seq.append(2)copy(1)(1)<br>
Seq.map(2)(1)<br>
Seq.map(2)(1)<br>
Seq.map(2)(1)<br>
Toplevel.proofs'(1)(1)(1)<br>
Runtime.debugging(2)(1)<br>
End of trace</p>
<p>proof (prove): step 7</p>
<p>fixed variables: final, r, t, s, was, s'<br>
prems:<br>
   rtrancl3p (redTW t) s was s'<br>
   Suspend ?w \&lt;notin&gt; set was</p>
<p>goal (1 subgoal):</p>
<p>1. \&lt;And&gt;a bs a' b a''.<br>
        \&lt;lbrakk&gt;rtrancl3p (redTW t) a bs a'; redTW t a' b a'';<br>
         \&lt;And&gt;w. Suspend w \&lt;notin&gt; set (bs @ [b]);<br>
         (interrupted_mem_red (thr a) (wset a))\&lt;^sup&gt;*\&lt;^sup&gt;* (shr a') <br>
(shr a'');<br>
         (interrupted_mem_red (thr a) (wset a))\&lt;^sup&gt;*\&lt;^sup&gt;* (shr a) <br>
(shr a')\&lt;rbrakk&gt;<br>
        \&lt;Longrightarrow&gt; (interrupted_mem_red (thr a) (wset <br>
a))\&lt;^sup&gt;*\&lt;^sup&gt;* (shr a) (shr a'')</p>
<p>*** exception TYPE raised (line 341 of "sign.ML"):<br>
*** Loose bound variable: B.4<br>
*** B.4<br>
*** At command "apply".</p>



<a name="294102104"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Loose%20bound%20variable/near/294102104" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Loose.20bound.20variable.html#294102104">(Aug 18 2022 at 14:48)</a>:</h4>
<p>From: Jasmin Blanchette &lt;<a href="mailto:jasmin.blanchette@gmail.com">jasmin.blanchette@gmail.com</a>&gt;<br>
Hi Andreas,</p>
<blockquote>
<p>I wanted to prove a lemma with an apply script. After some  <br>
manipulations (induct, rule, drule, frule) of the goals, auto,  <br>
fastsimp or force should easily solve the remaining goal. However,  <br>
simp (and all methods that use the simplifier) produce only this  <br>
error message:</p>
<p>*** exception TYPE raised (line 341 of "sign.ML"): Loose bound  <br>
variable: B.4<br>
*** At command "apply".</p>
<p>What does this error message mean?</p>
</blockquote>
<p>Isabelle's internal representation of lambda-terms uses de Bruijn  <br>
indices for bound variables. Errors like these usually mean that  <br>
there's a rather bad bug in some code that directly manipulates term  <br>
(e.g., some code that removes a lambda abstraction forgot to decrement  <br>
te bound variable indices).</p>
<blockquote>
<p>And how can I avoid it? Is there something wrong with my simplifier  <br>
setup?</p>
</blockquote>
<p>Is there anything _special_ about your simplifier setup?</p>
<p>Jasmin</p>



<a name="294102115"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Loose%20bound%20variable/near/294102115" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Loose.20bound.20variable.html#294102115">(Aug 18 2022 at 14:48)</a>:</h4>
<p>From: Jasmin Blanchette &lt;<a href="mailto:jasmin.blanchette@gmail.com">jasmin.blanchette@gmail.com</a>&gt;<br>
Please do. There wasn't much to be learned by just looking at the trace.</p>
<p>Jasmin</p>



<a name="294102142"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Loose%20bound%20variable/near/294102142" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Loose.20bound.20variable.html#294102142">(Aug 18 2022 at 14:48)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@kit.edu">andreas.lochbihler@kit.edu</a>&gt;<br>
Hi Jasmin,</p>
<p>thank you for the explanation.</p>
<p>No, not really. I have added some lemmas to the simp set, but that's <br>
about all. In particular, I haven't written any simpprocs.</p>
<p>If you like, I can send you my Isabelle2009-1/HOL theories such that you <br>
can reproduce the error and try to find bug.</p>
<p>Andreas</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>