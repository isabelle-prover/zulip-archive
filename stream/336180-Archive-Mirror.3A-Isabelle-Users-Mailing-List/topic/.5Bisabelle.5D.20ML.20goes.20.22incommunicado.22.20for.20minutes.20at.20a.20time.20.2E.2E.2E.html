<html>
<head><meta charset="utf-8"><title>[isabelle] ML goes &quot;incommunicado&quot; for minutes at a time ... · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20ML.20goes.20.22incommunicado.22.20for.20minutes.20at.20a.20time.20.2E.2E.2E.html">[isabelle] ML goes &quot;incommunicado&quot; for minutes at a time ...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294672735"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20ML%20goes%20%22incommunicado%22%20for%20minutes%20at%20a%20time%20.../near/294672735" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20ML.20goes.20.22incommunicado.22.20for.20minutes.20at.20a.20time.20.2E.2E.2E.html#294672735">(Aug 22 2022 at 13:11)</a>:</h4>
<p>From: "Eugene W. Stark" &lt;<a href="mailto:isabelle-users@starkeffect.com">isabelle-users@starkeffect.com</a>&gt;<br>
I have posted (and seen postings) about this general type of thing here before,<br>
but I am getting a more refined view of what seems to me to be a problem and want<br>
to ask again and provide some data points.</p>
<p>I am running Isabelle 2016 under Ubuntu 14.04 LTS.  I am using the 64-bit<br>
version on two similar machines, both of which are Intel(R) Core(TM)<br>
i5-4670K CPU @ 3.40GHz (4 cores).  One machine has 24GB RAM, and I have<br>
limited the ML heap to 16GB to avoid spamming other activities, and the other<br>
machine has 16GB RAM, and I have limited the ML heap to 8GB for the same<br>
reason.  The problem I am describing occurs on both machines, but for definiteness,<br>
the screenshots I took today were done on the 16GB machine.</p>
<p>The problem is that, during sledgehammering using "try" it seems that ML will<br>
go "incommunicado" for minutes at a time, and it is hard to figure out why.<br>
During this period the CPU usage ranges anywhere from 100% to 400%, where 100%<br>
means one core.  Based on previous postings, I would normally assume that it is<br>
due to a major GC taking place, but also during these periods, the "Monitor"<br>
window in JEdit does not receive any data updates from ML.  Once ML has come<br>
back online, the Monitor window starts receiving data again, but it interpolates<br>
the missing data by a line.  This makes it difficult to understand exactly what<br>
is going on.  I don't really know whether there are any conditions under which<br>
it is supposed to be the case that ML will stop sending data points to the<br>
Monitor window, but it seems odd to me.  Of course, the long pause for an<br>
unknown period is also frustrating, and in many cases I just terminate and<br>
restart Isabelle, substituting the known wait for my theories to be reloaded and<br>
rechecked for the unknown wait for ML to return.</p>
<p>For what it's worth, Isabelle memory use is limited, it is honoring the limits,<br>
paging traffic is low, and CPU utilization is high, so it is not a thrashing<br>
situation that is taking place.</p>
<p>I am attaching some screenshots that I took today when I let the sledghammering<br>
run for awhile through multiple cycles of this behavior.<br>
<a href="/user_uploads/14278/aULM1mLi6Bj74HiXoHJeyzMf/Screenshot-from-2016-04-21-102001.png">Screenshot from 2016-04-21 10:20:01.png</a><br>
<a href="/user_uploads/14278/SwOI0GOeAF3jQSBjLkwf3sqP/Screenshot-from-2016-04-21-102016.png">Screenshot from 2016-04-21 10:20:16.png</a><br>
<a href="/user_uploads/14278/OTsbBgn40ttwGXKVMyDsl0D1/Screenshot-from-2016-04-21-102027.png">Screenshot from 2016-04-21 10:20:27.png</a><br>
<a href="/user_uploads/14278/9vvqOuKCRZPStGLYgQ-bekFQ/Screenshot-from-2016-04-21-102037.png">Screenshot from 2016-04-21 10:20:37.png</a><br>
<a href="/user_uploads/14278/XHtgdsFR0sY9MMsy-w0s5Vwm/Screenshot-from-2016-04-21-102048.png">Screenshot from 2016-04-21 10:20:48.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/14278/aULM1mLi6Bj74HiXoHJeyzMf/Screenshot-from-2016-04-21-102001.png" title="Screenshot from 2016-04-21 10:20:01.png"><img src="/user_uploads/14278/aULM1mLi6Bj74HiXoHJeyzMf/Screenshot-from-2016-04-21-102001.png"></a></div><div class="message_inline_image"><a href="/user_uploads/14278/SwOI0GOeAF3jQSBjLkwf3sqP/Screenshot-from-2016-04-21-102016.png" title="Screenshot from 2016-04-21 10:20:16.png"><img src="/user_uploads/14278/SwOI0GOeAF3jQSBjLkwf3sqP/Screenshot-from-2016-04-21-102016.png"></a></div><div class="message_inline_image"><a href="/user_uploads/14278/OTsbBgn40ttwGXKVMyDsl0D1/Screenshot-from-2016-04-21-102027.png" title="Screenshot from 2016-04-21 10:20:27.png"><img src="/user_uploads/14278/OTsbBgn40ttwGXKVMyDsl0D1/Screenshot-from-2016-04-21-102027.png"></a></div><div class="message_inline_image"><a href="/user_uploads/14278/9vvqOuKCRZPStGLYgQ-bekFQ/Screenshot-from-2016-04-21-102037.png" title="Screenshot from 2016-04-21 10:20:37.png"><img src="/user_uploads/14278/9vvqOuKCRZPStGLYgQ-bekFQ/Screenshot-from-2016-04-21-102037.png"></a></div><div class="message_inline_image"><a href="/user_uploads/14278/XHtgdsFR0sY9MMsy-w0s5Vwm/Screenshot-from-2016-04-21-102048.png" title="Screenshot from 2016-04-21 10:20:48.png"><img src="/user_uploads/14278/XHtgdsFR0sY9MMsy-w0s5Vwm/Screenshot-from-2016-04-21-102048.png"></a></div>



<a name="294672798"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20ML%20goes%20%22incommunicado%22%20for%20minutes%20at%20a%20time%20.../near/294672798" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20ML.20goes.20.22incommunicado.22.20for.20minutes.20at.20a.20time.20.2E.2E.2E.html#294672798">(Aug 22 2022 at 13:11)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On Thu, 21 Apr 2016, Eugene W. Stark wrote:</p>
<blockquote>
<p>The problem is that, during sledgehammering using "try" it seems that ML <br>
will go "incommunicado" for minutes at a time, and it is hard to figure <br>
out why.</p>
</blockquote>
<blockquote>
<p>On the snapshot from the "Heap" window, you can see spikes in memory <br>
usage, leading to what appears to be a major GC.  Upon completion of the <br>
major GC, the "freeze" sets in, and no data is sent to the monitor for <br>
several minutes. When the data resumes, the heapsize is much lower, but <br>
quickly spikes up to the max and the cycle repeats.  Because there is no <br>
data during the freeze period, it is difficult to tell what is going on, <br>
but I have to wonder what it is doing during those 3+ minutes when there <br>
is only a short spike of computing activity that takes place before it <br>
starts again.</p>
</blockquote>
<blockquote>
<p>Could anyone comment on whether this behavior is considered "normal"?</p>
</blockquote>
<p>It sounds indeed like a normal consequence of a situation where the ML <br>
heap is under high pressure: tons of data produced and the GC + heap <br>
compaction phases trying to reclaim memory.</p>
<p>When the Poly/ML runtime system performs such GC-related operations, all <br>
ML threads are stopped. The Monitor data is produced by such a regular ML <br>
thread, so nothing will be reported during that time.</p>
<blockquote>
<p>I am suspicious of some kind of thread signalling/synchronization issue, <br>
but not knowing anything about the actual implementation, can only <br>
speculate.</p>
</blockquote>
<blockquote>
<p>From the description of the problem, it does not really look like that. <br>
Although there is always a possibility for something really strange going <br>
on.</p>
</blockquote>
<p>In conclusion, my guess from a distance is that "sledgehammer" or "try" <br>
produce more data than expected, potentially due to unusually big <br>
theories. You could also try to reset the machine-learning information in <br>
$ISABELLE_HOME_USER/mash_state.</p>
<p>Since you are using 64bit Poly/ML with substantial amounts of heap space, <br>
the question is what makes the theories so big that this is required. Even <br>
the biggest applications on AFP still fit into the small memory model of <br>
32bit with 3.5 GB heap. There is a penalty of approx. factor 2 in memory <br>
requirements, when switching from 32bit to 64bit.</p>
<p>Makarius</p>



<a name="294673036"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20ML%20goes%20%22incommunicado%22%20for%20minutes%20at%20a%20time%20.../near/294673036" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20ML.20goes.20.22incommunicado.22.20for.20minutes.20at.20a.20time.20.2E.2E.2E.html#294673036">(Aug 22 2022 at 13:13)</a>:</h4>
<p>From: Mathias Fleury &lt;<a href="mailto:mathias.fleury12@gmail.com">mathias.fleury12@gmail.com</a>&gt;<br>
Hello all,</p>
<p>I have seen the described behaviour too. So far, I know that:<br>
it is linked to MaSh (i.e., MePo does not exhibit this slow-down). You can deactivate the learning in the Sledgehammer options (via the Isabelle options in Isabelle/jEdit or sledgehammer_params).<br>
removing the $ISABELLE_HOME_USER/mash_state file helps.</p>
<p>I have not yet found a deterministic way to reproduce it.</p>
<p>Mathias</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>