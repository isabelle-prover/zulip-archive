<html>
<head><meta charset="utf-8"><title>[isabelle] Problems with datatype_compat · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Problems.20with.20datatype_compat.html">[isabelle] Problems with datatype_compat</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294292365"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Problems%20with%20datatype_compat/near/294292365" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Problems.20with.20datatype_compat.html#294292365">(Aug 19 2022 at 15:44)</a>:</h4>
<p>From: René Thiemann &lt;<a href="mailto:rene.thiemann@uibk.ac.at">rene.thiemann@uibk.ac.at</a>&gt;<br>
Dear all,</p>
<p>I encountered the following problem when using datatype_compat:</p>
<p>datatype_new 'a tree = Empty | Node 'a "'a tree list"<br>
datatype_compat tree</p>
<p>datatype_new 'a ttree = TEmpty | TNode 'a "'a ttree list tree"<br>
datatype_compat ttree</p>
<p>exception TYPE raised (line 329 of "~~/src/HOL/Tools/hologic.ML"):<br>
dest_prodT<br>
(('a ttree × 'b) list tree × 'd) list</p>
<p>However, both datatypes are easily declared using the old datatype package:</p>
<p>datatype 'a tree = Empty | Node 'a "'a tree list"<br>
datatype 'a ttree = TEmpty | TNode 'a "'a ttree list tree"</p>
<p>The problem occurs with both Isabelle2014-RC1 and -RC2.<br>
The datatypes can be also be found in $AFP/thys/Datatype_Order_Generator/Derive_Examples.</p>
<p>Kind regards,<br>
René</p>



<a name="294292445"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Problems%20with%20datatype_compat/near/294292445" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Problems.20with.20datatype_compat.html#294292445">(Aug 19 2022 at 15:44)</a>:</h4>
<p>From: Jasmin Christian Blanchette &lt;<a href="mailto:jasmin.blanchette@gmail.com">jasmin.blanchette@gmail.com</a>&gt;<br>
Hi René,</p>
<p>Thanks for the report! Dmitriy and I have been looking more closely at the issue but we haven't been able yet to determine if it's his bug or mine. ;) Hopefully we'll be able to come back to you in the coming days with a fix. Regarding the Isabelle2014 release, I fear we won't be able to include a fix, since this isn't a regression and we must be very conservative in our changes so close to a release.</p>
<p>As usual, sorry for the trouble.</p>
<p>Cheers,</p>
<p>Jasmin</p>



<a name="294293985"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Problems%20with%20datatype_compat/near/294293985" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Problems.20with.20datatype_compat.html#294293985">(Aug 19 2022 at 15:46)</a>:</h4>
<p>From: Dmitriy Traytel &lt;<a href="mailto:traytel@in.tum.de">traytel@in.tum.de</a>&gt;<br>
Hi René,</p>
<p>It should be better now in Isabelle's repository version 9c065009cd8a. <br>
The observed bug was mine, but your report triggered a cascade of <br>
robustifications in both, mine and Jasmin's code. Thanks again!</p>
<p>Dmitriy</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>