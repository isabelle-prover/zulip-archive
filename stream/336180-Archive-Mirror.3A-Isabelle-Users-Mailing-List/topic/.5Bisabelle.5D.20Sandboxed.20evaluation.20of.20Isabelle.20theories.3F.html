<html>
<head><meta charset="utf-8"><title>[isabelle] Sandboxed evaluation of Isabelle theories? · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html">[isabelle] Sandboxed evaluation of Isabelle theories?</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294233482"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233482" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233482">(Aug 19 2022 at 10:07)</a>:</h4>
<p>From: Joachim Breitner &lt;<a href="mailto:breitner@kit.edu">breitner@kit.edu</a>&gt;<br>
Dear List,</p>
<p>I am in the process of overhauling the Isabelle tutorial¹ at the<br>
University of Karlsruhe. Since we already have a somewhat nice system<br>
for submitting programming solutions (the Praktomat²) I am considering<br>
to use that for the submitted Isabelle solutions as well. For just<br>
submitting and commenting the files this would work well.</p>
<p>The next step would be to automatically check the files at submission,<br>
e.g. run them through isabelle-process or isabelle build. But is that<br>
safe? I believe not, as inside ML {* ... *}, arbitrary missiles could be<br>
launched.</p>
<p>Is there an option that disables all such unsafe features, that would<br>
allow running a theory from an untrusted source?</p>
<p>(I’m ignoring resources issues here; these could be enforced by other<br>
means.)</p>
<p>Thanks,<br>
Joachim</p>
<p>¹ <a href="http://pp.ipd.kit.edu/lehre/SS2013/tba/">http://pp.ipd.kit.edu/lehre/SS2013/tba/</a><br>
¹ <a href="http://pp.ipd.kit.edu/project.php?id=34">http://pp.ipd.kit.edu/project.php?id=34</a> and <br>
<a href="https://github.com/danielkleinert/Praktomat">https://github.com/danielkleinert/Praktomat</a><br>
<a href="/user_uploads/14278/P2cgUXPTbH4obHKOVbGSUqYj/signature.asc">signature.asc</a></p>



<a name="294233489"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233489" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233489">(Aug 19 2022 at 10:07)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
Given the combination of an LCF architecture and ML's static scoping rules, I don't see what harm could be done by the insertion of arbitrary ML code. In any event, anybody who can master Isabelle's APIs sufficiently to do anything interesting by inserting ML code deserves top marks for your course :-)</p>
<p>Larry Paulson</p>



<a name="294233499"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233499" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233499">(Aug 19 2022 at 10:07)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
That's a cource where top marks are very easy to get:</p>
<p>ML {* Isabelle_System.bash "echo 666" *}</p>
<p>It is left as an exercise to put something really dangerous into the above <br>
shell script.</p>
<p>To tighten up the system a little bit, there is isabelle-process option -S <br>
to disallow such gross insecurities.</p>
<p>If one wanted to take that issue very seriously, one could sandbox the ML <br>
compiler invocation that is embedded into Isabelle/Isar.  The <br>
infrastructure is in principle all there, but we don't have concrete <br>
applications for that, and nobody paying large sums to make it work and <br>
keep it working over time.</p>
<p>Makarius</p>



<a name="294233516"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233516" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233516">(Aug 19 2022 at 10:07)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
It depends on the definition of "harm". The student may be able to erase all of the professor's files, and that's certainly bad. If your students are really that crazy, you could run the assessments on a dedicated machine. But it would take a pretty clever series of UNIX calls to trick the system into thinking you had finished a proof.</p>
<p>Of course, for a tutorial course, it would be okay to prohibit access to ML altogether. That shouldn't be difficult to achieve.</p>
<p>Larry Paulson</p>



<a name="294233519"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233519" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233519">(Aug 19 2022 at 10:07)</a>:</h4>
<p>From: Peter Lammich &lt;<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>&gt;<br>
On Di, 2013-02-12 at 11:42 +0000, Lawrence Paulson wrote:</p>
<blockquote>
<p>Given the combination of an LCF architecture and ML's static scoping rules, I don't see what harm could be done by the insertion of arbitrary ML code.</p>
</blockquote>
<p>Well, you have acceess to the PolyML standard libraries, like File-IO,<br>
etc., which you can abuse for sending SPAM, manipulating/reading out<br>
other student's solutions, just mess up the config, etc ...</p>



<a name="294233561"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233561" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233561">(Aug 19 2022 at 10:08)</a>:</h4>
<p>From: Tjark Weber &lt;<a href="mailto:webertj@in.tum.de">webertj@in.tum.de</a>&gt;<br>
"You take the blue pill - the story ends, you wake up in your bed and<br>
believe whatever you want to believe. You take the red pill - you stay<br>
in Wonderland, and I show you how deep the rabbit hole goes."</p>
<p>Arbitrary ML code can hijack any communication between the LCF kernel<br>
and the user, thus creating a perfect illusion of unsoundness even when<br>
the kernel itself is unaffected.</p>
<p>Perhaps more interestingly, arbitrary ML code can spawn external<br>
processes, which can potentially modify the system state (including the<br>
memory of the running Isabelle process) in arbitrary ways.</p>
<p>Anyway, I am guessing that Joachim is more concerned about features<br>
like unrestricted file system or network access than about soundness of<br>
Isabelle.</p>
<p>Best regards,<br>
Tjark</p>



<a name="294233572"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233572" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233572">(Aug 19 2022 at 10:08)</a>:</h4>
<p>From: Joachim Breitner &lt;<a href="mailto:breitner@kit.edu">breitner@kit.edu</a>&gt;<br>
Hi,</p>
<p>exactly. Should -S be sufficient for that?</p>
<p>Thanks,<br>
Joachim<br>
<a href="/user_uploads/14278/pec_XrXWxhrxPw6eBuBkn9TA/signature.asc">signature.asc</a></p>



<a name="294233584"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233584" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233584">(Aug 19 2022 at 10:08)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
To some extent, yes.  It makes doing bad things harder.</p>
<p>That option was originally motivated by semi-public prover webservices, <br>
notably the Proofweb project from Nijmegen, around 2006/2007.  What they <br>
also did of course, was the usual sandboxing of the Unix process on the <br>
server side.</p>
<p>It is in principle possible to make this all much more secure, and <br>
restrict ML inside Isar to a precisely specified subset of the language <br>
and its libraries.</p>
<p>Makarius</p>



<a name="294233591"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233591" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233591">(Aug 19 2022 at 10:08)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
Isn't this what virtual machines are for?</p>
<p>But a student who injected malicious code in such circumstances would be lucky to avoid expulsion, and I can't see it happening here.</p>
<p>Larry Paulson</p>



<a name="294233606"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233606" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233606">(Aug 19 2022 at 10:08)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
The Nijmegen guys also had a course with assignments and solutions managed <br>
by the web server.</p>
<p>What they did back then was plain Linux chroot.  Current Linux variants <br>
probably offer a bit more, similar to classic BSD "jail". Variants of <br>
virtualization are also possible, of course.  I think that certain "cloud <br>
computing" infrastructure works like that.</p>
<p>The question of "LCF prover as secure web service" has many aspects to be <br>
explored more seriously.  One could easily make a research project out of <br>
that, with everybody still speaking about clouds until the next buzzword <br>
is emerging.</p>
<p>Makarius</p>



<a name="294233618"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233618" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233618">(Aug 19 2022 at 10:08)</a>:</h4>
<p>From: Joachim Breitner &lt;<a href="mailto:breitner@kit.edu">breitner@kit.edu</a>&gt;<br>
Hi,</p>
<p>thanks. Next question: </p>
<p>/opt/isabelle/Isabelle2013-RC2/bin/isabelle-process -S -r -I HOL &lt; Foo.thy</p>
<p>will tell me about wrong proofs (*** Failed to finish proof), but not about </p>
<ol>
<li>uses of sorry</li>
<li>unexpected end of the file.</li>
</ol>
<p>For the first one it seems I have to somehow disable the quick_and_dirty mode, but passing<br>
"-e 'quick_and_dirty := false'" did not have the desired effect.</p>
<p>Any suggestions on how to proceed here?</p>
<p>Greetings,<br>
Joachim<br>
<a href="/user_uploads/14278/XnrZUGs2wjiNsPqsc4nHm53n/signature.asc">signature.asc</a></p>



<a name="294233627"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233627" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233627">(Aug 19 2022 at 10:08)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Piping directly into the Isar toplevel gives indeed very little static <br>
consistency checking.  You would have to emulate Proof General in <br>
imitating some of that, but it never really managed &gt; 10 years.</p>
<p>It is better to work in batch mode, by telling the raw ML toplevel to <br>
invoke use_thys like this:</p>
<p>isabelle-process -S -r -q -e 'use_thys ["~/tmp/A"];'</p>
<p>Batch mode then also says something like this by default:</p>
<p>Loading theory "A"<br>
*** Cheating requires quick_and_dirty mode!<br>
*** At command "sorry" (line 4 of "/Volumes/Macintosh_HD/Users/makarius/tmp/A.thy")</p>
<p>Makarius</p>



<a name="294233666"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233666" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233666">(Aug 19 2022 at 10:09)</a>:</h4>
<p>From: "C. Diekmann" &lt;<a href="mailto:diekmann@in.tum.de">diekmann@in.tum.de</a>&gt;<br>
Does export_code still allow directory traversal and arbitrary file overwriting?</p>



<a name="294233704"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233704" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233704">(Aug 19 2022 at 10:09)</a>:</h4>
<p>From: Joachim Breitner &lt;<a href="mailto:breitner@kit.edu">breitner@kit.edu</a>&gt;<br>
Hi,</p>
<p>indeed it does; this is one problem.</p>
<p>Maybe export_code should be disabled with -S on, or at least export_code<br>
with an file argument different from "-"...</p>
<p>From browsing the code (which I’m unfortunately not fluent in) it seems<br>
that such safeguards could be added centrally<br>
in ./src/Pure/General/file.ML, e.g. disabling open_output completely if<br>
"-S" (or a stronger flag, say "-S -S") is on.</p>
<p>Another, lesser, problem is that the import statement can access<br>
arbitrary .thy files if the path is known.</p>
<p>Greetings,<br>
Joachim<br>
<a href="/user_uploads/14278/gfIqODw8L6KfnzCdsEEuRSIQ/signature.asc">signature.asc</a></p>



<a name="294233717"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233717" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233717">(Aug 19 2022 at 10:09)</a>:</h4>
<p>From: Joachim Breitner &lt;<a href="mailto:breitner@kit.edu">breitner@kit.edu</a>&gt;<br>
Dear Makarius,</p>
<p>thanks for the hint. Now it does detect sorry and partial theories well,<br>
and this invocation is also easier for out system as the filename can be<br>
passed in a parameter.</p>
<p>I noticed that -S had no effect any more (due to how the MLTEXT variable<br>
in isabelle-process is assembled), but passing <br>
        -e 'Secure.set_secure (); use_thys ["/tmp/Deduction"];'<br>
works.</p>
<p>Greetings,<br>
Joachim<br>
<a href="/user_uploads/14278/MhWcgMhuwpo6_fY3zmtE11_S/signature.asc">signature.asc</a></p>



<a name="294233727"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233727" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233727">(Aug 19 2022 at 10:09)</a>:</h4>
<p>From: Joachim Breitner &lt;<a href="mailto:breitner@kit.edu">breitner@kit.edu</a>&gt;<br>
Dear ML- and Isabelle-programmers,</p>
<p>would this be a good idea:</p>
<p>$ diff -u file.ML-orig file.ML<br>
--- file.ML-orig    2013-02-13 10:35:41.886000990 +0100<br>
+++ file.ML 2013-02-13 10:43:58.573982673 +0100<br>
@@ -104,7 +104,9 @@</p>
<p>fun open_dir f = with_file OS.FileSys.openDir OS.FileSys.closeDir f o platform_path;<br>
 fun open_input f = with_file TextIO.openIn TextIO.closeIn f o platform_path;<br>
-fun open_output f = with_file TextIO.openOut TextIO.closeOut f o platform_path;<br>
+fun open_output f path = <br>
+   (Secure.deny_secure "Cannot open file for writing in secure mode.";<br>
+   with_file TextIO.openOut TextIO.closeOut f (platform_path path));<br>
 fun open_append f = with_file TextIO.openAppend TextIO.closeOut f o platform_path;</p>
<p>end;</p>
<p>It seems to work here.</p>
<p>For some reason I don’t see the error message, but rather</p>
<p>Exception trace for exception - ERROR raised in library.ML line 264</p>
<p>End of trace</p>
<p>Exception- Interrupt raised</p>
<p>while using ML {* .. *}, which also causes a call to deny_secure, gives a nice error message.</p>
<p>*** Cannot evaluate ML source in secure mode<br>
        *** At command "ML" (line 3 of "/tmp/Deduction.thy")<br>
        Exception- TOPLEVEL_ERROR raised</p>
<p>Would it be possible to include this or an equivalent feature in a<br>
future Isabelle release, so that there is no risk of forgetting to patch<br>
Isabelle when we upgrade the submission server to a new release?</p>
<p>Thanks,<br>
Joachim<br>
<a href="/user_uploads/14278/zZp-Bkn3oLg6VWa3vqJPI78W/signature.asc">signature.asc</a></p>



<a name="294233738"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233738" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233738">(Aug 19 2022 at 10:09)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
This is where Unix chroot (or better) comes into play.  It is futile to <br>
try isolating file system access of the process in the implementation.</p>
<p>For the funny Secure.set_secure mode, I merely pinned down relatively <br>
well-defined things that can extend the code base dynamically.</p>
<p>Makarius</p>



<a name="294233826"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Sandboxed%20evaluation%20of%20Isabelle%20theories%3F/near/294233826" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Sandboxed.20evaluation.20of.20Isabelle.20theories.3F.html#294233826">(Aug 19 2022 at 10:10)</a>:</h4>
<p>From: Florian Haftmann &lt;<a href="mailto:florian.haftmann@informatik.tu-muenchen.de">florian.haftmann@informatik.tu-muenchen.de</a>&gt;</p>
<blockquote>
<p>This is where Unix chroot (or better) comes into play.</p>
</blockquote>
<p>What seems reasonably robust to me is:</p>
<ul>
<li>
<p>Setup one virtualized reference machine</p>
<ul>
<li>no access to net from the machine itself</li>
<li>
<p>read-only access to one dedicated directory on your host system<br>
where the theories to be checked are placed</p>
</li>
<li>
<p>Isabelle2013</p>
</li>
<li>sshd running to issue batch jobs there etc.</li>
</ul>
</li>
</ul>
<p>Safe this machine such that you can restore it on problems of any kind.<br>
 Then use it!</p>
<p>Cheers,<br>
    Florian<br>
<a href="/user_uploads/14278/ZyHtFPNSdFm4i1Qw-FhsyWvb/signature.asc">signature.asc</a></p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>