<html>
<head><meta charset="utf-8"><title>[isabelle] Should isatool document preparation preserve t... · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Should.20isatool.20document.20preparation.20preserve.20t.2E.2E.2E.html">[isabelle] Should isatool document preparation preserve t...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294099534"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Should%20isatool%20document%20preparation%20preserve%20t.../near/294099534" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Should.20isatool.20document.20preparation.20preserve.20t.2E.2E.2E.html#294099534">(Aug 18 2022 at 14:35)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Using -D generated is indeed the usual way to achieve any custom <br>
behaviour, beyond that what the example setup of the document preparation <br>
tool is doing.</p>
<p>BTW, "isatool" and the $ISATOOL variable are way old.  The tool wrapper is <br>
called "isabelle", and "$ISABELLE_TOOL" refers to it within the process <br>
environment.</p>
<p>Makarius</p>



<a name="294099645"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Should%20isatool%20document%20preparation%20preserve%20t.../near/294099645" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Should.20isatool.20document.20preparation.20preserve.20t.2E.2E.2E.html#294099645">(Aug 18 2022 at 14:36)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On Mon, 22 Feb 2010, Rafal Kolanski wrote:</p>
<blockquote>
<p>Makarius wrote:</p>
<blockquote>
<blockquote>
<p>USEDIR = $(ISATOOL) usedir -v true -i false -d false -D generated -C false</p>
</blockquote>
<p>Using -D generated is indeed the usual way to achieve any custom behaviour, <br>
beyond that what the example setup of the document preparation tool is <br>
doing.</p>
</blockquote>
<p>I understand, but that isn't my problem. The issue I'm having is that <br>
everything copied into generated by isabelle during the document <br>
generation process is timestamped with the time of the document <br>
generation process, not the timestamps of the original files in the <br>
document directory.</p>
</blockquote>
<p>Alternatively, you can use "-D document" to dump the generated sources <br>
into that very same directly, and of course keep "-C false".  Or you dump <br>
to a completely different place and adjust the make file accordingly.</p>
<p>No need to copy your other files at all.</p>
<blockquote>
<p>If I use -C false and rsync, make will notice that blah.pdf is newer <br>
than blah.svg and not run the conversion.</p>
</blockquote>
<p>rsync is part of the answer why special behaviour is avoided by default: <br>
it is not part of the classic Unix canon of tools.  Even just plain cp is <br>
very delicate: hardly any of the more advanced options are universally <br>
available.</p>
<p>The usual Isabelle tool policy is to make things work by default, rather <br>
than building too much sophistication into it.  (Which does not mean that <br>
the usedir and document tools are not infected by creeping featuritis.)</p>
<blockquote>
<p>So I should use $ISABELLE_TOOL instead of $ISATOOL? I don't actually use <br>
the lowercase 'isatool' anywhere. I was porting the IsaMakefile which <br>
had $ISATOOL in it, and it turned out that in 2009-1 that magically did <br>
the right thing (invoked isabelle instead of isatool), so I kept it.</p>
</blockquote>
<p>Yes, the ISATOOL setting variable is offically marked as "legacy" since <br>
Isabelle2009 -- see the start of that version's NEWS: "Simplified main <br>
Isabelle executables ...".</p>
<p>Makarius</p>



<a name="294099783"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Should%20isatool%20document%20preparation%20preserve%20t.../near/294099783" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Should.20isatool.20document.20preparation.20preserve.20t.2E.2E.2E.html#294099783">(Aug 18 2022 at 14:36)</a>:</h4>
<p>From: Rafal Kolanski &lt;<a href="mailto:rafalk@cse.unsw.edu.au">rafalk@cse.unsw.edu.au</a>&gt;<br>
Makarius wrote:</p>
<blockquote>
<blockquote>
<p>USEDIR = $(ISATOOL) usedir -v true -i false -d false -D generated -C <br>
false</p>
</blockquote>
<p>Using -D generated is indeed the usual way to achieve any custom <br>
behaviour, beyond that what the example setup of the document <br>
preparation tool is doing.</p>
</blockquote>
<p>I understand, but that isn't my problem. The issue I'm having is that <br>
everything copied into generated by isabelle during the document <br>
generation process is timestamped with the time of the document <br>
generation process, not the timestamps of the original files in the <br>
document directory. This confuses make, as the sources for files it is <br>
to generate are always newer than any generated files. I think I am <br>
being a bit vague, let me try with an example:</p>
<p>create document/blah.svg and tell document/Makefile to convert it<br>
   to a .pdf<br>
isabelle make<br>
   (copies document/blah.svg to generated/blah.svg and<br>
           document/Makefile to generated/Makefile)<br>
cd document; make<br>
   (creates generated/blah.pdf from generated/blah.svg)<br>
change a theory file<br>
isabelle make<br>
   (copies document/blah.svg to generated/blah.svg and<br>
           document/Makefile to generated/Makefile)<br>
cd document; make<br>
   (creates generated/blah.pdf from generated/blah.svg)</p>
<p>Every time I make my document, it'll re-create blah.pdf, despite <br>
blah.svg never changing. Additionally, document/Makefile has <br>
approximately the same timestamp as generated/blah.svg.<br>
If I use -C false and rsync, make will notice that blah.pdf is newer <br>
than blah.svg and not run the conversion.</p>
<blockquote>
<p>BTW, "isatool" and the $ISATOOL variable are way old.  The tool wrapper <br>
is called "isabelle", and "$ISABELLE_TOOL" refers to it within the <br>
process environment.</p>
</blockquote>
<p>So I should use $ISABELLE_TOOL instead of $ISATOOL? I don't actually use <br>
the lowercase 'isatool' anywhere. I was porting the IsaMakefile which <br>
had $ISATOOL in it, and it turned out that in 2009-1 that magically did <br>
the right thing (invoked isabelle instead of isatool), so I kept it.</p>
<p>Sincerely,</p>
<p>Rafal Kolanski.</p>



<a name="294102259"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Should%20isatool%20document%20preparation%20preserve%20t.../near/294102259" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Should.20isatool.20document.20preparation.20preserve.20t.2E.2E.2E.html#294102259">(Aug 18 2022 at 14:49)</a>:</h4>
<p>From: Rafal Kolanski &lt;<a href="mailto:rafalk@cse.unsw.edu.au">rafalk@cse.unsw.edu.au</a>&gt;<br>
Dear All,</p>
<p>Is there any reason that isatool does not preserve timestamps when <br>
copying document/ into (say) generated/ ? I was under the impression <br>
that we should put the document skeleton into document/, run the session <br>
using isatool (so it generates .tex files in generated/) and then invoke <br>
make inside generated/ to create the document itself. However, as it <br>
stands, constructing anything inside generated/ confuses make.</p>
<p>Example: my generated/Makefile generates .pdf files from .svg graphics <br>
for pdflatex as needed. If isatool copies the .svg files from document/, <br>
they are always newer than the .pdf files in generated/, thereby always <br>
undergoing the conversion process.<br>
If .pdf files are placed in document/, they are copied across at the <br>
same time as the .svg files, meaning they most likely have the same <br>
timestamp, which means that even if the .svg file was changed, the .pdf <br>
will not be updated.</p>
<p>My current solution to this is to tell isatool not to copy anything, and <br>
then do the copying manually, like so:<br>
     cd ..; $(USEDIR) $(BASE_IMAGE) $(SESSION)<br>
     rsync -av -c -H document/ generated<br>
Where:<br>
USEDIR = $(ISATOOL) usedir -v true -i false -d false -D generated -C false</p>
<p>Is there something obvious I'm missing here? I just don't see the reason <br>
not to preserve the timestamps during the copy...</p>
<p>Sincerely,</p>
<p>Rafal Kolanski.</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>