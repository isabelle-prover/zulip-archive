<html>
<head><meta charset="utf-8"><title>[isabelle] Type definitions in Isabelle; article &quot;A Consi... · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html">[isabelle] Type definitions in Isabelle; article &quot;A Consi...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294679942"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294679942" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294679942">(Aug 22 2022 at 13:52)</a>:</h4>
<p>From: Andrei Popescu &lt;<a href="mailto:A.Popescu@mdx.ac.uk">A.Popescu@mdx.ac.uk</a>&gt;<br>
Dear Ken,</p>
<blockquote>
<blockquote>
<p>My suspicion is that declarations separated from definitions generally might cause inconsistency.</p>
</blockquote>
</blockquote>
<p>Actually, this is precisely what we prove in our paper: that, under the described checks, delayed ad hoc overloaded definitions of constants (performed via declarations followed by definitions of instances at later times) and type definitions are jointly consistent under HOL deduction.</p>
<blockquote>
<blockquote>
<p>In order to experiment, I would need some hint how declarations of<br>
constants (accompanied with a latter definition) work in Isabelle 2016, as asked for at<br>
<a href="https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2016-August/msg00093.html">https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2016-August/msg00093.html</a><br>
as I couldn't find any information in the manuals about it.</p>
</blockquote>
</blockquote>
<p>In Isabelle 2016, you have to be more explicit about overloading -- see section 11.3 (ad hoc overloading for constants) in the reference manual:    <a href="http://isabelle.in.tum.de/doc/isar-ref.pdf">http://isabelle.in.tum.de/doc/isar-ref.pdf</a></p>
<p>Your noncircular example should be written as follows:</p>
<p>consts c :: 'a</p>
<p>typedef T = "{True}" by blast</p>
<p>overloading<br>
  c_bool    ? "c :: bool"<br>
begin<br>
definition c_bool :: bool where<br>
  "c_bool = (if (EX (x::T). ALL y. x = y) then False else True)"<br>
end</p>
<p>By contrast, Ondra's circular example fails in Isabelle 2016:</p>
<p>consts cc :: 'a</p>
<p>typedef (overloaded) TT = "{True,cc}" by blast</p>
<p>overloading<br>
  cc_bool    ? "cc :: bool"<br>
begin<br>
definition cc_bool :: bool where<br>
  "cc_bool = (if (EX (x::TT). ALL y. x = y) then False else True)"<br>
end</p>
<p>The theory is also attached.</p>
<p>Andrei<br>
<a href="/user_uploads/14278/a4atdoNJjn2-y5bTdYiu0POY/Defs.thy">Defs.thy</a></p>



<a name="294679956"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294679956" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294679956">(Aug 22 2022 at 13:52)</a>:</h4>
<p>From: Ken Kubota &lt;<a href="mailto:mail@kenkubota.de">mail@kenkubota.de</a>&gt;<br>
From a logical point of view, there is no reason to go below the HOL standard,<br>
according to which (in proof mode) "only consistency-preserving actions<br>
(namely valid proof) can be performed" [Gordon/Melham, 1993, p. 258 f.].</p>
<p>Andrei Popescu found a quite adequate formulation saying that the (consistent) logic exists<br>
independent of a particular implementation. Hence, if Isabelle/HOL is supposed to be a<br>
manifestation of a consistent logic, it must be consistent, too. "Nonsensical" user data<br>
should be allowed only in the form of hypotheses, which can be refuted by the logic (and,<br>
hence, dealt with in a reasonable way), as shown previously for R0.</p>
<p>If we would allow weakening logical rigor by enabling (user) definitions to make the<br>
logical system inconsistent, we could directly step back to Cantor's naive set theory,<br>
and accuse Russell of being the malicious "who has studied the source code" of set theory,<br>
claiming that Russell's paradox makes use of an "overtly nonsensical" definition.<br>
Of course it is nonsensical (in formal logic and mathematics), but therefore it<br>
shouldn't be expressible at all in the language of mathematics. This insight resulted,<br>
as is well known, in type theory.</p>
<p>My suspicion is that declarations separated from definitions generally might cause<br>
inconsistency. In order to experiment, I would need some hint how declarations of <br>
constants (accompanied with a latter definition) work in Isabelle 2016, as asked for at<br>
<a href="https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2016-August/msg00093.html">https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2016-August/msg00093.html</a><br>
as I couldn't find any information in the manuals about it.</p>
<hr>
<p>Ken Kubota<br>
doi: 10.4444/100<br>
<a href="http://dx.doi.org/10.4444/100">http://dx.doi.org/10.4444/100</a></p>



<a name="294679968"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294679968" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294679968">(Aug 22 2022 at 13:52)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
I just want to point out explicitly that I am no longer paying attention<br>
to this very strange thread.</p>
<p>At the level of abstraction of the discussion, Isabelle is indeed<br>
"inconsistent" and that is not going to change in the foreseeable future.</p>
<p>Makarius</p>



<a name="294679992"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294679992" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294679992">(Aug 22 2022 at 13:52)</a>:</h4>
<p>From: Andrei Popescu &lt;<a href="mailto:A.Popescu@mdx.ac.uk">A.Popescu@mdx.ac.uk</a>&gt;<br>
Makarius wrote:</p>
<blockquote>
<blockquote>
<p>I just want to point out explicitly that I am no longer paying attention<br>
to this very strange thread.<br>
At the level of abstraction of the discussion, Isabelle is indeed<br>
"inconsistent" and that is not going to change in the foreseeable future.</p>
</blockquote>
</blockquote>
<p>This is indeed a very strange thread -- and your backwards conclusion contributes to its strangeness. At the level of abstraction discussed here, that is, speaking of the logical system implemented in Isabelle/HOL, we are now (in 2016) talking about a logic proved to be <em>consistent</em>, not inconsistent. This level of abstraction assumes that we ignore what you call the back doors, and only focus on the purely logical mechanisms: type and constant definitions and HOL deduction.</p>
<p>Btw, even though they also deal with a very complex implementation, the Coq people do not have a problem speaking at this level of abstraction -- and in particular acknowledging any logic inconsistency violations arising from their definitional mechanism (as happened recently). Needless to say, they also don't have a problem reporting when these violations have been addressed. And they do use words like 'inconsistency' and 'fix'.</p>
<p>You show contempt for people's efforts to address such issues using proper and well-established logical concepts and terminology. And since you are speaking with the (deserved) authority of Isabelle's release manager, this is a big strategic mistake for Isabelle.</p>
<p>Andrei</p>
<p>Makarius</p>



<a name="294681327"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681327" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681327">(Aug 22 2022 at 14:00)</a>:</h4>
<p>From: Ken Kubota &lt;<a href="mailto:mail@kenkubota.de">mail@kenkubota.de</a>&gt;<br>
Dear Isabelle Developers,</p>
<p>Concerning the type definitions in Isabelle and the article by Ondřej Kunčar and Andrei Popescu, I have some questions.</p>
<ol>
<li>
<p>Which restriction was introduced in Isabelle (2016) in order to avoid the inconsistency of earlier versions revealed by Kunčar/Popescu? See<br>
<a href="http://www21.in.tum.de/~kuncar/kuncar-popescu-jar2016.pdf">http://www21.in.tum.de/~kuncar/kuncar-popescu-jar2016.pdf</a> (p. 3)<br>
The definition of the constant c contains a free variable y.<br>
Constant definitions in Gordon's original HOL do not allow free variables, but only "a closed term" [Gordon/Melham, 1993, p. 220; or<br>
<a href="http://sourceforge.net/projects/hol/files/hol/kananaskis-10/kananaskis-10-logic.pdf">http://sourceforge.net/projects/hol/files/hol/kananaskis-10/kananaskis-10-logic.pdf</a> (p. 33)].</p>
</li>
<li>
<p>Are all types still constructed via the "typedef" mechanism?<br>
The following formulation allows two interpretations: a mechanism on top of "typedef",<br>
or a new mechanism at the same (basic) level as and in addition to "typedef":<br>
"In the post–Isabelle 2012 development version, we have converted the numeric types int, rat, and real to use Lifting and Transfer. (Previously they were constructed as quotients with typedef, in the style of Paulson [6].)"<br>
<a href="http://www21.in.tum.de/~kuncar/documents/huffman-kuncar-itp2012.pdf">http://www21.in.tum.de/~kuncar/documents/huffman-kuncar-itp2012.pdf</a> (p. 17)</p>
</li>
<li>
<p>The main questions is, whether in Isabelle still all new types are (besides being tested for non-emptiness)<br>
introduced with an axiom stating a mapping, like in Gordon's original HOL,<br>
where for each new type an axiom is asserted saying that the new type is isomorphic to the defined (sub)set, cf.<br>
<a href="http://sourceforge.net/projects/hol/files/hol/kananaskis-10/kananaskis-10-logic.pdf">http://sourceforge.net/projects/hol/files/hol/kananaskis-10/kananaskis-10-logic.pdf</a> (p. 39).</p>
</li>
</ol>
<p>Let me remark that the section "8.5.2 Defining New Types" in<br>
<a href="http://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/Isabelle2016/doc/tutorial.pdf">http://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/Isabelle2016/doc/tutorial.pdf</a> (pp. 173 ff.)<br>
explaining "typedef" is quite hidden.<br>
It would be desirable to have it in a separate logic manual like in the HOL4 logic part linked above.</p>
<ol start="4">
<li>Why should "dependent types" be "to a large extent incompatible with the HOL philosophy of keeping all types non-empty" as claimed at<br>
<a href="http://www21.in.tum.de/~kuncar/kuncar-popescu-jar2016.pdf">http://www21.in.tum.de/~kuncar/kuncar-popescu-jar2016.pdf</a> (p. 4)?<br>
My R0 implementation is a dependent type theory, and there are no empty types in it.</li>
</ol>
<p>Kind regards,</p>
<p>Ken Kubota</p>
<hr>
<p>Ken Kubota<br>
doi: 10.4444/100<br>
<a href="http://dx.doi.org/10.4444/100">http://dx.doi.org/10.4444/100</a></p>



<a name="294681350"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681350" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681350">(Aug 22 2022 at 14:00)</a>:</h4>
<p>From: Andrei Popescu &lt;<a href="mailto:A.Popescu@mdx.ac.uk">A.Popescu@mdx.ac.uk</a>&gt;<br>
Dear Ken,</p>
<p>Please see *** below.</p>
<ol>
<li>Which restriction was introduced in Isabelle (2016) in order to avoid the inconsistency of earlier versions revealed by Kunčar/Popescu? See<br>
<a href="http://www21.in.tum.de/~kuncar/kuncar-popescu-jar2016.pdf">http://www21.in.tum.de/~kuncar/kuncar-popescu-jar2016.pdf</a> (p. 3)</li>
</ol>
<p>*** As explained in the paper, now the definitional dependency is tracked through types as well.</p>
<p>The definition of the constant c contains a free variable y.<br>
Constant definitions in Gordon's original HOL do not allow free variables, but only "a closed term" [Gordon/Melham, 1993, p. 220; or<br>
<a href="http://sourceforge.net/projects/hol/files/hol/kananaskis-10/kananaskis-10-logic.pdf">http://sourceforge.net/projects/hol/files/hol/kananaskis-10/kananaskis-10-logic.pdf</a> (p. 33)].</p>
<p>*** No: y is also bound there, by a forall quantifier.</p>
<ol start="2">
<li>Are all types still constructed via the "typedef" mechanism?<br>
The following formulation allows two interpretations: a mechanism on top of "typedef",<br>
or a new mechanism at the same (basic) level as and in addition to "typedef":<br>
"In the post-Isabelle 2012 development version, we have converted the numeric types int, rat, and real to use Lifting and Transfer. (Previously they were constructed as quotients with typedef, in the style of Paulson [6].)"<br>
<a href="http://www21.in.tum.de/~kuncar/documents/huffman-kuncar-itp2012.pdf">http://www21.in.tum.de/~kuncar/documents/huffman-kuncar-itp2012.pdf</a> (p. 17)</li>
</ol>
<p>*** All these types, including int, rat and real, as well as all the (co)datatypes, are ultimately compiled into typedefs.</p>
<ol start="3">
<li>The main questions is, whether in Isabelle still all new types are (besides being tested for non-emptiness)<br>
introduced with an axiom stating a mapping, like in Gordon's original HOL,<br>
where for each new type an axiom is asserted saying that the new type is isomorphic to the defined (sub)set, cf.<br>
<a href="http://sourceforge.net/projects/hol/files/hol/kananaskis-10/kananaskis-10-logic.pdf">http://sourceforge.net/projects/hol/files/hol/kananaskis-10/kananaskis-10-logic.pdf</a> (p. 39).</li>
</ol>
<p>*** Yes: One can also <em>declare</em> types (which are assumed non-empty).  But all the <em>defined</em> types come with the two functions<br>
representing the back and forth isomorphisms with a subset of the host type.</p>
<p>Let me remark that the section "8.5.2 Defining New Types" in<br>
<a href="http://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/Isabelle2016/doc/tutorial.pdf">http://www.cl.cam.ac.uk/research/hvg/Isabelle/dist/Isabelle2016/doc/tutorial.pdf</a> (pp. 173 ff.)<br>
explaining "typedef" is quite hidden.<br>
It would be desirable to have it in a separate logic manual like in the HOL4 logic part linked above.</p>
<ol start="4">
<li>Why should "dependent types" be "to a large extent incompatible with the HOL philosophy of keeping all types non-empty" as claimed at<br>
<a href="http://www21.in.tum.de/~kuncar/kuncar-popescu-jar2016.pdf">http://www21.in.tum.de/~kuncar/kuncar-popescu-jar2016.pdf</a> (p. 4)?<br>
My R0 implementation is a dependent type theory, and there are no empty types in it.</li>
</ol>
<p>*** Having all types non-empty is incompatible with the mainstream dependent type approach, where one uses the Curry-Howard isomorphism<br>
to model propositions as types, with their elements representing proofs -- then the existence of empty types simply means that not everything is provable.</p>
<p>Best,<br>
  Andrei</p>



<a name="294681372"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681372" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681372">(Aug 22 2022 at 14:00)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
This question is a perfect example why I dislike the use of the word “inconsistency" in connection with the work of Kunčar and Popescu. Probably most people associate that word with some sort of incorrect logical reasoning. However, their work is concerned with Isabelle's automatic detection and rejection of circular definitions. Obvious ones such as x == x+1 and i==j, j==i+1 have been rejected for many years, but they found some cases where a very devious user could sneak a circular definition through. While it’s right that they have fixed this problem, nobody had actually exploited it, and the fix had no effect on the millions of lines of Isabelle proofs in existence. </p>
<p>And it’s worth stressing again: even consistent definitions can be wrong.</p>
<p>Larry Paulson</p>



<a name="294681408"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681408" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681408">(Aug 22 2022 at 14:00)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Indeed, this misleading tale told around the work by Kuncar / Popescu <br>
greatly subtracts from otherwise fine technical improvements.</p>
<p>I have already pointed out many times that it was mainly a change of the <br>
documented situation in Isabelle/HOL. Before there was a section in the <br>
manual saying clearly that typedefs are not fully checked. Afterwards, <br>
the officially supported typedefs were (1) extended to typedefs <br>
depending on overloaded consts (which was previously not covered) and <br>
(2) the extended scheme checked by the system.</p>
<p>Thus the isar-ref manual entry of HOL typedef could be changed <br>
accordingly: the system has become more user-friendly, since the user is <br>
no longer blamed implicitly for not having read the manual when <br>
something goes wrong; instead the system complains explicitly. In <br>
practice, such a situation was never seen, though, because the <br>
counter-example from the paper by Kuncar / Popescu was constructed <br>
synthetically to illustrate a theoretical point.</p>
<p>Makarius</p>



<a name="294681429"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681429" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681429">(Aug 22 2022 at 14:00)</a>:</h4>
<p>From: Ondřej Kunčar &lt;<a href="mailto:kuncar@in.tum.de">kuncar@in.tum.de</a>&gt;<br>
That's a typo, that type should be tau, the type that was defined on the <br>
previous line. I've already uploaded an updated version of the draft.</p>
<p>Btw, we usually use alpha, beta, gamma for type variables, not sigma. <br>
But this is not mentioned until page 7.</p>
<p>Ondrej</p>



<a name="294681438"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681438" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681438">(Aug 22 2022 at 14:00)</a>:</h4>
<p>From: Ondřej Kunčar &lt;<a href="mailto:kuncar@in.tum.de">kuncar@in.tum.de</a>&gt;<br>
On 08/21/2016 12:21 PM, Lawrence Paulson wrote:</p>
<blockquote>
<p>This question is a perfect example why I dislike the use of the word<br>
“inconsistency" in connection with the work of Kunčar and Popescu.</p>
</blockquote>
<p>Which word would you use then? I'm open to suggestions.</p>
<blockquote>
<p>Probably most people associate that word with some sort of incorrect<br>
logical reasoning. However, their work is concerned with Isabelle's<br>
automatic detection and rejection of circular definitions.</p>
</blockquote>
<p>I see. I guess the whole discrepancy boils down to the question if <br>
definitions are part of logical reasoning. For me, this is the case <br>
since you can view definitions as the following inference rule:</p>
<p>T<br>
----------- [side conditions]<br>
T' |- c = t</p>
<p>And if "c = t" allows you to prove False, then I call it an inconsistency.</p>
<p>I don't find distinguishing between theorems stemming from axioms (and <br>
"pure" logical reasoning) and between theorems stemming from definitions <br>
particularly enlightening.</p>
<blockquote>
<p>While it’s right that they have<br>
fixed this problem, nobody had actually exploited it, and the fix had<br>
no effect on the millions of lines of Isabelle proofs in existence.</p>
</blockquote>
<p>You are right. As far as I know, this was the case for any problems <br>
(either implementation bugs or more substantial problems) that were <br>
found in other provers. But does this mean we should resign on <br>
inspecting and improving our kernels/logics? I hope not.</p>
<p>Bests,<br>
Ondrej</p>



<a name="294681464"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681464" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681464">(Aug 22 2022 at 14:01)</a>:</h4>
<p>From: Jasmin Blanchette &lt;<a href="mailto:jasmin.blanchette@inria.fr">jasmin.blanchette@inria.fr</a>&gt;</p>
<blockquote>
<p>As far as I know, this was the case for any problems (either implementation bugs or more substantial problems) that were found in other provers.</p>
</blockquote>
<p>I believe the soundness bug found in the Coq termination checker in December 2013 was hard to fix without breaking libraries -- I'm not sure what the exact resolution was and how much of an impact it had, but I believe it took them over one year to sort this out precisely because of the tension between soundness, expressiveness, and compatibility. Perhaps somebody with more knowledge about this should comment, but regardless it's dangerous to draw the conclusion that all soundness bugs can be fixed with no impact on real, legitimate applications.</p>
<p>Jasmin</p>



<a name="294681485"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681485" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681485">(Aug 22 2022 at 14:01)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
A number of bugs in PVS had this effect too. As with your example, even the most careful user could not escape. And that’s precisely my point: soundness bugs often have consequences. </p>
<p>Larry Paulson</p>



<a name="294681515"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681515" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681515">(Aug 22 2022 at 14:01)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
You can see definitions that way, but then almost everything can be codified as an inference system. </p>
<p>Of course I am not criticising your work, it's a positive contribution. Everything we can do to catch user errors is constructive. Note also how sledgehammer warns you if it can prove your theorem directly from an inconsistency in your assumptions. And we also have nitpick to catch user errors in theorem statements. But there is a difference between failing to catch a user error and performing incorrect deductions.</p>
<p>Larry</p>



<a name="294681520"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681520" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681520">(Aug 22 2022 at 14:01)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On 21.08.2016 21:41, Ondřej Kunčar wrote:</p>
<blockquote>
<p>I guess the whole discrepancy boils down to the question if <br>
definitions are part of logical reasoning. For me, this is the case <br>
since you can view definitions as the following inference rule:</p>
<p>T<br>
----------- [side conditions]<br>
T' |- c = t</p>
<p>And if "c = t" allows you to prove False, then I call it an <br>
inconsistency.</p>
</blockquote>
<p>This is an important observation. In classic Cambridge HOL systems, <br>
adding definitions is an inference, but in Isabelle it is not: it is a <br>
certain extension of the theory with certain properties that might or <br>
might not be checked separately. That distinction of genuine inferences <br>
vs. specifications is important, because explicit theory contexts are <br>
central to Isabelle.</p>
<blockquote>
<p>I don't find distinguishing between theorems stemming from axioms (and <br>
"pure" logical reasoning) and between theorems stemming from <br>
definitions particularly enlightening.<br>
Maybe, but this is how Isabelle works. Note that Isabelle follows <br>
conventional logic text books in that respect. It was Cambridge HOL to <br>
make specifications an inference, probably due to technical reasons: <br>
there is only one big implicit theory in the ML environment that is <br>
augmented by rules of inferences.</p>
</blockquote>
<p>It is always possible to discuss design decisions of existing systems, <br>
but it needs to be made clear in the text that this is done. Calling <br>
something broken (or "inconsistent"), while actually talking about a <br>
different system is leading to endless confusion.</p>
<blockquote>
<blockquote>
<p>While it’s right that they have<br>
fixed this problem, nobody had actually exploited it, and the fix had<br>
no effect on the millions of lines of Isabelle proofs in existence.<br>
This is because the lack of checks was known over many years as <br>
something that is hardly relevant in practice. The feature addition of <br>
that additional check is theoretically nice, nonetheless.</p>
</blockquote>
</blockquote>
<blockquote>
<p>You are right. As far as I know, this was the case for any problems <br>
(either implementation bugs or more substantial problems) that were <br>
found in other provers. But does this mean we should resign on <br>
inspecting and improving our kernels/logics? I hope not.<br>
No, but here the situation was different: You started to look at the <br>
implementation for other reasons, found things that were surprising, and <br>
called them a "bug". Then I pointed to the documentation, that this <br>
"bug" was an official feature. That caused a lot of noise and confusion <br>
that still seems to be unsettled until today, even though "typedef" has <br>
been officially upgraded from an axiomatic specification to a <br>
definitional one in the implementation and documentation. (Both were <br>
consistent before and after that feature addition.)</p>
</blockquote>
<p>Makarius</p>



<a name="294681540"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681540" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681540">(Aug 22 2022 at 14:01)</a>:</h4>
<p>From: Ken Kubota &lt;<a href="mailto:mail@kenkubota.de">mail@kenkubota.de</a>&gt;<br>
Dear Andrei,</p>
<p>Thank you for the quick answer, and also thanks to Larry Paulson and Makarius Wenzel.</p>
<p>I had read the abbreviated notation with the forall quantifier too quickly, but still the third restriction specified at<br>
<a href="http://sourceforge.net/projects/hol/files/hol/kananaskis-10/kananaskis-10-logic.pdf">http://sourceforge.net/projects/hol/files/hol/kananaskis-10/kananaskis-10-logic.pdf</a> (p. 33) or at [Gordon/Melham, 1993, p. 220].<br>
seems to be violated, as the type variable sigma occurs in the definiens, but not in (the type of) the definiendum.<br>
Your example <br>
    c:bool = ~(AL x:sigma AL y:sigma  .  x = y)<br>
is very similar to the standard example on the next page of the logic manual with type variable alpha not occurring in type of the definiendum "c:bool":<br>
    c:bool = EX f: alpha -&gt; alpha  .  One_One f /\ ~(Onto f)<br>
It seems to me that a remedy simply would have been the restriction of Gordon's HOL (the third restriction).</p>
<p>Larry Paulson's argument at<br>
<a href="https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2016-August/msg00075.html">https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2016-August/msg00075.html</a><br>
seems to aim at a strict distinction between reasoning (inference) and circular definitions (language).<br>
I doubt that this distinction can be made that strictly, since what restriction (iii) in Gordon's HOL tries to prevent,<br>
in Andrews' logic is prevented by the restrictions on Rule R' [cf. Andrews, 2002, p. 214], where an inference from<br>
    H  &gt;  A = B   and   H  &gt;  C<br>
to<br>
    H  &gt;  C [A/B]<br>
('H' denotes a set of hypotheses, '&gt;' the turnstile) by substituting one occurrence of A in C by B is subject to a certain restriction<br>
concerning variables, i.e., if a variable x is free in a member of H and free in (A = B).<br>
If one steps from polymorphic to dependent type theory, type variables are also subject to binding (quantification),<br>
such that type variable dependencies are preserved.<br>
For example, from<br>
    {}  &gt;  ~(AL x:sigma AL y:sigma  .  x = y)<br>
one could infer by the derived Rule of Universal Generalization (5220) [cf. Andrews, 2002, p. 222]<br>
    {}  &gt;  AL sigma:tau ~(AL x:sigma AL y:sigma  .  x = y)<br>
(tau denotes the type of types) and then<br>
    {}  &gt;  F<br>
because some types are singletons.<br>
In other words, your c:bool would be F (false), because free (type) variables are implicitly universally quantified.<br>
In contrast, if there were a condition upon sigma, for example, being bool: H = { sigma = bool }, then from<br>
    { sigma = bool }  &gt;  ~(AL x:sigma AL y:sigma  .  x = y)<br>
one couldn't use the derived Rule of Universal Generalization (5220) to infer<br>
    { sigma = bool }  &gt;  AL sigma:tau ~(AL x:sigma AL y:sigma  .  x = y)<br>
since (type) variable sigma occurs free in the set of hypotheses H, which violates the condition of rule 5220,<br>
which is a condition derived from Rule R', since 5220 (like all rules in Q0 except Rule R/R') is a derived rule.<br>
Hence, circular definitions are prevented by the inference rule (the reasoning) in Q0/R0 in a very simple manner.</p>
<p>Best wishes,</p>
<p>Ken Kubota</p>
<hr>
<p>Ken Kubota<br>
doi: 10.4444/100<br>
<a href="http://dx.doi.org/10.4444/100">http://dx.doi.org/10.4444/100</a></p>



<a name="294681553"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681553" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681553">(Aug 22 2022 at 14:01)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Yes, such extreme measures would greatly simplify the story from a <br>
theoretical point of view, but we are talking here of implemented logic: <br>
it needs to provide extra provisions to make it usable in practice.</p>
<p>Abbreviations that are always expanded would render the system <br>
impractical due to huge terms in expanded internal form.</p>
<p>Ruling out declarations that are separated from definitions greatly <br>
simplify things, but prevent important applications like type class <br>
instantiation.</p>
<p>There is always a tradeoff in theoretical simplicity versus complexity <br>
required for practical applications of logic.<br>
Without that tradeoff, making a usable theorem proving environment like <br>
Isabelle would be a trivial exercise, and not an effort of 30 years.</p>
<p>Makarius</p>



<a name="294681573"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681573" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681573">(Aug 22 2022 at 14:01)</a>:</h4>
<p>From: Andrei Popescu &lt;<a href="mailto:A.Popescu@mdx.ac.uk">A.Popescu@mdx.ac.uk</a>&gt;<br>
Regardless of whether we consider definitions as part of the inference kernel, the following is self-evident:</p>
<p>A logical system, if it takes the trouble to guarantee anything, is supposed to guarantee that False cannot be inferred via the canonical 'safe' user interaction with the system -- which consists of performing definitions plus logical deduction.</p>
<p>Since nobody does bare deduction without (building on top of) definitions, having the former consistent is pointless without having the latter consistent. So what are we talking about here?</p>
<p>Of course, Makarius, you are right to remind us that Isabelle/HOL is a complex software system and its reliability has many facets. Of course, Larry, you are right to remind us that often user definitions can fail to be faithful to the intended concepts. But please let me remind you (again) that these are both different points.</p>
<p>Andrei</p>



<a name="294681586"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681586" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681586">(Aug 22 2022 at 14:01)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
I am talking about how Isabelle works. You are talking about a different <br>
system. That is very dangerous, because people might pick up wrong ideas <br>
about the system, and then produce true non-sense.</p>
<p>The whole "typedef is axiomatic" versus "typedef is definitional in the <br>
sense of HOL set theory" affair from last year was about adding a <br>
feature in order to amend such social problems and misunderstandings. <br>
There was little practical relevance from a logical standpoint.</p>
<p>In Isabelle we have yet more ways to produce a bad theory content and <br>
then derive results that look wrong.</p>
<p>Makarius</p>



<a name="294681608"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681608" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681608">(Aug 22 2022 at 14:01)</a>:</h4>
<p>From: Andrei Popescu &lt;<a href="mailto:A.Popescu@mdx.ac.uk">A.Popescu@mdx.ac.uk</a>&gt;<br>
I find it very dangerous for the theoretical progress in our area to refuse to accept the existence of an Isabelle/HOL logical system -- namely, a system that</p>
<p>can be described mathematically by:</p>
<p>(A) a mechanism for constant and type definitions</p>
<p>(B) a set of rules of deduction</p>
<p>This system exists as a mathematical entity independently of the implementation. (All my contributions to Isabelle/HOL so far, admittedly modest, have</p>
<p>been based on this view -- and they have led to additions to the real system.)</p>
<p>As soon as you accept this view (regardless of how you choose to model (A) and (B) in a reasonable way), you will see the following:</p>
<p>You have incorporated the additional check that we suggested in the paper not only for 'adding a feature in order to amend such social problems and misunderstandings', but also for transforming an inconsistent logical system into a consistent one -- or, if you take the view that type <em>definitions</em> used to come with no consistency guarantees, this was the transformation of a logical system that officially allowed inconsistency into one that does not. And I am very happy for this.</p>
<p>A recurrent objection that you are bringing to the above view is that Isabelle/HOL is built on top of a logical framework, which, according to you,  makes the situation so complex that cannot be depicted by mortals. As I wrote  before, this is a matter that is settled separately, by an adequacy proof -- so that we can ignore the logical framework when making theoretical advancements.</p>
<p>Finally, let me note that, as far as I see, Larry's point is a distinct one: He considers that the consistency of all definitions, be they constant or type definitions, are in principle entirely the user's responsibility -- although he admits that it would be nice if the system 'nitpicked' them here and there.</p>
<p>On the way, he reveals something that had never crossed my mind: that what, in our paper, we naively call a consistency theorem is in fact an enhancement of Nitpick.  :-)  My last email was addressing Larry's point. And note that I was not talking about 'a different system', but about a logical system in general.</p>
<p>Andrei</p>



<a name="294681622"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681622" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681622">(Aug 22 2022 at 14:01)</a>:</h4>
<p>From: Ken Kubota &lt;<a href="mailto:mail@kenkubota.de">mail@kenkubota.de</a>&gt;<br>
But then, looking at the revised version, the problem still seems to be caused by the language.<br>
The first line ("consts" …) seems to be a declaration, and the third line ("defs" …) a definition.<br>
Declarations like this allow the declared constant to practically behave like a variable, since the constant can be specified (defined) much later.</p>
<p>In Q0/R0 there are no such declarations.<br>
If one would try to express the same in the language of R0, only one possibility would be left.<br>
The definition ("defs" …) could not be placed first, since it requires tau, which would be introduced by the latter type definition ("typedef" …) not available at the beginning.<br>
Hence first type tau has to be defined (being a mere abbreviation) on the basis of a variable "c" as:<br>
    tau := [\x:bool  .  x=T \/ x=c:bool]<br>
Proving tau_T (i.e., T is element of tau; '_' denotes lambda application) then makes tau a type (being non-empty).<br>
Finally,<br>
    c = ~(AL x,y:tau  .  x=y)<br>
could be introduced as a hypothesis. Since it leads to a contradiction, it is shown to be false (hence, c != ~(AL x,y:tau  .  x=y) ), which is the desired result.<br>
In summary, the solution would be not allowing declarations in the mathematical language, but only definitions, like in Q0/R0.</p>
<p>Concerning the question of definitions, they shouldn't be part of the kernel, since non-logical axioms should be avoided as discussed in section 3 at<br>
<a href="https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2016-August/msg00069.html">https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2016-August/msg00069.html</a><br>
Also, implementing definitions within the logical core contradicts to the LCF philosophy of a small trusted kernel.<br>
For this reason, definitions in R0 are mere abbreviations located outside of the logical kernel.<br>
They also can be removed at any time (and re-introduced again) without modifying the theorems already obtained.</p>
<p>Ken Kubota</p>
<hr>
<p>Ken Kubota<br>
doi: 10.4444/100<br>
<a href="http://dx.doi.org/10.4444/100">http://dx.doi.org/10.4444/100</a></p>



<a name="294681695"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681695" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681695">(Aug 22 2022 at 14:02)</a>:</h4>
<p>From: Lawrence Paulson &lt;<a href="mailto:lp15@cam.ac.uk">lp15@cam.ac.uk</a>&gt;<br>
We are talking about the danger – almost certainly realised – of misleading people.</p>
<p>The various issues involving Isabelle, Coq, PVS and other systems are all complicated in their details. Outside observes are probably not going to invest the time and effort necessary to investigate precisely what is going on in case case. They will regard these “inconsistencies” as roughly the same. So we are drawing a false equivalence between</p>
<p>I. The prover incorrectly handles correct and meaningful definitions. Users, who have done nothing wrong, cannot complete their projects.</p>
<p>II. Somebody who has studied the source code has devised a definition that is not meaningful and the prover fails to detect this. Nobody has ever used or wanted such a definition, because it is overtly nonsensical.</p>
<p>It’s wrong and misleading to give the impression that I and II are the same.</p>
<p>Larry</p>



<a name="294681767"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681767" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681767">(Aug 22 2022 at 14:02)</a>:</h4>
<p>From: Ken Kubota &lt;<a href="mailto:mail@kenkubota.de">mail@kenkubota.de</a>&gt;<br>
Using the current Isabelle 2016, it is not possible for me to reproduce the problem.</p>
<p>If I understand Andrei Popescu and Makarius Wenzel correctly,<br>
declarations of constants earlier than and separated from their definitions should be possible, <br>
but circular dependencies not anymore in the 2016 version of Isabelle.<br>
Nevertheless, the error message reports a problem with the definition of the constant,<br>
even if circularity is avoided by removing 'c' from tau ('T').</p>
<p>Could you please provide a working example (for the 2016 version of Isabelle)<br>
by correcting my attempt (shown with the results below)?</p>
<p>Please note that line "consts c:α" ("consts c:alpha") at<br>
<a href="http://www21.in.tum.de/~kuncar/kuncar-popescu-jar2016.pdf">http://www21.in.tum.de/~kuncar/kuncar-popescu-jar2016.pdf</a> (p. 3)<br>
still differs from line "consts c :: bool" in<br>
<a href="http://www21.in.tum.de/~kuncar/documents/False.tar.gz">http://www21.in.tum.de/~kuncar/documents/False.tar.gz</a><br>
available via<br>
<a href="http://www21.in.tum.de/~kuncar/documents/patch.html">http://www21.in.tum.de/~kuncar/documents/patch.html</a></p>
<p>Ken Kubota</p>
<p>(* using 'a, "(overloaded)", "definition", and c is removed from T  *)</p>
<p>consts c :: 'a</p>
<p>typedef (overloaded) T = "{True}" by blast</p>
<p>definition c_bool_def: <br>
  "c::bool ≡ if (∀(x::T) y. x = y) then False else True"<br>
(<em>ERROR: Bad head of lhs: existing constant "c"</em>)</p>
<p>(* using 'a, "(overloaded)" and "definition" *)</p>
<p>consts c :: 'a</p>
<p>typedef (overloaded) T = "{True, c}" by blast</p>
<p>definition c_bool_def: <br>
  "c::bool ≡ if (∀(x::T) y. x = y) then False else True"<br>
(<em>ERROR: Bad head of lhs: existing constant "c"</em>)</p>
<p>(* using "(overloaded)" and "definition" *)</p>
<p>consts c :: bool</p>
<p>typedef (overloaded) T = "{True, c}" by blast</p>
<p>definition c_bool_def: <br>
  "c::bool ≡ if (∀(x::T) y. x = y) then False else True"<br>
(<em>ERROR: Bad head of lhs: existing constant "c"</em>)</p>
<p>(* original version by Ondrej Kuncar, with "defs" *)</p>
<p>consts c :: bool</p>
<p>typedef T = "{True, c}" by blast</p>
<p>defs c_bool_def: <br>
  "c::bool ≡ if (∀(x::T) y. x = y) then False else True"<br>
(* several errors in current Isabelle 2016 *)</p>
<hr>
<p>Ken Kubota<br>
doi: 10.4444/100<br>
<a href="http://dx.doi.org/10.4444/100">http://dx.doi.org/10.4444/100</a></p>



<a name="294681810"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681810" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681810">(Aug 22 2022 at 14:02)</a>:</h4>
<p>From: Andrei Popescu &lt;<a href="mailto:A.Popescu@mdx.ac.uk">A.Popescu@mdx.ac.uk</a>&gt;<br>
Dear Larry,</p>
<blockquote>
<blockquote>
<p>We are talking about the danger - almost certainly realised - of misleading people.</p>
</blockquote>
</blockquote>
<p>I don't see how severely (and artificially) lowering the standard of what we want from a logical system can help against the potential confusion. Let me restate the obvious: We want consistency not only of bare deduction (from the HOL axioms), but of deduction from the definitional theories (including constant and type definitions). This is not a complicated statement, and most users of this systems and of similar systems will agree on it.</p>
<p>We did not have that in Isabelle/HOL---and this was hinted to in the reference manual, but in not very clear terms and few people knew about it. Today we have achieved this goal and it is documented in quite clear terms in the same reference manual, and people should know about it. What does not help is refusing to accept what we have already accomplished, <em>even as a principial goal for a logical system</em>.</p>
<p>It should also be stressed, of course, that the modifications needed to achieve this goal -- a harsher check at definitions -- did not affect in any way the previous Isabelle developments, which is great, and indeed different from similar problems in other systems.</p>
<blockquote>
<blockquote>
<p>The various issues involving Isabelle, Coq, PVS and other systems are all complicated in their details. Outside observes are probably not going to invest the time and effort necessary to investigate precisely what is going on in case case. They will regard these "inconsistencies" as roughly the same. So we are drawing a false equivalence between</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>I. The prover incorrectly handles correct and meaningful definitions. Users, who have done nothing wrong, cannot complete their projects.</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>II. Somebody who has studied the source code has devised a definition that is not meaningful and the prover fails to detect this. Nobody has ever used or wanted such a definition, because it is overtly nonsensical.</p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>It's wrong and misleading to give the impression that I and II are the same.</p>
</blockquote>
</blockquote>
<p>There is no a priori notion of 'meaningful' definition, apart from what the system accepts. So yes, from the point of view of the logical system these situations must be treated in the same way, in particular taken equally seriously. And this while ignoring the unnecessary reference to that malicious 'somebody who has studied the source code' -- who happens to be named Ondrej and happens to have been working on something else when he discovered that. But you know very well from day one the story behind this discovery and its ordeals.</p>
<p>Andrei</p>



<a name="294681845"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681845" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681845">(Aug 22 2022 at 14:03)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
How about III,<br>
a user devised a definition that is meaningful but mistakenly omits a <br>
word (eg "primrec") somewhere, and could "complete his project" or so it <br>
seems, by virtue of the fact that his definitions are nonsense, but not <br>
obviously so</p>
<p>Jeremy</p>



<a name="294681937"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294681937" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294681937">(Aug 22 2022 at 14:03)</a>:</h4>
<p>From: Ken Kubota &lt;<a href="mailto:mail@kenkubota.de">mail@kenkubota.de</a>&gt;<br>
Dear Andrei,</p>
<p>Thank you very much for your kind support at<br>
<a href="https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2016-August/msg00099.html">https://lists.cam.ac.uk/pipermail/cl-isabelle-users/2016-August/msg00099.html</a><br>
which I really appreciate.</p>
<p>I was wondering whether it would be possible to create declarations separated <br>
from definitions without (!) overloading in the current Isabelle version <br>
(2016). Such attempts were rejected by the current Isabelle version (see <br>
attached theory CircularDefs). So it seems that overall your approach is <br>
successful in preventing the kind of inconsistency described in your article.</p>
<p>Also, I tried to express your (Ondřej's) definitions in the R0 implementation <br>
and obtained interesting results on the methods preventing such paradoxes. I <br>
shall write more about it in a separate e-mail soon.</p>
<p>Kind regards,</p>
<p>Ken Kubota</p>
<hr>
<p>Ken Kubota<br>
doi: 10.4444/100<br>
<a href="http://dx.doi.org/10.4444/100">http://dx.doi.org/10.4444/100</a><br>
<a href="/user_uploads/14278/yPkUrE-nuM6CM5kPXOSuyIg9/CircularDefs.thy">CircularDefs.thy</a></p>



<a name="294733962"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Type%20definitions%20in%20Isabelle%3B%20article%20%22A%20Consi.../near/294733962" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Type.20definitions.20in.20Isabelle.3B.20article.20.22A.20Consi.2E.2E.2E.html#294733962">(Aug 22 2022 at 17:25)</a>:</h4>
<p>From: Ken Kubota &lt;<a href="mailto:mail@kenkubota.de">mail@kenkubota.de</a>&gt;<br>
Dear Andrei,</p>
<p>Answering a private communication, I referred to your paper on Isabelle/HOL<br>
as well as to Peter Homeier’s HOL-Omega TUTORIAL in a reply at<br>
<a href="http://owlofminerva.net/kubota/r0-faq/">http://owlofminerva.net/kubota/r0-faq/</a></p>
<p>Regards,</p>
<p>Ken</p>
<hr>
<p>Ken Kubota<br>
<a href="http://doi.org/10.4444/100">http://doi.org/10.4444/100</a></p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>