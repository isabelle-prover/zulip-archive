<html>
<head><meta charset="utf-8"><title>[isabelle] Weakest precondition of WHILE as a least fixed... · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Weakest.20precondition.20of.20WHILE.20as.20a.20least.20fixed.2E.2E.2E.html">[isabelle] Weakest precondition of WHILE as a least fixed...</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294328858"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Weakest%20precondition%20of%20WHILE%20as%20a%20least%20fixed.../near/294328858" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Weakest.20precondition.20of.20WHILE.20as.20a.20least.20fixed.2E.2E.2E.html#294328858">(Aug 19 2022 at 17:19)</a>:</h4>
<p>From: Piotr Trojanek &lt;<a href="mailto:piotr.trojanek@gmail.com">piotr.trojanek@gmail.com</a>&gt;<br>
Hi David,</p>
<p>I am aware that I should not start from the first equation when<br>
deriving the second one. That is why I was starting from big-step<br>
semantics (from which also the first equation is derived).</p>
<p>-- Piotr</p>



<a name="294328878"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Weakest%20precondition%20of%20WHILE%20as%20a%20least%20fixed.../near/294328878" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Weakest.20precondition.20of.20WHILE.20as.20a.20least.20fixed.2E.2E.2E.html#294328878">(Aug 19 2022 at 17:19)</a>:</h4>
<p>From: David Cock &lt;<a href="mailto:david.cock@inf.ethz.ch">david.cock@inf.ethz.ch</a>&gt;<br>
Piotr,<br>
   OK, then from the first equation, you have that the weakest <br>
precondition of the loop is a fixed point of the body (combined with the <br>
guard).  Depending on how you've defined 'weakest precondition', <br>
shouldn't you be able to appeal to the fact that it <em>is</em> the weakest to <br>
show that you must have the <em>least</em> fixed point?  You just need to <br>
appeal to the properties of the complete lattice of predicates.</p>
<p>David</p>



<a name="294328906"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Weakest%20precondition%20of%20WHILE%20as%20a%20least%20fixed.../near/294328906" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Weakest.20precondition.20of.20WHILE.20as.20a.20least.20fixed.2E.2E.2E.html#294328906">(Aug 19 2022 at 17:19)</a>:</h4>
<p>From: Piotr Trojanek &lt;<a href="mailto:piotr.trojanek@gmail.com">piotr.trojanek@gmail.com</a>&gt;<br>
David,</p>
<p>It was easy to show that the argument of lfp is a fixed point, but I<br>
cannot show that it is the <em>least</em> one.</p>
<p>My 'weakest precondition' is defined in a standard way, i.e. like the<br>
"wpt" in theory file for Concrete Semantics section 12.5.</p>
<p>Any extra hints? Maybe some textbook or a theory file?</p>
<p>Regards,<br>
Piotr</p>



<a name="294328923"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Weakest%20precondition%20of%20WHILE%20as%20a%20least%20fixed.../near/294328923" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Weakest.20precondition.20of.20WHILE.20as.20a.20least.20fixed.2E.2E.2E.html#294328923">(Aug 19 2022 at 17:19)</a>:</h4>
<p>From: David Cock &lt;<a href="mailto:david.cock@inf.ethz.ch">david.cock@inf.ethz.ch</a>&gt;<br>
Piotr,<br>
   Give me a little bit, and I'll forward you something.</p>
<p>David</p>



<a name="294328949"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Weakest%20precondition%20of%20WHILE%20as%20a%20least%20fixed.../near/294328949" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Weakest.20precondition.20of.20WHILE.20as.20a.20least.20fixed.2E.2E.2E.html#294328949">(Aug 19 2022 at 17:19)</a>:</h4>
<p>From: David Cock &lt;<a href="mailto:david.cock@inf.ethz.ch">david.cock@inf.ethz.ch</a>&gt;<br>
OK, your immediate problem is that wp in the Concrete Semantics book is the weakest liberal precondition i.e. gfp rather than lfp. The proof structure will be identical, just a mirror image.</p>
<p>David.</p>



<a name="294633494"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Weakest%20precondition%20of%20WHILE%20as%20a%20least%20fixed.../near/294633494" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Weakest.20precondition.20of.20WHILE.20as.20a.20least.20fixed.2E.2E.2E.html#294633494">(Aug 22 2022 at 09:07)</a>:</h4>
<p>From: Piotr Trojanek &lt;<a href="mailto:piotr.trojanek@gmail.com">piotr.trojanek@gmail.com</a>&gt;<br>
Dear experts,</p>
<p>I am experimenting with mechanized semantics of a simple imperative<br>
programming language. I have already seen a dozen of mechanizations<br>
which start from big-step semantics and derive the weakest<br>
precondition of WHILE expressed as a recursive equation (which is then<br>
used to derive Hoare rules).</p>
<p>Instead, I would like to derive the weakest precondition of WHILE<br>
expressed as a least fixed point (which is more useful in the<br>
refinement calculus).</p>
<p>I was trying to prove this derivation, but always ended in a loop. Any advice?</p>



<a name="294633530"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Weakest%20precondition%20of%20WHILE%20as%20a%20least%20fixed.../near/294633530" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Weakest.20precondition.20of.20WHILE.20as.20a.20least.20fixed.2E.2E.2E.html#294633530">(Aug 22 2022 at 09:07)</a>:</h4>
<p>From: Peter Lammich &lt;<a href="mailto:lammich@in.tum.de">lammich@in.tum.de</a>&gt;<br>
Hi Piotr.</p>
<p>Have you looked at this AFP-entry:<br>
<a href="http://afp.sourceforge.net/entries/MonoBoolTranAlgebra.shtml">http://afp.sourceforge.net/entries/MonoBoolTranAlgebra.shtml</a></p>
<p>in particular the while-statement in Statement.thy might be interesting<br>
for you.</p>



<a name="294633547"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Weakest%20precondition%20of%20WHILE%20as%20a%20least%20fixed.../near/294633547" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Weakest.20precondition.20of.20WHILE.20as.20a.20least.20fixed.2E.2E.2E.html#294633547">(Aug 22 2022 at 09:07)</a>:</h4>
<p>From: Gerwin Klein &lt;<a href="mailto:Gerwin.Klein@nicta.com.au">Gerwin.Klein@nicta.com.au</a>&gt;<br>
Hi Piotr,</p>
<p>is the fixpoint formulation in chapter 11 of <a href="http://concrete-semantics.org">http://concrete-semantics.org</a> what you are after?</p>
<p>Traditionally, Hoare Logic and weakest precondition calculi do not really derive a weakest precondition for While, but rely on user-provided invariants instead, but I might be misunderstanding what you mean by weakest precondition.</p>
<p>Cheers,<br>
Gerwin</p>
<hr>
<p>The information in this e-mail may be confidential and subject to legal professional privilege and/or copyright. National ICT Australia Limited accepts no liability for any damage caused by this email or its attachments.</p>



<a name="294633567"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Weakest%20precondition%20of%20WHILE%20as%20a%20least%20fixed.../near/294633567" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Weakest.20precondition.20of.20WHILE.20as.20a.20least.20fixed.2E.2E.2E.html#294633567">(Aug 22 2022 at 09:07)</a>:</h4>
<p>From: Piotr Trojanek &lt;<a href="mailto:piotr.trojanek@gmail.com">piotr.trojanek@gmail.com</a>&gt;<br>
Thank you both for your answers.</p>
<p>I am familiar with chapter 11 of Concrete Semantics. In section 12.3<br>
you have (page 205):</p>
<p>wp (WHILE b DO c) Q = (\s. if bval b s then wp (c ;; WHILE b DO c) Q s else Q s)</p>
<p>but I need:</p>
<p>wp (WHILE b DO c) Q = lfp (\w. b AND wp c w OR NOT b AND q)</p>
<p>(where AND, OR and NOT are lifted Boolean operators). I was trying to<br>
get it from the denotational equation with lfp but failed. Maybe I<br>
should try harder?</p>
<p>The second formulation is equivalent to that from HOL Light tutorial<br>
(section 17.2, while_def).</p>
<p>I am still studying the AFP entry suggested by Peter...</p>



<a name="294633591"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20Weakest%20precondition%20of%20WHILE%20as%20a%20least%20fixed.../near/294633591" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20Weakest.20precondition.20of.20WHILE.20as.20a.20least.20fixed.2E.2E.2E.html#294633591">(Aug 22 2022 at 09:07)</a>:</h4>
<p>From: David Cock &lt;<a href="mailto:david.cock@inf.ethz.ch">david.cock@inf.ethz.ch</a>&gt;<br>
Piotr,<br>
   One problem that you're likely to run into here is that the first <br>
equation that you quote is not definitional: It's an equality that holds <br>
for the denotation that you're after, but also for (potentially <br>
infinitely many) others, every fixed point of the loop body, in fact.  <br>
To go from the first equation to the second requires you to make a <br>
choice - to state that you want to interpret a loop as the <em>least</em> fixed <br>
point of its body.  This is not implied, it's sometimes useful to take <br>
the greatest fixed point, for example to derive a <br>
weakest-<em>liberal</em>-precondition semantics.</p>
<p>David</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>