<html>
<head><meta charset="utf-8"><title>[isabelle] afp_build in RC2 · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20afp_build.20in.20RC2.html">[isabelle] afp_build in RC2</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294233241"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20afp_build%20in%20RC2/near/294233241" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20afp_build.20in.20RC2.html#294233241">(Aug 19 2022 at 10:05)</a>:</h4>
<p>From: Christian Sternagel &lt;<a href="mailto:c.sternagel@gmail.com">c.sternagel@gmail.com</a>&gt;<br>
Dear list,</p>
<p>it is now the second time that I got</p>
<h3>I/O error:</h3>
<p>/home/griff/.isabelle/Isabelle2013-RC2/browser_info/HOL/.session/entries <br>
(No such file or directory)</p>
<h3>Browser info: failed to update session index of</h3>
<p>"$ISABELLE_BROWSER_INFO/HOL"</p>
<p>when starting "isabelle afp_build some-session". But this error is <br>
nondeterministic. Both times, when issuing the command again, it <br>
succeeded (and most of the time when I use afp_build, I do not get this <br>
error at all).</p>
<p>Just reporting something odd.</p>
<p>cheers</p>
<p>chris</p>
<p>PS: It might be just a coincidence that I got this with afp_build, maybe <br>
it can also happen with plain build.</p>



<a name="294233384"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20afp_build%20in%20RC2/near/294233384" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20afp_build.20in.20RC2.html#294233384">(Aug 19 2022 at 10:06)</a>:</h4>
<p>From: Gerwin Klein &lt;<a href="mailto:Gerwin.Klein@nicta.com.au">Gerwin.Klein@nicta.com.au</a>&gt;<br>
This probably just depends on if you have built HOL with browser_info on before or not, i.e. if the session file exists or not.</p>
<p>(afp_build just sets browser_info and document options)</p>
<p>I've hit this as well today, but I'm not sure which way is better: failing the build or not. If HOL has not been built with browser_info before, it doesn't really make sense to generate html that links to it.</p>
<p>Cheers,<br>
Gerwin</p>
<hr>
<p>The information in this e-mail may be confidential and subject to legal professional privilege and/or copyright. National ICT Australia Limited accepts no liability for any damage caused by this email or its attachments.</p>



<a name="294234613"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20afp_build%20in%20RC2/near/294234613" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20afp_build.20in.20RC2.html#294234613">(Aug 19 2022 at 10:16)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On Sat, 2 Feb 2013, Gerwin Klein wrote:</p>
<blockquote>
<p>This probably just depends on if you have built HOL with browser_info on <br>
before or not, i.e. if the session file exists or not.</p>
<p>(afp_build just sets browser_info and document options)</p>
<p>I've hit this as well today, but I'm not sure which way is better: <br>
failing the build or not. If HOL has not been built with browser_info <br>
before, it doesn't really make sense to generate html that links to it.</p>
</blockquote>
<p>I have made some refinements here just before starting the Isabelle2013-RC <br>
phase.  It should mostly work as in Isabelle2012, but with deterministic <br>
order of the HTML index and without certain race conditions from the past.</p>
<blockquote>
<p>On 02.02.2013, at 8:50 PM, Christian Sternagel &lt;<a href="mailto:c.sternagel@gmail.com">c.sternagel@gmail.com</a>&gt; wrote:</p>
<blockquote>
<h3>I/O error: /home/griff/.isabelle/Isabelle2013-RC2/browser_info/HOL/.session/entries (No such file or directory)</h3>
<h3>Browser info: failed to update session index of "$ISABELLE_BROWSER_INFO/HOL"</h3>
<p>when starting "isabelle afp_build some-session". But this error is <br>
nondeterministic. Both times, when issuing the command again, it <br>
succeeded (and most of the time when I use afp_build, I do not get this <br>
error at all).</p>
</blockquote>
</blockquote>
<p>Is it really non-deterministic due to parallel processing of sessions, or <br>
just as Gerwin pointed out that you happen to have HOL with or without <br>
browser_info already?</p>
<p>Looking briefly over src/Pure/Thy/present.scala (and .ML) I don't see <br>
anything suspicous.  The index is produced once after processing all <br>
sessions.</p>
<p>Makarius</p>



<a name="294235551"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20afp_build%20in%20RC2/near/294235551" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20afp_build.20in.20RC2.html#294235551">(Aug 19 2022 at 10:23)</a>:</h4>
<p>From: Christian Sternagel &lt;<a href="mailto:c.sternagel@gmail.com">c.sternagel@gmail.com</a>&gt;<br>
Dear Makarius,</p>
<p>it is not real non-determinism (it just seemed to me like it, since I <br>
didn't know the "raise" conditions ;)).</p>
<p>Incidentally, I always get the error when running.</p>
<p>isabelle build -d -nc '$AFP' &lt;session-name&gt;</p>
<p>followed by</p>
<p>isabelle afp_build &lt;session-name&gt;</p>
<p>Then, running</p>
<p>isabelle afp_build &lt;session-name&gt;</p>
<p>a second time succeeds.</p>
<p>Another thing. After manually deleting <br>
~/.isabelle/Isabelle2013-RC2/heaps and <br>
~/.isabelle/Isabelle2013-RC2/browser_info and then running</p>
<p>isabelle afp_build &lt;afp-session-name&gt;</p>
<p>I get the output:<br>
Building Pure ...<br>
Finished Pure (0:00:08 elapsed time, 0:00:08 cpu time, factor 1.00)<br>
Building HOL ...<br>
rmdir: failed to remove ‘/tmp/isabelle-griff14182’: Directory not empty<br>
HOL FAILED</p>
<p>Why do I get this error (and why so late, it seems to approximately take <br>
the same time as HOL usually needs to build)? This error does not go <br>
away when issuing afp_build another time. But with</p>
<p>isabelle build -b HOL</p>
<p>it is not triggered.</p>
<p>cheers</p>
<p>chris</p>
<p>PS: Isn't it odd that I have to write -nc if I only want to clean. I <br>
would have suspected -c to do exactly that... but then again, there is <br>
this difference between just "running" a session (and probably <br>
generating some document) and "building" a logic image, which I have not <br>
quite internalized yet.</p>



<a name="294235839"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20afp_build%20in%20RC2/near/294235839" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20afp_build.20in.20RC2.html#294235839">(Aug 19 2022 at 10:25)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
The isabelle build tool is controlled by "letter soups", a bit like Unix <br>
tar.  Certain combinations achieve certain things that you might want to <br>
do, but there is quite a lot what one could want.  So far isabelle build <br>
options cover only half of the alphabet, a bit less than its predecessor <br>
usedir.</p>
<p>The system manual explains the meaning of the build options, and gives <br>
various examples for real-life situations.</p>
<p>Also note that when you just need a certain session image to work with it, <br>
you do it via "isabelle build_dialog -l My_Session", or rather "isabelle <br>
jedit -l My_Session" which then invokes build_dialog.</p>
<p>Makarius</p>



<a name="294235994"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20afp_build%20in%20RC2/near/294235994" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20afp_build.20in.20RC2.html#294235994">(Aug 19 2022 at 10:26)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On Tue, 5 Feb 2013, Christian Sternagel wrote:</p>
<blockquote>
<p>it is not real non-determinism (it just seemed to me like it, since I didn't <br>
know the "raise" conditions ;)).</p>
</blockquote>
<p>I have experimented a bit, but without any clear conclusion.  There might <br>
be some remaining problems (and not just confusions) somewhere, but we <br>
need to pin them down precisely.</p>
<blockquote>
<p>Incidentally, I always get the error when running.</p>
<p>isabelle build -d -nc '$AFP' &lt;session-name&gt;</p>
<p>followed by</p>
<p>isabelle afp_build &lt;session-name&gt;</p>
<p>Then, running</p>
<p>isabelle afp_build &lt;session-name&gt;</p>
<p>a second time succeeds.</p>
</blockquote>
<p>The second time it will not build anything again, because it was already <br>
finished in the first run.  When insisting in a second build like this</p>
<p>isabelle afp_build -- -c &lt;session-name&gt;</p>
<p>you should see the same behaviour again.</p>
<p>Recall that "### I/O error" is just a warning, about an internal error <br>
that was ignored.  IIRC, this non-strict behaviour has been there all the <br>
time: the idea is that browser_info is not fully formally managed, so you <br>
could have too little or too much lying around in that directory, and the <br>
system fails gracefully.</p>
<p>In the next big reform of browser_info, I shall probably make all the <br>
information part of the log file, and merely have a tool to pull it from <br>
there to get actual HTML.</p>
<blockquote>
<p>Another thing. After manually deleting ~/.isabelle/Isabelle2013-RC2/heaps and <br>
~/.isabelle/Isabelle2013-RC2/browser_info and then running</p>
<p>isabelle afp_build &lt;afp-session-name&gt;</p>
<p>I get the output:<br>
Building Pure ...<br>
Finished Pure (0:00:08 elapsed time, 0:00:08 cpu time, factor 1.00)<br>
Building HOL ...<br>
rmdir: failed to remove ‘/tmp/isabelle-griff14182’: Directory not empty<br>
HOL FAILED</p>
<p>Why do I get this error (and why so late, it seems to approximately take the <br>
same time as HOL usually needs to build)?</p>
</blockquote>
<p>This also looks very odd to me, but I didn't get there.  It would help to <br>
see the log file of the failed HOL session, or the result of it running <br>
with "isabelle build -v", which gives some progress report.  And what is <br>
in /tmp/isabelle-griff14182 after breakdown?</p>
<p>(Better show me this privately off-list.)</p>
<p>Makarius</p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>