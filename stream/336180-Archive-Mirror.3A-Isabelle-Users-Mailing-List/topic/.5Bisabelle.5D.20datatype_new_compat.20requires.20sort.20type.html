<html>
<head><meta charset="utf-8"><title>[isabelle] datatype_new_compat requires sort type · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20datatype_new_compat.20requires.20sort.20type.html">[isabelle] datatype_new_compat requires sort type</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294264670"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20datatype_new_compat%20requires%20sort%20type/near/294264670" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20datatype_new_compat.20requires.20sort.20type.html#294264670">(Aug 19 2022 at 13:28)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Dear BNF implementors,</p>
<p>I just want to report that in Isabelle2013-2, the datatype_new_compat command fails on <br>
datatypes that have been declared with sorts other than {type} on their type variables. <br>
Here's a small example.</p>
<p>theory Scratch imports "~~/src/HOL/BNF/BNF" begin</p>
<p>default_sort equal<br>
datatype_new 'a foo = Foo 'a<br>
datatype_new_compat foo</p>
<p>*** Type error in application: incompatible operand type</p>
<hr>
<p>*** Operator:  fa :: 'a =&gt; nat<br>
*** Operand:   x :: 'b<br>
*** The error(s) above occurred in axiom "foo_size_def"<br>
*** At command "datatype_new_compat"</p>
<p>Best,<br>
Andreas</p>



<a name="294266569"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20datatype_new_compat%20requires%20sort%20type/near/294266569" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20datatype_new_compat.20requires.20sort.20type.html#294266569">(Aug 19 2022 at 13:28)</a>:</h4>
<p>From: Jasmin Blanchette &lt;<a href="mailto:jasmin.blanchette@gmail.com">jasmin.blanchette@gmail.com</a>&gt;<br>
Hi Andreas,</p>
<p>Thank you for the report. I've just fixed it in the repository version (f00012c20344). It should be easy to apply the change to 2013-2, should that be necessary.</p>
<p>Cheers,</p>
<p>Jasmin</p>



<a name="294266598"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20datatype_new_compat%20requires%20sort%20type/near/294266598" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20datatype_new_compat.20requires.20sort.20type.html#294266598">(Aug 19 2022 at 13:28)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Jasmin,</p>
<p>Thanks for fixing. I currently don't see the need to change my Isabelle2012-2 <br>
installation, as I don't know of an example of a datatype that falls in the scope of <br>
datatype_new_compat and that absolutely needs sort constraints on type variables. (I have <br>
some BNFs that need sort constraints, but datatype_compat_new cannot handle recursion <br>
through these.)</p>
<p>Andreas</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>