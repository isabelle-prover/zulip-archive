<html>
<head><meta charset="utf-8"><title>[isabelle] domintros generated by Function too weak · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20domintros.20generated.20by.20Function.20too.20weak.html">[isabelle] domintros generated by Function too weak</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294116378"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20domintros%20generated%20by%20Function%20too%20weak/near/294116378" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20domintros.20generated.20by.20Function.20too.20weak.html#294116378">(Aug 18 2022 at 16:00)</a>:</h4>
<p>From: Alexander Krauss &lt;<a href="mailto:krauss@in.tum.de">krauss@in.tum.de</a>&gt;</p>
<blockquote>
<p>I have some more issues with the Function package, this time with the<br>
domintros option.<br>
[...]</p>
</blockquote>
<blockquote>
<p>I’m not sure if this is a bug in in the Function package, or an<br>
unavoidable limitation.</p>
</blockquote>
<p>It is an unavoidable limitation of the specific implementation, i.e., a <br>
bug. I know it for a long time, and it is (again) caused by some <br>
uncontrolled forward simplification (which is from the devil, but I <br>
didn't know how bad it was when I wrote the code). Maybe it is time for <br>
a new attempt of improving this... I'll have a look.</p>
<p>Alex</p>



<a name="294116470"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20domintros%20generated%20by%20Function%20too%20weak/near/294116470" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20domintros.20generated.20by.20Function.20too.20weak.html#294116470">(Aug 18 2022 at 16:01)</a>:</h4>
<p>From: Joachim Breitner &lt;<a href="mailto:mail@joachim-breitner.de">mail@joachim-breitner.de</a>&gt;<br>
Hi,</p>
<p>I have some more issues with the Function package, this time with the<br>
domintros option. Consider this (not very useful) example:</p>
<hr>
<p>function (sequential,domintros) f where<br>
   "f v b = (if v = 1 then f 0 b else f (Suc v) b)"<br>
apply pat_completeness<br>
apply auto<br>
done</p>
<hr>
<p>The generated domintros rule is too weak:</p>
<hr>
<p>thm f.domintros(1)[no_vars]<br>
⟦f_dom (0, b); v ≠ Suc 0 ⟹ f_dom (Suc v, b)⟧ ⟹ f_dom (v, b)</p>
<hr>
<p>Note that the f_rel intros are correct:<br>
thm f_rel.intros[no_vars]</p>
<hr>
<p>v = 1 ⟹ f_rel (0, b) (v, b)<br>
v ≠ 1 ⟹ f_rel (Suc v, b) (v, b)</p>
<hr>
<p>I can work around the issue by wrapping the condition of the if<br>
statement in the identity function and removing it temporarily from the<br>
simpset:</p>
<hr>
<p>declare id_apply[simp del]<br>
function (sequential,domintros) f' where<br>
   "f' v b = (if id (v = 0) then f' 0 b else f' (Suc v) b)"<br>
apply pat_completeness<br>
apply auto<br>
done<br>
declare id_apply[simp]</p>
<hr>
<p>yields</p>
<hr>
<p>thm f'.domintros(1)[no_vars]<br>
⟦id (v = 0) ⟹ f'_dom (0, b); ¬ id (v = 0) ⟹ f'_dom (Suc v, b)⟧<br>
⟹ f'_dom (v, b)</p>
<hr>
<p>A probably related problem is that</p>
<hr>
<p>function (sequential,domintros) f where<br>
   "f l = (case l of [a,b,0] ⇒ f [a+b])"<br>
apply pat_completeness<br>
apply auto<br>
done</p>
<hr>
<p>gives the domintro rule</p>
<hr>
<p>thm f.domintros(1)[no_vars]<br>
(⋀a aa. f_dom [a + aa]) ⟹ f_dom l  [?]</p>
<hr>
<p>where I am missing the connection between l and a,aa.</p>
<p>I’m not sure if this is a bug in in the Function package, or an<br>
unavoidable limitation.</p>
<p>Thanks,<br>
Joachim<br>
<a href="/user_uploads/14278/2XTdqzHfv2uVf0uTXYQ-71IM/signature.asc">signature.asc</a></p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>