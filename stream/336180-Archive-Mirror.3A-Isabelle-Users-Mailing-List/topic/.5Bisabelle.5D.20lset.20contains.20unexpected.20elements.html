<html>
<head><meta charset="utf-8"><title>[isabelle] lset contains unexpected elements · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20lset.20contains.20unexpected.20elements.html">[isabelle] lset contains unexpected elements</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294650090"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20lset%20contains%20unexpected%20elements/near/294650090" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20lset.20contains.20unexpected.20elements.html#294650090">(Aug 22 2022 at 10:55)</a>:</h4>
<p>From: Jasmin Blanchette &lt;<a href="mailto:jasmin.blanchette@inria.fr">jasmin.blanchette@inria.fr</a>&gt;<br>
Dear Christoph,</p>
<p>Yes. Your lemma is correct. This is a bug in Nitpick. Nitpick was developed before the "codatatype" command was added to Isabelle, and it looks like I forgot to handle set functions properly. I'll look into this.</p>
<p>Cheers,</p>
<p>Jasmin</p>



<a name="294650855"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20lset%20contains%20unexpected%20elements/near/294650855" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20lset.20contains.20unexpected.20elements.html#294650855">(Aug 22 2022 at 11:00)</a>:</h4>
<p>From: Christoph Dittmann &lt;<a href="mailto:f-isabellelist@yozora.eu">f-isabellelist@yozora.eu</a>&gt;<br>
Dear Jasmin,</p>
<p>Thanks, this is a relief.</p>
<p>Best,<br>
Christoph</p>



<a name="294651014"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20lset%20contains%20unexpected%20elements/near/294651014" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20lset.20contains.20unexpected.20elements.html#294651014">(Aug 22 2022 at 11:01)</a>:</h4>
<p>From: Manuel Eberl &lt;<a href="mailto:eberlm@in.tum.de">eberlm@in.tum.de</a>&gt;<br>
Just out of curiosity: how does one prove this lemma? I played around<br>
with it yesterday but could not figure it out.</p>
<p>Cheers,</p>
<p>Manuel</p>



<a name="294651201"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20lset%20contains%20unexpected%20elements/near/294651201" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20lset.20contains.20unexpected.20elements.html#294651201">(Aug 22 2022 at 11:02)</a>:</h4>
<p>From: Dmitriy Traytel &lt;<a href="mailto:traytel@in.tum.de">traytel@in.tum.de</a>&gt;<br>
Hi Manuel,</p>
<p>the key ingredient is the following lemma proved by induction on the set <br>
function (provided by the codatatype package).</p>
<p>lemma "y ∈ lset w' ⟹ w' = w ⟹ x = y"<br>
   by (induct y w' rule: llist.set_induct; subst (asm) w.ctr; simp)</p>
<p>This is the rather general approach. For the special case of lazy lists, <br>
Andreas has a nice alternative characterization of lset in terms of lnth <br>
in Coinductive_LList which might make things simpler (but more index-based).</p>
<p>Dmitriy</p>



<a name="294651238"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20lset%20contains%20unexpected%20elements/near/294651238" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20lset.20contains.20unexpected.20elements.html#294651238">(Aug 22 2022 at 11:02)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Manuel,</p>
<p>You have to use the induction rule for lset. Here's the proof:</p>
<p>lemma "lset w = {x}"<br>
proof(intro set_eqI iffI)<br>
   fix y :: "'a"<br>
   assume "y ∈ lset w"<br>
   thus "y ∈ {x}"<br>
     by(induction xs=="w :: 'a llist" rule: lset_induct)(subst (asm) w.code; simp)+<br>
qed(subst w.code; simp)</p>
<p>Best,<br>
Andreas</p>



<a name="294652443"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20lset%20contains%20unexpected%20elements/near/294652443" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20lset.20contains.20unexpected.20elements.html#294652443">(Aug 22 2022 at 11:10)</a>:</h4>
<p>From: Christoph Dittmann &lt;<a href="mailto:f-isabellelist@yozora.eu">f-isabellelist@yozora.eu</a>&gt;<br>
Hello,</p>
<p>I have trouble understanding codatatypes.  The AFP entry "coinductive"<br>
defines lazy lists:</p>
<p>codatatype (lset: 'a) llist = LNil | LCons 'a "'a llist"</p>
<p>Then I define the infinite list containing only x (to my understanding,<br>
this list should be unique):</p>
<p>consts x :: 'a<br>
primcorec w where "w = LCons x w"</p>
<p>Then I expected "lset w = {x}" to hold.  Turns out it doesn't:</p>
<p>lemma "lset w = {x}" try<br>
(* Nitpick found a counterexample for card 'a = 2: Empty assignment *)</p>
<p>So I guess either my understanding of lset as "the set of all elements<br>
occuring in the list" is wrong or my definition of w is not what I think<br>
it is.</p>
<p>Could someone shed some light on this?</p>
<p>Thanks,<br>
Christoph</p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>