<html>
<head><meta charset="utf-8"><title>[isabelle] make_string · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html">[isabelle] make_string</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294733597"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294733597" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294733597">(Aug 22 2022 at 17:22)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Well, obviously I don't want to create a print function for any new <br>
datatype when there is one there already (now that I've been told how to <br>
remove all the extra crap in the output from @{make_string}).</p>
<p>In what way is @{make_string} not suitable for production-quality output?</p>
<p>Thanks</p>
<p>Jeremy</p>



<a name="294733613"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294733613" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294733613">(Aug 22 2022 at 17:23)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
Before we continue this thread, can you just explain what you are trying<br>
to do.</p>
<p>There is usually no need to abuse Isabelle/ML to get things done properly.</p>
<p>Makarius</p>



<a name="294733985"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294733985" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294733985">(Aug 22 2022 at 17:25)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Hi Makarius,</p>
<p>Well, as you suggest, this gives only machine writable/readable data; I <br>
want to get an ML value of type term (or, as in my case, a related <br>
datatype, or more generally any ML value), as a string, that is, an ML <br>
value of type string, which is readable, and could be used to construct <br>
a theory file, by reading it in by<br>
  ML {* val t = ... *}<br>
Just like PolyML.makestring, which I assume has been deliberately made <br>
unavailable (why is this?)<br>
  And just like @{make_string} combined with |&gt; YXML.parse_body |&gt; <br>
XML.content_of seems to do, but you seem to be saying that I shouldn't <br>
use this for production-quality output (why is this the case?)</p>
<p>Regards,</p>
<p>Jeremy</p>



<a name="294734002"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734002" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734002">(Aug 22 2022 at 17:25)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Hi Makarius,</p>
<p>How so?  When I try<br>
theory Scratch imports ZF Main begin<br>
I get an error message</p>
<p>Jeremy</p>



<a name="294734022"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734022" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734022">(Aug 22 2022 at 17:25)</a>:</h4>
<p>From: Lars Hupel &lt;<a href="mailto:hupel@in.tum.de">hupel@in.tum.de</a>&gt;<br>
"In the same process" means that you can have an editor window open with <br>
two theories, one of which imports "ZF", the other imports "Main". Both <br>
theories can be edited simultaneously.</p>
<p>It doesn't mean that you can import both into the same theory, which <br>
would be very hard indeed.</p>
<p>Cheers<br>
Lars</p>



<a name="294734032"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734032" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734032">(Aug 22 2022 at 17:25)</a>:</h4>
<p>From: Lars Hupel &lt;<a href="mailto:hupel@in.tum.de">hupel@in.tum.de</a>&gt;<br>
I would be suprised if that worked for terms.</p>
<p>If you use this routine on the term "λx. x", you'll get:</p>
<p>Abs ("x", "'a", Bound 0)</p>
<p>Note that the type there is pretty-printed as "'a". If you try to read <br>
that in in an ML block:</p>
<p>ML‹Abs ("x", "'a", Bound 0)›</p>
<p>You'll get an error message that the type is supposed to be a "typ", not <br>
a "string". The correct ML input representation would instead be:</p>
<p>Abs ("x", TFree ("'a", ["HOL.type"]), Bound 0)</p>
<p>I would instead recommend dealing with non-human-readable terms in files <br>
instead (arguably, the above is not really human-readable anyway).</p>
<p>Cheers<br>
Lars</p>



<a name="294734088"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734088" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734088">(Aug 22 2022 at 17:26)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Hi Lars,</p>
<p>Abs ("x", TFree ("'a", ["HOL.type"]), Bound 0)</p>
<p>is exactly what I want, having learnt the lesson a very long time ago <br>
that human-readable is always better, for debugging and generally <br>
understanding what is going on.  That's why internet protocols such as <br>
HTTP, SMTP etc, are human-readable.</p>
<p>And I can get Abs ("x", TFree ("'a", ["HOL.type"]), Bound 0) printed on<br>
the screen, and by using @{make_string}, coupled with |&gt; YXML.parse_body <br>
|&gt; XML.content_of I can get it into a string value.</p>
<p>What I am asking is (1) why is @{make_string} unsuitable for <br>
production-quality code, and (2) if this is a reason for not using it, <br>
what should I use to achieve the same effect.</p>
<p>Thanks</p>
<p>Jeremy</p>



<a name="294734115"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734115" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734115">(Aug 22 2022 at 17:26)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Hi Lars,</p>
<p>Thanks but how do I do this?  Does the "editor window" mean the bit on <br>
the top left, where I enter things like theory Scratch imports ZF begin?</p>
<p>And how do I do what you are referring to?</p>
<p>If I try</p>
<p>theory Scratch imports ZF begin</p>
<p>ML {* val t = 1 *}</p>
<p>end</p>
<p>theory Scratch imports Main begin</p>
<p>it gives one error message, if I delete the "end" it gives another error <br>
message, changing Scratch to Scratch1 makes no difference.</p>
<p>What do I actually do to achieve "have an editor window open with</p>
<blockquote>
<p>two theories, one of which imports "ZF", the other imports "Main""</p>
</blockquote>
<p>Thanks.</p>
<p>Jeremy</p>



<a name="294734144"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734144" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734144">(Aug 22 2022 at 17:26)</a>:</h4>
<p>From: Lars Hupel &lt;<a href="mailto:hupel@in.tum.de">hupel@in.tum.de</a>&gt;</p>
<blockquote>
<p>What do I actually do to achieve "have an editor window open with</p>
<blockquote>
<p>two theories, one of which imports "ZF", the other imports "Main""</p>
</blockquote>
</blockquote>
<p>One theory = one buffer. You have to open a new buffer by pressing <br>
Ctrl-N (or Cmd-N on macOS). You can also have them open side-by-side, by <br>
going to "View", "Splitting".</p>
<p>Cheers<br>
Lars</p>



<a name="294734158"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734158" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734158">(Aug 22 2022 at 17:26)</a>:</h4>
<p>From: Lars Hupel &lt;<a href="mailto:hupel@in.tum.de">hupel@in.tum.de</a>&gt;<br>
How, if I may ask? If you can get this printed on the screen, surely you<br>
must have it as a string somehow? So why shoving this to @{make_string}<br>
again?</p>



<a name="294734174"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734174" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734174">(Aug 22 2022 at 17:26)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Hi Lars,</p>
<p>structure MyTerm = struct<br>
datatype typ =<br>
     TFree of string * sort<br>
   | TVar of indexname * sort<br>
   | Type of string * typ list</p>
<p>datatype term =<br>
     $ of term * term<br>
   | Abs of string * typ * term<br>
   | Bound of int<br>
   | Const of string * typ<br>
   | Free of string * typ<br>
   | Var of indexname * typ<br>
end ; (* structure MyTerm *)</p>
<p>fun ty_toMy (Term.Type (s, tys)) = MyTerm.Type (s, <a href="http://List.map">List.map</a> ty_toMy tys)<br>
   | ty_toMy (Term.TVar (ixn, st)) = MyTerm.TVar (ixn, st)<br>
   | ty_toMy (Term.TFree (s, st)) = MyTerm.TFree (s, st) ;</p>
<p>fun tm_toMy (Term.$ (f, x)) = MyTerm.$ (tm_toMy f, tm_toMy x)<br>
   | tm_toMy (Term.Abs (s, ty, tm)) = MyTerm.Abs (s, ty_toMy ty, tm_toMy tm)<br>
   | tm_toMy (Term.Bound n) = MyTerm.Bound n<br>
   | tm_toMy (Term.Const (s, ty)) = MyTerm.Const (s, ty_toMy ty)<br>
   | tm_toMy (Term.Free (s, ty)) = MyTerm.Free (s, ty_toMy ty)<br>
   | tm_toMy (Term.Var (ixn, ty)) = MyTerm.Var (ixn, ty_toMy ty) ;</p>
<p>so tm_toMy t results in<br>
val it = .... (ie, it gets printed out naturally, with no <br>
pretty-printing of types).  I don't know if that's the easiest way of <br>
stopping types from being pretty-printed, but it is the way I found.</p>
<p>I maybe don't quite understand your remark, but since ML always prints a <br>
newly defined value on the screen - which means it must work out how to <br>
express it as a string (sometimes not very usefully, when it's a <br>
function), but it doesn't actually give you an ML value of type string.</p>
<p>But to get this as a string ML value one would normally use <br>
PolyML.makestring, or the "production-quality equivalent" of<br>
@{make_string}, followed by |&gt; YXML.parse_body |&gt; XML.content_of.</p>
<p>My question is, what is that production-quality equivalent.</p>
<p>Cheers,</p>
<p>Jeremy</p>



<a name="294734194"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734194" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734194">(Aug 22 2022 at 17:26)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
OK, thanks - I've done that (ie both those things), but the second <br>
buffer is completely non-responsive (well, almost, since clicking in the <br>
second buffer removes the output from the first buffer from the output <br>
area, but there's no output from the second buffer.  Is there a second <br>
output area that's hidden away somewhere, that I need to do something to <br>
make visible?</p>
<p>Thanks,</p>
<p>Jeremy</p>



<a name="294734205"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734205" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734205">(Aug 22 2022 at 17:26)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
See the included ROOT file which defines a session that contains all<br>
theories from HOL + ZF. You can copy that to your project DIRECTORY and<br>
use the session in Isabelle/jEdit as follows:</p>
<p>isabelle jedit -d DIRECTORY -l "HOL+ZF"</p>
<p>Then you can work with theory ML values from unrelated contexts as<br>
illustrated in the included Scratch.thy, but note that<br>
Thy_Info.get_theory only works for theories loaded into the underlying<br>
session image.</p>
<p>So there is no need to write out string representations of ML values at<br>
all, and try to read them back again (that additional problem has not<br>
even been touch on this thread so far).</p>
<p>Makarius<br>
<a href="/user_uploads/14278/VF4ZRDnfQvhrtu5_YSZeKsjb/ROOT">ROOT</a><br>
<a href="/user_uploads/14278/RzVFfnEsHCg15kxzvqZ4PfTP/Scratch.thy">Scratch.thy</a></p>



<a name="294734241"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734241" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734241">(Aug 22 2022 at 17:27)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Hi Makarius,</p>
<p>Thanks - I tried the above and an extra window appeared containing the <br>
following</p>
<p>Build started for Isabelle/HOL+ZF ...<br>
Building HOL+ZF ...</p>
<p>(lots of output here)</p>
<p>*** Failed to load theory "ZF.InfDatatype" (unresolved "ZF.Cardinal_AC")<br>
*** Failed to load theory "ZFC" (unresolved "ZF.InfDatatype")<br>
*** Cannot merge theories with different application syntax<br>
*** At command "theory" (line 10 of "~~/src/ZF/Cardinal_AC.thy")<br>
Unfinished session(s): HOL+ZF<br>
Return code: 2</p>
<p>Session build failed -- prover process remains inactive!</p>
<p>Cheers,</p>
<p>Jeremy</p>



<a name="294734244"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734244" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734244">(Aug 22 2022 at 17:27)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
You actually need Isabelle2018-RC0 for that: it approximates the<br>
Isabelle2018 release that is scheduled for August 2018, see<br>
<a href="http://isabelle.in.tum.de/website-Isabelle2018-RC0">http://isabelle.in.tum.de/website-Isabelle2018-RC0</a></p>
<p>Makarius</p>



<a name="294734394"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734394" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734394">(Aug 22 2022 at 17:28)</a>:</h4>
<p>From: Lars Hupel &lt;<a href="mailto:hupel@in.tum.de">hupel@in.tum.de</a>&gt;<br>
You obviously have to enter something in the second buffer to see <br>
something in the output. The output shows only the current state of <br>
where your cursor is.</p>



<a name="294734446"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734446" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734446">(Aug 22 2022 at 17:28)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Hi Lars,</p>
<p>I did that - ie, entering stuff in the second buffer, but no response</p>
<p>Jeremy</p>



<a name="294734456"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734456" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734456">(Aug 22 2022 at 17:28)</a>:</h4>
<p>From: Dominique Unruh &lt;<a href="mailto:unruh@ut.ee">unruh@ut.ee</a>&gt;<br>
Hi,</p>
<blockquote>
<p>Abs ("x", TFree ("'a", ["HOL.type"]), Bound 0)</p>
</blockquote>
<p>You will not get this from @{make_string}, only something similar looking<br>
but unparseable.<br>
@{make_string} gives you somewhat human readable output, for debugging<br>
(which, in case of term is relatively raw, I assume that is because it has<br>
to work on non-wellformed terms, too).<br>
So - independent of whether it is production-suitable or it - it does not<br>
seem to be what you are looking for.</p>
<p>If I understand right, what you want is something that converts a term into<br>
valid ML-code?<br>
You find this here: ML_Syntax.print_term</p>
<p>I think the reason why @{make_string} is not production-suitable (besides<br>
the fact that for terms, it is not very readable) is that it is a bit of a<br>
hack: It does not have an argument "context", so it has to guess which<br>
context is appropriate for the term at hand.</p>
<p>Best wishes,<br>
Dominique.</p>



<a name="294734475"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734475" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734475">(Aug 22 2022 at 17:28)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
This already summarizes the situation nicely: @{make_string} / @{print}<br>
is for tracing and debugging while doing Isabelle/ML development. The<br>
output is sometimes close to ML notation (e.g. term structure),<br>
sometimes close to regular output (e.g. typ). In some situations there<br>
might be no usable output at all: the exact side-conditions change over<br>
time as the Poly/ML compiler evolves.</p>
<p>Thus it is suitable (and very useful) for adhoc tests, but not suitable<br>
for another program reading the results. Even with perfect output, the<br>
build-in print_depth prevents this. (The print_depth is very important<br>
to avoid bombing the system when printing really big values.)</p>
<p>The default pretty printing with markup conforms to this overall idea of<br>
@{make_string} / @{print} as adhoc diagnostic output. That was the start<br>
of the thread: the &lt;markup&gt; that appears routinely when printing<br>
structured values.</p>
<p>Makarius</p>



<a name="294734523"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734523" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734523">(Aug 22 2022 at 17:28)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Hi Dominique,</p>
<p>No, I want exactly Abs ("x", TFree ("'a", ["HOL.type"]), Bound 0),<br>
and it's what I get in the case of a value of type MyTerm.term (which I <br>
use because the system doesn't know how to pretty print the type part of <br>
it, because it is of type MyTerm.typ)</p>
<p>And I don't want a context involved (at least, not unless I can get two <br>
contexts to co-exist together - which the latest messages in this thread <br>
suggest may be possible).  PolyML.makestring is of general <br>
applicability, far beyond situations where there is an Isabelle context.</p>
<p>Cheers,</p>
<p>Jeremy</p>



<a name="294734544"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734544" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734544">(Aug 22 2022 at 17:28)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Hi Makarius,</p>
<p>From the length of this email thread, and the absence in it of any <br>
information giving an answer as to how I should be doing the equivalent <br>
of PolyML.makestring, I infer that this function has been made <br>
unavailable with nothing to take its place.</p>
<p>Is this so?  And if so, I'm curious as to why it was removed?</p>
<p>Thanks</p>
<p>Jeremy</p>



<a name="294734676"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294734676" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294734676">(Aug 22 2022 at 17:29)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Hi Makarius,</p>
<p>OK, I've downloaded Isabelle 2018 RC0, and got your attached Scratch.thy <br>
to work (which was as follows)</p>
<p>theory Scratch<br>
   imports Pure<br>
begin</p>
<p>ML \&lt;open&gt;<br>
   val Main_thy = Thy_Info.get_theory "Main";</p>
<p>val ZF_thy = Thy_Info.get_theory "ZF";<br>
\&lt;close&gt;</p>
<p>end</p>
<p>and it still works when I substitute imports ZF for imports Pure.</p>
<p>So no doubt I could grab a goal from the middle of a ZF proof and create <br>
a HOL term/cterm out of it.</p>
<p>But how do I then start doing a proof in HOL involving that term?  The <br>
theory window won't let me put in another theory following the end of <br>
the first one, and it won't let me do<br>
theory Scratch<br>
   imports ZF Main<br>
and if I back up to the beginning and replace imports ZF by imports Main <br>
then it has forgotten the ML values which were declared.<br>
So how does one transfer ML values from a ZF proof to a proof in Main?</p>
<p>Plus, there is the additional problem that<br>
ML_prf {* @{Isar.goal} *} doesn't work (why?) and that<br>
although ML_val {* @{Isar.goal} *} works,<br>
ML_val {* ... *} seems to forget any ML value definitions anyway.<br>
So that seems like an additional impediment to the idea of transferring <br>
computed ML terms from a ZF proof to a HOL proof.</p>
<p>So, given that the problem is to take a goal from a ZF proof, compute a <br>
goal to be proved in HOL, and start a HOL proof with that new goal, how <br>
can I do that?</p>
<p>Cheers,</p>
<p>Jeremy</p>



<a name="294736297"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294736297" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294736297">(Aug 22 2022 at 17:38)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Hi,</p>
<p>I find that when I use @{make_string} to get a string from a value, it <br>
produces something which is reported simply as</p>
<p>val str = "&lt;markup&gt;": string,</p>
<p>its length (String.size) is something enormous, and when exploded into <br>
an enormous list of characters, seems to incorporate some sort of <br>
pretty-printing information.</p>
<p>How do I get it simply as a string?  There is a function writeln which <br>
will print it on the screen as a sensible string, but how do I get this <br>
string as an ML value?</p>
<p>thanks</p>
<p>Jeremy</p>



<a name="294736378"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294736378" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294736378">(Aug 22 2022 at 17:39)</a>:</h4>
<p>From: "Nagashima, Yutaka" &lt;<a href="mailto:Yutaka.Nagashima@uibk.ac.at">Yutaka.Nagashima@uibk.ac.at</a>&gt;<br>
Hi Jeremy,</p>
<p>Dose this function trm_to_string [1] do the job?</p>
<p>fun trm_to_string (ctxt:Proof.context) (trm:term) =  Syntax.string_of_term ctxt trm<br>
 |&gt; YXML.parse_body<br>
 |&gt; XML.content_of : string;</p>
<p>davidg's comment here [2] might be useful as well.</p>
<p>[1] <a href="https://github.com/data61/PSL/blob/master/PGT/PGT.ML#L23">https://github.com/data61/PSL/blob/master/PGT/PGT.ML#L23</a><br>
[2] <a href="https://stackoverflow.com/questions/26007442/how-do-i-convert-thm-conji-to-an-ascii-string-i-can-save-to-a-file">https://stackoverflow.com/questions/26007442/how-do-i-convert-thm-conji-to-an-ascii-string-i-can-save-to-a-file</a></p>
<p>Regards,<br>
Yutaka</p>



<a name="294736410"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294736410" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294736410">(Aug 22 2022 at 17:39)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
See also section 0.2.4 Printing ML values in the "implementation"<br>
manual, which is the first place to look for anything regarding<br>
Isabelle/ML tool development.</p>
<p>In particular it says:</p>
<p>This is occasionally useful for diagnostic or demonstration purposes.<br>
  Note that production-quality tools require proper user-level error<br>
  messages, avoiding raw ML values in the output.</p>
<p>In other words, you use @{make_string} or more conveniently @{print} for<br>
temporary output experiments, but use regular user-space print<br>
operations for real output. The latter depends on what types of values<br>
you want to print, and what is the purpose of it.</p>
<p>Makarius</p>



<a name="294736445"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294736445" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294736445">(Aug 22 2022 at 17:39)</a>:</h4>
<p>From: Dominique Unruh &lt;<a href="mailto:unruh@ut.ee">unruh@ut.ee</a>&gt;<br>
One more explanation to clarify why you see "&lt;markup&gt;" here.</p>
<p>@{make_string} produces a string containing special markup instructions<br>
(e.g., for supporting ctrl-click in jEdit, type-annotations when hovering,<br>
and many more things).<br>
And now the ML toplevel gives you the value of the ML-value "str".<br>
However, since ML-value are not necessarily strings, but complex values,<br>
those values are pretty printed.<br>
So, the ML-toplevel applies the equivalent to @{make_string} to the content<br>
of "str".<br>
And what you end up with is the result of the attempt to pretty print a<br>
string with markup (namely, @{make_string} (@{make_string} something)).</p>
<p>If you use, e.g., "tracing" or "warning" to output the result of<br>
@{make_string} instead, then you will get proper readable output.<br>
(And "tracing (@{make_string} (@{make_string} something))" will output<br>
"&lt;markup&gt;" no matter what 'something' is.)</p>
<p>Best wishes,<br>
Dominique.</p>



<a name="294736578"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294736578" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294736578">(Aug 22 2022 at 17:40)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Hi Yutaka,</p>
<p>Thanks, that helps wonderfully.</p>
<p>Your function trm_to_string of course only works for terms, but<br>
the following fixes the output of @{make_string}, exactly what I want</p>
<p>fun fix_markup str = str |&gt; YXML.parse_body |&gt; XML.content_of : string ;</p>
<p>Thanks again!</p>
<p>Jeremy</p>



<a name="294736595"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294736595" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294736595">(Aug 22 2022 at 17:40)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:Jeremy.Dawson@anu.edu.au">Jeremy.Dawson@anu.edu.au</a>&gt;<br>
Hi Makarius,</p>
<p>Thanks for the information that I shouldn't be using @{make_string}.<br>
This raises the obvious question of what I should be using.  Would it be <br>
possible for you to tell me that?  Ie, what is the equivalent in the<br>
managed ML environment called "Isabelle/ML" of the PolyML function<br>
PolyML.makestring?</p>
<p>Thanks</p>
<p>Jeremy</p>



<a name="294736636"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20make_string/near/294736636" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20make_string.html#294736636">(Aug 22 2022 at 17:40)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
There is none. For quick adhoc debugging and diagnistics, there is<br>
@{print} and @{make_string}. For production-quality output, you do it<br>
yourself specifically for your data types, potentially using existing<br>
operations like Syntax.pretty_term -- generally it is better to print<br>
Pretty.T than string.</p>
<p>Makarius</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>