<html>
<head><meta charset="utf-8"><title>[isabelle] more Isabelle2007 conversion pains · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20more.20Isabelle2007.20conversion.20pains.html">[isabelle] more Isabelle2007 conversion pains</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294061309"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20more%20Isabelle2007%20conversion%20pains/near/294061309" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20more.20Isabelle2007.20conversion.20pains.html#294061309">(Aug 18 2022 at 11:56)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:jeremy@rsise.anu.edu.au">jeremy@rsise.anu.edu.au</a>&gt;<br>
Stefan Berghofer wrote:<br>
Stefan,</p>
<p>thanks.  But I now find a similar problem: the theorems x.mono, x.unfold <br>
and x.defs<br>
seem to have disappeared.  Actually it seems the theorems x.mono, <br>
x.unfold already don't appear in Isabelle2005 for new-style theory <br>
files, but you could use an old-style theory file, or (sometimes) derive <br>
x.unfold from x.defs.</p>
<p>But in Isabelle2007 you can't use an old-style theory file and even <br>
x.defs doesn't seem to exist.  Where have all these theorems gone?</p>
<p>Regards,</p>
<p>Jeremy</p>



<a name="294061451"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20more%20Isabelle2007%20conversion%20pains/near/294061451" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20more.20Isabelle2007.20conversion.20pains.html#294061451">(Aug 18 2022 at 11:57)</a>:</h4>
<p>From: <a href="mailto:stefan.berghofer@in.tum.de">stefan.berghofer@in.tum.de</a><br>
Quoting Jeremy Dawson &lt;<a href="mailto:jeremy@rsise.anu.edu.au">jeremy@rsise.anu.edu.au</a>&gt;:</p>
<p>Dear Jeremy,</p>
<p>the problem with these rules is that they expose the internal representation<br>
of inductive sets or predicates, which violates the principle of information<br>
hiding. Since the internal representation has been changed recently, proofs<br>
using these rules would not have worked any longer anyway, so I decided to<br>
remove them. The 'official' way of proving something about an inductive<br>
definition is to use the introduction, induction and case analysis rules,<br>
and indeed all proofs using the x.unfold or x.defs rules can easily be<br>
rewritten to use these 'official' rules.</p>
<p>Greetings,<br>
Stefan</p>



<a name="294061502"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20more%20Isabelle2007%20conversion%20pains/near/294061502" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20more.20Isabelle2007.20conversion.20pains.html#294061502">(Aug 18 2022 at 11:57)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:jeremy@rsise.anu.edu.au">jeremy@rsise.anu.edu.au</a>&gt;<br>
<a href="mailto:berghofe@mailbroy.informatik.tu-muenchen.de">berghofe@mailbroy.informatik.tu-muenchen.de</a> wrote:<br>
Dear Stefan,</p>
<p>Thanks for your reply.</p>
<p>I don't understand what you say about "violates the principle of <br>
information<br>
hiding".  If anything provable using x.unfold or x.defs can be proved <br>
using the 'official' rules, then surely the 'official' rules contain (at <br>
least) the same information as  x.unfold or x.defs.</p>
<p>If I can prove x.unfold or x.defs using the 'official' rules, then whay <br>
can't they be included in the inductive set package as previously?</p>
<p>More importantly, may I suggest that it would be good policy on the part <br>
of the developers to ensure that new developments are made to be <br>
backward compatible where possible? </p>
<p>For about 3 years recently I worked on a particular project where they <br>
generally would use the latest development version of Isabelle.  It <br>
seems to me that during that time, about half my time on the project was <br>
spent doing useful work and about half was spent changing my work in <br>
response to changes in Isabelle. </p>
<p>Now I'm doing different work, with a mass of Isabelle theories which <br>
work for Isabelle2005.  If I don't adapt them to Isabelle 2007 (and I <br>
obviously have a strong incentive not to do so) it means that any <br>
further work I do is in Isabelle2005; this means that if someone else <br>
does similar things in Isabelle2007, neither of us can use each other's <br>
work.  This is not a good idea, but it is a natural consequence of the <br>
significant incompatibilities which have often been a consequence of <br>
recent developments in Isabelle.</p>
<p>Regards,</p>
<p>Jeremy Dawson</p>



<a name="294061606"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20more%20Isabelle2007%20conversion%20pains/near/294061606" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20more.20Isabelle2007.20conversion.20pains.html#294061606">(Aug 18 2022 at 11:58)</a>:</h4>
<p>From: Stefan Berghofer &lt;<a href="mailto:berghofe@in.tum.de">berghofe@in.tum.de</a>&gt;<br>
Jeremy Dawson wrote:</p>
<blockquote>
<p>I don't understand what you say about "violates the principle of information<br>
hiding".  If anything provable using x.unfold or x.defs can be proved <br>
using the 'official' rules, then surely the 'official' rules contain (at <br>
least) the same information as  x.unfold or x.defs.</p>
</blockquote>
<p>Dear Jeremy,</p>
<p>on Wikipedia (<a href="http://en.wikipedia.org/wiki/Information_hiding">http://en.wikipedia.org/wiki/Information_hiding</a>), I found the<br>
following definition of "information hiding":</p>
<p>The principle of information hiding is the hiding of design decisions<br>
   in a computer program that are most likely to change, thus protecting<br>
   other parts of the program from change if the design decision is changed.<br>
   The protection involves providing a stable interface which shields the<br>
   remainder of the program from the implementation (the details that are<br>
   most likely to change).</p>
<p>In the context of the inductive definition package, the "design decision"<br>
is the way how inductive sets (or predicates) are defined, and the "other<br>
parts of the program" that should be protected from change are the proofs<br>
about inductively defined sets. Moreover, the "stable interface" that we<br>
provide is the introduction, induction and case analysis rules.<br>
This also means that proofs relying on an inductive set being defined<br>
(or "implemented") in a particular way (such as proofs involving x.defs)<br>
will no longer work once the definition has changed.</p>
<p>In the old inductive definition package, an inductive set was defined by<br>
forming the least fixpoint of a function on the complete lattice of sets<br>
of n-tuples, whereas the new inductive command defines inductive predicates<br>
as a least fixpoint of a function on the complete lattice of n-ary predicates,<br>
and the inductive_set command is just a wrapper for the inductive command.<br>
For example, the definition of rtrancl in Isabelle2005 is</p>
<p>r^* == lfp (%S. {x. (EX a. x = (a, a)) |<br>
                       (EX a b c. x = (a, c) &amp; (a, b) : S &amp; (b, c) : r)})</p>
<p>whereas in Isabelle2007, it is</p>
<p>r^** == lfp (%p x1 x2. (EX a. x1 = a &amp; x2 = a) |<br>
                          (EX a b c. x1 = a &amp; x2 = c &amp; p a b &amp; r b c))<br>
   r^* == {(xa, x). (%x xa. (x, xa) : r)^** xa x}</p>
<blockquote>
<p>If I can prove x.unfold or x.defs using the 'official' rules, then whay <br>
can't they be included in the inductive set package as previously?</p>
<p>More importantly, may I suggest that it would be good policy on the part <br>
of the developers to ensure that new developments are made to be <br>
backward compatible where possible?</p>
</blockquote>
<p>We really tried very hard to ensure backward compatibility when introducing<br>
the new inductive definition package. In particular, we put a lot of work<br>
in the implementation of the inductive_set wrapper that allows most of the<br>
proofs using inductive sets to be ported to Isabelle2007 with a minimal<br>
amount of changes. However, the x.defs and x.unfold rules are really a bit<br>
obscure in my opinion, which is why they were not mentioned in the tutorial<br>
either. It therefore made no sense to me to write additional code for proving<br>
these obscure rules from the "official" ones, in particular because the few<br>
proofs in the Isabelle distributions that were using these rules could easily<br>
be adapted.<br>
For example, the proof of exec_mono in HOL/Induct/Com.thy in Isabelle2005<br>
looked as follows:</p>
<p>lemma exec_mono: "A&lt;=B ==&gt; exec(A) &lt;= exec(B)"<br>
   apply (unfold exec.defs )<br>
   apply (rule lfp_mono)<br>
   apply (assumption | rule basic_monos)+<br>
   done</p>
<p>In contrast, the Isabelle2007 version is</p>
<p>lemma exec_mono: "A&lt;=B ==&gt; exec(A) &lt;= exec(B)"<br>
   apply (rule subsetI)<br>
   apply (simp add: split_paired_all)<br>
   apply (erule exec.induct)<br>
   apply blast+<br>
   done</p>
<blockquote>
<p>For about 3 years recently I worked on a particular project where they <br>
generally would use the latest development version of Isabelle.  It <br>
seems to me that during that time, about half my time on the project was <br>
spent doing useful work and about half was spent changing my work in <br>
response to changes in Isabelle.</p>
</blockquote>
<p>I can understand your frustration, but with thousands of Isabelle theories<br>
out there, it is almost impossible to achieve that none of the changes we<br>
make affects any of these theories.<br>
A good way of ensuring that your theories will still work with newer versions<br>
of Isabelle is to submit them to the AFP. Once your theories are in the AFP,<br>
every developer who makes a change that breaks any of the theories in the AFP<br>
(or the Isabelle distribution) is responsible for fixing it, which is usually<br>
not too difficult, since the developer knows what kind of changes he has made.</p>
<p>Finally, let me assure you that I am happy to assist in porting any of your<br>
proofs about inductive definitions to Isabelle2007.</p>
<p>Regards,<br>
Stefan</p>



<a name="294061936"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20more%20Isabelle2007%20conversion%20pains/near/294061936" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20more.20Isabelle2007.20conversion.20pains.html#294061936">(Aug 18 2022 at 12:00)</a>:</h4>
<p>From: Jeremy Dawson &lt;<a href="mailto:jeremy@rsise.anu.edu.au">jeremy@rsise.anu.edu.au</a>&gt;<br>
Stefan Berghofer wrote:</p>
<blockquote>
<p>Jeremy Dawson wrote:</p>
<blockquote>
<p>I don't understand what you say about "violates the principle of <br>
information<br>
hiding".  If anything provable using x.unfold or x.defs can be proved <br>
using the 'official' rules, then surely the 'official' rules contain <br>
(at least) the same information as  x.unfold or x.defs.</p>
</blockquote>
<p>Dear Jeremy,</p>
<p>on Wikipedia (<a href="http://en.wikipedia.org/wiki/Information_hiding">http://en.wikipedia.org/wiki/Information_hiding</a>), I <br>
found the<br>
following definition of "information hiding":</p>
<p>The principle of information hiding is the hiding of design decisions<br>
  in a computer program that are most likely to change, thus protecting<br>
  other parts of the program from change if the design decision is <br>
changed.<br>
  The protection involves providing a stable interface which shields the<br>
  remainder of the program from the implementation (the details that are<br>
  most likely to change).</p>
<p>In the context of the inductive definition package, the "design decision"<br>
is the way how inductive sets (or predicates) are defined, and the "other<br>
parts of the program" that should be protected from change are the proofs<br>
about inductively defined sets. Moreover, the "stable interface" that we<br>
provide is the introduction, induction and case analysis rules.<br>
This also means that proofs relying on an inductive set being defined<br>
(or "implemented") in a particular way (such as proofs involving x.defs)<br>
will no longer work once the definition has changed.</p>
<p>In the old inductive definition package, an inductive set was defined by<br>
forming the least fixpoint of a function on the complete lattice of sets<br>
of n-tuples, whereas the new inductive command defines inductive <br>
predicates<br>
as a least fixpoint of a function on the complete lattice of n-ary <br>
predicates,<br>
and the inductive_set command is just a wrapper for the inductive <br>
command.<br>
For example, the definition of rtrancl in Isabelle2005 is</p>
<p>r^* == lfp (%S. {x. (EX a. x = (a, a)) |<br>
                      (EX a b c. x = (a, c) &amp; (a, b) : S &amp; (b, c) : r)})</p>
<p>Dear Stefan,</p>
</blockquote>
<p>I think there is some misunderstanding here.  I don't care how the <br>
inductive set is defined, logically, internally.  The point is, if I'm <br>
not mistaken, that the above equality is still true in Isabelle2007.  <br>
That is, the truth of this equality does not depend on the "design <br>
decision" of the way how inductive sets (or predicates) are defined.  <br>
You would provide a "stable interface" by continuing to make it available. </p>
<blockquote>
<p>whereas in Isabelle2007, it is</p>
<p>r^** == lfp (%p x1 x2. (EX a. x1 = a &amp; x2 = a) |<br>
                         (EX a b c. x1 = a &amp; x2 = c &amp; p a b &amp; r b c))<br>
  r^* == {(xa, x). (%x xa. (x, xa) : r)^** xa x}</p>
<blockquote>
<p>If I can prove x.unfold or x.defs using the 'official' rules, then <br>
whay can't they be included in the inductive set package as previously?</p>
<p>More importantly, may I suggest that it would be good policy on the <br>
part of the developers to ensure that new developments are made to be <br>
backward compatible where possible?</p>
</blockquote>
<p>We really tried very hard to ensure backward compatibility when <br>
introducing<br>
the new inductive definition package. In particular, we put a lot of work<br>
in the implementation of the inductive_set wrapper that allows most of <br>
the<br>
proofs using inductive sets to be ported to Isabelle2007 with a minimal<br>
amount of changes. However, the x.defs and x.unfold rules are really a <br>
bit<br>
obscure in my opinion, which is why they were not mentioned in the <br>
tutorial<br>
either.<br>
Well, they are mentioned in the HOL Logic document (including the <br>
version of 22 November 2007 (that is, I think, the one distributed with <br>
Isabelle 2007)</p>
<blockquote>
<p>For about 3 years recently I worked on a particular project where <br>
they generally would use the latest development version of Isabelle.  <br>
It seems to me that during that time, about half my time on the <br>
project was spent doing useful work and about half was spent changing <br>
my work in response to changes in Isabelle.<br>
I can understand your frustration, but with thousands of Isabelle <br>
theories<br>
out there, it is almost impossible to achieve that none of the changes we<br>
make affects any of these theories.<br>
A good way of ensuring that your theories will still work with newer <br>
versions<br>
of Isabelle is to submit them to the AFP. <br>
Well, I have a rather vague recollection of hearing that the AFP is only <br>
interested in proofs written in Isar.  Is that correct? <br>
Once your theories are in the AFP,<br>
every developer who makes a change that breaks any of the theories in <br>
the AFP<br>
(or the Isabelle distribution) is responsible for fixing it, which is <br>
usually<br>
not too difficult, since the developer knows what kind of changes he <br>
has made.</p>
</blockquote>
<p>Finally, let me assure you that I am happy to assist in porting any of <br>
your<br>
proofs about inductive definitions to Isabelle2007.</p>
<p>Well, thanks - there is also the question of whether it is worthwhile <br>
for anyone to bother with doing this, since I'm managing fine with <br>
Isabelle2005.  Maybe I'll email you separately on this.</p>
</blockquote>
<p>regards,</p>
<p>Jeremy Dawson</p>
<blockquote>
<p>Regards,<br>
Stefan<br>
</p>
</blockquote>



<a name="294061950"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20more%20Isabelle2007%20conversion%20pains/near/294061950" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20more.20Isabelle2007.20conversion.20pains.html#294061950">(Aug 18 2022 at 12:00)</a>:</h4>
<p>From: Tobias Nipkow &lt;<a href="mailto:nipkow@in.tum.de">nipkow@in.tum.de</a>&gt;</p>
<blockquote>
<p>Well, I have a rather vague recollection of hearing that the AFP is only <br>
interested in proofs written in Isar.  Is that correct?</p>
</blockquote>
<p>It does not say so anywhere. And some contributions are not in Isar. <br>
Although we do have a preference for Isar and may ask for revisions of <br>
particularly brittle theories before adding them.</p>
<p>Tobias</p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>