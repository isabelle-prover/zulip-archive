<html>
<head><meta charset="utf-8"><title>[isabelle] proving the substitution lemma · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20proving.20the.20substitution.20lemma.html">[isabelle] proving the substitution lemma</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294052834"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20proving%20the%20substitution%20lemma/near/294052834" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20proving.20the.20substitution.20lemma.html#294052834">(Aug 18 2022 at 10:58)</a>:</h4>
<p>From: "Moez A. Abdel-Gawad" &lt;<a href="mailto:moez@cs.rice.edu">moez@cs.rice.edu</a>&gt;<br>
Hi,</p>
<p>I'm new to Isabelle and Coq.</p>
<p>However, my own personal attempt to prove the substitution<br>
lemma in Coq - with very minor resort to the variable con-<br>
vention and alpha-conversion equivalence - seemed to tell<br>
that the substitution lemma may not be the best example to<br>
use for <em>motivating</em> the need for the 'isabelle-nominal'<br>
package and project, as is done for example on this web-<br>
page <a href="http://isabelle.in.tum.de/nominal/main.html">http://isabelle.in.tum.de/nominal/main.html</a></p>
<p>While I do not discount the possibility of the package<br>
being useful - and even necessary - for other proofs, my<br>
experiment gave me the feeling that a much simpler app-<br>
roach may be possible (may be even as simple as adding a<br>
new tactic), which may work in fact for many similar pr-<br>
oofs as well, and - if not - is very likely to work at<br>
least for the purpose of proving the substitution lemma.</p>
<p>Your thoughts?</p>
<p>-Moez</p>
<p>PS: I was wondering if there is a Coq package and/or<br>
project similar to the 'isabelle-nominal' ones.</p>
<p><a href="mailto:moez@rice.edu">moez@rice.edu</a> | <a href="http://www.cs.rice.edu/~moez">www.cs.rice.edu/~moez</a> | (713) 392-2844</p>
<p>======================================================</p>
<p>"And you have been given of knowledge but little"<br>
  -Al-Qur'an [17:85]</p>
<p>"Our knowledge can only be finite, while our ignorance<br>
  must necessarily be infinite."   -Karl Popper</p>



<a name="294052844"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20proving%20the%20substitution%20lemma/near/294052844" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20proving.20the.20substitution.20lemma.html#294052844">(Aug 18 2022 at 10:58)</a>:</h4>
<p>From: Brian Aydemir &lt;<a href="mailto:baydemir@cis.upenn.edu">baydemir@cis.upenn.edu</a>&gt;<br>
Hi Moez,</p>
<p>If you're interested in what is possible with a "lightweight"<br>
approach in this area, you may want to take at the following<br>
paper.</p>
<p>[1] Engineering Formal Metatheory, by Brian Aydemir, Arthur<br>
Charguéraud, Benjamin C. Pierce, Randy Pollack, and Stephanie<br>
Weirich.  Available from<br>
<a href="http://www.cis.upenn.edu/~baydemir/papers.shtml#AydCha+07a">http://www.cis.upenn.edu/~baydemir/papers.shtml#AydCha+07a</a></p>
<p>This is a paper that will appear at POPL 2008 that focuses on a<br>
particular style of locally nameless representation for<br>
formalizing languages with binding.  (Coq code for the paper is<br>
available through the link above.)  The style is lightweight in<br>
that one could use it in a variety of proof assistants, e.g., Coq<br>
and Isabelle, without any additional infrastructure.  The paper<br>
also makes some comparisons with other first-order approaches,<br>
including the Isabelle/Nominal package.</p>
<p>If you're interested in nominal techniques in Coq, I can mention<br>
two other works (which Christian Urban has already pointed out<br>
on the Isabelle lists).</p>
<p>[2] Nominal Reasoning Techniques in Coq, by Brian Aydemir, Aaron<br>
Bohannon, and Stephanie Weirich.  Available from<br>
<a href="http://www.cis.upenn.edu/~baydemir/nominal-reasoning-in-coq.html">http://www.cis.upenn.edu/~baydemir/nominal-reasoning-in-coq.html</a></p>
<p>This is not really a package like the Isabelle/Nominal package but<br>
more a demonstration of what nominal reasoning might look like in<br>
Coq.  In order to be practically useable, a similar amount of<br>
infrastructure would be required in Coq as in Isabelle.</p>
<p>[3] A locally nameless solution to the POPLmark challenge, by<br>
Xavier Leroy.  Available from<br>
<a href="http://cristal.inria.fr/~xleroy/POPLmark/locally-nameless/">http://cristal.inria.fr/~xleroy/POPLmark/locally-nameless/</a></p>
<p>Leroy uses some nominal techniques in a locally-nameless setting<br>
in Coq.</p>
<p>Cheers,<br>
Brian</p>



<a name="294052887"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20proving%20the%20substitution%20lemma/near/294052887" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20proving.20the.20substitution.20lemma.html#294052887">(Aug 18 2022 at 10:58)</a>:</h4>
<p>From: "Moez A. Abdel-Gawad" &lt;<a href="mailto:moez@cs.rice.edu">moez@cs.rice.edu</a>&gt;<br>
Hi,</p>
<p>Here's the story behind my substitution lemma proof development. I<br>
apologize if it is a bit long, and informal.  It was in fact the<br>
original email I intended to send in place of my earlier email, but<br>
then I realized it - being long and informal - may not be approp-<br>
riate as an introductory email. I apologize also for any possible<br>
inconsistencies that may have crept-in due to the heavy editing,<br>
and re-editing, I made to this message.</p>
<p>Also, attached is my Coq proof script. It is almost-complete (except<br>
for the small part that needed the freshness assertion, of course),<br>
but it is very likely a very "inefficient" proof script, since I am<br>
new to Coq. I am, however, currently not interested in "optimizing"<br>
it. My goal when I developed this proof was to learn the basics of<br>
Coq, and to get as much as possible of the proof done with whatever<br>
tactics are currently available in Coq (i.e., without resorting to<br>
any sort of explicit use of nominality). The proof script is only my<br>
second real - ie, non-toy-like - proof in Coq (after proving that<br>
forall n: nat, n &lt; 2^n).</p>
<p>In my quest to learn Coq, I started playing with a personal imple-<br>
mentation of lambda calculus.  My initial goal was to prove the<br>
substitution lemma, i.e., if x &lt;&gt; y and x \nin FV(L) then<br>
M[x:=N][y:=L] = [y:=L][x:=N[y:=L]].</p>
<p>Using induction on M, doing the 'App' induction case in Coq was the<br>
most trivial case. As hypothesis for my proof, I had assumed - as<br>
Barendregt explicitly does - that x &lt;&gt; y and x \nin FV(L). Not pay-<br>
ing much attention, I did not - initially - assume freshness, nor<br>
did I assume the  equivalence of lambda terms modulo alpha-conver-<br>
sion. Thus, for the 'Var' and 'Abs' induction cases, everything<br>
went well, by reasoning - using cases (on the boolean value<br>
'string_dec') - whether the free variable (in case of 'Var') or the<br>
abstraction variable (in case of 'Abs') is equal to or different<br>
from other variables in the proof (i.e., x and y. The name chosen<br>
by Coq for that auxiliary variable, in both cases, was 's', because<br>
Coq chooses names based on the type, which is 'string' in both<br>
cases), on until one tiny sub-subcase of the 'Abs' induction case<br>
(also sometimes called the lambda-case), where I had 's' assumed to<br>
be not equal to x, but equal to y.  After doing all possible simpli-<br>
fications, unfoldings and foldings, the goal I had to prove became:</p>
<p>Abs s (subs x M N) = Abs s (subs x M (subs y N L))</p>
<p>Having gone thru all earlier subcases successfully (i.e., in parti-<br>
cular, without resorting to any additional external hypothesis), I<br>
was wondering why is that sub-subcase in particular hard to prove,<br>
and what exactly was going on.  Not deterred by the failure of this<br>
sub-subcase, I was able to do the remaining other parts of the pr-<br>
oof (using Coq's "n:" notation) without any problems... except for<br>
this little impeding sub-subcase.</p>
<p>I then searched online for 'proving substitution lemma'. That is<br>
when I came to know about the 'Nominal Isabelle' project, after<br>
coming across the following webpage:</p>
<p><a href="http://isabelle.in.tum.de/nominal/main.html">http://isabelle.in.tum.de/nominal/main.html</a></p>
<p>The webpage explained what's going on very nicely, and reminded me<br>
of the possible need for Barendregt's variable convention, as well<br>
as the possible need for the equivalence of lambda terms modulo<br>
alpha-conversion. It was also nice to know that there is an ongoing<br>
project that is trying to solve this deficiency (which is a defic-<br>
iency that exists, it seems to me, in most semi-automated theorem<br>
provers in general, not only in Isabelle and Coq).</p>
<p>However, based on my experience with trying to prove the substitu-<br>
tion lemma, it seems I may disagree with some implication in the<br>
webpage above.</p>
<p>In particular, for purposes of the 'substitution lemma' only, I do<br>
not believe - again, based on my experience - that the 'full power'<br>
of the freshness assumption (i.e., the variable convention) and the<br>
'alpha-equivalence' is actually needed to prove it. Also, the "ins-<br>
tance of freshness" needed seems to me to be much simpler (and gen-<br>
erally less powerful) than the one the 'nominal-isabelle' package<br>
would provide (which, of course, may be useful for other more intr-<br>
icate lemmas).</p>
<p>That's because for proving the substitution lemma all that I needed<br>
was just to somehow be able to assert the freshness of 's', not in<br>
all cases and subcases, but only <em>at that particular sub-subcase</em> I<br>
mentioned above. I did not need the freshness of 's' in any other<br>
parts of my proof. (I even only needed an assertion that 's' is not<br>
equal to y, i.e., that it is different from one variable only, not<br>
necessarily that it is different from <em>all</em> other variables (in the<br>
current environment)).</p>
<p>That observation led me to two conclusions.</p>
<p>First, I would think thus that something simpler than the new nom-<br>
inal-isabelle constructs (nominal_datatype, nominal_induction,<br>
avoiding, fresh_fact, forget, etc) maybe more intuitive, and also<br>
more straight-forward to add (to Isabelle, or other semi-automated<br>
theorem provers). In my proof development I wished there was just<br>
something available as "simple" as a tactic that would allow stat-<br>
ing that 's is fresh' (having a syntax like 'fresh s'), to assert<br>
that s, as a variable name (string), is different from all other<br>
variable names in the current environment (x and y, as well as<br>
other possibly ones inside M and N and L, that are irrelevant to<br>
the proof and are thus not explicitly mentioned in the lemma's<br>
statement, even though all I actually needed is for s to be diffe-<br>
rent from y).</p>
<p>Next, I also concluded that the substitution lemma, even though<br>
well-known to many PL researchers, may NOT be a very convincing<br>
example to cite (eg, on the webpage) for developing the new 'nom-<br>
inal-isabelle' package. That is NOT to say the package itself is<br>
useless, but only to say that probably other examples can do a<br>
better job in motivating the whole new package (a new package<br>
suggests that users have to learn a whole new bag of "tricks and<br>
tools" to do proofs, and thus need a very strong motivation for<br>
that). In my view, using 'nominal-isabelle' to prove the substi-<br>
tution lemma is like using a big hammer to pound a hair pin, when<br>
it - the lemma - can, in my view, be proved using much simpler<br>
means (e.g., a simple new tactic).</p>
<p>Your insights and constructive feedback is more than welcome, and<br>
would be deeply appreciated.</p>
<p>-Moez</p>
<p>PS1: Further analyzing the subgoal written above, I realized that<br>
the freshness of 's' is actually not an absolute necessity in that<br>
sub-subcase, but only if I had initially assumed (added to my hypo-<br>
thesis) that y is not a free variable in N (y \nin FV(N)). If that<br>
was assumed then the third 'subs' (substitution) in the subgoal<br>
above would be an identity operation over N, and the RHS would be<br>
indeed equal to the LHS, and I'd be done. However, in the bigger<br>
context, that second solution to my sub-subcase actually makes the<br>
substitution lemma's statement very trivial and shallow.</p>
<p>PS2: I am annoyed by receiving some of the latest emails three,<br>
and even sometime four, times. What even aggravates the situation<br>
is that there are also delayed deliveries (multiple copies of the<br>
same email, thus, do not come in as a chunk, at one time). I am<br>
wondering if there is some means to get rid of this duplicity, and<br>
of the delayed deliveries, coalescing multiple copies of the same<br>
emails into one email, and/or having them be delivered almost at<br>
the same time. I did not check the mailing list archives to see if<br>
this issue was discussed before, but I believe it would be apprec-<br>
iated by most of subscribers to the mailing lists if it is true<br>
(and my guess is that it is) that the vast majority of subscribers<br>
to one list are subscribers to the other (among Coq and Isabelle),<br>
and that subscribers of the nominal-isabelle mailing list are very<br>
likely to be a proper subset of the subscribers to the isabelle<br>
mailing list (probably some cooperation at the level of the list<br>
admins is needed?).</p>
<p><a href="mailto:moez@rice.edu">moez@rice.edu</a> | <a href="http://www.cs.rice.edu/~moez">www.cs.rice.edu/~moez</a> | (713) 392-2844</p>
<p>======================================================</p>
<p>"And you have been given of knowledge but little"<br>
  -Al-Qur'an [17:85]</p>
<p>"Our knowledge can only be finite, while our ignorance<br>
  must necessarily be infinite."   -Karl Popper<br>
<a href="/user_uploads/14278/Q4vsMyWzGNegSVcXDaZEjiuT/LC.v">LC.v</a></p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>