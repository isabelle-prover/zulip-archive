<html>
<head><meta charset="utf-8"><title>[isabelle] size for records · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20size.20for.20records.html">[isabelle] size for records</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294714882"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20size%20for%20records/near/294714882" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20size.20for.20records.html#294714882">(Aug 22 2022 at 15:50)</a>:</h4>
<p>From: Lars Hupel &lt;<a href="mailto:hupel@in.tum.de">hupel@in.tum.de</a>&gt;<br>
Dear list,</p>
<p>I'm having a lot of troubles with records right now. They're not BNFs,<br>
but luckily there's the "copy_bnf" command. Unfortunately, it seems this<br>
doesn't generate a size function (at least I don't see it). Is it<br>
possible to transfer the size function from the original BNF? Because<br>
without size function, nested recursion through the record becomes tricky.</p>
<p>Cheers<br>
Lars</p>



<a name="294714963"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20size%20for%20records/near/294714963" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20size.20for.20records.html#294714963">(Aug 22 2022 at 15:51)</a>:</h4>
<p>From: Lars Hupel &lt;<a href="mailto:hupel@in.tum.de">hupel@in.tum.de</a>&gt;<br>
Hi Jasmin,</p>
<blockquote>
<p>To quote from the docs: "For each datatype t, the size plugin generates a generic size function t.size_t as well as a specific instance size :: t ⇒ nat belonging to the size type class."</p>
<p>The key word is "datatype". In general, a BNF is not a datatype.</p>
</blockquote>
<p>yeah, right. I guess the general problem is that records are<br>
insufficiently like datatypes. But rebasing their construction on top of<br>
new datatypes would be a significant effort.</p>
<blockquote>
<p>I would presume that this should be an easy task for the Lifting package. Otherwise, you should be able to define the size function manually without too much effort.</p>
</blockquote>
<p>Sure, and I just went down that route (manually). But I thought I might<br>
ask if someone has done anything similar :-)</p>
<p>Cheers<br>
Lars</p>



<a name="294715001"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20size%20for%20records/near/294715001" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20size.20for.20records.html#294715001">(Aug 22 2022 at 15:51)</a>:</h4>
<p>From: Dmitriy Traytel &lt;<a href="mailto:traytel@inf.ethz.ch">traytel@inf.ethz.ch</a>&gt;<br>
Hi Lars,</p>
<blockquote>
<p>On 11 Aug 2017, at 14:15, Lars Hupel &lt;<a href="mailto:hupel@in.tum.de">hupel@in.tum.de</a>&gt; wrote:</p>
<blockquote>
<p>To quote from the docs: "For each datatype t, the size plugin generates a generic size function t.size_t as well as a specific instance size :: t ⇒ nat belonging to the size type class."</p>
<p>The key word is "datatype". In general, a BNF is not a datatype.</p>
</blockquote>
<p>yeah, right. I guess the general problem is that records are<br>
insufficiently like datatypes. But rebasing their construction on top of<br>
new datatypes would be a significant effort.</p>
</blockquote>
<p>not only that: the record construction is much more efficient than the datatype one. So, basing record on datatype would make the seL4 people with their huge records quite unhappy.</p>
<blockquote>
<blockquote>
<p>I would presume that this should be an easy task for the Lifting package. Otherwise, you should be able to define the size function manually without too much effort.</p>
</blockquote>
<p>Sure, and I just went down that route (manually). But I thought I might<br>
ask if someone has done anything similar :-)</p>
</blockquote>
<p>Ideally, there should be a plugin infrastructure and a size plugin for records. (Oh, and record should be localized. :) ) But since the workaround of a manual definition is so easy, it is hard to find a volunteer to do this.</p>
<p>Dmitriy</p>



<a name="294715013"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20size%20for%20records/near/294715013" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20size.20for.20records.html#294715013">(Aug 22 2022 at 15:51)</a>:</h4>
<p>From: Lars Hupel &lt;<a href="mailto:hupel@in.tum.de">hupel@in.tum.de</a>&gt;</p>
<blockquote>
<p>not only that: the record construction is much more efficient than the datatype one. So, basing record on datatype would make the seL4 people with their huge records quite unhappy.</p>
</blockquote>
<p>I'm aware of that, but didn't know that the difference is that large.</p>
<blockquote>
<p>Ideally, there should be a plugin infrastructure and a size plugin for records. (Oh, and record should be localized. :) ) But since the workaround of a manual definition is so easy, it is hard to find a volunteer to do this.</p>
</blockquote>
<p>A good starting point could be to decouple record syntax from record<br>
definitions. There's no reason why</p>
<p>datatype foo = Bar (x: nat) (y: nat)</p>
<p>couldn't be treated as a record, including update functions. I'm already<br>
working on a plugin that produces "*_update" functions (this allows for<br>
record update syntax, albeit not construction syntax). The next step<br>
would be to patch Lem to use this instead of records.</p>
<p>Cheers<br>
Lars</p>



<hr><p>Last updated: Nov 01 2025 at 16:22 UTC</p>
</html>