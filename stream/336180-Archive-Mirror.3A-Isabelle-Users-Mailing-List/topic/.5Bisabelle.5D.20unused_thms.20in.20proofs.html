<html>
<head><meta charset="utf-8"><title>[isabelle] unused_thms in proofs · Archive Mirror: Isabelle Users Mailing List · Zulip Chat Archive</title></head>
<h2>Stream: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/index.html">Archive Mirror: Isabelle Users Mailing List</a></h2>
<h3>Topic: <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20unused_thms.20in.20proofs.html">[isabelle] unused_thms in proofs</a></h3>

<hr>

<base href="https://isabelle.zulipchat.com/">

<head><link href="http://isabelle.systems/zulip-archive/style.css" rel="stylesheet"></head>

<a name="294671274"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20unused_thms%20in%20proofs/near/294671274" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20unused_thms.20in.20proofs.html#294671274">(Aug 22 2022 at 13:04)</a>:</h4>
<p>From: Christian Sternagel &lt;<a href="mailto:c.sternagel@gmail.com">c.sternagel@gmail.com</a>&gt;<br>
This would definitely be useful! +1 - chris</p>



<a name="294671303"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20unused_thms%20in%20proofs/near/294671303" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20unused_thms.20in.20proofs.html#294671303">(Aug 22 2022 at 13:04)</a>:</h4>
<p>From: Jasmin Blanchette &lt;<a href="mailto:jasmin.blanchette@inria.fr">jasmin.blanchette@inria.fr</a>&gt;<br>
A student came to me and asked for a 6-week internship project (starting in August). Perhaps this could be something suitable for him? (But if anybody else wants to implement this, go ahead and don't wait for us.)</p>
<p>Jasmin</p>



<a name="294673275"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20unused_thms%20in%20proofs/near/294673275" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20unused_thms.20in.20proofs.html#294673275">(Aug 22 2022 at 13:14)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Dear all,</p>
<p>I have written several Isar-style proofs of lemmas each of which is quite long (&gt;1000 <br>
lines). As the proofs have evolved over time, I am not sure any more that I use every <br>
intermediate result to prove the result. Is there any convenient way to find out whether <br>
there are some unused intermediate steps?</p>
<p>I tried to use unused_thms before the final qed, but this gives me only top-level <br>
theorems, not intermediate (named) facts stated with "have". I could imagine a diagnostic <br>
command that one issues before the qed and it lists all the unused intermediate facts <br>
since the last "next" or "proof" command on the same level. If this is not available, <br>
could this be implemented and how hard would it be? Would anyone else find such a <br>
functionality useful?</p>
<p>Cheers,<br>
Andreas</p>



<a name="294673295"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20unused_thms%20in%20proofs/near/294673295" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20unused_thms.20in.20proofs.html#294673295">(Aug 22 2022 at 13:14)</a>:</h4>
<p>From: Tobias Nipkow &lt;<a href="mailto:nipkow@in.tum.de">nipkow@in.tum.de</a>&gt;<br>
On 29/04/2016 10:39, Andreas Lochbihler wrote:</p>
<blockquote>
<p>Dear all,</p>
<p>I have written several Isar-style proofs of lemmas each of which is quite long<br>
(&gt;1000 lines). As the proofs have evolved over time, I am not sure any more that<br>
I use every intermediate result to prove the result. Is there any convenient way<br>
to find out whether there are some unused intermediate steps?</p>
<p>I tried to use unused_thms before the final qed, but this gives me only<br>
top-level theorems, not intermediate (named) facts stated with "have". I could<br>
imagine a diagnostic command that one issues before the qed and it lists all the<br>
unused intermediate facts since the last "next" or "proof" command on the same<br>
level. If this is not available, could this be implemented and how hard would it<br>
be? Would anyone else find such a functionality useful?</p>
</blockquote>
<p>I would. Especially if it is integrated with the interface and marks such unused <br>
local facts (on demand).</p>
<p>Tobias</p>
<blockquote>
<p>Cheers,<br>
Andreas</p>
<p><a href="/user_uploads/14278/baWGx8TC0G6dcPYJKv426Acp/smime.p7s">smime.p7s</a></p>
</blockquote>



<a name="294673308"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20unused_thms%20in%20proofs/near/294673308" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20unused_thms.20in.20proofs.html#294673308">(Aug 22 2022 at 13:14)</a>:</h4>
<p>From: Manuel Eberl &lt;<a href="mailto:eberlm@in.tum.de">eberlm@in.tum.de</a>&gt;<br>
Absolutely.</p>



<a name="294673319"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20unused_thms%20in%20proofs/near/294673319" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20unused_thms.20in.20proofs.html#294673319">(Aug 22 2022 at 13:14)</a>:</h4>
<p>From: Gerwin Klein &lt;<a href="mailto:Gerwin.Klein@nicta.com.au">Gerwin.Klein@nicta.com.au</a>&gt;<br>
+1!</p>
<p>Gerwin</p>
<hr>
<p>The information in this e-mail may be confidential and subject to legal professional privilege and/or copyright. National ICT Australia Limited accepts no liability for any damage caused by this email or its attachments.</p>



<a name="294673338"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20unused_thms%20in%20proofs/near/294673338" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20unused_thms.20in.20proofs.html#294673338">(Aug 22 2022 at 13:14)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
On Tue, 3 May 2016, Thomas Sewell wrote:</p>
<blockquote>
<p>Well, they could be optionally given dummy names. That would break the <br>
usual rule that names in the PThms (other than Pure.blah) look up facts, <br>
but would allow you to check whether they were really used.</p>
</blockquote>
<p>The names in PThm nodes are not even right for global facts. It is an old <br>
confusion that is still there until today.</p>
<blockquote>
<p>The other option would be to check whether they were syntactically used, <br>
of course.</p>
</blockquote>
<p>That is the dual approach to inspecting the internal inferences: looking <br>
at the source with its PIDE markup. Recently I have already added some <br>
rendering for the use of formal entities, visually connecting definitions <br>
and references of items. This includes facts, but there are more ways to <br>
refer to facts than for most other items:</p>
<p>(1) via literal fact references (backquotes or cartouche notation)</p>
<p>(2) via declarations that put them into the context for tools to pick<br>
     them up later, e.g. the "simp" attribute and "simp" proof method</p>
<p>(1) might soon be included in the PIDE markup model: it is syntactically <br>
relatively clear. (2) is more difficult, because the absence or presence <br>
of a "simp del" declaration can affect the proof. It might be better just <br>
to test-run the proof document, and see if it still works with or without <br>
certain elements.</p>
<p>Makarius</p>



<a name="294674020"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20unused_thms%20in%20proofs/near/294674020" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20unused_thms.20in.20proofs.html#294674020">(Aug 22 2022 at 13:18)</a>:</h4>
<p>From: Andreas Lochbihler &lt;<a href="mailto:andreas.lochbihler@inf.ethz.ch">andreas.lochbihler@inf.ethz.ch</a>&gt;<br>
Hi Jasmin,</p>
<p>That's a good idea. I don't know whether the current implementation of reasoning actually <br>
supports such a command. Makarius might know better. But if it does, I guess that this <br>
could be a reasonably-sized project for a student.</p>
<p>Andreas</p>



<a name="294674215"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20unused_thms%20in%20proofs/near/294674215" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20unused_thms.20in.20proofs.html#294674215">(Aug 22 2022 at 13:19)</a>:</h4>
<p>From: Jasmin Blanchette &lt;<a href="mailto:jasmin.blanchette@inria.fr">jasmin.blanchette@inria.fr</a>&gt;<br>
Hi Andreas,</p>
<blockquote>
<p>That's a good idea. I don't know whether the current implementation of reasoning actually supports such a command. Makarius might know better. But if it does, I guess that this could be a reasonably-sized project for a student.</p>
</blockquote>
<p>For Sledgehammer (esp. MaSh), we had to do some fishing around in the local context to retrieve facts in Isar proofs. I am under the impression that all the information we would need is stored in some form.</p>
<p>Jasmin</p>



<a name="294674435"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20unused_thms%20in%20proofs/near/294674435" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20unused_thms.20in.20proofs.html#294674435">(Aug 22 2022 at 13:20)</a>:</h4>
<p>From: Makarius &lt;<a href="mailto:makarius@sketis.net">makarius@sketis.net</a>&gt;<br>
I think the main challenge are such questions about internal naming of <br>
derivations (the infamous PThm nodes). I've never fully understood the <br>
scheme introduced by Larry Paulson and reformed by Stefan Berghofer, more <br>
than 15 years ago. Nonetheless, I've tinkered with it out of necessity, to <br>
make parallel proof checking work.</p>
<p>It is definitely worth revisiting all that, and unifying it with the <br>
treatment in Sledgehammer.</p>
<p>Afterwards, a student project to wrap it up as PIDE print function etc. <br>
would be rather trivial. Still worth to learn how that works, but from 6 <br>
weeks only 1 is probably required.</p>
<p>Makarius</p>



<a name="294674797"></a>
<h4><a href="https://isabelle.zulipchat.com/#narrow/stream/336180-Archive%20Mirror%3A%20Isabelle%20Users%20Mailing%20List/topic/%5Bisabelle%5D%20unused_thms%20in%20proofs/near/294674797" class="zl"><img src="http://isabelle.systems/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Email Gateway <a href="http://isabelle.systems/zulip-archive/stream/336180-Archive-Mirror.3A-Isabelle-Users-Mailing-List/topic/.5Bisabelle.5D.20unused_thms.20in.20proofs.html#294674797">(Aug 22 2022 at 13:22)</a>:</h4>
<p>From: Thomas Sewell &lt;<a href="mailto:thomas.sewell@nicta.com.au">thomas.sewell@nicta.com.au</a>&gt;<br>
I had a brief look at this a while ago. My understanding is that a<br>
(small) change might be needed.</p>
<p>OK, so, PThms track the derivation steps of thms. There are special<br>
nodes which mark where thms (and their derivations) are named. This is<br>
called through Thm.name_derivation, and via Global_Theory.name_thm.</p>
<p>Point is, globally-anonymous facts, such as steps in proofs, don't have<br>
named derivations (currently). So proof term summaries will see them as<br>
just part of the proof of the facts they result in.</p>
<p>Well, they could be optionally given dummy names. That would break the<br>
usual rule that names in the PThms (other than Pure.blah) look up facts,<br>
but would allow you to check whether they were really used.</p>
<p>The other option would be to check whether they were syntactically used,<br>
of course.</p>
<p>Cheers,<br>
     Thomas.</p>
<hr>
<p>The information in this e-mail may be confidential and subject to legal professional privilege and/or copyright. National ICT Australia Limited accepts no liability for any damage caused by this email or its attachments.</p>



<hr><p>Last updated: Feb 22 2026 at 20:30 UTC</p>
</html>