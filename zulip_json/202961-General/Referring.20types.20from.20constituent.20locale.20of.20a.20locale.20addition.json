[
    {
        "content": "<p>I have the following example:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"k\">locale</span><span class=\"w\"> </span><span class=\"n\">simple</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kp\">fixes</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"'A\"</span>\n\n<span class=\"k\">locale</span><span class=\"w\"> </span><span class=\"n\">complex</span><span class=\"w\"> </span><span class=\"o\">=</span>\n<span class=\"n\">Alpha</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">simple</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">Beta</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">simple</span><span class=\"w\"> </span><span class=\"n\">B</span>\n<span class=\"kp\">for</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">+</span>\n<span class=\"kp\">fixes</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"Alpha.a ⇒ Beta.a\"</span>\n</code></pre></div>\n<p>How can I refer to Alpha's 'A type? In a more detailed example I could use the generated type variables after the for clause, but I think in general it is not recommended to rely on generated variable or type names.</p>\n<p>For the above I get this error message:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"n\">Undefined</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">name</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"Alpha.a\"</span><span class=\"n\">⌂</span>\n<span class=\"n\">Failed</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">parse</span><span class=\"w\"> </span><span class=\"n\">type</span>\n</code></pre></div>\n<p>I tried with <code>Alpha.'A</code> but it also did not work.</p>",
        "id": 498380075,
        "sender_full_name": "Gergely Buday",
        "timestamp": 1738946095
    },
    {
        "content": "<p>I would go for</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"k\">locale</span><span class=\"w\"> </span><span class=\"n\">complex</span><span class=\"w\"> </span><span class=\"o\">=</span>\n<span class=\"n\">Alpha</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">simple</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">Beta</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">simple</span><span class=\"w\"> </span><span class=\"n\">B</span>\n<span class=\"kp\">for</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"'A\"</span><span class=\"w\"> </span><span class=\"kp\">and</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"'B\"</span><span class=\"w\"> </span><span class=\"o\">+</span>\n<span class=\"kp\">fixes</span><span class=\"w\"> </span><span class=\"n\">f</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"'A ⇒ 'B\"</span>\n</code></pre></div>",
        "id": 498381579,
        "sender_full_name": "Mathias Fleury",
        "timestamp": 1738946558
    },
    {
        "content": "<p>Follow-up question: in the body of the <code>complex</code> locale, how could I refer to <code>'A</code> and <code>'B</code>? ChatGPT says this is not possible, I am not sure if it is right saying so.</p>",
        "id": 498721883,
        "sender_full_name": "Gergely Buday",
        "timestamp": 1739183213
    },
    {
        "content": "<p>As the body I mean the part after <code>begin</code></p>",
        "id": 498768713,
        "sender_full_name": "Gergely Buday",
        "timestamp": 1739195932
    },
    {
        "content": "<p>Interestingly, I can use it in a definition:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"k\">locale</span><span class=\"w\"> </span><span class=\"n\">simple</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kp\">fixes</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"'A\"</span>\n\n<span class=\"k\">locale</span><span class=\"w\"> </span><span class=\"n\">complex</span><span class=\"w\"> </span><span class=\"o\">=</span>\n<span class=\"n\">Alpha</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">simple</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">Beta</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">simple</span><span class=\"w\"> </span><span class=\"n\">B</span>\n<span class=\"kp\">for</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"'A\"</span><span class=\"w\"> </span><span class=\"kp\">and</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"'B\"</span>\n<span class=\"k\">begin</span>\n\n<span class=\"k\">definition</span><span class=\"w\"> </span><span class=\"n\">foo</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"'A\"</span>\n<span class=\"w\">  </span><span class=\"kp\">where</span><span class=\"w\"> </span><span class=\"s\">\"foo = A\"</span>\n\n<span class=\"kt\">value</span><span class=\"w\"> </span><span class=\"s\">\"foo\"</span>\n</code></pre></div>\n<p>and <code>value</code> correctly reports <code>'A</code> as the type of <code>foo</code>, but I cannot fix the following in the body:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"k\">datatype</span><span class=\"w\"> </span><span class=\"n\">A2</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"n\">Original</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">the</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n n-Type\">'A</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>Isabelle tells me that <code>'A</code> is a type variable, not a type that I could use in a datatype definition:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"n\">Extra</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">variables</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">right</span><span class=\"o\">-</span><span class=\"n\">hand</span><span class=\"w\"> </span><span class=\"n\">side</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"'A\"</span>\n</code></pre></div>\n<p>How could I refer to locale <code>Alpha</code>'s <code>'A</code> type variable for my datatype?</p>\n<p>If I try give <code>'A</code> as a type variable:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"k\">datatype</span><span class=\"w\"> </span><span class=\"n n-Type\">'A</span><span class=\"w\"> </span><span class=\"n\">A2</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Foo</span><span class=\"w\"> </span><span class=\"n\">string</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"n\">Original</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">the</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n n-Type\">'A</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>then I get this error message:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"n\">Locally</span><span class=\"w\"> </span><span class=\"n\">fixed</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"n\">argument</span><span class=\"w\"> </span><span class=\"s\">\"'A\"</span><span class=\"w\"> </span><span class=\"kp\">in</span><span class=\"w\"> </span><span class=\"k\">datatype</span><span class=\"w\"> </span><span class=\"kn\">specification</span>\n</code></pre></div>\n<p>I'm confused then, what \"'A\" is.</p>",
        "id": 498780377,
        "sender_full_name": "Gergely Buday",
        "timestamp": 1739198708
    },
    {
        "content": "<p>ANSWER:</p>\n<p><a href=\"https://stackoverflow.com/questions/16556633/what-kind-of-type-definitions-are-legal-in-local-contexts\">https://stackoverflow.com/questions/16556633/what-kind-of-type-definitions-are-legal-in-local-contexts</a></p>\n<p>says that I should define my datatype outside of locales</p>",
        "id": 498808007,
        "sender_full_name": "Gergely Buday",
        "timestamp": 1739205107
    }
]