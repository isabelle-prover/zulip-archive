[
    {
        "content": "<p>Hi all,</p>\n<p>I am trying to find an automatic tools that helps you to copy-and-paste proofs found by sledgehammer into their invocation sites. Here's a screenshot for a typical workload:<br>\n<a href=\"/user_uploads/14278/smMa1oMv72CVFRKbRnn2EQEU/Screenshot-2024-05-01-at-22.16.14.png\">Screenshot-2024-05-01-at-22.16.14.png</a><br>\nI am dealing with Isar proofs that are composed of hundreds of subgoals like these, most of which can be solved by sledgehammer with a one-liner proof. The problem is whether this copy-paste job can be totally automated so that I can focus only on the goals that needs human intervention. I am hoping there's some existing tools for this, but any suggestions/sources of information for implementing one would also be greatly appreciated.</p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/14278/smMa1oMv72CVFRKbRnn2EQEU/Screenshot-2024-05-01-at-22.16.14.png\" title=\"Screenshot-2024-05-01-at-22.16.14.png\"><img src=\"/user_uploads/14278/smMa1oMv72CVFRKbRnn2EQEU/Screenshot-2024-05-01-at-22.16.14.png\"></a></div><p>Best wishes,<br>\nChengsong</p>",
        "id": 436575085,
        "sender_full_name": "Chengsong Tan",
        "timestamp": 1714598566
    },
    {
        "content": "<p>I don't know of an existing tool doing this.  To build this, you'd have to define a <code>Scala.Fun</code> in Isabelle/Scala to perform the document edit, and then write your custom s/h command that invokes this function from the Isabelle/ML process (using the <code>\\&lt;^scala&gt;</code> antiquotation) whenever a proof is found.</p>",
        "id": 436628131,
        "sender_full_name": "Fabian Huch",
        "timestamp": 1714632994
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"348400\">Fabian Huch</span> <a href=\"#narrow/stream/202961-General/topic/tools.20to.20automatically.20adopt.20sledgehammer.20proofs.20into.20theory/near/436628131\">said</a>:</p>\n<blockquote>\n<p>I don't know of an existing tool doing this.  To build this, you'd have to define a <code>Scala.Fun</code> in Isabelle/Scala to perform the document edit, and then write your custom s/h command that invokes this function from the Isabelle/ML process (using the <code>\\&lt;^scala&gt;</code> antiquotation) whenever a proof is found.</p>\n</blockquote>\n<p>Hi Fabian, </p>\n<p>Thanks a lot for the reply!</p>\n<p>If you have used Isabelle/Scala, could you give me some advice on setting things up and experiment with the tool? Right now I am trying to follow the very short tutorial on <br>\n<code>https://dominique-unruh.github.io/scala-isabelle/setup.html</code>, however I got the error </p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"n\">error</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"n\">bad</span><span class=\"w\"> </span><span class=\"kp\">constant</span><span class=\"w\"> </span><span class=\"n\">pool</span><span class=\"w\"> </span><span class=\"n\">index</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">0</span><span class=\"w\"> </span><span class=\"n\">at</span><span class=\"w\"> </span><span class=\"n\">pos</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">48461</span>\n<span class=\"w\">     </span><span class=\"n\">while</span><span class=\"w\"> </span><span class=\"n\">compiling</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">&lt;no</span><span class=\"w\"> </span><span class=\"kp\">file</span><span class=\"n\">&gt;</span>\n<span class=\"w\">        </span><span class=\"n\">during</span><span class=\"w\"> </span><span class=\"n\">phase</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">globalPhase</span><span class=\"o\">=</span><span class=\"n\">&lt;no</span><span class=\"w\"> </span><span class=\"n\">phase&gt;</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">enteringPhase</span><span class=\"o\">=</span><span class=\"n\">&lt;some</span><span class=\"w\"> </span><span class=\"n\">phase&gt;</span>\n<span class=\"w\">     </span><span class=\"n\">library</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"n\">2.13.7</span>\n<span class=\"w\">    </span><span class=\"n\">compiler</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"n\">2.13.7</span>\n<span class=\"w\">  </span><span class=\"n\">reconstructed</span><span class=\"w\"> </span><span class=\"n\">args</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">d</span><span class=\"w\"> </span><span class=\"n\">/var/folders/gp/sn8kdjh95bv3fq5315dv1bww0000gp/T/scalascript10668209491638361976.tmp</span>\n\n<span class=\"w\">  </span><span class=\"n\">last</span><span class=\"w\"> </span><span class=\"n\">tree</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">typer</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">EmptyTree</span>\n<span class=\"w\">       </span><span class=\"n\">tree</span><span class=\"w\"> </span><span class=\"n\">position</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">&lt;unknown&gt;</span>\n<span class=\"w\">            </span><span class=\"n\">tree</span><span class=\"w\"> </span><span class=\"n\">tpe</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">&lt;notype&gt;</span>\n<span class=\"w\">              </span><span class=\"n\">symbol</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">null</span>\n<span class=\"w\">           </span><span class=\"n\">call</span><span class=\"w\"> </span><span class=\"n\">site</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">&lt;none&gt;</span><span class=\"w\"> </span><span class=\"kp\">in</span><span class=\"w\"> </span><span class=\"n\">&lt;none&gt;</span>\n</code></pre></div>\n<p>by running <code>scala Example.scala</code> in <code>https://dominique-unruh.github.io/scala-isabelle/example.html</code>.</p>",
        "id": 436731185,
        "sender_full_name": "Chengsong Tan",
        "timestamp": 1714666978
    },
    {
        "content": "<p>I have no Idea about <code>scala-isabelle</code>, I was referring to Isabelle/Scala, which is the Isabelle suprocess within the system. Isabelle/Scala is extensively documented in the system manual, Chapter 5.</p>",
        "id": 436732495,
        "sender_full_name": "Fabian Huch",
        "timestamp": 1714667424
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"348400\">Fabian Huch</span> <a href=\"#narrow/stream/202961-General/topic/tools.20to.20automatically.20adopt.20sledgehammer.20proofs.20into.20theory/near/436628131\">said</a>:</p>\n<blockquote>\n<p>I don't know of an existing tool doing this.  To build this, you'd have to define a <code>Scala.Fun</code> in Isabelle/Scala to perform the document edit, and then write your custom s/h command that invokes this function from the Isabelle/ML process (using the <code>\\&lt;^scala&gt;</code> antiquotation) whenever a proof is found.</p>\n</blockquote>\n<p>Hi Fabian, </p>\n<p>Do you have any example projects with similar workflows (e.g. defining new Scala.Fun functions, writing custom s/h commands etc.)? I have gone through the system manual chapter 5 and it's a bit difficult to see how such a tool is made without an example.</p>\n<p>Thanks a lot,<br>\nChengsong</p>",
        "id": 436747286,
        "sender_full_name": "Chengsong Tan",
        "timestamp": 1714672547
    },
    {
        "content": "<p>The Isabelle codebase is the best place to look for examples. For the scala part, I would recommend using an IDE to find the implementors of the abstract <code>Scala.Fun</code> class in <code>src/Pure/System/scala.scala</code> (use <code>isabelle scala_project</code> to generate a version of the sources that an IDE can understand); a few examples are already in the <code>Scala</code> module itself.</p>\n<p>As for Isabelle/ML, there is the excellent Isabelle/ML Cookbook  as a general resource, and for the s/h command I would simply copy from the existing sledgehammer command and adapt.</p>",
        "id": 436833845,
        "sender_full_name": "Fabian Huch",
        "timestamp": 1714722208
    },
    {
        "content": "<p>All of this involves a fair bit of work and getting used to the Isabelle code-base, though.</p>",
        "id": 436834301,
        "sender_full_name": "Fabian Huch",
        "timestamp": 1714722391
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"348400\">Fabian Huch</span> <a href=\"#narrow/stream/202961-General/topic/tools.20to.20automatically.20adopt.20sledgehammer.20proofs.20into.20theory/near/436833845\">said</a>:</p>\n<blockquote>\n<p>The Isabelle codebase is the best place to look for examples. For the scala part, I would recommend using an IDE to find the implementors of the abstract <code>Scala.Fun</code> class in <code>src/Pure/System/scala.scala</code> (use <code>isabelle scala_project</code> to generate a version of the sources that an IDE can understand); a few examples are already in the <code>Scala</code> module itself.</p>\n<p>As for Isabelle/ML, there is the excellent Isabelle/ML Cookbook  as a general resource, and for the s/h command I would simply copy from the existing sledgehammer command and adapt.</p>\n</blockquote>\n<p>So how do I generate a \"hello world\" project that can invoke in some theory context s/h using some Scala code? I have run the command <code>isabelle scala_project</code> in a different folder than <code>src/Pure/System/scala.scala</code>.  I assume that has created a project template. But how to fill in the <code>hello world</code> bits in that project? Once I fill in, what tool do I run to compile and execute it, maybe <code>sbt</code>?</p>",
        "id": 436890599,
        "sender_full_name": "Chengsong Tan",
        "timestamp": 1714745035
    },
    {
        "content": "<p>Have a look into the system manual, especially Chapter 5.2 and 5.4 (an example module is also provided in the distribution). There is a hello world example of how to call your Scala function from within ML. </p>\n<p>The <code>scala_project</code> tool merely creates a copy of your Isabelle sources. I would recommend running it with the 'symlink' option so changes get reflected back into the actual sources (see the description of that tool, either in the manual or with <code>isabelle scala_project -?</code>.</p>\n<p>Generally, the workflow is that you change your sources and run Isabelle. The tool to run compile and execute it is Isabelle. When you change sources and start Isabelle, it does all of that.</p>",
        "id": 436901122,
        "sender_full_name": "Fabian Huch",
        "timestamp": 1714748157
    }
]