[
    {
        "content": "<p>Hi,<br>\ni started Isabelle/vscode on windows by starting the cygwin terminal and typing</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"n\">isabelle</span><span class=\"w\"> </span><span class=\"n\">vscode</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">HOL</span>\n</code></pre></div>\n<p>However it seems it cant load correctly because of a path issue:<br>\n<a href=\"/user_uploads/14278/PR8Q6tHinc3Thmzr3DRc7QJj/vscodium.png\">vscodium.png</a><br>\ni get </p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/14278/PR8Q6tHinc3Thmzr3DRc7QJj/vscodium.png\" title=\"vscodium.png\"><img data-original-dimensions=\"3785x2147\" src=\"/user_uploads/thumbnail/14278/PR8Q6tHinc3Thmzr3DRc7QJj/vscodium.png/840x560.webp\"></a></div><div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"o\">[</span><span class=\"n\">Info</span><span class=\"w\">  </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">18</span><span class=\"o\">:</span><span class=\"n\">33</span><span class=\"o\">:</span><span class=\"n\">01</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Welcome</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">Isabelle/HOL</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Isabelle2024</span><span class=\"o\">)</span>\n<span class=\"n\">***</span><span class=\"w\"> </span><span class=\"n\">Consumer</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"isabelle.vscode.Dynamic_Output\"</span>\n<span class=\"n\">***</span><span class=\"w\"> </span><span class=\"n\">Illegal</span><span class=\"w\"> </span><span class=\"n\">character</span><span class=\"w\"> </span><span class=\"s\">\":\"</span><span class=\"w\"> </span><span class=\"kp\">in</span><span class=\"w\"> </span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"n\">element</span><span class=\"w\"> </span><span class=\"s\">\"C:\\Isabelle2024\\src\\HOL\\Nat.thy\"</span>\n<span class=\"n\">***</span><span class=\"w\"> </span><span class=\"n\">The</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">above</span><span class=\"w\"> </span><span class=\"n\">occurred</span><span class=\"w\"> </span><span class=\"kp\">in</span><span class=\"w\"> </span><span class=\"s\">\"C:\\Isabelle2024\\src\\HOL\\Nat.thy\"</span>\n</code></pre></div>\n<p>while the <em>ISABELLE:OUTPUT</em> stays empty.</p>",
        "id": 477485150,
        "sender_full_name": "Moritz R",
        "timestamp": 1729183550
    },
    {
        "content": "<p>FIX:<br>\nInside an Isabelle installation, you'll find a <code>bin/isabelle</code> binary. This binary can launch various Isabelle tools, including <code>bin/isabelle vscode</code> and <code>bin/isabelle jedit</code>. The former will install a separate <strong>custom patched VSCodium</strong> (separate from your normal VSCode install and unfortunately somewhat outdated). Beware that there used to be an Isabelle VSCode extension that I believe is still listed in the extension store. It is deprecated and will not work. If you plan to use Isabelle/VSCode, I'd recommend using it with Thomas Lindaes changes which aren't in a release yet. So to get his changes (and a needed fix for windows), you'll first need to grab the development version of Isabelle:</p>\n<ol>\n<li>Clone the <a href=\"https://isabelle-dev.sketis.net/source/isabelle/\">Isabelle Mercurial Repository</a>: <code>hg clone https://isabelle-dev.sketis.net/source/isabelle/</code></li>\n</ol>\n<p>There is also a <a href=\"https://github.com/isabelle-prover/mirror-isabelle\">GitHub mirror</a> if you prefer to use git (although it might lag behind a little <code>git clone https://github.com/isabelle-prover/mirror-isabelle.git</code>).</p>\n<ol start=\"2\">\n<li>\n<p>Navigate into the cloned repo (i'll refer to the folder containing the <code>src</code> folder as the <code>isabelle</code> folder (if you used git, this folder will be called <code>mirror-isabelle</code>)): <code>cd isabelle</code></p>\n</li>\n<li>\n<p>from a normal install, copy the <code>contrib</code> folder and the <code>Cygwin-Terminal.bat</code> into the <code>isabelle</code> folder.</p>\n</li>\n<li>\n<p>(Optional) Add a unique Isabelle identifier to keep it separate from other Isabelle instances on the system: <code>echo \"isabelle-language-server\" &gt;&gt; ./etc/ISABELLE_IDENTIFIER</code></p>\n</li>\n<li>\n<p><strong>Windows error FIX:</strong> Edit the two following files. (Neccessary at this moment, else you will get this error:</p>\n</li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"w\">    </span><span class=\"o\">[</span><span class=\"n\">Info</span><span class=\"w\">  </span><span class=\"o\">-</span><span class=\"w\"> </span><span class=\"n\">18</span><span class=\"o\">:</span><span class=\"n\">33</span><span class=\"o\">:</span><span class=\"n\">01</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"n\">Welcome</span><span class=\"w\"> </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"n\">Isabelle/HOL</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Isabelle2024</span><span class=\"o\">)</span>\n\n<span class=\"w\">    </span><span class=\"n\">***</span><span class=\"w\"> </span><span class=\"n\">Consumer</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"isabelle.vscode.Dynamic_Output\"</span>\n\n<span class=\"w\">    </span><span class=\"n\">***</span><span class=\"w\"> </span><span class=\"n\">Illegal</span><span class=\"w\"> </span><span class=\"n\">character</span><span class=\"w\"> </span><span class=\"s\">\":\"</span><span class=\"w\"> </span><span class=\"kp\">in</span><span class=\"w\"> </span><span class=\"n\">path</span><span class=\"w\"> </span><span class=\"n\">element</span><span class=\"w\"> </span><span class=\"s\">\"C:\\Isabelle2024\\src\\HOL\\Nat.thy\"</span>\n\n<span class=\"w\">    </span><span class=\"n\">***</span><span class=\"w\"> </span><span class=\"n\">The</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">(</span><span class=\"n\">s</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">above</span><span class=\"w\"> </span><span class=\"n\">occurred</span><span class=\"w\"> </span><span class=\"kp\">in</span><span class=\"w\"> </span><span class=\"s\">\"C:\\Isabelle2024\\src\\HOL\\Nat.thy\"</span>\n</code></pre></div>\n<p>)</p>\n<p>I cannot guarantee that this works, but it seems to be doing fine. Im not sure why these checks are there.</p>\n<p>We need to remove <code>:</code> and <code>\\\\</code> from the <code>illegal char</code> sets in <code>src/Pure/General/path.ML</code> and <code>src/Pure/General/path.scala</code>.</p>\n<p>The <code>path.ML</code> should be changed from</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"n\">illegal_char</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"s\">\"/\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"\\\\\", \"</span><span class=\"n\">$\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\":\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"\\\"\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"'\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"&lt;\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"&gt;\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"|\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"?\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"*\"</span><span class=\"o\">]</span><span class=\"n\">;</span>\n</code></pre></div>\n<p>to</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"n\">illegal_char</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"s\">\"/\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"$\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"\\\"\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"'\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"&lt;\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"&gt;\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"|\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"?\"</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"s\">\"*\"</span><span class=\"o\">]</span><span class=\"n\">;</span>\n</code></pre></div>\n<p>and the <code>path.scala</code> from</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"n\">private</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"n\">illegal_char</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"/\\\\$:\\\"'&lt;&gt;|?*\"</span>\n</code></pre></div>\n<p>to</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"n\">private</span><span class=\"w\"> </span><span class=\"n\">val</span><span class=\"w\"> </span><span class=\"n\">illegal_char</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"/$\\\"'&lt;&gt;|?*\"</span>\n</code></pre></div>\n<ol start=\"6\">\n<li>\n<p>Start the <code>Cygwin-Terminal.bat</code> (and execute the following commands in this terminal).</p>\n</li>\n<li>\n<p>Initialize Isabelle: <code>./Admin/init</code> (requires internet access as it downloads external dependencies, like the aforementioned custom patched VSCodium)</p>\n</li>\n</ol>\n<p>It's probably also a good idea to run the following command. This will actually happen automatically if you open a theory file, but it takes a long time with no feedback: <code>./bin/isabelle build -b HOL</code></p>\n<p>You'll also find similar instructions in the <a href=\"https://github.com/Treeniks/isabelle-lsp.nvim/blob/master/README.md\"><code>isabelle-lsp.nvim</code> repo's README</a>.</p>\n<ol start=\"8\">\n<li>You can now start Isabelle vscode from the Cygwin terminal through</li>\n</ol>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"n\">isabelle</span><span class=\"w\"> </span><span class=\"n\">vscode</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">HOL</span>\n</code></pre></div>\n<p>if you want to change the print mode (e.g. to <code>brackets</code>)it needs to be passed in the command line (changing it in the vscode extension settings doesnt do anything at this moment) so start it with</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"n\">isabelle</span><span class=\"w\"> </span><span class=\"n\">vscode</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">HOL</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"n\">brackets</span>\n</code></pre></div>",
        "id": 479337635,
        "sender_full_name": "Moritz R",
        "timestamp": 1730140375
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"768294\">Moritz R</span> <a href=\"#narrow/channel/238552-Beginner-Questions/topic/Colon.20illegal.20in.20Path.20on.20Windows.20with.20vscodium/near/479337635\">said</a>:</p>\n<blockquote>\n<p>I cannot guarantee that this works, but it seems to be doing fine. Im not sure why these checks are there.</p>\n</blockquote>\n<p>Maybe <span class=\"user-mention\" data-user-id=\"348400\">@Fabian Huch</span> knows why</p>",
        "id": 479413113,
        "sender_full_name": "Kevin Kappelmann",
        "timestamp": 1730185705
    },
    {
        "content": "<p>The checks for illegal characters seem to be targeted at only allowing linux/cygwin paths (/home/user/ or /cygdrive/c/) and disallowing Microsoft paths</p>",
        "id": 479419479,
        "sender_full_name": "Mathias Fleury",
        "timestamp": 1730188665
    },
    {
        "content": "<p>the real question is why is the path normalization not done before starting Isabelle</p>",
        "id": 479419598,
        "sender_full_name": "Mathias Fleury",
        "timestamp": 1730188699
    },
    {
        "content": "<p>I know from porting the \"theory panel\" to VSCode that you really should not play with this part of the code or you might end-up with Isabelle believing that you have two theories open with the same name and a different path.</p>",
        "id": 479419932,
        "sender_full_name": "Mathias Fleury",
        "timestamp": 1730188819
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"233154\">Kevin Kappelmann</span> <a href=\"#narrow/channel/238552-Beginner-Questions/topic/Colon.20illegal.20in.20Path.20on.20Windows.20with.20vscodium/near/479413113\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"768294\">Moritz R</span> <a href=\"#narrow/channel/238552-Beginner-Questions/topic/Colon.20illegal.20in.20Path.20on.20Windows.20with.20vscodium/near/479337635\">said</a>:</p>\n<blockquote>\n<p>I cannot guarantee that this works, but it seems to be doing fine. Im not sure why these checks are there.</p>\n</blockquote>\n<p>Maybe <span class=\"user-mention silent\" data-user-id=\"348400\">Fabian Huch</span> knows why</p>\n</blockquote>\n<p>The concept of an Isabelle Path abstracts away from file-system paths, which have different rules on different platforms. Your change is sure to break many things in unexpected ways.</p>\n<p>As for the actual problem (with Isabelle2024), be sure to report it on the isabelle-users mailing list, which is the appropriate place for it.</p>",
        "id": 479429940,
        "sender_full_name": "Fabian Huch",
        "timestamp": 1730192323
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"233198\">Mathias Fleury</span> <a href=\"#narrow/channel/238552-Beginner-Questions/topic/Colon.20illegal.20in.20Path.20on.20Windows.20with.20vscodium/near/479419479\">said</a>:</p>\n<blockquote>\n<p>The checks for illegal characters seem to be targeted at only allowing linux/cygwin paths (/home/user/ or /cygdrive/c/) and disallowing Microsoft paths</p>\n</blockquote>\n<p>It has nothing to do with that: It is the representation of a logical path, not a file-system path (for those, we use java.io.File). For instance, Isabelle paths can have environment variables as path elements, which would start iwth a <code>$</code>.</p>",
        "id": 479430615,
        "sender_full_name": "Fabian Huch",
        "timestamp": 1730192531
    },
    {
        "content": "<p>Well this is fun, now i get Java.lang.OutOfMemoryErrors even when using Jedit <span aria-label=\"octopus\" class=\"emoji emoji-1f419\" role=\"img\" title=\"octopus\">:octopus:</span></p>",
        "id": 480322944,
        "sender_full_name": "Moritz R",
        "timestamp": 1730653645
    },
    {
        "content": "<p>But that isnt caused by my modifications. Just use sledgehammer for a while and it will do funny crashes</p>",
        "id": 480342746,
        "sender_full_name": "Moritz R",
        "timestamp": 1730672214
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"768294\">Moritz R</span> <a href=\"#narrow/channel/238552-Beginner-Questions/topic/Colon.20illegal.20in.20Path.20on.20Windows.20with.20vscodium/near/480342746\">said</a>:</p>\n<blockquote>\n<p>But that isnt caused by my modifications. Just use sledgehammer for a while and it will do funny crashes</p>\n</blockquote>\n<p>pretty sure that been an issue for some time. there is a similar zulip thread with the same problem</p>",
        "id": 480350401,
        "sender_full_name": "irvin",
        "timestamp": 1730680203
    }
]