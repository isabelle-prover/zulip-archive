[
    {
        "content": "<p>Say I'm working with a locale representing groups:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"k\">locale</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"w\"> </span><span class=\"o\">=</span>\n<span class=\"w\">   </span><span class=\"kp\">fixes</span>\n<span class=\"w\">      </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"n n-Type\">'a</span>\n<span class=\"w\">      </span><span class=\"n\">mult</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"n n-Type\">'a</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"n\">&gt;</span><span class=\"w\"> </span><span class=\"n n-Type\">'a</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"n\">&gt;</span><span class=\"w\"> </span><span class=\"n n-Type\">'a</span>\n<span class=\"w\">   </span><span class=\"kp\">assumes</span>\n<span class=\"w\">      </span><span class=\"ow\">...</span>\n</code></pre></div>\n<p>Suppose furthermore that I want to think about the automorphism group of a given group, so I define something like this:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"k\">definition</span>\n<span class=\"w\">   </span><span class=\"n\">set_of_automorphisms</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"('a =&gt; 'a) set\"</span>\n<span class=\"w\">   </span><span class=\"kp\">where</span><span class=\"w\"> </span><span class=\"ow\">...</span>\n</code></pre></div>\n<p>Now I'd like to say that the automorphisms of a group themselves form a group under composition. It seems like I should be doing this by declaring some kind of sublocale or interpretation, but I haven't been able to determine from the examples I've found online whether this makes sense or not and how I would go about doing it if it does.</p>",
        "id": 426984299,
        "sender_full_name": "James Hanson",
        "timestamp": 1710644821
    },
    {
        "content": "<p>You mean something like that:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"k\">locale</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"w\"> </span><span class=\"o\">=</span>\n<span class=\"w\">   </span><span class=\"kp\">fixes</span>\n<span class=\"w\">      </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"'a set\"</span><span class=\"w\"> </span><span class=\"kp\">and</span>\n<span class=\"w\">      </span><span class=\"n\">mult</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"'a =&gt; 'a =&gt; 'a\"</span>\n\n<span class=\"k\">context</span><span class=\"w\"> </span><span class=\"n\">group</span>\n<span class=\"k\">begin</span>\n<span class=\"k\">definition</span>\n<span class=\"w\">   </span><span class=\"n\">set_of_automorphisms</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"('a =&gt; 'a) set\"</span>\n<span class=\"w\">   </span><span class=\"kp\">where</span>\n<span class=\"w\">   </span><span class=\"s\">\"set_of_automorphisms = undefined\"</span>\n\n<span class=\"kn\">interpretation</span><span class=\"w\"> </span><span class=\"n\">automorphism</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"w\"> </span><span class=\"kp\">where</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">set_of_automorphisms</span><span class=\"w\"> </span><span class=\"kp\">and</span><span class=\"w\"> </span><span class=\"n\">mult</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"(o)\"</span>\n<span class=\"w\">  </span><span class=\"k\">done</span>\n\n<span class=\"kt\">term</span><span class=\"w\"> </span><span class=\"n\">automorphism.set_of_automorphisms</span>\n\n<span class=\"k\">end</span>\n</code></pre></div>",
        "id": 427035162,
        "sender_full_name": "Mathias Fleury",
        "timestamp": 1710659068
    },
    {
        "content": "<p>main issue is that interpretation do not live outside of the context</p>",
        "id": 427035243,
        "sender_full_name": "Mathias Fleury",
        "timestamp": 1710659090
    },
    {
        "content": "<p>(sublocale do not work, because it creates a cycle)</p>",
        "id": 427037035,
        "sender_full_name": "Mathias Fleury",
        "timestamp": 1710659615
    },
    {
        "content": "<p>Is there a difference between these?</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"k\">definition</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kp\">in</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"o\">)</span>\n<span class=\"w\">   </span><span class=\"n\">set_of_automorphisms</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"('a =&gt; 'a) set\"</span>\n<span class=\"w\">   </span><span class=\"kp\">where</span><span class=\"w\"> </span><span class=\"s\">\"set_of_automorphisms = undefined\"</span>\n</code></pre></div>\n<p>vs.</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"k\">context</span><span class=\"w\"> </span><span class=\"n\">group</span>\n<span class=\"k\">begin</span>\n\n<span class=\"k\">definition</span>\n<span class=\"w\">   </span><span class=\"n\">set_of_automorphisms</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"('a =&gt; 'a) set\"</span>\n<span class=\"w\">   </span><span class=\"kp\">where</span><span class=\"w\"> </span><span class=\"s\">\"set_of_automorphisms = undefined\"</span>\n\n<span class=\"k\">end</span>\n</code></pre></div>",
        "id": 427154698,
        "sender_full_name": "James Hanson",
        "timestamp": 1710691501
    },
    {
        "content": "<p>I think the answer is no, but it also seems like there's no syntax of the form:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"kn\">interpretation</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kp\">in</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">automorphism</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"w\"> </span><span class=\"kp\">where</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">set_of_automorphisms</span><span class=\"w\"> </span><span class=\"kp\">and</span><span class=\"w\"> </span><span class=\"n\">mult</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"(o)\"</span>\n</code></pre></div>",
        "id": 427155207,
        "sender_full_name": "James Hanson",
        "timestamp": 1710691628
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"688391\">James Hanson</span> <a href=\"#narrow/stream/238552-Beginner-Questions/topic/How.20to.20structure.20sublocales.20for.20'derived'.20objects.3F/near/427154698\">said</a>:</p>\n<blockquote>\n<p>Is there a difference between these?</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"k\">definition</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kp\">in</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"o\">)</span>\n<span class=\"w\">   </span><span class=\"n\">set_of_automorphisms</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"('a =&gt; 'a) set\"</span>\n<span class=\"w\">   </span><span class=\"kp\">where</span><span class=\"w\"> </span><span class=\"s\">\"set_of_automorphisms = undefined\"</span>\n</code></pre></div>\n<p>vs.</p>\n<p><div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"k\">context</span><span class=\"w\"> </span><span class=\"n\">group</span>\n<span class=\"k\">begin</span>\n\n<span class=\"k\">definition</span>\n<span class=\"w\">   </span><span class=\"n\">set_of_automorphisms</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"('a =&gt; 'a) set\"</span>\n<span class=\"w\">   </span><span class=\"kp\">where</span><span class=\"w\"> </span><span class=\"s\">\"set_of_automorphisms = undefined\"</span>\n\n<span class=\"k\">end</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>no difference</p>",
        "id": 427156738,
        "sender_full_name": "Mathias Fleury",
        "timestamp": 1710692029
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"688391\">James Hanson</span> <a href=\"#narrow/stream/238552-Beginner-Questions/topic/How.20to.20structure.20sublocales.20for.20'derived'.20objects.3F/near/427155207\">said</a>:</p>\n<blockquote>\n<p>I think the answer is no, but it also seems like there's no syntax of the form:</p>\n<p><div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"kn\">interpretation</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"kp\">in</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">automorphism</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"w\"> </span><span class=\"kp\">where</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">set_of_automorphisms</span><span class=\"w\"> </span><span class=\"kp\">and</span><span class=\"w\"> </span><span class=\"n\">mult</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"(o)\"</span>\n</code></pre></div><br>\n</p>\n</blockquote>\n<p>would not make sense, because the interpretation would not live long enough to be useful. Try this:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"k\">locale</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"w\"> </span><span class=\"o\">=</span>\n<span class=\"w\">   </span><span class=\"kp\">fixes</span>\n<span class=\"w\">      </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"'a set\"</span><span class=\"w\"> </span><span class=\"kp\">and</span>\n<span class=\"w\">      </span><span class=\"n\">mult</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"'a =&gt; 'a =&gt; 'a\"</span>\n\n<span class=\"k\">context</span><span class=\"w\"> </span><span class=\"n\">group</span>\n<span class=\"k\">begin</span>\n<span class=\"k\">definition</span>\n<span class=\"w\">   </span><span class=\"n\">set_of_automorphisms</span><span class=\"w\"> </span><span class=\"o\">::</span><span class=\"w\"> </span><span class=\"s\">\"('a =&gt; 'a) set\"</span>\n<span class=\"w\">   </span><span class=\"kp\">where</span>\n<span class=\"w\">   </span><span class=\"s\">\"set_of_automorphisms = undefined\"</span>\n\n<span class=\"kn\">interpretation</span><span class=\"w\"> </span><span class=\"n\">automorphism</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">group</span><span class=\"w\"> </span><span class=\"kp\">where</span><span class=\"w\"> </span><span class=\"n\">G</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">set_of_automorphisms</span><span class=\"w\"> </span><span class=\"kp\">and</span><span class=\"w\"> </span><span class=\"n\">mult</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"(o)\"</span>\n<span class=\"w\">  </span><span class=\"k\">done</span>\n\n<span class=\"kt\">term</span><span class=\"w\"> </span><span class=\"n\">automorphism.set_of_automorphisms</span>\n\n<span class=\"k\">end</span>\n\n\n<span class=\"k\">context</span><span class=\"w\"> </span><span class=\"n\">group</span>\n<span class=\"k\">begin</span>\n\n<span class=\"kt\">term</span><span class=\"w\"> </span><span class=\"n\">automorphism.set_of_automorphisms</span>\n<span class=\"c\">(*fails because interpretation is not living long enough*)</span>\n<span class=\"k\">end</span>\n</code></pre></div>",
        "id": 427156982,
        "sender_full_name": "Mathias Fleury",
        "timestamp": 1710692089
    },
    {
        "content": "<p>So how would I show that the automorphism group is a group in a reusable way? Is this not in general the right way to structure that kind of fact?</p>",
        "id": 427165407,
        "sender_full_name": "James Hanson",
        "timestamp": 1710694295
    },
    {
        "content": "<p>I think a closer analog of my actual use case might be metric spaces. Say I have a locale for (possibly incomplete) metric spaces, then I want to be able to talk about the completion of a metric space which is itself also a metric space. So my thinking is that I would have a locale for <code>complete_metric_space</code> extending <code>metric_space</code> and I want to say that <code>complete_metric_space</code> can be interpreted in <code>metric_space</code> in the obvious way (although I'm not sure I'm using the word 'interpreted' in a technically correct way in the sense of Isabelle/HOL).</p>",
        "id": 427166145,
        "sender_full_name": "James Hanson",
        "timestamp": 1710694486
    },
    {
        "content": "<p>section 7.1 of <a href=\"https://isabelle.in.tum.de/doc/locales.pdf\">https://isabelle.in.tum.de/doc/locales.pdf</a> ?</p>",
        "id": 427171521,
        "sender_full_name": "Mathias Fleury",
        "timestamp": 1710695902
    },
    {
        "content": "<p>This is what I was originally confused by, but I think I understand it now. Thank you.</p>",
        "id": 427965237,
        "sender_full_name": "James Hanson",
        "timestamp": 1710951014
    }
]