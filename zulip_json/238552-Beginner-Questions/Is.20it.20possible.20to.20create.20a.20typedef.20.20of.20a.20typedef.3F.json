[
    {
        "content": "<p>Hi, I'm trying to leverage <code>fmap</code> and create a new type with a restriction, but with this code</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"kn\">typedef</span><span class=\"w\"> </span><span class=\"n\">Assets</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"{assets. (∀ t v. fmlookup assets t = Some v ⟶ v &gt; 0)} :: ((Token, nat) fmap) set\"</span>\n<span class=\"k\">proof</span>\n<span class=\"w\">  </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"s\">\"fmempty ∈ {assets. (∀ t v. fmlookup assets t = Some v ⟶ v &gt; 0)}\"</span>\n<span class=\"w\">    </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">auto</span>\n<span class=\"k\">qed</span>\n\n\n<span class=\"k\">setup_lifting</span><span class=\"w\"> </span><span class=\"n\">type_definition_Assets</span>\n</code></pre></div>\n<p>I have the following error on the last command</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"n\">exception</span><span class=\"w\"> </span><span class=\"n\">THM</span><span class=\"w\"> </span><span class=\"n\">1</span><span class=\"w\"> </span><span class=\"n\">raised</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">line</span><span class=\"w\"> </span><span class=\"n\">1872</span><span class=\"w\"> </span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"s\">\"thm.ML\"</span><span class=\"o\">):</span>\n<span class=\"w\">  </span><span class=\"n\">dest_state</span>\n<span class=\"w\">  </span><span class=\"n\">Quotient</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fmrel</span><span class=\"w\"> </span><span class=\"o\">(=))</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fmmap</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fmmap</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">fmrel</span><span class=\"w\"> </span><span class=\"o\">(=))</span>\n</code></pre></div>\n<p>Is it possible to create a typedef of a typedef?</p>",
        "id": 340510660,
        "sender_full_name": "Hernán Rajchert",
        "timestamp": 1678335961
    },
    {
        "content": "<p>I vaguely remember having had problems myself when trying something like this, and I cannot offer you a direct solution.</p>\n<p>That said, it might make sense in your case to define the assets type differently. Spontaneously, I see the following two options:</p>\n<ul>\n<li>Assets are defined as finite maps that map to positive integers (thus excluding 0). This would be the straightforward solution, in my opinion, but it might require you to define the type of positive integers first, which might involve quite a bit of work.</li>\n<li>Assets are defined as those (total) functions from tokens to natural numbers which map only a finite number of tokens to something greater than zero. The idea would be to use <code>0</code> as representing absence of a mapping. You should then define accessor functions that hide this implementation trick.</li>\n</ul>\n<p>By the way, the Isabelle convention is to have type names start with lower case letters.</p>",
        "id": 363580696,
        "sender_full_name": "Wolfgang Jeltsch",
        "timestamp": 1685920132
    }
]