[
    {
        "content": "<p>What is the difference between adding facts to the goal premise with keywords like <code>using</code> in comparison to adding them to the simplifier with <code>simp add: fact</code> and  the <code>no_asm_simp</code> attribute?</p>\n<p>Specifically this fails:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"s\">\"card a = 2 ⟹ card b = 3 ⟹ card (a × b) = 6\"</span>\n<span class=\"w\">  </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">card_cartesian_product</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">no_asm_simp</span><span class=\"o\">))</span>\n</code></pre></div>\n<p>This works:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"kn\">theorem</span><span class=\"w\"> </span><span class=\"s\">\"card a = 2 ⟹ card b = 3 ⟹ card (a × b) = 6\"</span>\n<span class=\"w\">  </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">card_cartesian_product</span><span class=\"o\">)</span>\n</code></pre></div>\n<p>From the documentation:</p>\n<blockquote>\n<p>Note that the original goal premises and chained facts are subject to simplification themselves, while declarations via add/del merely follow the policies of the object-logic to extract rewrite rules from theorems, without further simplification. This may lead to slightly different behavior in either case, which might be required precisely like that in some boundary situations to perform the intended simplification step!</p>\n</blockquote>\n<p>I thought adding <code>no_asm_simp</code> would equalize their behavior:</p>\n<blockquote>\n<p>assumptions are used in the simplification of the conclusion but are not themselves simplified</p>\n</blockquote>\n<p>Am I missing something here?</p>",
        "id": 446849446,
        "sender_full_name": "Mete Polat",
        "timestamp": 1719313744
    },
    {
        "content": "<p><code>declare [[simp_trace]]</code> is your friend:</p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"o\">[</span><span class=\"n\">1</span><span class=\"o\">]</span><span class=\"n\">Cannot</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"w\"> </span><span class=\"n\">premise</span><span class=\"w\"> </span><span class=\"n\">as</span><span class=\"w\"> </span><span class=\"n\">rewrite</span><span class=\"w\"> </span><span class=\"n\">rule</span><span class=\"w\"> </span><span class=\"n\">because</span><span class=\"w\"> </span><span class=\"n\">it</span><span class=\"w\"> </span><span class=\"n\">contains</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">type</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">unknowns</span><span class=\"o\">:</span>\n<span class=\"n\">⋀A</span><span class=\"w\"> </span><span class=\"n\">B.</span><span class=\"w\"> </span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">×</span><span class=\"w\"> </span><span class=\"n\">B</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">*</span><span class=\"w\"> </span><span class=\"n\">card</span><span class=\"w\"> </span><span class=\"n\">B</span>\n</code></pre></div>",
        "id": 447943756,
        "sender_full_name": "Mathias Fleury",
        "timestamp": 1719647064
    }
]