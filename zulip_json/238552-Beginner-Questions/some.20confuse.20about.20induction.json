[
    {
        "content": "<p>I am trying to use induction to prove a lemma, but stuck with some problems. </p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"kn\">lemma</span><span class=\"w\"> </span><span class=\"n\">a_equal_b</span><span class=\"o\">:</span>\n<span class=\"w\">  </span><span class=\"kp\">assumes</span><span class=\"w\"> </span><span class=\"n\">1</span><span class=\"o\">:</span><span class=\"s\">\"vec n a\"</span><span class=\"w\"> </span><span class=\"kp\">and</span><span class=\"w\">  </span><span class=\"n\">2</span><span class=\"o\">:</span><span class=\"s\">\"vec n b\"</span><span class=\"w\"> </span><span class=\"kp\">and</span><span class=\"w\"> </span><span class=\"n\">3</span><span class=\"o\">:</span><span class=\"s\">\"vec n l\"</span><span class=\"w\"> </span><span class=\"kp\">and</span><span class=\"w\"> </span><span class=\"n\">4</span><span class=\"o\">:</span><span class=\"s\">\"∀i∈set [0..&lt;n]. vec n (m!i)\"</span><span class=\"w\">  </span><span class=\"kp\">and</span><span class=\"w\"> </span><span class=\"n\">5</span><span class=\"o\">:</span><span class=\"s\">\"∀i∈set [0..&lt;n]. ewp_vec (m!i)\"</span><span class=\"w\"> </span><span class=\"kp\">and</span>\n<span class=\"w\">    </span><span class=\"n\">6</span><span class=\"o\">:</span><span class=\"s\">\"∀i∈set [0..&lt;n].   equations a (m!i) + l!i = a!i\"</span><span class=\"w\">  </span><span class=\"kp\">and</span>\n<span class=\"w\">    </span><span class=\"n\">7</span><span class=\"o\">:</span><span class=\"s\">\"∀i∈set [0..&lt;n].   equations b (m!i) + l!i = b!i\"</span>\n<span class=\"w\">  </span><span class=\"kp\">shows</span><span class=\"w\"> </span><span class=\"s\">\"∀i∈set [0..&lt;n]. a!i = b!i\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">assms</span>\n<span class=\"k\">proof</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">induct</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">case</span><span class=\"w\"> </span><span class=\"n\">0</span>\n<span class=\"w\">  </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"o\">?</span><span class=\"k\">case</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">assms</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"k\">next</span>\n<span class=\"w\">  </span><span class=\"k\">case</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Suc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"o\">?</span><span class=\"k\">case</span>\n<span class=\"w\">  </span><span class=\"k\">proof</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">induct</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"k\">case</span><span class=\"w\"> </span><span class=\"n\">0</span>\n<span class=\"w\">    </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"o\">?</span><span class=\"k\">case</span><span class=\"w\"> </span><span class=\"kp\">apply</span><span class=\"w\"> </span><span class=\"n\">auto</span>\n<span class=\"w\">      </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">smt</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">verit</span><span class=\"o\">,</span><span class=\"w\"> </span><span class=\"n\">del_insts</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"s\">\"0.prems\"</span><span class=\"o\">(</span><span class=\"n\">5</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"s\">\"0.prems\"</span><span class=\"o\">(</span><span class=\"n\">6</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"s\">\"1\"</span><span class=\"w\"> </span><span class=\"s\">\"6\"</span><span class=\"w\"> </span><span class=\"s\">\"7\"</span><span class=\"w\"> </span><span class=\"n\">One_nat_def</span><span class=\"w\"> </span><span class=\"n\">base_case</span><span class=\"w\"> </span><span class=\"n\">vec_def</span><span class=\"o\">)</span>\n<span class=\"w\">  </span><span class=\"k\">next</span>\n<span class=\"w\">    </span><span class=\"k\">case</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Suc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span>\n<span class=\"w\">    </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"o\">?</span><span class=\"k\">case</span>\n<span class=\"w\">    </span><span class=\"k\">proof</span><span class=\"w\"> </span><span class=\"o\">-</span>\n<span class=\"w\">      </span><span class=\"k\">assume</span><span class=\"w\"> </span><span class=\"n\">i1</span><span class=\"o\">:</span><span class=\"s\">\"vec (Suc (Suc n)) a\"</span><span class=\"w\"> </span><span class=\"kp\">and</span><span class=\"w\"> </span><span class=\"n\">i2</span><span class=\"o\">:</span><span class=\"s\">\"vec (Suc (Suc n)) b\"</span><span class=\"w\"> </span><span class=\"kp\">and</span><span class=\"w\"> </span><span class=\"n\">i3</span><span class=\"o\">:</span><span class=\"s\">\"vec (Suc (Suc n)) l\"</span><span class=\"w\"> </span><span class=\"kp\">and</span>\n<span class=\"w\">        </span><span class=\"n\">i4</span><span class=\"o\">:</span><span class=\"s\">\"∀i∈set [0..&lt;Suc (Suc n)]. vec (Suc (Suc n)) (m ! i)\"</span><span class=\"w\"> </span><span class=\"kp\">and</span>\n<span class=\"w\">        </span><span class=\"n\">i5</span><span class=\"o\">:</span><span class=\"s\">\"∀i∈set [0..&lt;Suc (Suc n)]. ewp_vec (m ! i)\"</span><span class=\"w\"> </span><span class=\"kp\">and</span>\n<span class=\"w\">        </span><span class=\"n\">i6</span><span class=\"o\">:</span><span class=\"s\">\"∀i∈set [0..&lt;Suc (Suc n)]. equations a (m ! i) + l ! i = a ! i\"</span><span class=\"w\"> </span><span class=\"kp\">and</span>\n<span class=\"w\">        </span><span class=\"n\">i7</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"∀i∈set [0..&lt;Suc (Suc n)]. equations b (m ! i) + l ! i = b ! i\"</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">co6</span><span class=\"o\">:</span><span class=\"s\">\"∀i∈set [0..&lt;(Suc n)].  a!i = equations (butlast a) (map2 (+) (butlast (m!i)) (map (λr. r * (m!(Suc n)!(Suc n))⇧⋆ * (m!i!(Suc n))) (butlast (m!(Suc n)))))  +</span>\n<span class=\"s\">          l!(Suc n) * (m!(Suc n)!(Suc n))⇧⋆ * (m!i!(Suc n)) + l!i\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">i1</span><span class=\"w\"> </span><span class=\"n\">i3</span><span class=\"w\"> </span><span class=\"n\">i4</span><span class=\"w\"> </span><span class=\"n\">i6</span><span class=\"w\"> </span><span class=\"n\">i5</span><span class=\"w\"> </span><span class=\"n\">m12</span><span class=\"o\">[</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"s\">\"Suc n\"</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">blast</span>\n<span class=\"w\">      </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">co6</span><span class=\"w\"> </span><span class=\"n\">i1</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">cof1</span><span class=\"o\">:</span><span class=\"s\">\"∀i∈set [0..&lt;(Suc n)].  equations (butlast a) (map2 (+) (butlast (m!i)) (map (λr. r * (m!(Suc n)!(Suc n))⇧⋆ * (m!i!(Suc n))) (butlast (m!(Suc n)))))  +</span>\n<span class=\"s\">          l!(Suc n) * (m!(Suc n)!(Suc n))⇧⋆ * (m!i!(Suc n)) + l!i = (butlast a)!i \"</span>\n<span class=\"w\">        </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">nth_butlast</span><span class=\"w\"> </span><span class=\"n\">vec_def</span><span class=\"o\">)</span>\n\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">c07</span><span class=\"o\">:</span><span class=\"s\">\"∀i∈set [0..&lt;(Suc n)].  b!i = equations (butlast b) (map2 (+) (butlast (m!i)) (map (λr. r * (m!(Suc n)!(Suc n))⇧⋆ * (m!i!(Suc n))) (butlast (m!(Suc n)))))  +</span>\n<span class=\"s\">          l!(Suc n) * (m!(Suc n)!(Suc n))⇧⋆ * (m!i!(Suc n)) + l!i\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">i2</span><span class=\"w\"> </span><span class=\"n\">i3</span><span class=\"w\"> </span><span class=\"n\">i4</span><span class=\"w\"> </span><span class=\"n\">i7</span><span class=\"w\"> </span><span class=\"n\">i5</span><span class=\"w\"> </span><span class=\"n\">m12</span><span class=\"o\">[</span><span class=\"n\">of</span><span class=\"w\"> </span><span class=\"s\">\"Suc n\"</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">m</span><span class=\"o\">]</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">blast</span>\n<span class=\"w\">      </span><span class=\"k\">from</span><span class=\"w\"> </span><span class=\"n\">c07</span><span class=\"w\"> </span><span class=\"n\">i2</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">cof2</span><span class=\"o\">:</span><span class=\"s\">\"∀i∈set [0..&lt;(Suc n)].  equations (butlast b) (map2 (+) (butlast (m!i)) (map (λr. r * (m!(Suc n)!(Suc n))⇧⋆ * (m!i!(Suc n))) (butlast (m!(Suc n)))))  +</span>\n<span class=\"s\">          l!(Suc n) * (m!(Suc n)!(Suc n))⇧⋆ * (m!i!(Suc n)) + l!i = (butlast b)!i\"</span>\n<span class=\"w\">        </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">nth_butlast</span><span class=\"w\"> </span><span class=\"n\">vec_def</span><span class=\"o\">)</span>\n\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">co1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"vec (Suc n) (butlast a)\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">i1</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"o\">(</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"o\">:</span><span class=\"n\">vec_def</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">co2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"vec (Suc n) (butlast b)\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">i2</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"o\">(</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"o\">:</span><span class=\"n\">vec_def</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">co3</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"∀i∈set [0..&lt;Suc n]. vec (Suc n) (map (λi. l!(Suc n) * (m!(Suc n)!(Suc n))⇧⋆ * (m!i!(Suc n)) + l!i) [0..&lt;Suc n])\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">i4</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">co4</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"∀i∈set [0..&lt;Suc n]. ewp_vec (map2 (+) (butlast (m!i)) (map (λr. r * (m!(Suc n)!(Suc n))⇧⋆ * (m!i!(Suc n))) (butlast (m!(Suc n)))))\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">i5</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">c1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"∀i∈set [0..&lt;(Suc n)]. a ! i = b ! i\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">co1</span><span class=\"w\"> </span><span class=\"n\">co2</span><span class=\"w\"> </span><span class=\"n\">co3</span><span class=\"w\"> </span><span class=\"n\">co4</span><span class=\"w\"> </span><span class=\"n\">cof1</span><span class=\"w\"> </span><span class=\"n\">cof2</span><span class=\"w\"> </span><span class=\"n\">Suc.hyps</span><span class=\"w\"> </span><span class=\"kt\">sledgehammer</span>\n<span class=\"w\">        </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">co6</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">fastforce</span>\n<span class=\"w\">      </span><span class=\"k\">moreover</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"s\">\"a !(Suc n) = b ! (Suc n)\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">i1</span><span class=\"w\"> </span><span class=\"n\">i2</span><span class=\"w\"> </span><span class=\"n\">i3</span><span class=\"w\"> </span><span class=\"n\">i4</span><span class=\"w\"> </span><span class=\"n\">i5</span><span class=\"w\"> </span><span class=\"n\">i6</span><span class=\"w\"> </span><span class=\"n\">i7</span><span class=\"w\"> </span><span class=\"k\">proof</span><span class=\"w\"> </span><span class=\"o\">-</span>\n<span class=\"w\">        </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">cc1</span><span class=\"o\">:</span><span class=\"s\">\"a!(Suc n) = (equations (butlast a) (butlast (m!(Suc n))) + l!(Suc n)) * (m!(Suc n)!(Suc n))⇧⋆\"</span>\n<span class=\"w\">          </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">i1</span><span class=\"w\"> </span><span class=\"n\">i3</span><span class=\"w\"> </span><span class=\"n\">i4</span><span class=\"w\"> </span><span class=\"n\">i5</span><span class=\"w\"> </span><span class=\"n\">i6</span><span class=\"w\"> </span><span class=\"n\">m5</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">blast</span>\n<span class=\"w\">        </span><span class=\"k\">moreover</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">cc2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"b!(Suc n) = (equations (butlast b) (butlast (m!(Suc n))) + l!(Suc n)) * (m!(Suc n)!(Suc n))⇧⋆\"</span>\n<span class=\"w\">          </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">i2</span><span class=\"w\"> </span><span class=\"n\">i3</span><span class=\"w\"> </span><span class=\"n\">i4</span><span class=\"w\"> </span><span class=\"n\">i5</span><span class=\"w\"> </span><span class=\"n\">i7</span><span class=\"w\"> </span><span class=\"n\">m5</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">blast</span>\n<span class=\"w\">        </span><span class=\"k\">moreover</span><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"s\">\"(butlast a) = (butlast b)\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">c1</span><span class=\"w\"> </span><span class=\"n\">i1</span><span class=\"w\"> </span><span class=\"n\">i2</span><span class=\"w\"> </span><span class=\"kp\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"o\">:</span><span class=\"n\">vec_def</span><span class=\"o\">)</span>\n<span class=\"w\">        </span><span class=\"k\">proof</span><span class=\"w\"> </span><span class=\"o\">-</span>\n<span class=\"w\">          </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"s\">\"take (length a - 1) a  = take (length b - 1) b\"</span><span class=\"w\">  </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">c1</span><span class=\"w\"> </span><span class=\"n\">i1</span><span class=\"w\"> </span><span class=\"n\">i2</span><span class=\"w\"> </span><span class=\"kp\">apply</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"o\">:</span><span class=\"n\">vec_def</span><span class=\"o\">)</span>\n<span class=\"w\">            </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">aux_2</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">blast</span>\n<span class=\"w\">          </span><span class=\"k\">then</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"o\">?</span><span class=\"n\">thesis</span>\n<span class=\"w\">            </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">metis</span><span class=\"w\"> </span><span class=\"n\">take_replace</span><span class=\"o\">)</span>\n<span class=\"w\">        </span><span class=\"k\">qed</span>\n<span class=\"w\">         </span><span class=\"k\">ultimately</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"o\">?</span><span class=\"n\">thesis</span>\n<span class=\"w\">          </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">presburger</span>\n<span class=\"w\">      </span><span class=\"k\">qed</span>\n<span class=\"w\">      </span><span class=\"k\">ultimately</span><span class=\"w\"> </span><span class=\"k\">show</span><span class=\"w\"> </span><span class=\"o\">?</span><span class=\"n\">thesis</span>\n<span class=\"w\">        </span><span class=\"k\">by</span><span class=\"w\"> </span><span class=\"n\">simp</span>\n<span class=\"w\">    </span><span class=\"k\">qed</span>\n<span class=\"w\">  </span><span class=\"k\">qed</span>\n<span class=\"k\">qed</span>\n</code></pre></div>\n<p>When to prove <code>∀i∈set [0..&lt;(Suc n)]. a ! i = b ! i</code>, I am trying to rewrite the inductive assumption?</p>\n<p>The assumption says that the conclusion could reach by  </p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"w\"> </span><span class=\"n\">vec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Suc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">⟹</span>\n<span class=\"w\">    </span><span class=\"n\">vec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Suc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"n\">⟹</span>\n<span class=\"w\">    </span><span class=\"n\">vec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Suc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"n\">⟹</span>\n<span class=\"w\">    </span><span class=\"n\">∀i∈set</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">0..&lt;Suc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"ow\">.</span><span class=\"w\"> </span><span class=\"n\">vec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">Suc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">⟹</span>\n<span class=\"w\">    </span><span class=\"n\">∀i∈set</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">0..&lt;Suc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"ow\">.</span><span class=\"w\"> </span><span class=\"n\">ewp_vec</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"n\">⟹</span>\n<span class=\"w\">    </span><span class=\"n\">∀i∈set</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">0..&lt;Suc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"ow\">.</span><span class=\"w\"> </span><span class=\"n\">equations</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">⟹</span><span class=\"w\"> </span><span class=\"n\">∀i∈set</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">0..&lt;Suc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"ow\">.</span><span class=\"w\"> </span><span class=\"n\">equations</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">(</span><span class=\"n\">m</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"n\">⟹</span><span class=\"w\"> </span><span class=\"n\">∀i∈set</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">0..&lt;Suc</span><span class=\"w\"> </span><span class=\"n\">n</span><span class=\"o\">]</span><span class=\"ow\">.</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">b</span><span class=\"w\"> </span><span class=\"o\">!</span><span class=\"w\"> </span><span class=\"n\">i</span>\n</code></pre></div>\n<p>And I got the <code>a</code> as <code>(butlast a)</code>, <code>b</code> as <code>(butlast b)</code> and so to <code>l, m</code>. But isabelle tells me can't rewrite it. </p>\n<div class=\"codehilite\" data-code-language=\"Isabelle\"><pre><span></span><code><span class=\"w\"> </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">co1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"vec (Suc n) (butlast a)\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">i1</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"o\">(</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"o\">:</span><span class=\"n\">vec_def</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">co2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"vec (Suc n) (butlast b)\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">i2</span><span class=\"w\"> </span><span class=\"k\">by</span><span class=\"o\">(</span><span class=\"n\">simp</span><span class=\"w\"> </span><span class=\"n\">add</span><span class=\"o\">:</span><span class=\"n\">vec_def</span><span class=\"o\">)</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">co3</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"∀i∈set [0..&lt;Suc n]. vec (Suc n) (map (λi. l!(Suc n) * (m!(Suc n)!(Suc n))⇧⋆ * (m!i!(Suc n)) + l!i) [0..&lt;Suc n])\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">i4</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">co4</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"∀i∈set [0..&lt;Suc n]. ewp_vec (map2 (+) (butlast (m!i)) (map (λr. r * (m!(Suc n)!(Suc n))⇧⋆ * (m!i!(Suc n))) (butlast (m!(Suc n)))))\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">i5</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n<span class=\"w\">      </span><span class=\"k\">have</span><span class=\"w\"> </span><span class=\"n\">c1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s\">\"∀i∈set [0..&lt;(Suc n)]. a ! i = b ! i\"</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">co1</span><span class=\"w\"> </span><span class=\"n\">co2</span><span class=\"w\"> </span><span class=\"n\">co3</span><span class=\"w\"> </span><span class=\"n\">co4</span><span class=\"w\"> </span><span class=\"n\">cof1</span><span class=\"w\"> </span><span class=\"n\">cof2</span><span class=\"w\"> </span><span class=\"n\">Suc.hyps</span><span class=\"w\"> </span><span class=\"gr\">sorry</span>\n</code></pre></div>\n<p>So my question here is how to explioit the inductive hypothesis among the induction proof. Thanks a lot</p>",
        "id": 420130031,
        "sender_full_name": "Hongjian Jiang",
        "timestamp": 1707251389
    },
    {
        "content": "<blockquote>\n<p><code>a</code> as <code>(butlast a)</code></p>\n</blockquote>\n<p>and here lies your problem. If your variable is <code>a</code>, Isabelle wants a. No other option</p>",
        "id": 420134264,
        "sender_full_name": "Mathias Fleury",
        "timestamp": 1707253050
    },
    {
        "content": "<p>If your IH was <code>forall a. ...</code> then you could instantiate <code>a</code> with <code>butlast a</code></p>",
        "id": 420134389,
        "sender_full_name": "Mathias Fleury",
        "timestamp": 1707253092
    }
]