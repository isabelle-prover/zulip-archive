[
    {
        "content": "<p>From: Vincent Jackson &lt;<a href=\"mailto:vjjac@student.unimelb.edu.au\">vjjac@student.unimelb.edu.au</a>&gt;<br>\nHello all,</p>\n<p>Recently I tried to build an old project (in Isabelle 2025, but which <br>\nlast built on Isabelle 2019), and got a \"Duplicate use of directory\" <br>\nerror. This problem appears to show up whenever there are two sessions <br>\nin the same ROOT file, but which use different theory files from the <br>\ncurrent directory.</p>\n<p>In which Isabelle edition did this error become a thing, and what is the <br>\nintended way we should structure our sessions now? I do not understand <br>\nwhy this is now an error; I find it strange that it now seems necessary <br>\nto mirror the session hierarchy in our directory hierarchy. Is there a <br>\nway to build different sessions from the same directory that I am not <br>\naware of, or is this the intent of the change?</p>\n<p>Also, this behaviour does not seem to be documented in the Isabelle <br>\nSystem Manual (at least, not in §2.1), so that should be updated.</p>\n<p>Thanks,<br>\nVincent Jackson<br>\nPh.D. Student<br>\nSchool of Computing and Information Systems<br>\nThe University of Melbourne</p>\n<p>P.S.</p>\n<p>I have constructed a minimal example of the problem as follows:</p>\n<p>$ cat A.thy<br>\ntheory A<br>\nimports Main<br>\nbegin<br>\nend<br>\n$ cat B.thy<br>\ntheory B<br>\nimports A<br>\nbegin<br>\nend<br>\n$ cat ROOT<br>\nsession A = Main +<br>\n   theories<br>\n     \"A\"</p>\n<p>session B = A +<br>\n   theories<br>\n     \"B\"</p>\n<p>and the error that results is</p>\n<p>/home/admin/.isabelle/Isabelle2025/jedit/jars/isabelle_jedit_main.jar:<br>\nCannot start:<br>\n*** Duplicate use of directory \"/home/admin/Development/Isabelle/Theories\"<br>\n***   for session \"A\" (line 2 of \"/home/admin/Development/Isabelle/Theories/ROOT\")<br>\n***   vs. session \"B\" (line 6 of \"/home/admin/Development/Isabelle/Theories/ROOT\")</p>",
        "id": 531316850,
        "sender_full_name": "Email Gateway",
        "timestamp": 1753694293
    },
    {
        "content": "<p>From: Makarius &lt;<a href=\"mailto:makarius@sketis.net\">makarius@sketis.net</a>&gt;<br>\nOn 28/07/2025 07:02, Vincent Jackson wrote:</p>\n<blockquote>\n<p>Recently I tried to build an old project (in Isabelle 2025, but which last <br>\nbuilt on Isabelle 2019), and got a \"Duplicate use of directory\" error. This <br>\nproblem appears to show up whenever there are two sessions in the same ROOT <br>\nfile, but which use different theory files from the current directory.</p>\n<p>In which Isabelle edition did this error become a thing, and what is the <br>\nintended way we should structure our sessions now?</p>\n</blockquote>\n<p>See the NEWS file, as for any new Isabelle release. The relevant entry is:</p>\n<p>\"\"\"<br>\nNew in Isabelle2020 (April 2020)</p>\n<hr>\n<p><strong>* General </strong>*</p>\n<ul>\n<li>Session ROOT files need to specify explicit 'directories' for import<br>\nof theory files. Directories cannot be shared by different sessions.<br>\n(Recall that import of theories from other sessions works via<br>\nsession-qualified theory names, together with suitable 'sessions'<br>\ndeclarations in the ROOT.)<br>\n\"\"\"</li>\n</ul>\n<blockquote>\n<p>Also, this behaviour does not seem to be documented in the Isabelle System <br>\nManual (at least, not in §2.1), so that should be updated.</p>\n</blockquote>\n<p>I do see this text in §2.1:</p>\n<p>\"\"\"<br>\ndirectories dirs specifies additional directories for import of theory files<br>\nvia theories within ROOT or imports within a theory; dirs are relative<br>\nto the main session directory (cf. session . . . in dir). These directories<br>\nneed to be exclusively assigned to a unique session, without implicit<br>\nsharing of file-system locations.<br>\n\"\"\"</p>\n<p>Makarius</p>",
        "id": 531334152,
        "sender_full_name": "Email Gateway",
        "timestamp": 1753699496
    },
    {
        "content": "<p>From: Makarius &lt;<a href=\"mailto:makarius@sketis.net\">makarius@sketis.net</a>&gt;<br>\nOn 28/07/2025 14:27, Vincent Jackson wrote:</p>\n<blockquote>\n<p>I think it would be good to note explicitly in the \"session\" <br>\nsyntax documentation (or maybe the \"session ... in ...\" syntax documentation) <br>\nthat every session has an associated directory (which, as already explained in <br>\nthe documentation, is either explicitly given using the \"in ...\" syntax or <br>\ndefaults to the current directory) and that each directory so associated must <br>\nbe assigned to only one session.</p>\n</blockquote>\n<p>This documentation is unusually clear and explicit. I won't add even more text.</p>\n<p>Makarius</p>",
        "id": 531358518,
        "sender_full_name": "Email Gateway",
        "timestamp": 1753706274
    },
    {
        "content": "<p>From: Vincent Jackson &lt;<a href=\"mailto:vjjac@student.unimelb.edu.au\">vjjac@student.unimelb.edu.au</a>&gt;<br>\nI see. Thanks for finding that.</p>\n<p>That documentation could be better placed. The listing you have <br>\nidentified is for the \"directories\" syntax, which is why I, <br>\nunfortunately, overlooked it. (As I did not use that syntax element.) <br>\nThe documentation also says these directories are \"additional\", but the <br>\nduplicate directory exclusion also applies to the default directory. <br>\n(And one can traverse additional directories via the \"in ...\" syntax too.)</p>\n<p>I think it would be good to note explicitly in the \"session\" <br>\nsyntax documentation (or maybe the \"session ... in ...\" syntax <br>\ndocumentation) that every session has an associated directory (which, as <br>\nalready explained in the documentation, is either explicitly given using <br>\nthe \"in ...\" syntax or defaults to the current directory) and that each <br>\ndirectory so associated must be assigned to only one session.</p>\n<p>In any case, thanks for answering my questions.<br>\nVincent</p>\n<p>On 28/7/25 20:44, Makarius wrote:</p>\n<blockquote>\n<p>On 28/07/2025 07:02, Vincent Jackson wrote:</p>\n<blockquote>\n<p>Recently I tried to build an old project (in Isabelle 2025, but which <br>\nlast built on Isabelle 2019), and got a \"Duplicate use of directory\" <br>\nerror. This problem appears to show up whenever there are two <br>\nsessions in the same ROOT file, but which use different theory files <br>\nfrom the current directory.</p>\n<p>In which Isabelle edition did this error become a thing, and what is <br>\nthe intended way we should structure our sessions now?</p>\n</blockquote>\n<p>See the NEWS file, as for any new Isabelle release. The relevant entry <br>\nis:</p>\n<p>\"\"\"<br>\nNew in Isabelle2020 (April 2020)</p>\n<hr>\n<p><strong>* General </strong>*</p>\n<ul>\n<li>Session ROOT files need to specify explicit 'directories' for import<br>\nof theory files. Directories cannot be shared by different sessions.<br>\n(Recall that import of theories from other sessions works via<br>\nsession-qualified theory names, together with suitable 'sessions'<br>\ndeclarations in the ROOT.)<br>\n\"\"\"</li>\n</ul>\n<blockquote>\n<p>Also, this behaviour does not seem to be documented in the Isabelle <br>\nSystem Manual (at least, not in §2.1), so that should be updated.</p>\n</blockquote>\n<p>I do see this text in §2.1:</p>\n<p>\"\"\"<br>\ndirectories dirs specifies additional directories for import of theory <br>\nfiles<br>\nvia theories within ROOT or imports within a theory; dirs are relative<br>\nto the main session directory (cf. session . . . in dir). These <br>\ndirectories<br>\nneed to be exclusively assigned to a unique session, without implicit<br>\nsharing of file-system locations.<br>\n\"\"\"</p>\n<p>Makarius</p>\n</blockquote>",
        "id": 531790041,
        "sender_full_name": "Email Gateway",
        "timestamp": 1753866706
    }
]