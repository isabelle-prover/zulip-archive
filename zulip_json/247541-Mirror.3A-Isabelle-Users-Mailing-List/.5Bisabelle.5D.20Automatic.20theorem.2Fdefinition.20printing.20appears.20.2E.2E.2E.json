[
    {
        "content": "<p>From: Rafal Kolanski &lt;<a href=\"mailto:xs@xaph.net\">xs@xaph.net</a>&gt;<br>\nHi,</p>\n<p>most likely in the Isabelle 2022 update, the automatic printing of <br>\ntheorems and definitions stopped working for me while in jEdit.</p>\n<p>I have the state and output split into separate buffers. Normally I'd <br>\nexpect:</p>\n<p>lemma blah:<br>\n   \"something\" (* prints goal state in proof state buffer *)<br>\n   apply (simp ...) (* prints goal state in proof state buffer *)<br>\n   done (* prints proved lemma in output buffer *)</p>\n<p>This was especially useful for figuring out what transformed lemmas were <br>\ngenerated without modifying the buffer, e.g.</p>\n<p>lemmas corres_underlying_gets_pre_rhs =<br>\n   corres_symb_exec_r[OF _ _ gets_inv no_fail_pre[OF no_fail_gets TrueI]]</p>\n<p>This is probably related to the relatively recent feature of turning on <br>\nthese outputs when not in interactive mode (show_states/show_results).</p>\n<p>I initially thought this line in proof_display.ML was causing the <br>\ndecision whether to print or not:</p>\n<p>fun no_print int ctxt = not (Config.get (Config.put interactive int <br>\nctxt) show_results);</p>\n<p>but it is clear I don't really comprehend the implications here.</p>\n<p>Can anyone offer some insight?</p>\n<p>Raf.</p>",
        "id": 343274364,
        "sender_full_name": "Email Gateway",
        "timestamp": 1679374424
    },
    {
        "content": "<p>From: Rafal Kolanski &lt;<a href=\"mailto:xs@xaph.net\">xs@xaph.net</a>&gt;<br>\nI have finally figured out what the regression is. The<br>\n\"editor_output_state\" setting has conflated two concepts when moving to<br>\nIsabelle 2022:</p>\n<ul>\n<li>it controls whether proof states are sent to the output panel</li>\n<li>but now it <em>also</em> controls whether the results are printed in the<br>\n   output panel (as per Proof_Display.print_results) (which is invoked<br>\n   at the end of a \"lemma\" command, or for \"lemmas\")</li>\n</ul>\n<p>Ideally, one would want to control these separately:</p>\n<ul>\n<li>turning off states in Output panel when using a separate State panel</li>\n<li>turning off printing results in Output panel (I'm not sure<br>\n   why someone would want this, but performance maybe?)</li>\n</ul>\n<p>This can be worked around by changing the following in<br>\nsrc/Tools/jEdit/src/output_dockable.scala :</p>\n<p>val new_output =<br>\n          if (restriction.isEmpty || restriction.get.contains(command))</p>\n<ul>\n<li>Rendering.output_messages(results, JEdit_Options.output_state())</li>\n<li>Rendering.output_messages(results, true)<br>\n          else current_output</li>\n</ul>\n<p>The situation might make sense if output_messages filtered out only<br>\nproof state messages when its output_state argument is false, but it<br>\nseems that:</p>\n<ul>\n<li>\n<p>proof state messages are not passed in anyway because they got<br>\n   filtered much earlier due to \"Proof state\" checkbox setting the global<br>\n   \"editor_output_state\" option</p>\n</li>\n<li>\n<p>asking output_messages to not output state messages also makes it drop<br>\n   results messages, i.e.<br>\n     (if (output_state) states else Nil) ::: other</p>\n</li>\n</ul>\n<p>Perhaps the filtering in output_messages is supposed to filter state<br>\nmessages into \"states\" and results messages into \"other\", but it<br>\ndoesn't. I don't have any more time for code decryption.</p>\n<p>Raf.</p>",
        "id": 360682976,
        "sender_full_name": "Email Gateway",
        "timestamp": 1684901394
    },
    {
        "content": "<p>From: Makarius &lt;<a href=\"mailto:makarius@sketis.net\">makarius@sketis.net</a>&gt;<br>\nWe have a long and complex history, especially for interaction with Isabelle: <br>\nhistorically ProofGeneral Emacs (some of its legacy is still there), now PIDE <br>\nwith Isabelle/jEdit or Isabelle/VSCode or \"isabelle server\" as front-ends.</p>\n<p>All that needs to be taken into account when sorting out such fine points. <br>\nMoreover, it is important to look into the formal Mercurial (not git) history, <br>\ne.g. using \"hg bisect\".</p>\n<p>That was missing on this thread: I did not have time to do your homework.</p>\n<p>Just for the historical record, here are a few relevant changesets:</p>\n<p>changeset:   75840:f8c412a45af8<br>\nuser:        wenzelm<br>\ndate:        Sat Aug 13 14:29:59 2022 +0200<br>\nsummary:     more accurate treatment of option \"editor_output_state\", e.g. <br>\nwhen changed via Isabelle/jEdit Plugin Options panel;</p>\n<p>changeset:   56897:c668735fb8b5<br>\nuser:        wenzelm<br>\ndate:        Wed May 07 13:55:16 2014 +0200<br>\nfiles:       src/Pure/Isar/obtain.ML src/Pure/Isar/proof.ML <br>\nsrc/Pure/Isar/proof_display.ML src/Pure/Isar/specification.ML <br>\nsrc/Pure/Isar/toplevel.ML<br>\ndescription:<br>\nprint results as \"state\", to avoid intrusion into the source text;<br>\nprint new local theory (again);</p>\n<p>changeset:   74156:ecf80e37ed1a<br>\nuser:        wenzelm<br>\ndate:        Wed Aug 18 23:04:58 2021 +0200<br>\nfiles:       NEWS src/Pure/Isar/attrib.ML src/Pure/Isar/proof_display.ML<br>\ndescription:<br>\nsupport configuration options \"show_results\";</p>\n<p>If something still emerges from that for Isabelle2023-RC2 depends how other <br>\ndetails work out.</p>\n<p>Makarius</p>",
        "id": 378828466,
        "sender_full_name": "Email Gateway",
        "timestamp": 1690382426
    }
]