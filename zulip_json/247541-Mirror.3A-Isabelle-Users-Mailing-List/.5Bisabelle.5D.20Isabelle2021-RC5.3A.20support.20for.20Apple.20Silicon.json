[
    {
        "content": "<p>From: Makarius &lt;<a href=\"mailto:makarius@sketis.net\">makarius@sketis.net</a>&gt;<br>\nThe announcement now says:</p>\n<p>* Support for macOS Big Sur on Intel and Apple Silicon (ARM).</p>\n<p>For RC5 the main change is \"Improved support for Apple Silicon (ARM): external<br>\nprocesses are managed by Isabelle/Scala instead of Apple's Rosetta (which does<br>\nnot support multithreaded process fork).\"</p>\n<p>Thus sledgehammer works properly, and as far as I can see everything else as well.</p>\n<p>I also managed to run complete Isabelle + AFP twice: it takes approx. 12h for<br>\none run. Detailed timings are included for the following setup:</p>\n<ul>\n<li>\n<p>Hardware: Macmini9,1, Apple M1 CPU with 4 cores * 2 (hyperthreading), 16GB RAM</p>\n</li>\n<li>\n<p>macOS Big Sur 11.2</p>\n</li>\n<li>\n<p>Isabelle/da0ee7fbc068 (approx. Isabelle2021-RC5)</p>\n</li>\n<li>\n<p>AFP/07ea995a6665 from afp-2021 repository</p>\n</li>\n<li>\n<p>etc/settings:</p>\n<p>ISABELLE_TOOL_JAVA_OPTIONS=\"-Djava.awt.headless=true -Xms512m -Xmx4g -Xss16m\"</p>\n<p>ML_PLATFORM=\"x86_64_32-darwin\"<br>\nML_OPTIONS=\"--minheap 1500 --maxheap=10g\"</p>\n</li>\n<li>\n<p>isabelle build -o threads=4 -d '$AFP' -a -X very_slow</p>\n</li>\n</ul>\n<p>For comparison, here are timings for Isabelle on the last generation of Intel<br>\nMac Mini (Macmini8,1, 6-Core Intel Core i7, 64 GB RAM):<br>\n<a href=\"https://isabelle.sketis.net/devel/build_status/macOS_11.1_Big_Sur_4_threads/index.html\">https://isabelle.sketis.net/devel/build_status/macOS_11.1_Big_Sur_4_threads/index.html</a></p>\n<p>Overall the Apple Silicon machine is pretty impressive: slightly faster than<br>\nthe Intel one. Note that 16 GB is presently the upper bound for that new<br>\ngeneration of Mac Minis, while the older generation supported 64 GB.</p>\n<p>Makarius<br>\n<a href=\"/user_uploads/14278/N-SPQFVJR4CuQYqHeqDm836z/nohup.out\">nohup.out</a></p>",
        "id": 225616495,
        "sender_full_name": "Email Gateway",
        "timestamp": 1612822181
    },
    {
        "content": "<p>From: Makarius &lt;<a href=\"mailto:makarius@sketis.net\">makarius@sketis.net</a>&gt;<br>\nHere are side-by-side measurements of the last two generations of Mac Minis.</p>\n<p>Overall setup:</p>\n<ul>\n<li>\n<p>Isabelle2021-RC5 (approximately, with minor/irrelevant variations in the<br>\nchangeset ids)</p>\n</li>\n<li>\n<p>AFP/9a6ed530ce81 (afp-2021 branch)</p>\n</li>\n<li>\n<p>ISABELLE_TOOL_JAVA_OPTIONS=\"-Djava.awt.headless=true -Xms512m -Xmx4g -Xss16m\"</p>\n</li>\n<li>\n<p>ML_PLATFORM=\"x86_64_32-darwin\"<br>\n  ML_OPTIONS=\"--minheap 1500 --maxheap 10g\"</p>\n</li>\n<li>\n<p>isabelle build -o threads=4 -d '$AFP' -f -g slow</p>\n</li>\n<li>\n<p>Machines:</p>\n<p>(1) Intel: Macmini8,1, i7 CPU with 6/12 cores, 64 GB RAM, SSD storage, macOS<br>\n11.2</p>\n<p>(2) Apple Silicon: Macmini9,1, M1 CPU with 4/8 cores, 16 GB RAM, SSD<br>\nstorage, macOS 11.2.1</p>\n</li>\n</ul>\n<p>The counting of CPU cores has become more difficult than before: Intel has its<br>\ntraditional notion of hyperthreading, but Apple M1 has a different notion of<br>\nbig vs. little cores. Poly/ML reports 6 cores on (1) and 8 cores on (2).</p>\n<p>For the measurements, I have enforced 4 worker threads in Isabelle/ML and<br>\nrestricted the heap size such that the Macmini9,1 still feels comfortable: it<br>\nhas only 16 GB (at maximum), while the older Intel Mac Mini has 64 GB (at<br>\nmaximum).</p>\n<p>The results for AFP \"slow\" are included in the attachment. The new Apple<br>\nSilicon machine is slightly faster, even with the runtime translation of<br>\nPoly/ML x86_64 code to ARM64 via Rosetta 2.</p>\n<p>Some notable results:</p>\n<p>intel.log:Finished HOL (0:02:53 elapsed time, 0:07:52 cpu time, factor 2.72)<br>\napple.log:Finished HOL (0:02:45 elapsed time, 0:07:22 cpu time, factor 2.67)</p>\n<p>intel.log:Finished AODV (1:14:08 elapsed time, 4:06:45 cpu time, factor 3.33)<br>\napple.log:Finished AODV (0:58:25 elapsed time, 3:16:21 cpu time, factor 3.36)</p>\n<p>intel.log:Finished Flyspeck-Tame-Computation (2:38:30 elapsed time, 3:58:26<br>\ncpu time, factor 1.50)<br>\napple.log:Finished Flyspeck-Tame-Computation (2:36:44 elapsed time, 3:56:57<br>\ncpu time, factor 1.51)</p>\n<p>intel.log:Finished ConcurrentGC (0:13:35 elapsed time, 0:51:12 cpu time,<br>\nfactor 3.77)<br>\napple.log:Finished ConcurrentGC (0:12:27 elapsed time, 0:46:32 cpu time,<br>\nfactor 3.74)</p>\n<p>In conclusion, I am pleased to declare Apple Silicon M1 (and macOS 11 Big Sur)<br>\nas fully supported by the Isabelle2021 release (which is to be published<br>\ntowards the end of next week).</p>\n<p>Side-remark: This rather quick adoption of quite different new hardware has<br>\nbeen possible thanks to a generous donation of a Macmini9,1.</p>\n<p>Makarius<br>\n<a href=\"/user_uploads/14278/OX8v9OfjJTNWmtDYtzAGdeFU/intel.log\">intel.log</a><br>\n<a href=\"/user_uploads/14278/AO7JRv9G_zBw4EtL2TObJtJL/apple.log\">apple.log</a></p>",
        "id": 226243844,
        "sender_full_name": "Email Gateway",
        "timestamp": 1613221046
    }
]