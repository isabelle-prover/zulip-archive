[
    {
        "content": "<p>From: Pasquale Noce &lt;<a href=\"mailto:pasquale.noce.lavoro@gmail.com\">pasquale.noce.lavoro@gmail.com</a>&gt;<br>\nDear Isabelle users,</p>\n<p>In the new AFP submission on which I am currently working, I am using the<br>\nLaTeX listings package for some sample C code snippets, enclosed between<br>\n\\begin{lstlisting} and \\end{lstlisting} commands, and everything worked fine<br>\nup to the previous document generation, performed a couple of weeks ago.<br>\nParticularly, my manual indentation of those code snippets using simple<br>\nspaces, according to some examples found on the internet, was faithfully<br>\nrendered in my document.<br>\nYesterday, as I generated my document again, I found out to my surprise that<br>\nthose code snippets are no longer indented in the document, although I had not<br>\nchanged anything either in the snippets themselves or in the \\lstset command<br>\nused to configure the package, which is reported here below.</p>\n<p>\\lstset{<br>\n  basicstyle = \\small\\ttfamily,<br>\n  frame = tb,<br>\n  keywordstyle = \\bfseries,<br>\n  language = C,<br>\n  numbers = left,<br>\n  numberstyle = \\tiny<br>\n}</p>\n<p>I am using MikTeX on Windows 10, so after detecting this unexpected behavior,<br>\nI launched the MikTeX console to update the LaTeX packages. However, this did<br>\nnot have any effect: when I generate my document, those code snippets keep not<br>\nbeing indented.<br>\nDoes any one of you have any hint about the possible reasons for this sudden<br>\nchange in the behavior of the package, as well as about some possible solution<br>\nto this issue?</p>\n<p>Thank you very much, best regards,<br>\nPasquale Noce</p>",
        "id": 399192524,
        "sender_full_name": "Email Gateway",
        "timestamp": 1698621058
    },
    {
        "content": "<p>From: Makarius &lt;<a href=\"mailto:makarius@sketis.net\">makarius@sketis.net</a>&gt;<br>\nOn 30/10/2023 00:10, Pasquale Noce wrote:</p>\n<blockquote>\n<p>In the new AFP submission on which I am currently working, I am using the<br>\nLaTeX listings package for some sample C code snippets, enclosed between<br>\n\\begin{lstlisting} and \\end{lstlisting} commands<br>\n[...]<br>\nYesterday, as I generated my document again, I found out to my surprise that<br>\nthose code snippets are no longer indented in the document</p>\n</blockquote>\n<p>On 31/10/2023 12:31, Pasquale Noce wrote:</p>\n<blockquote>\n<p>I have further investigated this unexpected behavior, and it turns out to take<br>\nplace if the text command containing the code listings also contains a list<br>\ncreated using the markdown control symbols described in the Isabelle/jEdit<br>\nreference manual (<a href=\"https://isabelle.in.tum.de/dist/Isabelle2023/doc/jedit.pdf\">https://isabelle.in.tum.de/dist/Isabelle2023/doc/jedit.pdf</a>,<br>\nsection 4.2).</p>\n</blockquote>\n<p>(The latter snippet is from a private mail thread. I will answer that here to <br>\nclose the isabelle-users thread properly.)</p>\n<p>The observation about markdown already explains the situation: a paragraph is <br>\na list of lines where initial spaces are not taken into account for document <br>\noutput. Only the indentation of the first line is significant --- to determine <br>\noverall markdown structure.</p>\n<p>The listing environment is in conflict with that. It deviates from the normal <br>\n(non-)treatment of blanks within paragraphs. Thus it may be seen as a <br>\nvariation on the \"verbatim\" environment, and needs to be treated similarly to <br>\nthe \"verbatim\" document antiquotation.</p>\n<p>Here is a suitable definition in Isabelle/ML:</p>\n<p>setup ‹<br>\n   Document_Output.antiquotation_raw_embedded \\&lt;^binding&gt;‹lstlisting›<br>\n     (Scan.lift Parse.embedded)<br>\n     (fn _ =&gt; fn s =&gt;<br>\n       Latex.string \"\\\\begin{lstlisting}\\n\" @<br>\n       Latex.string (cat_lines (trim (forall_string Symbol.is_space) <br>\n(trim_split_lines s))) @<br>\n       Latex.string \"\\n\\\\end{lstlisting}\")<br>\n›</p>\n<p>And here is an example document snippet:</p>\n<p>text ‹<br>\n   List:<br>\n     ▪ Lorem ipsum dolor sit amet, consectetur adipiscing elit.<br>\n     ▪ Sed sit amet porta orci, vitae ultricies ipsum. Phasellus volutpat arcu<br>\n       quam, non blandit purus cursus vitae.</p>\n<p>Nam vehicula magna ut purus sagittis, ac vehicula nisl iaculis. Nam nec<br>\n   ullamcorper mi, non tincidunt ipsum.</p>\n<p>\\&lt;^lstlisting&gt;‹<br>\ndo<br>\n{<br>\n     r = a % b;<br>\n     a = b;<br>\n     b = r;<br>\n} while (b);<br>\n   ›</p>\n<p>Cras sit amet est rhoncus massa semper venenatis. Sed elementum diam sed mi<br>\n   tempor pellentesque sit amet at justo. Aliquam vitae nunc nec massa<br>\n   ultricies ullamcorper.<br>\n›</p>\n<p>The full example is attached (and hopefully not lost).</p>\n<p>Makarius</p>\n<p><a href=\"/user_uploads/14278/EaQ5XsjwkxjIq6yaSu0kciUW/Test_C.tar.gz\">Test_C.tar.gz</a></p>",
        "id": 399746401,
        "sender_full_name": "Email Gateway",
        "timestamp": 1698851900
    }
]