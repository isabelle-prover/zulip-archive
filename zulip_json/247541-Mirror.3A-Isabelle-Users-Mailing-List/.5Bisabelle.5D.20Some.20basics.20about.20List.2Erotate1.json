[
    {
        "content": "<p>From: Jeremy Sylvestre &lt;<a href=\"mailto:jsylvest@ualberta.ca\">jsylvest@ualberta.ca</a>&gt;<br>\nA few more --- wondering if any of the below is of interest for<br>\nsrc/HOL/List.thy.</p>\n<p>Cheers,<br>\nJeremy S</p>\n<p>lemma inj_rotate1: \"inj rotate1\"<br>\nproof<br>\n  fix xs ys :: \"'a list\" show \"rotate1 xs = rotate1 ys ⟹ xs = ys\"<br>\n    by (cases xs, cases ys, simp_all, cases ys, simp_all)<br>\nqed</p>\n<p>lemma surj_rotate1: \"surj rotate1\"<br>\nproof (safe, simp_all)<br>\n  fix xs :: \"'a list\" show \"xs ∈ range rotate1\"<br>\n  proof (cases xs rule: rev_exhaust)<br>\n    case Nil<br>\n    hence \"xs = rotate1 []\" by auto<br>\n    thus ?thesis by fast<br>\n  next<br>\n    case (snoc as a)<br>\n    hence \"xs = rotate1 (a#as)\" by force<br>\n    thus ?thesis by fast<br>\n  qed<br>\nqed</p>\n<p>lemma bij_rotate1: \"bij (rotate1 :: 'a list ⇒ 'a list)\"<br>\n  using bijI inj_rotate1 surj_rotate1 by blast</p>\n<p>lemma the_inv_rotate1_simps:<br>\n  \"the_inv rotate1 [] = []\"<br>\n  \"the_inv rotate1 (xs@[x]) = x#xs\"<br>\n  using inj_rotate1 the_inv_f_f[of rotate1 \"[]\"] the_inv_f_f[of rotate1<br>\n\"x#xs\"] by auto</p>\n<p>lemma rotate1_replicate: \"rotate1 (replicate n a) = replicate n a\"<br>\n  by (cases n, simp_all add: replicate_append_same)</p>\n<p>lemma rotate1_fixed_pt:<br>\n  assumes \"rotate1 xs = xs\"<br>\n  obtains x where \"xs = replicate (length xs) x\"<br>\nproof (cases xs, simp)<br>\n  case (Cons a as)<br>\n  have nth_as: \"\\&lt;forall&gt;i&lt;length as. as!i = a\"<br>\n  proof clarify<br>\n    fix i from assms Cons show \"i &lt; length as \\&lt;Longrightarrow&gt; as!i = a\"<br>\n      using nth_append[of as \"[a]\" 0] nth_append[of as \"[a]\" \"Suc _\"] by<br>\n(induct i) auto<br>\n  qed<br>\n  have \"xs = replicate (length xs) a\"<br>\n  proof (intro nth_equalityI, simp)<br>\n    fix i from Cons show \"i &lt; length xs ⟹ xs!i = replicate (length xs) a !<br>\ni\"<br>\n      using nth_as by (cases i) auto<br>\n  qed<br>\n  with that show thesis by force<br>\nqed</p>",
        "id": 303918455,
        "sender_full_name": "Email Gateway",
        "timestamp": 1665693025
    },
    {
        "content": "<p>From: Jeremy Sylvestre &lt;<a href=\"mailto:jsylvest@ualberta.ca\">jsylvest@ualberta.ca</a>&gt;<br>\nHit send too soon, here's a shorter proof for that last one</p>\n<p>lemma rotate1_fixed_pts:<br>\n  assumes \"rotate1 xs = xs\"<br>\n  obtains x where \"xs = replicate (length xs) x\"<br>\nproof (cases xs, simp)<br>\n  case (Cons a as)<br>\n  moreover have \"as = replicate (length as) a\"<br>\n  proof (intro nth_equalityI, simp_all)<br>\n    fix i from assms Cons show \"i &lt; length as \\&lt;Longrightarrow&gt; as!i = a\"<br>\n      using nth_append[of as \"[a]\" 0] nth_append[of as \"[a]\" \"Suc _\"] by<br>\n(induct i) auto<br>\n  qed<br>\n  ultimately show thesis using that by simp<br>\nqed</p>",
        "id": 303919459,
        "sender_full_name": "Email Gateway",
        "timestamp": 1665693418
    },
    {
        "content": "<p>From: Tobias Nipkow &lt;<a href=\"mailto:nipkow@in.tum.de\">nipkow@in.tum.de</a>&gt;<br>\nThanks Jeremy, I have added all except for the the_inv ones (for no strong <br>\nreason) and rotate1_fixed_pt. The latter follows from what I feel is a (new) <br>\nmore basic lemma</p>\n<p>lemma rotate1_fixpoint_card: \"rotate1 xs = xs ⟹ xs = [] ∨ card(set xs) = 1\"</p>\n<p>together with the new</p>\n<p>lemma card_set_1_iff_replicate:<br>\n   \"card(set xs) = Suc 0 ⟷ xs ≠ [] ∧ (∃x. xs = replicate (length xs) x)\"</p>\n<p>like this:</p>\n<p>lemma rotate1_fixpoint_replicate:<br>\n   assumes \"rotate1 xs = xs\"<br>\n   obtains x where \"xs = replicate (length xs) x\"<br>\nusing rotate1_fixpoint_card[OF assms]<br>\nby (auto simp add: card_set_1_iff_replicate)</p>\n<p>which I have not included - it is always difficult to draw the line ...</p>\n<p><a href=\"https://isabelle.in.tum.de/repos/isabelle/rev/642f1a36e1d6\">https://isabelle.in.tum.de/repos/isabelle/rev/642f1a36e1d6</a></p>\n<p>Thanks again<br>\nTobias<br>\n<a href=\"/user_uploads/14278/bQ2Wk2M28L0jz1chHtWpU2oV/smime.p7s\">smime.p7s</a></p>",
        "id": 304067599,
        "sender_full_name": "Email Gateway",
        "timestamp": 1665763791
    }
]