[
    {
        "content": "<p>From: Jakub Kądziołka &lt;<a href=\"mailto:kuba@kadziolka.net\">kuba@kadziolka.net</a>&gt;<br>\nGood evening,</p>\n<p>I have proven some lemmas that would probably fit into the Isabelle<br>\ndistribution - a lower bound on the size of a set of natural numbers,<br>\nand a summation formula that counts how many times each value occurs.</p>\n<p>By the way, I seem to be submitting mails like these somewhat often<br>\nlately; please let me know if I should be doing something to make this<br>\nmore manageable.</p>\n<p>Regards,<br>\nJakub Kądziołka</p>\n<p>lemma max_ge_card: \"finite S ⟹ Suc (Max S) ≥ card S\"<br>\nproof (rule classical)<br>\n  assume \"finite S\" and \"¬ Suc (Max S) ≥ card S\"<br>\n  then have \"Suc (Max S) &lt; card S\"<br>\n    by simp<br>\n  with <code>finite S</code> have \"S ⊆ {0..Max S}\"<br>\n    by auto<br>\n  hence \"card S ≤ card {0..Max S}\"<br>\n    by (intro card_mono; auto)<br>\n  thus \"card S ≤ Suc (Max S)\"<br>\n    by simp<br>\nqed</p>\n<p>lemma nat_sum_ge_card_sum:<br>\n  shows \"∑ {0..&lt;card S} ≤ ∑ S\"<br>\nproof (cases \"finite S\")<br>\n  case True<br>\n  then show ?thesis<br>\n  proof (induction \"card S\" arbitrary: S)<br>\n    case (Suc x)<br>\n    then have \"Max S ≥ x\" using max_ge_card by fastforce<br>\n    let ?S' = \"S - {Max S}\"<br>\n    from Suc have \"Max S ∈ S\" by (auto intro: Max_in)<br>\n    hence cards: \"card S = Suc (card ?S')\"<br>\n      using <code>finite S</code> by (intro card.remove; auto)<br>\n    hence \"∑ {0..&lt;card ?S'} ≤ ∑ ?S'\"<br>\n      using Suc by (intro Suc; auto)</p>\n<p>hence \"∑ {0..&lt;card ?S'} + x ≤ ∑ ?S' + Max S\"<br>\n      using <code>Max S ≥ x</code> by simp<br>\n    also have \"... = ∑ S\"<br>\n      using sum.remove[OF <code>finite S</code> <code>Max S ∈ S</code>, where g=\"λx. x\"]<br>\n      by simp<br>\n    finally show ?case<br>\n      using cards Suc by auto<br>\n  qed simp<br>\nqed simp</p>\n<p>lemma sum_count:<br>\n  assumes \"finite S\" \"finite R\" \"g <code> S ⊆ R\"\n  shows \"(∑x ∈ S. f (g x)) = (∑y ∈ R. of_nat (card {x ∈ S. g x = y}) * f y)\"\nproof -\n  let ?r = \"relation_of (λp q. g p = g q) S\"\n  have eqv: \"equiv S ?r\"\n    unfolding relation_of_def by (auto intro: comp_equivI)\n  have finite: \"C ∈ S//?r ⟹ finite C\" for C\n    by (fact finite_equiv_class[OF </code>finite S<code> equiv_type[OF </code>equiv S ?r`]])<br>\n  have disjoint: \"A ∈ S//?r ⟹ B ∈ S//?r ⟹ A ≠ B ⟹ A ∩ B = {}\" for A B<br>\n    using eqv quotient_disj by blast</p>\n<p>let ?cls = \"λy. {x ∈ S. y = g x}\"<br>\n  have quot_as_img: \"S//?r = ?cls <code> g </code> S\"<br>\n    by (auto simp add: relation_of_def quotient_def)<br>\n  have cls_inj: \"inj_on ?cls (g ` S)\"<br>\n    by (auto intro: inj_onI)</p>\n<p>have rest_0: \"(∑y ∈ R - g <code> S. of_nat (card (?cls y)) * f y) = 0\"\n    (is \"?rest = 0\")\n  proof -\n    {\n      fix y\n      assume \"y ∈ R - g </code> S\"<br>\n      then have *: \"?cls y = {}\"<br>\n        by auto<br>\n      have \"of_nat (card (?cls y)) * f y = 0\"<br>\n        unfolding * by simp<br>\n    }<br>\n    thus ?thesis by simp<br>\n  qed</p>\n<p>have \"(∑x ∈ S. f (g x)) = (∑C ∈ S//?r. ∑x ∈ C. f (g x))\"<br>\n    using eqv finite disjoint<br>\n    by (simp flip: sum.Union_disjoint[simplified] add: Union_quotient)<br>\n  also have \"... = (∑y ∈ g <code> S. ∑x ∈ ?cls y. f (g x))\"\n    unfolding quot_as_img by (simp add: sum.reindex[OF cls_inj])\n  also have \"... = (∑y ∈ g </code> S. ∑x ∈ ?cls y. f y)\"<br>\n    by auto<br>\n  also have \"... = (∑y ∈ g <code> S. of_nat (card (?cls y)) * f y)\"\n    by (simp flip: sum_constant)\n  also have \"... = (∑y ∈ R. of_nat (card (?cls y)) * f y)\"\n    using rest_0 by (simp add: sum.subset_diff[OF ‹g </code> S ⊆ R› ‹finite R›])<br>\n  finally show ?thesis<br>\n    by (simp add: eq_commute)<br>\nqed</p>",
        "id": 223069209,
        "sender_full_name": "Email Gateway",
        "timestamp": 1610925793
    },
    {
        "content": "<p>From: Tobias Nipkow &lt;<a href=\"mailto:nipkow@in.tum.de\">nipkow@in.tum.de</a>&gt;<br>\nThank you for your contributions, they will be added shortly.<br>\nYes, the process of submitting contributions like yours needs to be improved.</p>\n<p>Tobias<br>\n<a href=\"/user_uploads/14278/fJfwbAtwDMe1toM12J_3uKxe/smime.p7s\">smime.p7s</a></p>",
        "id": 223208944,
        "sender_full_name": "Email Gateway",
        "timestamp": 1611052247
    },
    {
        "content": "<p>From: Tobias Nipkow &lt;<a href=\"mailto:nipkow@in.tum.de\">nipkow@in.tum.de</a>&gt;<br>\nJakub,</p>\n<p>I added and renamed your lemmas:<br>\n<a href=\"http://isabelle.in.tum.de/repos/isabelle/rev/be9b73dfd3e0\">http://isabelle.in.tum.de/repos/isabelle/rev/be9b73dfd3e0</a></p>\n<p>Thanks<br>\nTobias<br>\n<a href=\"/user_uploads/14278/EydFbCK2vJCXUbJ047bP_nGQ/smime.p7s\">smime.p7s</a></p>",
        "id": 223368100,
        "sender_full_name": "Email Gateway",
        "timestamp": 1611147083
    }
]