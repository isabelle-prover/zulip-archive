[
    {
        "content": "<p>From: Jakub Kądziołka &lt;<a href=\"mailto:kuba@kadziolka.net\">kuba@kadziolka.net</a>&gt;<br>\nHello,</p>\n<p>I am trying to get Isabelle2021 working on NixOS. Due to filesystem<br>\nlayout, downloading binaries doesn't really work on NixOS, so this<br>\ninvolves packaging Isabelle, with some external dependencies.<br>\nHowever, we do match the version of polyml exactly:</p>\n<p>polyml = polyml.overrideAttrs (attrs: {<br>\n  configureFlags = [ \"--enable-intinf-as-int\" \"--with-gmp\" \"--disable-shared\" ];<br>\n  version = \"for-isabelle\";<br>\n  src = fetchFromGitHub {<br>\n    owner = \"polyml\";<br>\n    repo = \"polyml\";<br>\n    rev = \"f86ae3dc168612d51e7a73fbe3b7e02cb3bc1bac\";<br>\n    sha256 = \"09f28jz6mnb4c0r1v57cwyw2vcwhdq57v6c5j8kwn2640cfl1gz7\";<br>\n  };<br>\n});</p>\n<p>Nevertheless, building Pure results in this quite curious error:</p>\n<p>Error: Value or constructor (buildCall3) has not been declared in structure Foreign<br>\nForeign.buildCall3<br>\n(<br>\n   Foreign.getSymbol (Foreign.loadLibraryIndirect (fn ...)) \"sha1_buffer\",<br>\n   (Foreign.cByteArray, Foreign.cUlong, ...),<br>\n   Foreign.cPointer<br>\n   )<br>\nAt (line 152 of \"General/sha1.ML\")<br>\nError: Value or constructor (getSymbol) has not been declared in structure Foreign<br>\nForeign.buildCall3<br>\n(<br>\n   Foreign.getSymbol (Foreign.loadLibraryIndirect (fn ...)) \"sha1_buffer\",<br>\n   (Foreign.cByteArray, Foreign.cUlong, ...),<br>\n   Foreign.cPointer<br>\n   )<br>\nAt (line 153 of \"General/sha1.ML\")<br>\n[...]</p>\n<p>I'm not sure what's going on here. There were some changes in the commit<br>\nrange between 5.8.1 and this pinned commit involving libffi, but the<br>\nPoly/ML sources distributed with Isabelle don't seem to include any<br>\nworkarounds; diff claims there's no difference.</p>\n<p>I confirmed that referring to Foreign.buildCall3 in a REPL triggers the<br>\nerror in the new Poly but not in 5.8.1.</p>\n<p>Any insights on why this might be happening? Perhaps this was already<br>\nencountered when updating the Poly/ML in use by Isabelle?</p>\n<p>Kind regards,<br>\nJakub Kądziołka</p>",
        "id": 229047678,
        "sender_full_name": "Email Gateway",
        "timestamp": 1614990648
    },
    {
        "content": "<p>From: Jakub Kądziołka &lt;<a href=\"mailto:kuba@kadziolka.net\">kuba@kadziolka.net</a>&gt;<br>\nHello,</p>\n<p>I have figured out what the problem was. We were building PolyML by<br>\nrunning 'make', instead of running 'make compiler' twice like Isabelle<br>\ndoes. This seems to have had some weird consequences for bootstrapping.</p>\n<p>Regards,<br>\nJakub Kądziołka</p>",
        "id": 229137455,
        "sender_full_name": "Email Gateway",
        "timestamp": 1615072563
    }
]