[
    {
        "content": "<p>From: Gunnar Teege &lt;<a href=\"mailto:cl-isabelle-users@lists.cam.ac.uk\">cl-isabelle-users@lists.cam.ac.uk</a>&gt;<br>\nDear Isabelle developers,</p>\n<p>when defining a quotient type for a record I get an unexpected warning <br>\nabout a missing mapper function. A minimized example is as follows:<br>\n   record 'a myrec = c1 :: \"'a\"<br>\n   setup_lifting type_definition_myrec_ext<br>\n   copy_bnf ('a, 'm) myrec_ext<br>\n   term map_myrec_ext<br>\n   quotient_type 'a myrec_quot =<br>\n    \"'a myrec\" / \"λ(r1::'a myrec) (r2::'a myrec). c1 r1 = c1 r2\"<br>\n     by (simp add: equivp_def) metis<br>\nHere the quotient_type command signals the warning<br>\n   \"No map function defined for Test_Mapper.myrec.myrec_ext. This will <br>\ncause problems later on.\"<br>\nFor my understanding the mapper should have been defined by the copy_bnf <br>\ncommand as map_myrec_ext, it is displayed by the subsequent term command.</p>\n<p>If I omit the copy_bnf the record scheme is not registered as BNF and <br>\nthe quotient_type command signals the additional warning about the <br>\nmissing relator. So I don't see why after copy_bnf it finds the relator <br>\nbut not the mapper.</p>\n<p>It is not really a problem, because it is only a warning, but I would <br>\nlike to understand it. Also it is not new for the 2025 RC2, it also <br>\noccurs at least in Isabelle 2023. But the 2025 release may be a good <br>\nopportunity to check and possibly resolve it.</p>\n<p>I attach a theory file with a slightly extended example with two type <br>\nparameters where the quotient_type is nontrivial, it reproduces the same <br>\nwarning.</p>\n<p>Regards<br>\nGunnar Teege</p>\n<p><a href=\"/user_uploads/14278/1H7H5MHIA0iVauZ49VTcBP80/Test_Mapper.thy\">Test_Mapper.thy</a><br>\n<a href=\"/user_uploads/14278/OKLJTRiTYuKS0_0WwKL3MC5W/smime.p7s\">smime.p7s</a></p>",
        "id": 500125139,
        "sender_full_name": "Email Gateway",
        "timestamp": 1739783858
    },
    {
        "content": "<p>From: Gunnar Teege &lt;<a href=\"mailto:cl-isabelle-users@lists.cam.ac.uk\">cl-isabelle-users@lists.cam.ac.uk</a>&gt;<br>\nOk, I have an answer to my question.</p>\n<p>It seems that copy_bnf does not register the mapper in the functor <br>\nstructure. When adding<br>\n   functor map_myrec_ext<br>\n     using myrec_ext.map_comp apply fastforce<br>\n     apply (simp add: myrec_ext.map_id0)<br>\n     done<br>\nafter copy_bnf the warning disappears.</p>\n<p>Thanks to Peter Gammie for figuring that out.</p>\n<p>Maybe it would be useful to extend copy_bnf (and supposedly lift_bnf) <br>\naccordingly.</p>\n<p>Regards<br>\nGunnar Teege</p>\n<blockquote>\n<p>when defining a quotient type for a record I get an unexpected warning <br>\nabout a missing mapper function. A minimized example is as follows:<br>\n   record 'a myrec = c1 :: \"'a\"<br>\n   setup_lifting type_definition_myrec_ext<br>\n   copy_bnf ('a, 'm) myrec_ext<br>\n   term map_myrec_ext<br>\n   quotient_type 'a myrec_quot =<br>\n    \"'a myrec\" / \"λ(r1::'a myrec) (r2::'a myrec). c1 r1 = c1 r2\"<br>\n     by (simp add: equivp_def) metis<br>\nHere the quotient_type command signals the warning<br>\n   \"No map function defined for Test_Mapper.myrec.myrec_ext. This will <br>\ncause problems later on.\"</p>\n</blockquote>\n<p><a href=\"/user_uploads/14278/tK8kRRGENnuVGDIrYAXPmTi0/smime.p7s\">smime.p7s</a></p>",
        "id": 500143043,
        "sender_full_name": "Email Gateway",
        "timestamp": 1739788159
    }
]