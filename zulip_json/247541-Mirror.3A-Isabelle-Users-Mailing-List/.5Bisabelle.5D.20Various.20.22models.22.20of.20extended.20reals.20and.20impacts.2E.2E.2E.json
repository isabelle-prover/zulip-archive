[
    {
        "content": "<p>From: \"Chun Tian (binghe)\" &lt;<a href=\"mailto:binghe.lisp@gmail.com\">binghe.lisp@gmail.com</a>&gt;<br>\nDear HOL4 and Isabelle community,</p>\n<p>the sole purpose of this email is to have your attention on a recent pull<br>\nrequest on HOL4:</p>\n<p><a href=\"https://github.com/HOL-Theorem-Prover/HOL/pull/845\">https://github.com/HOL-Theorem-Prover/HOL/pull/845</a></p>\n<p>where I was trying to formalize Fubini's theorem (in Lebesgue Integrals)<br>\nbut was blocked somehow by HOL4's new arithmetic definitions of extended<br>\nreals (extreal), i.e. the addition/subtraction of infinities.</p>\n<p>In short words, I feel that the statements of this classical result<br>\n(Fubini's theorem) by <em>Guido Fubini</em> (1879-1943) are not sufficient,<br>\nbecause its proof seems inevitably relied on the forbidden part of extreal<br>\narithmetics.   As a result, Fubini's theorem in its original statements has<br>\nbeen or (can be) formalized in Isabelle/HOL, Lean and Mizar, but not in<br>\nlatest HOL4 where <code>PosInf + NegInf</code> is unspecified.</p>\n<p>Thanks in advance for your opinions and comments!</p>\n<p>Regards,</p>\n<p>Chun Tian</p>",
        "id": 205083274,
        "sender_full_name": "Email Gateway",
        "timestamp": 1595828060
    },
    {
        "content": "<p>From: Manuel Eberl &lt;<a href=\"mailto:eberlm@in.tum.de\">eberlm@in.tum.de</a>&gt;<br>\nHello,</p>\n<p>I find this a bit odd and I think that abstractly, there should be no<br>\nproblem here.</p>\n<p>Your assumptions include</p>\n<p>(AE y::(Y,B,v). integrable (X,A,u) (λx. f (x,y)))<br>\n(AE x::(X,A,u). integrable (Y,B,v) (λy. f (x,y)))</p>\n<p>And you say you need to add the assumptions</p>\n<p>∀y. y ∈ Y ⇒ ∫⁺ (X,A,u) (λx. (abs ∘ f) (x,y)) ≠ +∞<br>\n∀x. x ∈ X ⇒ ∫⁺ (Y,B,v) (λy. (abs ∘ f) (x,y)) ≠ +∞</p>\n<p>The former implies the \"almost everywhere\" form of the latter. So,<br>\nsuppose X' and Y' are the subsets of X and Y where it doesn't hold, why<br>\ndon't you just w.l.o.g. assume f to be zero on (X'×Y)∪(X×Y')? That does<br>\nnot change the value of the integral – since both measures are<br>\nsigma-finite, and X' and Y' are null sets, (X'×Y)∪(X×Y') is also a null set.</p>\n<p>Not saying that this is the easiest way to do it, but it should work.</p>\n<p>In Isabelle, the situation is quite a bit different. Most of the heavy<br>\nlifting is done with non-negative integrals (nn_integral), which work on<br>\nextended non-negative reals, which are a much nicer algebraic structure<br>\nthan \"normal\" extended reals.</p>\n<p>The \"normal\" integral (lebesgue_integral) does not even return extended<br>\nreals, but normal reals, and is undefined (or rather always returns 0)<br>\nif the function is not integrable (i.e. if the nn_integral of the<br>\nabsolute value is ∞).</p>\n<p>If I recall correctly, results for lebesgue_integral usually follow<br>\nfairly easily from those of nn_integral. Especially because<br>\nintegrability is just measurability + \"nn_integral ≠ ∞\" so the results<br>\nfor nn_integral allow you to show integrability easily, and once you<br>\nhave shown integrability, lebesgue_integral behaves fairly nicely.</p>\n<p>(I've only contributed a little bit to this library, most of the work<br>\nwas done by Johannes Hölzl, so the above is just my impression from<br>\nusing and browsing the library)</p>\n<p>Cheers,</p>\n<p>Manuel</p>",
        "id": 205089041,
        "sender_full_name": "Email Gateway",
        "timestamp": 1595835879
    },
    {
        "content": "<p>From: \"Chun Tian (binghe)\" &lt;<a href=\"mailto:binghe.lisp@gmail.com\">binghe.lisp@gmail.com</a>&gt;<br>\nHi Manuel,</p>\n<p>please be noticed that</p>\n<p>(AE y::(Y,B,v). integrable (X,A,u) (λx. f (x,y)))<br>\n(AE x::(X,A,u). integrable (Y,B,v) (λy. f (x,y)))</p>\n<p>are conclusions of Fubini's theorem.</p>\n<p>Furthermore, the definition of integrability, besides the finiteness of<br>\nnn_integral (pos_fn_integral in HOL4) of the positive and negative parts,<br>\nalso includes the measurability of the involved functions. And actually the<br>\nmeasurability is the main problem:</p>\n<p>[integrable_def]  Definition<br>\n      ⊢ ∀m f.<br>\n            integrable m f ⇔<br>\n            f ∈ Borel_measurable (m_space m,measurable_sets m) ∧<br>\n            ∫⁺ m f⁺ ≠ +∞ ∧ ∫⁺ m f⁻ ≠ +∞</p>\n<p>One may think that, if two functions f and g only differ at a null set<br>\n(i.e. they're a.e.-equivalent), and one of them, say f, is measurable, then<br>\nso is the other.  But this is actually not true. In fact, this argument is<br>\nonly true if the involved measure space is complete (i.e. all subsets of<br>\nnull sets are null sets too).  However their integrations are the same<br>\n(when they're integrable). See the following two theorems in HOL4:</p>\n<p>[integral_cong_AE]  Theorem<br>\n      ⊢ ∀m f g. measure_space m ∧ (AE x::m. f x = g x) ⇒ ∫ m f = ∫ m g</p>\n<p>[integrable_eq_AE]  Theorem<br>\n      ⊢ ∀m f g.<br>\n            complete_measure_space m ∧ integrable m f ∧<br>\n            (AE x::m. f x = g x) ⇒<br>\n            integrable m g</p>\n<p>To see a counterexample (of integrable_eq_AE when <code>complete_measure_space</code><br>\nis replaced by just <code>measure_space</code>), see the following artificial example<br>\ngiven by Prof. Massimo Campanino (University of Bologna):</p>\n<p>\"I think I found an example using Cantor set C which has 0 Lebesque<br>\nmeasure. Let f and g  both be equal to 1 on the complementary set of C. We<br>\ncan decompose C as the union of two disjoint non-measurable sets C_1 and<br>\nC_2  using a modification of the standard example of non-measurable subset<br>\nof [0, 1]. Let f be equal to 0 ang g be equal to 1/3 on C_1 and to 2/3 on<br>\nC_2.\"</p>\n<p>Regards,</p>\n<p>Chun Tian</p>",
        "id": 205090440,
        "sender_full_name": "Email Gateway",
        "timestamp": 1595837097
    },
    {
        "content": "<p>From: Manuel Eberl &lt;<a href=\"mailto:eberlm@in.tum.de\">eberlm@in.tum.de</a>&gt;<br>\nOn 27/07/2020 10:04, Chun Tian (binghe) wrote:</p>\n<blockquote>\n<p>are conclusions of Fubini's theorem.</p>\n</blockquote>\n<p>Oops, okay, sorry!</p>\n<blockquote>\n<p>Furthermore, the definition of integrability, besides the finiteness of<br>\nnn_integral (pos_fn_integral in HOL4) of the positive and negative parts,<br>\nalso includes the measurability of the involved functions.</p>\n</blockquote>\n<p>Perhaps the problem is simply that your measurability theorem for<br>\nsubtraction on extreals is too weak. I would be very surprised if it<br>\nwere not possible to prove that subtraction of extreals is measurable<br>\nwith no preconditions.</p>\n<p>After all, there are only finitely many problematic points and you can<br>\ntreat those separately. Testing for equality is measurable, constant<br>\nfunctions are measurable, \"if-then-else\" is measurable – so a function<br>\nthat is measurable with finitely many exceptions should also be measurable.</p>\n<p>At the end of the day, pretty much everything you can write down without<br>\ndoing something crazy (like choice operators) is Borel-measurable.</p>\n<p>Manuel</p>",
        "id": 205091790,
        "sender_full_name": "Email Gateway",
        "timestamp": 1595838476
    },
    {
        "content": "<p>From: \"Chun Tian (binghe)\" &lt;<a href=\"mailto:binghe.lisp@gmail.com\">binghe.lisp@gmail.com</a>&gt;<br>\nHi,</p>\n<p>If f and g are both measurable functions, then {x | f x = g x /\\ x IN<br>\nm_space m} (abbrev: {f = g}) must be a measurable set. However, if you have<br>\njust f a measurable function, and {f = g} a measurable set, then it is NOT<br>\ntrue that g is a measurable set, UNLESS m is a complete measure space.</p>\n<p>But actually I just got a new idea to resolve my problem:</p>\n<p>Although the value of <code>PosInf + NegInf</code>, etc. are not specified (in latest<br>\nHOL4), but if I let <code>x = PosInf + NegInf</code> in a proof, and then do a case<br>\nanalysis on <code>x</code>, there must be only three possibilities: x = PosInf, x =<br>\nNegInf, x = Normal r, where r is an arbitrary normal real number.   But I<br>\ndo have proven the involved theorems under all these 3 cases (with very<br>\ndifferent proofs, sometimes), thus in theory I also have a proof when<br>\n<code>PosInf + NegInf</code> is unspecified!</p>\n<p>What I have just benefited from logic is that the same logical term cannot<br>\nequal to different values in the same proof.</p>\n<p>Regards,</p>\n<p>Chun Tian</p>",
        "id": 205096957,
        "sender_full_name": "Email Gateway",
        "timestamp": 1595842750
    },
    {
        "content": "<p>From: Manuel Eberl &lt;<a href=\"mailto:eberlm@in.tum.de\">eberlm@in.tum.de</a>&gt;<br>\nI don't understand that statement at all. Did you mean \"it is NOT true<br>\nthat g is a measurable function\"? If yes, then, well, of course not,<br>\nsince {f = g} could be the empty set (which is certainly measurable) and<br>\nthen obviously the measurability of f does not tell you anything about<br>\ng. Not sure why you are bringing this up.</p>\n<p>In any case, all I said in my last email was that you should be able to<br>\neasily prove</p>\n<p>⊢ ∀a f g h. sigma_algebra a ∧ f ∈ Borel_measurable a ∧ g ∈<br>\nBorel_measurable a ⇒ (λx. f x − g x) ∈ Borel_measurable a</p>\n<p>no matter what ∞ + -∞ is defined as (including undefined, which is just<br>\nsome globally fixed value in HOL). But perhaps that is the same<br>\nrealisation that you also had in your last email.</p>\n<p>Manuel</p>",
        "id": 205098138,
        "sender_full_name": "Email Gateway",
        "timestamp": 1595843522
    },
    {
        "content": "<p>From: \"Chun Tian (binghe)\" &lt;<a href=\"mailto:binghe.lisp@gmail.com\">binghe.lisp@gmail.com</a>&gt;<br>\nNot that easy, or just impossible. However, if f and g are positive and<br>\nnegative parts of the same function (h), then the theorem indeed holds<br>\nwithout any extra antecedents:</p>\n<p>[IN_MEASURABLE_BOREL_PLUS_MINUS]  Theorem<br>\n      ⊢ ∀a f.<br>\n            f ∈ Borel_measurable a ⇔<br>\n            f⁺ ∈ Borel_measurable a ∧ f⁻ ∈ Borel_measurable a</p>\n<p>My previous idea actually doesn't work. The problem is that, not only ∞ +<br>\n-∞, but also the other three cases (-∞ + ∞, ∞ - ∞, -∞ - -∞) will also<br>\ninvolve when you actually try to prove that proposition, and these four<br>\ncases have in total 3^4 possible value combinations, none leads to any<br>\ninconsistency.</p>",
        "id": 205109563,
        "sender_full_name": "Email Gateway",
        "timestamp": 1595852359
    },
    {
        "content": "<p>From: Manuel Eberl &lt;<a href=\"mailto:eberlm@in.tum.de\">eberlm@in.tum.de</a>&gt;<br>\nThe way that measurability of subtraction on ereals is proven in<br>\nIsabelle strongly suggests to me that it does not depend on any<br>\nparticular choice of what ∞ - ∞ and -∞ - (-∞) are. I quickly checked it<br>\nby defining my own ereals and leaving it undefined, and all those proofs<br>\nstill work fine.</p>\n<p>In case you are interested in /how/ this is proven in Isabelle: You take<br>\nthe following lemma:</p>\n<p>lemma borel_measurable_ereal2:<br>\n  fixes f g :: \"'a ⇒ ereal\"<br>\n  assumes f: \"f ∈ borel_measurable M\"<br>\n  assumes g: \"g ∈ borel_measurable M\"<br>\n  assumes H: \"(λx. H (ereal (real_of_ereal (f x))) (ereal (real_of_ereal<br>\n(g x)))) ∈ borel_measurable M\"<br>\n    \"(λx. H (-∞) (ereal (real_of_ereal (g x)))) ∈ borel_measurable M\"<br>\n    \"(λx. H (∞) (ereal (real_of_ereal (g x)))) ∈ borel_measurable M\"<br>\n    \"(λx. H (ereal (real_of_ereal (f x))) (-∞)) ∈ borel_measurable M\"<br>\n    \"(λx. H (ereal (real_of_ereal (f x))) (∞)) ∈ borel_measurable M\"<br>\n  shows \"(λx. H (f x) (g x)) ∈ borel_measurable M\"<br>\nproof -<br>\n  let ?G = \"λy x. if g x = ∞ then H y ∞ else if g x = - ∞ then H y (-∞)<br>\nelse H y (ereal (real_of_ereal (g x)))\"<br>\n  let ?F = \"λx. if f x = ∞ then ?G ∞ x else if f x = - ∞ then ?G (-∞) x<br>\nelse ?G (ereal (real_of_ereal (f x))) x\"<br>\n  { fix x have \"H (f x) (g x) = ?F x\" by (cases \"f x\" \"g x\" rule:<br>\nereal2_cases) auto }<br>\n  note * = this<br>\n  from assms show ?thesis unfolding * by simp<br>\nqed</p>\n<p>Then you note that the conversions between \"real\" and \"ereal\" (which are<br>\ncalled \"ereal :: real ⇒ ereal\" and \"real_of_ereal :: ereal ⇒ real\" in<br>\nIsabelle) are unconditionally Borel-measurable.</p>\n<p>For the first one, that should be obvious. For the second one, note that<br>\n\"real_of_ereal\" is clearly a continuous map from \"UNIV - {±∞} :: ereal\"<br>\nto \"UNIV :: real\" and then still Borel-measurable on the entire Borel<br>\nspace of ereal because there are only countable many (namely 2)<br>\nexceptional points.</p>\n<p>I don't see why this kind of argument should not work in HOL4. This does<br>\nnot even assume that \"∞ - ∞ = -∞ - (-∞)\" or anything of the sort. It<br>\nonly assumes that \"∞ - ∞\" is some arbitrary but globally fixed value –<br>\nsurely that is the case in HOL4's logic.</p>\n<p>Manuel</p>",
        "id": 205118648,
        "sender_full_name": "Email Gateway",
        "timestamp": 1595857635
    },
    {
        "content": "<p>From: Manuel Eberl &lt;<a href=\"mailto:eberlm@in.tum.de\">eberlm@in.tum.de</a>&gt;<br>\nWell, if you want to do it the \"proper\" way, you need a logic with an<br>\nexplicit notion of undefinedness. Or some form of dependent types,<br>\nperhaps. But I think even in Coq and Lean they often go for the \"let's<br>\npick a convenient dummy result\" approach as opposed to the \"let's<br>\nrestrict the function's input to a subtype\" approach when it comes to<br>\nquestions like \"what is the integral of a non-integrable function\".</p>\n<p>(I don't have any hard data for that, just from anecdotes I recall from<br>\ntalking to people, but I'm sure someone will contradict me if the above<br>\nis wrong.)</p>\n<p>In Isabelle/HOL, the current consensus seems to be that convenient dummy<br>\nvalues are the best way to go. We've yet to encounter a situation where<br>\nthey are a problem (and I for one do not think there is one) and they<br>\nmake life much easier.</p>\n<p>For instance, if you define something like \"ln x = (THE y. x = exp y)\",<br>\nthe ln of all non-positive numbers is completely unspecified. If you add<br>\na \"if x ≤ 0 then undefined else …\", it's still unspecified, but you at<br>\nleast know that \"ln x1 = ln x2\" for any non-positive numbers x1, x2.<br>\nThat might sound silly to you, but the nice thing is that this allows<br>\nyou to prove that ln is measurable on the reals, whereas the other thing<br>\ndoes not.</p>\n<p>Of course, you could do all the maths you can do with that definition<br>\nalso with the previous one, but things just become a lot messier because<br>\nyou then have to talk about measurability on a subspace and some of the<br>\nautomation will probably not work anymore etc. So why not make your life<br>\na bit easier?</p>\n<p>All in all, I think this fixation on defining things the \"proper\" way is<br>\nunnecessary. But don't get me wrong, I totally understand where it is<br>\ncoming from, and I do think it is a legitimate view.</p>\n<p>Manuel</p>",
        "id": 205215160,
        "sender_full_name": "Email Gateway",
        "timestamp": 1595928978
    }
]