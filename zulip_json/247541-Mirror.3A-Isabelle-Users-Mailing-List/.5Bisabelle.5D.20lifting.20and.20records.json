[
    {
        "content": "<p>From: Gunnar Teege &lt;<a href=\"mailto:Gunnar.Teege@unibw.de\">Gunnar.Teege@unibw.de</a>&gt;<br>\nDear all,</p>\n<p>I would like to apply the lifting and transfer packages to lift <br>\nfunctions from a record type to a subtype of it. My problem is the <br>\nmissing relator for the record type.</p>\n<p>Example:<br>\nrecord ('a, 'b) R =<br>\n   f1 :: \"'a\"<br>\n   f2 :: \"'b\"</p>\n<p>type_synonym rr = \"(nat, nat) R\"</p>\n<p>definition wlfR :: \"rr ⇒ bool\" where \"wlfR r ≡ (f1 r) = 0\"<br>\ntypedef WlfR = \"{x. wlfR x}\"<br>\nproof<br>\n   show \"⦇R.f1 = 0, f2 = 0⦈ ∈ {x. wlfR x}\" by (simp add: wlfR_def)<br>\nqed</p>\n<p>When I now setup the lifting package using<br>\n   setup_lifting type_definition_WlfR<br>\nIsabelle says<br>\n   Generation of a parametrized correspondence relation failed.<br>\n   Reason:  No relator for the type \"&lt;theory name&gt;.R.R_ext\" found.</p>\n<p>I understand that the record type constructor R needs a relator which <br>\ncan be defined by something like<br>\n   definition rel_R ::<br>\n     \"('a ⇒ 'b ⇒ bool) ⇒ ('c ⇒ 'd ⇒ bool) ⇒ ('e ⇒ 'f ⇒ bool) ⇒<br>\n      ('a,'c,'e) R_scheme ⇒ ('b,'d,'f) R_scheme ⇒ bool\"<br>\n   where \"rel_R p1 p2 p3 r1 r2 ≡<br>\n     p1 (f1 r1) (f1 r2) ∧<br>\n     p2 (f2 r1) (f2 r2) ∧<br>\n     p3 (R.more r1) (R.more  r2)\"<br>\n(do I really need to handle the more part explicitly here?)</p>\n<p>but how can I make the relator known to the lifting package so that <br>\nsetup_lifting finds it?</p>\n<p>Regards<br>\nGunnar Teege<br>\n<a href=\"/user_uploads/14278/e_scfihE0BatkMDmYv-YD790/smime.p7s\">smime.p7s</a></p>",
        "id": 303624900,
        "sender_full_name": "Email Gateway",
        "timestamp": 1665580615
    },
    {
        "content": "<p>From: Dmitriy Traytel &lt;<a href=\"mailto:traytel@di.ku.dk\">traytel@di.ku.dk</a>&gt;<br>\nHi Gunnar,</p>\n<p>First of all, the message from setup_lifting is just a warning. Whether it is relevant depends on what you want to do after that.</p>\n<p>You can automatically generate and register the relator for R (more precisely for R_ext) using the following command:</p>\n<p>copy_bnf (no_warn_transfer) ('a, 'b, 'more) R_ext</p>\n<p>This does a bit more than just adding the relator: you can read about it in the datatypes tutorial.</p>\n<p>If you want just the relator you can define it as you did. To register it with lifting you will need to prove a couple of properties of your definition and register those theorems with corresponding attributes. See the isar-ref section on the Lifting and Transfer packages that mention the attributes relator_mono, relator_eq, relator_distr, relator_eq_onp, and quot_map and points to HOL-Library.Lifting_Set for examples — I’m not sure which subset of these attributes is strictly necessary to get rid of the warning.</p>\n<p>Best wishes,<br>\nDmitriy</p>",
        "id": 303650016,
        "sender_full_name": "Email Gateway",
        "timestamp": 1665585732
    },
    {
        "content": "<p>From: Gunnar Teege &lt;<a href=\"mailto:Gunnar.Teege@unibw.de\">Gunnar.Teege@unibw.de</a>&gt;<br>\nHi Dmitriy,</p>\n<p>thanks for the answers. copy_bnf worked fine for me and removed the <br>\nwarning. Actually, as you supposed, it was not even required for the <br>\nliftings I wanted do do.</p>\n<p>Next question: When a record component has a word type, another warning <br>\nappears in setup_lifting: \"No relator for the type \"Numeral_Type.bit0\" <br>\nfound.\" It seems no problem either, but I would like to understand it <br>\nand how the warning can be handled. I tried<br>\n   lift_bnf 'a Numeral_Type.bit0<br>\n(I am using an older Isabelle version (before 2021) where bit0 was <br>\ndefined by a typedef), but Isabelle tells me \"No live variables\", so it <br>\nseems not so easy. And I am not sure how to define a relator at all for <br>\nbit0 or whether bit0 is a BNF.</p>\n<p>Here is the definition of bit0 in the version I use:<br>\n   typedef 'a bit0 = \"{0 ..&lt; 2 * int CARD('a::finite)}\"</p>\n<p>Cheers<br>\nGunnar<br>\n<a href=\"/user_uploads/14278/-ygYHlgzMgAUqkDP7rwk0nIo/smime.p7s\">smime.p7s</a></p>",
        "id": 303814422,
        "sender_full_name": "Email Gateway",
        "timestamp": 1665663257
    }
]