[
    {
        "content": "<p>From: Makarius &lt;<a href=\"mailto:makarius@sketis.net\">makarius@sketis.net</a>&gt;<br>\n<strong>* ML </strong>*</p>\n<ul>\n<li>\n<p>Term operations under abstractions are now more robust (and more<br>\nstrict) by using the formal proof context in subsequent operations:</p>\n<p>Variable.dest_abs<br>\nVariable.dest_abs_cterm<br>\nVariable.dest_all<br>\nVariable.dest_all_cterm</p>\n</li>\n</ul>\n<p>This works under the assumption that terms are always properly declared<br>\nto the proof context (e.g. via Variable.declare_term). Failure to do so,<br>\nor working with the wrong context, will cause an error (exception Fail,<br>\nbased on Term.USED_FREE from Term.dest_abs_fresh).</p>\n<p>The Simplifier and equational conversions now use the above operations<br>\nroutinely, and thus require user-space tools to be serious about the<br>\nproof context (notably in their use of Goal.prove, SUBPROOF etc.).<br>\nINCOMPATIBILITY in add-on tools is to be expected occasionally: a proper<br>\ncontext discipline needs to be followed.</p>\n<ul>\n<li>\n<p>Former operations Term.dest_abs and Logic.dest_all (without a proper<br>\ncontext) have been discontinued. INCOMPATIBILITY, either use<br>\nVariable.dest_abs etc. above, or the following operations that imitate<br>\nthe old behavior to a great extent:</p>\n<p>Term.dest_abs_global<br>\nLogic.dest_all_global</p>\n</li>\n</ul>\n<p>This works under the assumption that the given (sub-)term directly shows<br>\nall free variables that need to be avoided when generating a fresh name.<br>\nA violation of the assumption are variables stemming from the enclosing<br>\ncontext that get involved in a proof only later.</p>\n<p>This refers to Isabelle/7f06e317fe25 + AFP/0cfcfc7a85ea.</p>\n<p>The actual change is rather minor, but it required several days to go through<br>\nold (and some new) applications that still did not work with the proof context<br>\ncorrectly, e.g. see <a href=\"https://isabelle-dev.sketis.net/rISABELLE8ee3d5d3c1\">https://isabelle-dev.sketis.net/rISABELLE8ee3d5d3c1</a> for<br>\nHOL-Nominal or <a href=\"https://isabelle-dev.sketis.net/rAFPe1f8faf5261f\">https://isabelle-dev.sketis.net/rAFPe1f8faf5261f</a> for AFP/Simpl.</p>\n<p>The new setup will prevent such inaccurate treatment of contexts in the<br>\nfuture, because it fails rather quickly on bad situations --- with a proper<br>\nerror instead of just a warning from &gt; 15 years ago<br>\n<a href=\"https://isabelle-dev.sketis.net/rISABELLE7df8abe926c3\">https://isabelle-dev.sketis.net/rISABELLE7df8abe926c3</a></p>\n<p>Makarius</p>\n<hr>\n<p>isabelle-dev mailing list<br>\n<a href=\"mailto:isabelle-dev@in.tum.de\">isabelle-dev@in.tum.de</a><br>\n<a href=\"https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev\">https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev</a></p>",
        "id": 258262079,
        "sender_full_name": "Email Gateway",
        "timestamp": 1634673626
    }
]