[
    {
        "content": "<p>From: Martin Desharnais &lt;<a href=\"mailto:martin.desharnais@posteo.de\">martin.desharnais@posteo.de</a>&gt;<br>\nDear Isabelle developers,</p>\n<p>I noticed that the map_ran function from HOL-Library is defined with the <br>\nfollowing type annotation.</p>\n<p>definition map_ran :: \"('key ⇒ 'val ⇒ 'val) ⇒ ('key × 'val) list ⇒ ('key <br>\n× 'val) list\"<br>\n   where \"map_ran f = map (λ(k, v). (k, f k v))\"</p>\n<p>This means that it is not possible to use map_ran to map an association <br>\nlist from one range type to another. This would be possible if it had <br>\nthe following type annotation (or no type annotation at all).</p>\n<p>('key ⇒ 'val1 ⇒ 'val2) ⇒ ('key × 'val1) list ⇒ ('key × 'val2) list</p>\n<p>I cannot think of any case where it would pose a problem for map_ran to <br>\nhave this general type so I tried to changed it. I noticed no resulting <br>\nproblem in the HOL distribution. I also checked in the AFP and found <br>\nthat only the following sessions use this constant: Call_Arity, <br>\nLaunchbury, LTL_to_DRA, and Collections. I also noticed no problem in <br>\nthese sessions with the general type.</p>\n<p>Is there an historical reason why map_ran has this restrictive type <br>\nannotation?</p>\n<p>Is there any objection to me pushing this change?</p>\n<p>While I am at it, I also have the following two small lemmas that I <br>\nfound useful and would like to add to HOL-Library.AList. Note that <br>\nmap_ran_Cons is only a generalization of map_ran_simps(2) that avoids <br>\nthe need for a case analysis of the product x. Is there any objection?</p>\n<p>lemma map_fst_map_ran[simp]: \"map fst (map_ran f xs) = map fst xs\"<br>\n   by (simp add: map_ran_def case_prod_beta)</p>\n<p>lemma map_ran_Cons: \"map_ran f (x # xs) = (fst x, f (fst x) (snd x)) # <br>\nmap_ran f xs\"<br>\n   by (simp add: map_ran_def case_prod_beta)</p>\n<p>Regards,<br>\nMartin Desharnais<br>\n<a href=\"/user_uploads/14278/V_VUjlH11gWAA4E3MZsKZPl3/OpenPGP_0x58AE985FE188789A.asc\">OpenPGP_0x58AE985FE188789A.asc</a><br>\n<a href=\"/user_uploads/14278/UmwkIUBN8jDlSn2bjS29BSlB/OpenPGP_signature\">OpenPGP_signature</a></p>",
        "id": 238261644,
        "sender_full_name": "Email Gateway",
        "timestamp": 1620717116
    },
    {
        "content": "<p>From: Tobias Nipkow &lt;<a href=\"mailto:nipkow@in.tum.de\">nipkow@in.tum.de</a>&gt;<br>\nHi Martin,</p>\n<p>On 11/05/2021 09:11, Martin Desharnais wrote:</p>\n<blockquote>\n<p>Dear Isabelle developers,</p>\n<p>I noticed that the map_ran function from HOL-Library is defined with the <br>\nfollowing type annotation.</p>\n<p>definition map_ran :: \"('key ⇒ 'val ⇒ 'val) ⇒ ('key × 'val) list ⇒ ('key × 'val) <br>\nlist\"<br>\n   where \"map_ran f = map (λ(k, v). (k, f k v))\"</p>\n</blockquote>\n<p>Somebody wasn't thinking when they fixed that type. I have generalized it as you <br>\nsuggested and everything still works, as expected.</p>\n<blockquote>\n<p>This means that it is not possible to use map_ran to map an association list <br>\nfrom one range type to another. This would be possible if it had the following <br>\ntype annotation (or no type annotation at all).</p>\n<p>('key ⇒ 'val1 ⇒ 'val2) ⇒ ('key × 'val1) list ⇒ ('key × 'val2) list<br>\n</p>\n</blockquote>\n<blockquote>\n<p>While I am at it, I also have the following two small lemmas that I found useful <br>\nand would like to add to HOL-Library.AList. Note that map_ran_Cons is only a <br>\ngeneralization of map_ran_simps(2) that avoids the need for a case analysis of <br>\nthe product x. Is there any objection?</p>\n<p>lemma map_fst_map_ran[simp]: \"map fst (map_ran f xs) = map fst xs\"<br>\n   by (simp add: map_ran_def case_prod_beta)</p>\n<p>lemma map_ran_Cons: \"map_ran f (x # xs) = (fst x, f (fst x) (snd x)) # map_ran f <br>\nxs\"<br>\n   by (simp add: map_ran_def case_prod_beta)</p>\n</blockquote>\n<p>No objections.</p>\n<p>Tobias</p>\n<blockquote>\n<p>Regards,<br>\nMartin Desharnais</p>\n<hr>\n<p>isabelle-dev mailing list<br>\n<a href=\"mailto:isabelle-dev@in.tum.de\">isabelle-dev@in.tum.de</a><br>\n<a href=\"https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev\">https://mailman46.in.tum.de/mailman/listinfo/isabelle-dev</a></p>\n<p><a href=\"/user_uploads/14278/2RP5w7Ymu0QL2FkMMSjP9RCl/smime.p7s\">smime.p7s</a></p>\n</blockquote>",
        "id": 238427907,
        "sender_full_name": "Email Gateway",
        "timestamp": 1620801329
    }
]