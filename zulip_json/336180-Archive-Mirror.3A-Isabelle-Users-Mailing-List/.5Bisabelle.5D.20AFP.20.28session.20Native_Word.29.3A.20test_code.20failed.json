[
    {
        "content": "<p>From: Christian Sternagel &lt;<a href=\"mailto:c.sternagel@gmail.com\">c.sternagel@gmail.com</a>&gt;<br>\nDear all,</p>\n<p>I am in the strange situation that on a workstation Native_Word builds,<br>\nwhile on my laptop (with, as far as I can tell, almost identical setup)<br>\nthere is a problem with code generation (see the attached log file).</p>\n<p>On both machines I use Isabelle2017 and afp-2017 ( 5af4ceb1cc28 ). On<br>\nthe workstation I have</p>\n<p>$ isabelle build -v Native_Word<br>\nStarted at Tue Dec 12 13:13:57 GMT+1 2017 (polyml-5.6_x86_64-linux on<br>\ncllabws1)<br>\nISABELLE_BUILD_OPTIONS=\"threads=12\"</p>\n<p>ML_PLATFORM=\"x86_64-linux\"<br>\nML_HOME=\"/home/griff/Downloads/Isabelle2017/contrib/polyml-5.6-1/x86_64-linux\"<br>\nML_SYSTEM=\"polyml-5.6\"<br>\nML_OPTIONS=\"-H 1500 --gcthreads 6\"<br>\n...</p>\n<p>and on my laptop</p>\n<p>$ isabelle build -v Native_Word<br>\nStarted at Tue Dec 12 13:13:37 GMT+1 2017 (polyml-5.6_x86_64-linux on<br>\ncst470s)<br>\nISABELLE_BUILD_OPTIONS=\"threads=4\"</p>\n<p>ML_PLATFORM=\"x86_64-linux\"<br>\nML_HOME=\"/usr/local/Isabelle2017/contrib/polyml-5.6-1/x86_64-linux\"<br>\nML_SYSTEM=\"polyml-5.6\"<br>\nML_OPTIONS=\"-H 1500 --gcthreads 2\"<br>\n...</p>\n<p>Any ideas what could have gone wrong? (In the meantime I am just copying<br>\nthe heap images generated on the workstation to my laptop, which works<br>\nfine.)</p>\n<p>cheers</p>\n<p>chris<br>\n<a href=\"/user_uploads/14278/-BCTpG859mCsvmE5Rugc-YoD/Native_Word\">Native_Word</a></p>",
        "id": 294723967,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661185808
    },
    {
        "content": "<p>From: Manuel Eberl &lt;<a href=\"mailto:eberlm@in.tum.de\">eberlm@in.tum.de</a>&gt;<br>\nI think I know what this is.</p>\n<p>I had a very similar problem a while ago. I worked for a day or two with<br>\nMakarius and David Matthews to figure out what it is and it is related<br>\nto some problem with thread synchronisation in Poly/ML.</p>\n<p>The problem appears to be resolved in Poly/ML 5.7.1.</p>\n<p>To be more precise, Poly/ML has something called a \"crowbar thread\" that<br>\nis launched at the very end of the process (before all the resources are<br>\ncleaned up) and terminates the process after 20 seconds if the cleanup<br>\nhas not completed. However, at some point during the cleanup, one of the<br>\nthread synchronisation variables that was still in use was being<br>\ndeleted, which is undefined behaviour in pthreads.</p>\n<p>Apparently, this causes no problems on most systems, but there are rare<br>\ncases where you get spurious deadlocks, which cause the crowbar thread<br>\nto kick in at some point and ML returns with exit code 1.</p>\n<p>Independently from these problems, David Matthews changed the way the<br>\nthread synchronisation is done in 5.7.1 and now the problem does not<br>\noccur anymore; at least for me.</p>\n<p>Cheers,</p>\n<p>Manuel</p>",
        "id": 294723980,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661185812
    }
]