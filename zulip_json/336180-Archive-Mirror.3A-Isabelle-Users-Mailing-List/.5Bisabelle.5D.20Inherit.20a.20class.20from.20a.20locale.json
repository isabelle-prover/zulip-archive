[
    {
        "content": "<p>From: Denis Nikiforov &lt;<a href=\"mailto:denis.nikif@gmail.com\">denis.nikif@gmail.com</a>&gt;<br>\nHi</p>\n<p>It seems that I \"invented\" a cool technique to \"inherit\" a class from a<br>\nlocale.</p>\n<p>Let \"loc\" is a locale defining some useful functions (g' in this case):</p>\n<p>locale loc =<br>\n  fixes f :: \"'a ⇒ 'b\"<br>\n  assumes inj_f: \"inj f\"<br>\nbegin<br>\nabbreviation \"g' ≡ map_option f\"<br>\nend</p>\n<p>Let \"cls\" is a class which should be inherited from loc with 'b binded to<br>\n\"'a ty\":</p>\n<p>datatype 'a ty = A | B</p>\n<p>class cls =<br>\n  fixes f :: \"'a ⇒ 'a ty\"<br>\n  assumes inj_f: \"inj f\"<br>\nbegin</p>\n<p>interpretation loc f<br>\n  apply standard<br>\n  by (simp add: local.inj_f)</p>\n<p>definition \"g ≡ g'\"</p>\n<p>end</p>\n<p>Here is a test case:</p>\n<p>datatype dt = C | D</p>\n<p>instantiation dt :: cls<br>\nbegin</p>\n<p>fun f_dt :: \"dt ⇒ dt ty\" where<br>\n  \"f_dt C = A\"<br>\n| \"f_dt D = B\"</p>\n<p>instance<br>\n  apply intro_classes<br>\n  by (smt f_dt.elims injI ty.distinct(1))</p>\n<p>end</p>\n<p>value \"f C\"<br>\nvalue \"g (Some C)\"</p>\n<p>As you can see g is implemented in the locale. But it is overloaded as a<br>\nfunction defined for a class. Maybe it will be useful for somebody else.<br>\nThis technique allows to combine pros of both classes and locales.</p>",
        "id": 294748598,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661194525
    }
]