[
    {
        "content": "<p>From: \"C. Diekmann\" &lt;<a href=\"mailto:diekmann@in.tum.de\">diekmann@in.tum.de</a>&gt;<br>\nDear Makarius,</p>\n<p>I experienced some unexpected behavior of the automatic indentation when<br>\nused together with the <code>subgoal</code> command.</p>\n<p>Here is a minimal example where the auto indenter does great work:</p>\n<p>lemma \"A ⟹ B ⟹ A ∧ B\"<br>\n  apply(rule conjI)<br>\n   apply(simp)<br>\n  by(assumption)</p>\n<p>After the conjI rule is applied, we have two subgoals and the following<br>\nsimp is indented by one additional space. This is how it should be. If I<br>\nwant to specifically indicate that simp solves the subgoal, I can use the<br>\n<code>subgoal</code> command. This is what the auto indenter gives me:</p>\n<p>lemma \"A ⟹ B ⟹ A ∧ B\"<br>\n  apply(rule conjI)<br>\n  subgoal by (simp)<br>\n  by(assumption)</p>\n<p>The \"subgoal by (simp)\"-step does not get indented. I don't know if this is<br>\nthe expected behavior, but I would expect the following:</p>\n<p>lemma \"A ⟹ B ⟹ A ∧ B\"<br>\n  apply(rule conjI)<br>\n   subgoal by (simp)<br>\n  by(assumption)</p>\n<p>This report is not about simp. For this particular example, I could use the<br>\napply(simp; fail) pattern, which the indenter handles fine. This report is<br>\nabout -- from my point of view -- a bad interaction of the indenter and the<br>\nsubgoal command.</p>\n<p>This is what the indenter does if the <code>subgoal</code> is solved by a longer apply<br>\nscript:</p>\n<p>lemma \"A ⟹ B ⟹ A ∧ B\"<br>\n  apply(rule conjI)<br>\n  subgoal apply -<br>\n    apply -<br>\n    apply(insert TrueI)<br>\n    apply blast<br>\n    done<br>\n  by(assumption)</p>\n<p>My points of criticism are:</p>\n<ul>\n<li>\n<p>the first line where <code>subgoal</code> appears is not additionally indented,<br>\nthough the previous line produced a new subgoal.</p>\n</li>\n<li>\n<p>The apply script of the <code>subgoal</code> is indented by two additional spaces,<br>\nthough no new subgoals appeared.</p>\n</li>\n</ul>\n<p>Best Regards,<br>\n  Cornelius</p>",
        "id": 294719312,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661184223
    },
    {
        "content": "<p>From: Makarius &lt;<a href=\"mailto:makarius@sketis.net\">makarius@sketis.net</a>&gt;<br>\nThe idea behind this: 'subgoal' enforces a certain structure on its own,<br>\nand extra indentation is not required to indicate that in the text: it<br>\nalways solves one subgoal and always requires a complete subproof. Thus<br>\nit is the analogue of 'show'. For example:</p>\n<p>lemma A B C<br>\nproof -<br>\n  show A \\&lt;proof&gt;<br>\n  show B \\&lt;proof&gt;<br>\n  show C \\&lt;proof&gt;<br>\nqed</p>\n<p>lemma A B C<br>\n  subgoal A \\&lt;proof&gt;<br>\n  subgoal B \\&lt;proof&gt;<br>\n  subgoal C \\&lt;proof&gt;<br>\n  done</p>\n<p>At least that is the idea from some years ago, when subgoal emerged as<br>\nspin-off from Eisbach. Since it is relatively new, it might require<br>\nfurther iterations of refinement, but that requires some real-world<br>\nexamples to look at. (So far I've done this sporadically in various<br>\nlibrary sessions, using the above scheme.)</p>\n<p>Apropos 'using' (as a command): it is always indented like a structured<br>\ncommand, even though it might float freely within an apply script and<br>\nthus would require the same indentation as 'apply'. Luckily, we no<br>\nlonger need that and may use the \"use\" proof method instead:</p>\n<p>using facts apply method</p>\n<p>becomes:</p>\n<p>apply (use facts in method)</p>\n<p>Makarius</p>",
        "id": 294719334,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661184229
    },
    {
        "content": "<p>From: <a href=\"mailto:Gerwin.Klein@data61.csiro.au\">Gerwin.Klein@data61.csiro.au</a><br>\nAs a an additional data point (maybe not for this release any more):</p>\n<p>We do have some large apply scripts that use subgoal to good advantage, and in those an indentation similar to apply would work quite well. That use is slightly different to the originally intended analogy to \"show\", but still has some connection:</p>\n<p>For instance, we have things like:</p>\n<p>lemma X<br>\n  apply ..<br>\n         apply ..<br>\n        apply ..<br>\n       subgoal<br>\n         by ...<br>\n      subgoal<br>\n        apply ..<br>\n        apply ..<br>\n        done<br>\n     apply ..<br>\n    ...</p>\n<p>The current auto indent would turn this into</p>\n<p>lemma X<br>\n  apply ..<br>\n         apply ..<br>\n        apply ..<br>\n  subgoal<br>\n    by ...       <br>\n  subgoal<br>\n    apply ..<br>\n    apply ..<br>\n    done<br>\n      apply ..</p>\n<p>which is a bit jarring and confers less information to the reader.</p>\n<p>Cheers,<br>\nGerwin</p>",
        "id": 294720326,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661184559
    }
]