[
    {
        "content": "<p>From: Tjark Weber &lt;<a href=\"mailto:tjark.weber@it.uu.se\">tjark.weber@it.uu.se</a>&gt;<br>\nThe attached lemma about well-foundedness of relational composition<br>\nfeatured prominently in a recent termination proof of mine. If the<br>\nlemma is not available already, I would like to propose it for<br>\ninclusion in HOL/Wellfounded.thy (or some derived theory).</p>\n<p>I discovered the lemma and proof myself, but I suspect that the result<br>\nis well-known. Pointers to the literature would be appreciated.</p>\n<p>Best,<br>\nTjark</p>\n<p>===== 8&lt; =====</p>\n<p>lemma wf_relcomp_compatible:<br>\n  assumes \"wf R\" and \"R O S \\&lt;subseteq&gt; S O R\"<br>\n  shows \"wf (S O R)\"<br>\nproof (rule wfI_pf)<br>\n  fix A assume A: \"A \\&lt;subseteq&gt; (S O R) <code> A\"\n  {\n    fix n have \"(S ^^ n) </code> A \\&lt;subseteq&gt; R <code> (S ^^ Suc n) </code> A\"<br>\n    proof (induction n)<br>\n      case 0 show ?case<br>\n        using A by (simp add: relcomp_Image)<br>\n    next<br>\n      case (Suc n)<br>\n      then have \"S <code> (S ^^ n) </code> A \\&lt;subseteq&gt; S <code> R </code> (S ^^ Suc n)<br>\n<code> A\"\n        by (metis Image_mono subsetCI)\n      also have \"\\&lt;dots&gt; \\&lt;subseteq&gt; R </code> S <code> (S ^^ Suc n) </code> A\"<br>\n        using assms(2) by (metis (no_types, hide_lams) Image_mono<br>\norder_refl relcomp_Image)<br>\n      finally show ?case<br>\n        by (metis relcomp_Image relpow.simps(2))<br>\n    qed<br>\n  }<br>\n  then have \"(\\&lt;Union&gt;n. (S ^^ n) <code> A) \\&lt;subseteq&gt; R </code> (\\&lt;Union&gt;n. (S<br>\n^^ n) <code> A)\"\n    by blast\n  then have \"(\\&lt;Union&gt;n. (S ^^ n) </code> A) = {}\"<br>\n    using assms(1) by (metis wfE_pf)<br>\n  then show \"A = {}\"<br>\n    using relpow.simps(1) by blast<br>\nqed</p>",
        "id": 294636325,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661160287
    },
    {
        "content": "<p>From: Tobias Nipkow &lt;<a href=\"mailto:nipkow@in.tum.de\">nipkow@in.tum.de</a>&gt;<br>\nI am not aware of this lemma from the literature, but maybe our friends in <br>\nInnsbruck are?</p>\n<p>I'll be happy to include it in HOL/Wellfounded.thy if you do me the favour of <br>\ngetting rid of metis - it is not available at that theory yet. Maybe somebody <br>\ncan also think of a more telling name suffix than \"_compatible\".</p>\n<p>Thanks<br>\nTobias<br>\n<a href=\"/user_uploads/14278/xaDWNlh2dbRESjzP5x1Mz7Bl/smime.p7s\">smime.p7s</a></p>",
        "id": 294636601,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661160404
    },
    {
        "content": "<p>From: Tjark Weber &lt;<a href=\"mailto:tjark.weber@it.uu.se\">tjark.weber@it.uu.se</a>&gt;<br>\nTobias,</p>\n<p>On Sun, 2015-04-26 at 09:24 +0200, Tobias Nipkow wrote:</p>\n<blockquote>\n<p>I'll be happy to include it in HOL/Wellfounded.thy if you do me the favour of <br>\ngetting rid of metis - it is not available at that theory yet.</p>\n</blockquote>\n<p>Certainly. A proof that uses only simp and blast is attached.</p>\n<blockquote>\n<p>Maybe somebody can also think of a more telling name suffix than \"_compatible\".</p>\n</blockquote>\n<p>This was inspired by the existing lemma wf_union_compatible. Of course,<br>\nit is a terrible name.</p>\n<p>Best,<br>\nTjark</p>\n<p>===== 8&lt; =====</p>\n<p>lemma wf_relcomp_compatible:<br>\n  assumes \"wf R\" and \"R O S \\&lt;subseteq&gt; S O R\"<br>\n  shows \"wf (S O R)\"<br>\nproof (rule wfI_pf)<br>\n  fix A assume A: \"A \\&lt;subseteq&gt; (S O R) <code> A\"\n  {\n    fix n have \"(S ^^ n) </code> A \\&lt;subseteq&gt; R <code> (S ^^ Suc n) </code> A\"<br>\n    proof (induction n)<br>\n      case 0 show ?case<br>\n        using A by (simp add: relcomp_Image)<br>\n    next<br>\n      case (Suc n)<br>\n      then have \"S <code> (S ^^ n) </code> A \\&lt;subseteq&gt; S <code> R </code> (S ^^ Suc n)<br>\n<code> A\"\n        by (simp add: Image_mono)\n      also have \"\\&lt;dots&gt; \\&lt;subseteq&gt; R </code> S <code> (S ^^ Suc n) </code> A\"<br>\n        using assms(2) by (simp add: Image_mono O_assoc<br>\nrelcomp_Image[symmetric] relcomp_mono)<br>\n      finally show ?case<br>\n        by (simp add: relcomp_Image)<br>\n    qed<br>\n  }<br>\n  then have \"(\\&lt;Union&gt;n. (S ^^ n) <code> A) \\&lt;subseteq&gt; R </code> (\\&lt;Union&gt;n. (S<br>\n^^ n) <code> A)\"\n    by blast\n  then have \"(\\&lt;Union&gt;n. (S ^^ n) </code> A) = {}\"<br>\n    using assms(1) by (simp only: wfE_pf)<br>\n  then show \"A = {}\"<br>\n    using relpow.simps(1) by blast<br>\nqed</p>",
        "id": 294636634,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661160419
    },
    {
        "content": "<p>From: Christian Sternagel &lt;<a href=\"mailto:c.sternagel@gmail.com\">c.sternagel@gmail.com</a>&gt;<br>\nDear Tjark and Tobias,</p>\n<p>This is my first impression: I've definitely seen this fact applied <br>\n(although implicitly) and think it counts as, as they say, \"folklore\".</p>\n<p>Especially so, since the paper \"proof\" is trivial ;):</p>\n<p>Assume: RS RS RS RS RS RS ...<br>\nRearrange into: R SR SR SR SR SR ...<br>\nApply \"RS &lt;= SR\": R RS RS RS RS RS ...<br>\nRepeat this process to obtain: R R R R R R ...<br>\nContradiction.</p>\n<p>I checked IsaFoR by hypersearch but didn't find anything that looks <br>\nalike immediately. That is, I'm not aware of any formalized proof.</p>\n<p>After investigating a little further, I found some relevant literature. <br>\nCommutation has been investigated by Rosen [3], but as far as I can tell <br>\non a short glance only w.r.t. confluence. Bachmair and Dershowitz [2] <br>\npronounce \"RS &lt;= SR\" as \"R <em>commutes over</em> S\" (whereas \"commutation\" <br>\nwithout \"over\" would result in a \"diamond\" diagram). And Geser [1] <br>\n(which was the reference I started from) at least comments about <br>\nsomething similar to your lemma on page 38:</p>\n<p>If R is Noetherian, it is more convenient to check for strict<br>\n   local commutation than for quasi-commutation: They are<br>\n   equivalent, and checking for strict local commutation is<br>\n   less complex ...</p>\n<p>But also here I did not find a proof by skimming through. Maybe a closer <br>\nlook would reveal something.</p>\n<p>[1] Alfons Geser. Relative Termination. PhD-Thesis. 1990.<br>\n[2] Leo Bachmair, Nachum Dershowitz. Commutation, Transformation, and <br>\nTermination. CADE. 1986. <a href=\"http://dx.doi.org/10.1007/3-540-16780-3_76\">http://dx.doi.org/10.1007/3-540-16780-3_76</a><br>\n[3] Barry K. Rosen. Tree-Manipulating Systems and Church-Rosser <br>\nTheorems. J. ACM (JACM) 20(1):160-187 (1973). <br>\n<a href=\"http://doi.acm.org/10.1145/321738.321750\">http://doi.acm.org/10.1145/321738.321750</a></p>\n<p>cheers</p>\n<p>chris</p>",
        "id": 294636723,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661160452
    },
    {
        "content": "<p>From: Christian Sternagel &lt;<a href=\"mailto:c.sternagel@gmail.com\">c.sternagel@gmail.com</a>&gt;<br>\nOkay, here is a little bit more:</p>\n<p>The following is Lemma 2 from Bachmair and Dershowitz 1986 (I left the <br>\nhard part of the proof as an exercise ;) ... I hope it works similar to <br>\nwhat Tjark did before, but since it was proved on paper it has to be <br>\ncorrect \\o/ right?):</p>\n<p>lemma qc_wf_relto_iff:<br>\n   assumes \"R O S ⊆ S O (R ∪ S)⇧*\" -- ‹R quasi-commutes over S›<br>\n   shows \"wf (S⇧* O R O S⇧*) ⟷ wf R\"<br>\nproof<br>\n   assume \"wf (S⇧* O R O S⇧*)\"<br>\n   moreover have \"R ⊆ S⇧* O R O S⇧*\" by auto<br>\n   ultimately show \"wf R\" using wf_subset by auto<br>\nnext<br>\n   assume \"wf R\"<br>\n   then show \"wf (S⇧* O R O S⇧*)\" sorry<br>\nqed</p>\n<p>It can be used to proof \"Tjark's Lemma\" :)</p>\n<p>corollary<br>\n   assumes \"wf R\" and \"R O S ⊆ S O R\"<br>\n   shows \"wf (S O R)\"<br>\nproof -<br>\n   have \"R O S ⊆ S O (R ∪ S)⇧*\" using ‹R O S ⊆ S O R› by auto<br>\n   then have \"wf (S⇧* O R O S⇧*)\"<br>\n     using ‹wf R› by (simp add: qc_wf_relto_iff)<br>\n   moreover have \"S O R ⊆ S⇧* O R O S⇧*\" by auto<br>\n   ultimately show ?thesis using wf_subset by auto<br>\nqed</p>\n<p>Depending on who you cite the \"subset assumption\" could be called:</p>\n<ul>\n<li>R commutes over S (BD86)</li>\n<li>\n<p>R strictly locally commutes over S (Geser, PhD); which actually <br>\ndenotes: R O S ⊆ S^* O R^+</p>\n</li>\n<li>\n<p>...</p>\n</li>\n</ul>\n<p>hope this helps</p>\n<p>chris</p>",
        "id": 294636750,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661160465
    },
    {
        "content": "<p>From: Tjark Weber &lt;<a href=\"mailto:tjark.weber@it.uu.se\">tjark.weber@it.uu.se</a>&gt;<br>\nChristian,</p>\n<p>Thank you for the detailed literature search. Of course, I am all for<br>\nadding the much more general lemma to Wellfounded.thy.</p>\n<p>I can try to complete the formal proof later this week. (If somebody<br>\nelse wants to go ahead with this right now, I certainly don't mind.)</p>\n<p>Best,<br>\nTjark</p>",
        "id": 294636766,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661160470
    },
    {
        "content": "<p>From: Tobias Nipkow &lt;<a href=\"mailto:nipkow@in.tum.de\">nipkow@in.tum.de</a>&gt;<br>\nI have just added it. You are welcome to send me an improved version later.</p>\n<p>Tobias<br>\n<a href=\"/user_uploads/14278/gYlotwfaOt358IJA5TLbU8HQ/smime.p7s\">smime.p7s</a></p>",
        "id": 294636827,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661160484
    },
    {
        "content": "<p>From: Jeremy Dawson &lt;<a href=\"mailto:Jeremy.Dawson@anu.edu.au\">Jeremy.Dawson@anu.edu.au</a>&gt;<br>\nHi Tjark / Christian,</p>\n<p>I'm confused by the notation here.<br>\nFirstly, R O S:<br>\ndoesn't this mean, that where (a, b) in S and (b, c) in R, then (a, c) <br>\nin R 0 S ?<br>\nSecondly, wf R - doesn't this mean that there is no infinite chain<br>\n  ..... an ... a1 a0<br>\nsuch that each (a_{n+1}, a_n) in R ?</p>\n<p>So using this notation,<br>\nlet R = (n, n+1) for all n (naturals)<br>\nlet S = (n+1, n) for all n<br>\nThen R O S = {(n, n) | n &gt;= 1}<br>\nS O R = {(n, n) | n &gt;= 0}</p>\n<p>Anyhow, in<br>\n<a href=\"http://users.cecs.anu.edu.au/~jeremy/isabelle/2005/gen/WfUn.{thy,ML}\">http://users.cecs.anu.edu.au/~jeremy/isabelle/2005/gen/WfUn.{thy,ML}</a><br>\nI have proofs of<br>\n  \"(s O r &lt;= r O s^*) --&gt; wf r --&gt; wf (r O s^*)\"<br>\nand  \"(s O r &lt;= r O s^*) --&gt; wf r --&gt; wf (s^* O r)\"<br>\n(they're called<br>\nwf_movl_comp and wf_movl_comp2)<br>\n(obviously, wf (r O s) = wf (s O r))<br>\n(proofs are in Isabelle2005)</p>\n<p>I now see in that file I have a note:</p>\n<p>(* note - can't get result<br>\n   \"(r O s &lt;= s^* O r) ==&gt; wf r ==&gt; wf (s^* O r)\", eg<br>\n   E = {(x, y) | x &gt;= 0, 0 &lt;= y &lt;= x}<br>\n   (x, y) &gt;_r (x, y+1) - so r is wf<br>\n   (x, y) &gt;_s (x+1, y) - so r O s, s O r not wf<br>\n   In r O s, (x, y) &gt; (x+1, y+1) but only if y &lt; x<br>\n   In s O r, (x, y) &gt; (x+1, y+1) always<br>\n   So (r O s &lt;= s O r) *)</p>\n<p>As for the paper proof below - what does it mean?  It seems to <br>\ncorrespond to the theorem stated if<br>\nRS RS ...<br>\nmeans x0 &gt;R x1 &gt;S x2 &gt;R x3 &gt;S x4 ...<br>\nin which case wf R means R R R R ... is not possible, but then<br>\nhaven't you actually applied SR &lt;= RS, not RS &lt;= SR?</p>\n<p>Even if I've got conused somewhere above I can't see how you and I could <br>\nhave both proved results, in Isabelle, one of which seems to be wrong. <br>\nHas the definition of wf or of O changed since 2005?</p>\n<p>Cheers,</p>\n<p>Jeremy</p>",
        "id": 294636845,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661160490
    },
    {
        "content": "<p>From: Christian Sternagel &lt;<a href=\"mailto:c.sternagel@gmail.com\">c.sternagel@gmail.com</a>&gt;<br>\nJust for the record: Sorry, I introduced a typo in my (sorry) lemma. <br>\n(Actually hinted at by quickcheck, since my formulation is not correct.)</p>\n<p>The problem was (once again) to adapt the orientation from the rewriting <br>\nliterature (where \"smaller\" is on the right) to the orientation of \"wf\" <br>\n(where \"smaller\" is on the left).</p>\n<p>It should actually be:</p>\n<p>lemma qc_wf_relto_iff:<br>\n   assumes \"R O S ⊆ (R ∪ S)⇧* O R\"<br>\n   shows \"wf (S⇧* O R O S⇧*) ⟷ wf R\"<br>\n...</p>\n<p>This still implies Tjark's lemma and I hope it is provable ;) (I'll give <br>\nit a try).</p>\n<p>cheers</p>\n<p>chris</p>",
        "id": 294636863,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661160495
    },
    {
        "content": "<p>From: Christian Sternagel &lt;<a href=\"mailto:c.sternagel@gmail.com\">c.sternagel@gmail.com</a>&gt;<br>\nDear Jeremy,</p>\n<p>Without having read everything below in detail: Yes, the definition of O <br>\nhas changed. At the moment:</p>\n<p>(x, z) : R O S &lt;--&gt; EX y. (x, y) : R &amp; (y, z) : S</p>\n<p>As to your other remarks, I'm sure that I have many typos in everything <br>\nthat was not checked by Isabelle ;). I'll look into it later.</p>\n<p>cheers</p>\n<p>chris</p>",
        "id": 294636870,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661160502
    },
    {
        "content": "<p>From: Christian Sternagel &lt;<a href=\"mailto:c.sternagel@gmail.com\">c.sternagel@gmail.com</a>&gt;<br>\nPlease find attached a formalization (thanks to Bertram for pointless <br>\ninduction having a point ;)), alas, it still relies on Regexp. Maybe <br>\nsomeone would like to rectify this?</p>\n<p>cheers</p>\n<p>chris<br>\n<a href=\"/user_uploads/14278/ISOpdUV6uhui3xphOPcxN1zp/Bla.thy\">Bla.thy</a></p>",
        "id": 294636908,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661160520
    },
    {
        "content": "<p>From: Tjark Weber &lt;<a href=\"mailto:tjark.weber@it.uu.se\">tjark.weber@it.uu.se</a>&gt;<br>\nTobias (and Christian),</p>\n<p>Attached is a proof of Bachmair and Dershowitz's Lemma 2 that should<br>\nwork in the context of Wellfounded.thy.</p>\n<p>If you decide to add this lemma to Wellfounded.thy, I would suggest<br>\nthat the lemma that I provided earlier (which you added in<br>\n<a href=\"https://isabelle.in.tum.de/repos/isabelle/rev/f0fc2378a479\">https://isabelle.in.tum.de/repos/isabelle/rev/f0fc2378a479</a>) could<br>\nperhaps be removed again. As Christian pointed out, it is an easy<br>\ncorollary of this much more general result.</p>\n<p>Best,<br>\nTjark<br>\n<a href=\"/user_uploads/14278/dR97xP6H2GNLQ1NhDbPVEwTy/Scratch.thy\">Scratch.thy</a></p>",
        "id": 294642691,
        "sender_full_name": "Email Gateway",
        "timestamp": 1661162783
    }
]