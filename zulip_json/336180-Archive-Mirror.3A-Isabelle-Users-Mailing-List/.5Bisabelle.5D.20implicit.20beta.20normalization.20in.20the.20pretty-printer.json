[
    {
        "content": "<p>From: Makarius &lt;<a href=\"mailto:makarius@sketis.net\">makarius@sketis.net</a>&gt;<br>\n(I am answering this on isabelle-users, not on isabelle-dev, because <br>\nIsabelle/ML is perfectly normal user space; \"the ML level\" is actually <br>\npart of the Isar toplevel.  I also refrain from cross-posting (!) to <br>\nisabelle-dev, because that list is de-facto a subset of isabelle-users <br>\nand duplicates don't help.)</p>\n<p>The beta contraction observed above is actually part of the treatment of <br>\nterm abbreviations, which uses principles from higher-order rewriting and <br>\nthat includes beta-contraction.  Abbreviations are treated both in the <br>\n\"term check\" phase for input and the \"term uncheck\" phase for output.  So <br>\nit is hard to input terms that are not beta normal, and the following uses <br>\nsome plain Isabelle/Isar/ML:</p>\n<p>ML {*<br>\n   val t = @{term \"%x::'a. x\"} $ @{term \"a::'a\"};<br>\n   val u = singleton (Syntax.uncheck_terms @{context}) t;<br>\n*}</p>\n<p>val t = Abs (\"x\", \"'a\", Bound 0) $ Free (\"a\", \"'a\"): term<br>\nval u = Free (\"a\", \"'a\"): term</p>\n<p>The actual pretty printing is done in the so-called \"unparse\" phase and is <br>\ninnocent here: it does not do any beta contraction on its own.  You could <br>\neven try to make your own low-level printing for diagnostic purposes based <br>\non Syntax.uncheck_terms alone, which is mainly the pretty printer only.</p>\n<p>In order to disable merely the contraction of abbreviations (with its beta <br>\nconversion) during term-unchecking, you can use the following suitable <br>\nconfiguration option on the context:</p>\n<p>declare [[show_abbrevs = false]]</p>\n<p>Of course you need to use the correct context for printing to see the <br>\neffect.</p>\n<p>Makarius</p>",
        "id": 294150164,
        "sender_full_name": "Email Gateway",
        "timestamp": 1660849021
    }
]